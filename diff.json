{
  "platform": {
    "name": "centos",
    "release": "7.2.1511"
  },
  "profiles": [
    {
      "name": "elasticsearch-baseline",
      "version": "0.1.0",
      "sha256": "d64349f936de8a82816f645c38e92bfbb035db1fcc93f0ca2b35c49945154517",
      "title": "Elasticsearch Baseline",
      "maintainer": "The Authors",
      "summary": "An InSpec Compliance Profile",
      "license": "Apache-2.0",
      "copyright": "The Authors",
      "copyright_email": "you@example.com",
      "supports": [],
      "attributes": [
        {
          "name": "elastic_ip",
          "options": {
            "description": "IP address of the elasticsearch instance",
            "default": "0.0.0.0"
          }
        },
        {
          "name": "elastic_port",
          "options": {
            "description": "Port address of the elasticsearch instance",
            "default": "9200"
          }
        },
        {
          "name": "es_admin",
          "options": {
            "description": "Elasticsearch admin",
            "default": "elastic"
          }
        },
        {
          "name": "es_pass",
          "options": {
            "description": "Elasticsearch admin password",
            "default": "changeme"
          }
        },
        {
          "name": "ssl_verify",
          "options": {
            "description": "Elasticsearch admin password",
            "default": false
          }
        },
        {
          "name": "elasticsearch_conf",
          "options": {
            "description": "Path to elasticsearch.yml",
            "default": "/etc/elasticsearch/elasticsearch.yml"
          }
        },
        {
          "name": "elastic_ip",
          "options": {
            "description": "IP address of the elasticsearch instance",
            "default": "0.0.0.0"
          }
        },
        {
          "name": "elastic_port",
          "options": {
            "description": "Port address of the elasticsearch instance",
            "default": "9200"
          }
        },
        {
          "name": "es_admin",
          "options": {
            "description": "Elasticsearch admin",
            "default": "elastic"
          }
        },
        {
          "name": "es_pass",
          "options": {
            "description": "Elasticsearch admin password",
            "default": "changeme"
          }
        },
        {
          "name": "ssl_verify",
          "options": {
            "description": "Elasticsearch admin password",
            "default": false
          }
        },
        {
          "name": "elasticsearch_conf",
          "options": {
            "description": "Path to elasticsearch.yml",
            "default": "/etc/elasticsearch/elasticsearch.yml"
          }
        },
        {
          "name": "elastic_ip",
          "options": {
            "description": "IP address of the elasticsearch instance",
            "default": "0.0.0.0"
          }
        },
        {
          "name": "elastic_port",
          "options": {
            "description": "Port address of the elasticsearch instance",
            "default": "9200"
          }
        },
        {
          "name": "es_admin",
          "options": {
            "description": "Elasticsearch admin",
            "default": "elastic"
          }
        },
        {
          "name": "es_pass",
          "options": {
            "description": "Elasticsearch admin password",
            "default": "changeme"
          }
        },
        {
          "name": "ssl_verify",
          "options": {
            "description": "Elasticsearch admin password",
            "default": false
          }
        },
        {
          "name": "elasticsearch_conf",
          "options": {
            "description": "Path to elasticsearch.yml",
            "default": "/etc/elasticsearch/elasticsearch.yml"
          }
        },
        {
          "name": "elastic_ip",
          "options": {
            "description": "IP address of the elasticsearch instance",
            "default": "0.0.0.0"
          }
        },
        {
          "name": "elastic_port",
          "options": {
            "description": "Port address of the elasticsearch instance",
            "default": "9200"
          }
        },
        {
          "name": "es_admin",
          "options": {
            "description": "Elasticsearch admin",
            "default": "elastic"
          }
        },
        {
          "name": "es_pass",
          "options": {
            "description": "Elasticsearch admin password",
            "default": "changeme"
          }
        },
        {
          "name": "ssl_verify",
          "options": {
            "description": "Elasticsearch admin password",
            "default": false
          }
        },
        {
          "name": "elasticsearch_conf",
          "options": {
            "description": "Path to elasticsearch.yml",
            "default": "/etc/elasticsearch/elasticsearch.yml"
          }
        },
        {
          "name": "elastic_ip",
          "options": {
            "description": "IP address of the elasticsearch instance",
            "default": "0.0.0.0"
          }
        },
        {
          "name": "elastic_port",
          "options": {
            "description": "Port address of the elasticsearch instance",
            "default": "9200"
          }
        },
        {
          "name": "es_admin",
          "options": {
            "description": "Elasticsearch admin",
            "default": "elastic"
          }
        },
        {
          "name": "es_pass",
          "options": {
            "description": "Elasticsearch admin password",
            "default": "changeme"
          }
        },
        {
          "name": "ssl_verify",
          "options": {
            "description": "Elasticsearch admin password",
            "default": false
          }
        },
        {
          "name": "elasticsearch_conf",
          "options": {
            "description": "Path to elasticsearch.yml",
            "default": "/etc/elasticsearch/elasticsearch.yml"
          }
        },
        {
          "name": "elastic_ip",
          "options": {
            "description": "IP address of the elasticsearch instance",
            "default": "0.0.0.0"
          }
        },
        {
          "name": "elastic_port",
          "options": {
            "description": "Port address of the elasticsearch instance",
            "default": "9200"
          }
        },
        {
          "name": "es_admin",
          "options": {
            "description": "Elasticsearch admin",
            "default": "elastic"
          }
        },
        {
          "name": "es_pass",
          "options": {
            "description": "Elasticsearch admin password",
            "default": "changeme"
          }
        },
        {
          "name": "ssl_verify",
          "options": {
            "description": "Elasticsearch admin password",
            "default": false
          }
        },
        {
          "name": "elastic_ip",
          "options": {
            "description": "IP address of the elasticsearch instance",
            "default": "0.0.0.0"
          }
        },
        {
          "name": "elastic_port",
          "options": {
            "description": "Port address of the elasticsearch instance",
            "default": "9200"
          }
        },
        {
          "name": "es_admin",
          "options": {
            "description": "Elasticsearch admin",
            "default": "elastic"
          }
        },
        {
          "name": "es_pass",
          "options": {
            "description": "Elasticsearch admin password",
            "default": "changeme"
          }
        },
        {
          "name": "ssl_verify",
          "options": {
            "description": "Elasticsearch admin password",
            "default": false
          }
        },
        {
          "name": "elastic_ip",
          "options": {
            "description": "IP address of the elasticsearch instance",
            "default": "0.0.0.0"
          }
        },
        {
          "name": "elastic_port",
          "options": {
            "description": "Port address of the elasticsearch instance",
            "default": "9200"
          }
        },
        {
          "name": "es_admin",
          "options": {
            "description": "Elasticsearch admin",
            "default": "elastic"
          }
        },
        {
          "name": "es_pass",
          "options": {
            "description": "Elasticsearch admin password",
            "default": "changeme"
          }
        },
        {
          "name": "ssl_verify",
          "options": {
            "description": "Elasticsearch admin password",
            "default": false
          }
        },
        {
          "name": "elastic_ip",
          "options": {
            "description": "IP address of the elasticsearch instance",
            "default": "0.0.0.0"
          }
        },
        {
          "name": "elastic_port",
          "options": {
            "description": "Port address of the elasticsearch instance",
            "default": "9200"
          }
        },
        {
          "name": "es_admin",
          "options": {
            "description": "Elasticsearch admin",
            "default": "elastic"
          }
        },
        {
          "name": "es_pass",
          "options": {
            "description": "Elasticsearch admin password",
            "default": "changeme"
          }
        },
        {
          "name": "ssl_verify",
          "options": {
            "description": "Elasticsearch admin password",
            "default": false
          }
        },
        {
          "name": "elasticsearch_conf",
          "options": {
            "description": "Path to elasticsearch.yml",
            "default": "/etc/elasticsearch/elasticsearch.yml"
          }
        },
        {
          "name": "elastic_ip",
          "options": {
            "description": "IP address of the elasticsearch instance",
            "default": "0.0.0.0"
          }
        },
        {
          "name": "elastic_port",
          "options": {
            "description": "Port address of the elasticsearch instance",
            "default": "9200"
          }
        },
        {
          "name": "es_admin",
          "options": {
            "description": "Elasticsearch admin",
            "default": "elastic"
          }
        },
        {
          "name": "es_pass",
          "options": {
            "description": "Elasticsearch admin password",
            "default": "changeme"
          }
        },
        {
          "name": "ssl_verify",
          "options": {
            "description": "Elasticsearch admin password",
            "default": false
          }
        },
        {
          "name": "elasticsearch_conf",
          "options": {
            "description": "Path to elasticsearch.yml",
            "default": "/etc/elasticsearch/elasticsearch.yml"
          }
        },
        {
          "name": "elastic_ip",
          "options": {
            "description": "IP address of the elasticsearch instance",
            "default": "0.0.0.0"
          }
        },
        {
          "name": "elastic_port",
          "options": {
            "description": "Port address of the elasticsearch instance",
            "default": "9200"
          }
        },
        {
          "name": "es_admin",
          "options": {
            "description": "Elasticsearch admin",
            "default": "elastic"
          }
        },
        {
          "name": "es_pass",
          "options": {
            "description": "Elasticsearch admin password",
            "default": "changeme"
          }
        },
        {
          "name": "ssl_verify",
          "options": {
            "description": "Elasticsearch admin password",
            "default": false
          }
        },
        {
          "name": "elasticsearch_conf",
          "options": {
            "description": "Path to elasticsearch.yml",
            "default": "/etc/elasticsearch/elasticsearch.yml"
          }
        },
        {
          "name": "elastic_ip",
          "options": {
            "description": "IP address of the elasticsearch instance",
            "default": "0.0.0.0"
          }
        },
        {
          "name": "elastic_port",
          "options": {
            "description": "Port address of the elasticsearch instance",
            "default": "9200"
          }
        },
        {
          "name": "es_admin",
          "options": {
            "description": "Elasticsearch admin",
            "default": "elastic"
          }
        },
        {
          "name": "es_pass",
          "options": {
            "description": "Elasticsearch admin password",
            "default": "changeme"
          }
        },
        {
          "name": "ssl_verify",
          "options": {
            "description": "Elasticsearch admin password",
            "default": false
          }
        },
        {
          "name": "elasticsearch_conf",
          "options": {
            "description": "Path to elasticsearch.yml",
            "default": "/etc/elasticsearch/elasticsearch.yml"
          }
        },
        {
          "name": "elastic_ip",
          "options": {
            "description": "IP address of the elasticsearch instance",
            "default": "0.0.0.0"
          }
        },
        {
          "name": "elastic_port",
          "options": {
            "description": "Port address of the elasticsearch instance",
            "default": "9200"
          }
        },
        {
          "name": "es_admin",
          "options": {
            "description": "Elasticsearch admin",
            "default": "elastic"
          }
        },
        {
          "name": "es_pass",
          "options": {
            "description": "Elasticsearch admin password",
            "default": "changeme"
          }
        },
        {
          "name": "ssl_verify",
          "options": {
            "description": "Elasticsearch admin password",
            "default": false
          }
        },
        {
          "name": "elasticsearch_conf",
          "options": {
            "description": "Path to elasticsearch.yml",
            "default": "/etc/elasticsearch/elasticsearch.yml"
          }
        },
        {
          "name": "elastic_ip",
          "options": {
            "description": "IP address of the elasticsearch instance",
            "default": "0.0.0.0"
          }
        },
        {
          "name": "elastic_port",
          "options": {
            "description": "Port address of the elasticsearch instance",
            "default": "9200"
          }
        },
        {
          "name": "es_admin",
          "options": {
            "description": "Elasticsearch admin",
            "default": "elastic"
          }
        },
        {
          "name": "es_pass",
          "options": {
            "description": "Elasticsearch admin password",
            "default": "changeme"
          }
        },
        {
          "name": "ssl_verify",
          "options": {
            "description": "Elasticsearch admin password",
            "default": false
          }
        },
        {
          "name": "elasticsearch_conf",
          "options": {
            "description": "Path to elasticsearch.yml",
            "default": "/etc/elasticsearch/elasticsearch.yml"
          }
        },
        {
          "name": "elastic_ip",
          "options": {
            "description": "IP address of the elasticsearch instance",
            "default": "0.0.0.0"
          }
        },
        {
          "name": "elastic_port",
          "options": {
            "description": "Port address of the elasticsearch instance",
            "default": "9200"
          }
        },
        {
          "name": "es_admin",
          "options": {
            "description": "Elasticsearch admin",
            "default": "elastic"
          }
        },
        {
          "name": "es_pass",
          "options": {
            "description": "Elasticsearch admin password",
            "default": "changeme"
          }
        },
        {
          "name": "ssl_verify",
          "options": {
            "description": "Elasticsearch admin password",
            "default": false
          }
        },
        {
          "name": "elasticsearch_conf",
          "options": {
            "description": "Path to elasticsearch.yml",
            "default": "/etc/elasticsearch/elasticsearch.yml"
          }
        },
        {
          "name": "elastic_ip",
          "options": {
            "description": "IP address of the elasticsearch instance",
            "default": "0.0.0.0"
          }
        },
        {
          "name": "elastic_port",
          "options": {
            "description": "Port address of the elasticsearch instance",
            "default": "9200"
          }
        },
        {
          "name": "es_admin",
          "options": {
            "description": "Elasticsearch admin",
            "default": "elastic"
          }
        },
        {
          "name": "es_pass",
          "options": {
            "description": "Elasticsearch admin password",
            "default": "changeme"
          }
        },
        {
          "name": "ssl_verify",
          "options": {
            "description": "Elasticsearch admin password",
            "default": false
          }
        },
        {
          "name": "elasticsearch_conf",
          "options": {
            "description": "Path to elasticsearch.yml",
            "default": "/etc/elasticsearch/elasticsearch.yml"
          }
        },
        {
          "name": "elastic_ip",
          "options": {
            "description": "IP address of the elasticsearch instance",
            "default": "0.0.0.0"
          }
        },
        {
          "name": "elastic_port",
          "options": {
            "description": "Port address of the elasticsearch instance",
            "default": "9200"
          }
        },
        {
          "name": "es_admin",
          "options": {
            "description": "Elasticsearch admin",
            "default": "elastic"
          }
        },
        {
          "name": "es_pass",
          "options": {
            "description": "Elasticsearch admin password",
            "default": "changeme"
          }
        },
        {
          "name": "ssl_verify",
          "options": {
            "description": "Elasticsearch admin password",
            "default": false
          }
        },
        {
          "name": "elasticsearch_conf",
          "options": {
            "description": "Path to elasticsearch.yml",
            "default": "/etc/elasticsearch/elasticsearch.yml"
          }
        },
        {
          "name": "elastic_ip",
          "options": {
            "description": "IP address of the elasticsearch instance",
            "default": "0.0.0.0"
          }
        },
        {
          "name": "elastic_port",
          "options": {
            "description": "Port address of the elasticsearch instance",
            "default": "9200"
          }
        },
        {
          "name": "es_admin",
          "options": {
            "description": "Elasticsearch admin",
            "default": "elastic"
          }
        },
        {
          "name": "es_pass",
          "options": {
            "description": "Elasticsearch admin password",
            "default": "changeme"
          }
        },
        {
          "name": "ssl_verify",
          "options": {
            "description": "Elasticsearch admin password",
            "default": false
          }
        },
        {
          "name": "elasticsearch_conf",
          "options": {
            "description": "Path to elasticsearch.yml",
            "default": "/etc/elasticsearch/elasticsearch.yml"
          }
        },
        {
          "name": "elastic_ip",
          "options": {
            "description": "IP address of the elasticsearch instance",
            "default": "0.0.0.0"
          }
        },
        {
          "name": "elastic_port",
          "options": {
            "description": "Port address of the elasticsearch instance",
            "default": "9200"
          }
        },
        {
          "name": "es_admin",
          "options": {
            "description": "Elasticsearch admin",
            "default": "elastic"
          }
        },
        {
          "name": "es_pass",
          "options": {
            "description": "Elasticsearch admin password",
            "default": "changeme"
          }
        },
        {
          "name": "ssl_verify",
          "options": {
            "description": "Elasticsearch admin password",
            "default": false
          }
        },
        {
          "name": "elasticsearch_conf",
          "options": {
            "description": "Path to elasticsearch.yml",
            "default": "/etc/elasticsearch/elasticsearch.yml"
          }
        },
        {
          "name": "elastic_ip",
          "options": {
            "description": "IP address of the elasticsearch instance",
            "default": "0.0.0.0"
          }
        },
        {
          "name": "elastic_port",
          "options": {
            "description": "Port address of the elasticsearch instance",
            "default": "9200"
          }
        },
        {
          "name": "es_admin",
          "options": {
            "description": "Elasticsearch admin",
            "default": "elastic"
          }
        },
        {
          "name": "es_pass",
          "options": {
            "description": "Elasticsearch admin password",
            "default": "changeme"
          }
        },
        {
          "name": "ssl_verify",
          "options": {
            "description": "Elasticsearch admin password",
            "default": false
          }
        },
        {
          "name": "elasticsearch_conf",
          "options": {
            "description": "Path to elasticsearch.yml",
            "default": "/etc/elasticsearch/elasticsearch.yml"
          }
        },
        {
          "name": "elastic_ip",
          "options": {
            "description": "IP address of the elasticsearch instance",
            "default": "0.0.0.0"
          }
        },
        {
          "name": "elastic_port",
          "options": {
            "description": "Port address of the elasticsearch instance",
            "default": "9200"
          }
        },
        {
          "name": "es_admin",
          "options": {
            "description": "Elasticsearch admin",
            "default": "elastic"
          }
        },
        {
          "name": "es_pass",
          "options": {
            "description": "Elasticsearch admin password",
            "default": "changeme"
          }
        },
        {
          "name": "ssl_verify",
          "options": {
            "description": "Elasticsearch admin password",
            "default": false
          }
        },
        {
          "name": "elasticsearch_conf",
          "options": {
            "description": "Path to elasticsearch.yml",
            "default": "/etc/elasticsearch/elasticsearch.yml"
          }
        },
        {
          "name": "elastic_ip",
          "options": {
            "description": "IP address of the elasticsearch instance",
            "default": "0.0.0.0"
          }
        },
        {
          "name": "elastic_port",
          "options": {
            "description": "Port address of the elasticsearch instance",
            "default": "9200"
          }
        },
        {
          "name": "es_admin",
          "options": {
            "description": "Elasticsearch admin",
            "default": "elastic"
          }
        },
        {
          "name": "es_pass",
          "options": {
            "description": "Elasticsearch admin password",
            "default": "changeme"
          }
        },
        {
          "name": "ssl_verify",
          "options": {
            "description": "Elasticsearch admin password",
            "default": false
          }
        },
        {
          "name": "elasticsearch_conf",
          "options": {
            "description": "Path to elasticsearch.yml",
            "default": "/etc/elasticsearch/elasticsearch.yml"
          }
        },
        {
          "name": "elastic_ip",
          "options": {
            "description": "IP address of the elasticsearch instance",
            "default": "0.0.0.0"
          }
        },
        {
          "name": "elastic_port",
          "options": {
            "description": "Port address of the elasticsearch instance",
            "default": "9200"
          }
        },
        {
          "name": "es_admin",
          "options": {
            "description": "Elasticsearch admin",
            "default": "elastic"
          }
        },
        {
          "name": "es_pass",
          "options": {
            "description": "Elasticsearch admin password",
            "default": "changeme"
          }
        },
        {
          "name": "ssl_verify",
          "options": {
            "description": "Elasticsearch admin password",
            "default": false
          }
        },
        {
          "name": "elasticsearch_conf",
          "options": {
            "description": "Path to elasticsearch.yml",
            "default": "/etc/elasticsearch/elasticsearch.yml"
          }
        },
        {
          "name": "rsyslog_conf",
          "options": {
            "description": "Path to rsyslog.conf",
            "default": "/etc/rsyslog.conf"
          }
        },
        {
          "name": "log_aggregation_system",
          "options": {
            "description": "URI to the log aggregation system",
            "default": "logagg.site.mil"
          }
        },
        {
          "name": "rsyslog_conf",
          "options": {
            "description": "Path to rsyslog.conf",
            "default": "/etc/rsyslog.conf"
          }
        },
        {
          "name": "log_aggregation_system",
          "options": {
            "description": "URI to the log aggregation system",
            "default": "logagg.site.mil"
          }
        },
        {
          "name": "rsyslog_conf",
          "options": {
            "description": "Path to rsyslog.conf",
            "default": "/etc/rsyslog.conf"
          }
        },
        {
          "name": "log_aggregation_system",
          "options": {
            "description": "URI to the log aggregation system",
            "default": "logagg.site.mil"
          }
        },
        {
          "name": "rsyslog_conf",
          "options": {
            "description": "Path to rsyslog.conf",
            "default": "/etc/rsyslog.conf"
          }
        },
        {
          "name": "log_aggregation_system",
          "options": {
            "description": "URI to the log aggregation system",
            "default": "logagg.site.mil"
          }
        },
        {
          "name": "rsyslog_conf",
          "options": {
            "description": "Path to rsyslog.conf",
            "default": "/etc/rsyslog.conf"
          }
        },
        {
          "name": "log_aggregation_system",
          "options": {
            "description": "URI to the log aggregation system",
            "default": "logagg.site.mil"
          }
        },
        {
          "name": "rsyslog_conf",
          "options": {
            "description": "Path to rsyslog.conf",
            "default": "/etc/rsyslog.conf"
          }
        },
        {
          "name": "log_aggregation_system",
          "options": {
            "description": "URI to the log aggregation system",
            "default": "logagg.site.mil"
          }
        },
        {
          "name": "rsyslog_conf",
          "options": {
            "description": "Path to rsyslog.conf",
            "default": "/etc/rsyslog.conf"
          }
        },
        {
          "name": "log_aggregation_system",
          "options": {
            "description": "URI to the log aggregation system",
            "default": "logagg.site.mil"
          }
        },
        {
          "name": "rsyslog_conf",
          "options": {
            "description": "Path to rsyslog.conf",
            "default": "/etc/rsyslog.conf"
          }
        },
        {
          "name": "log_aggregation_system",
          "options": {
            "description": "URI to the log aggregation system",
            "default": "logagg.site.mil"
          }
        },
        {
          "name": "elasticsearch_conf",
          "options": {
            "description": "Path to elasticsearch.yml",
            "default": "/etc/elasticsearch/elasticsearch.yml"
          }
        },
        {
          "name": "documented_super_roles",
          "options": {
            "description": "List of authorized super roles",
            "default": [
              "superuser"
            ]
          }
        },
        {
          "name": "elastic_ip",
          "options": {
            "description": "IP address of the elasticsearch instance",
            "default": "0.0.0.0"
          }
        },
        {
          "name": "elastic_port",
          "options": {
            "description": "Port address of the elasticsearch instance",
            "default": "9200"
          }
        },
        {
          "name": "es_home",
          "options": {
            "description": "Path to elasticsearch home directory",
            "default": "/usr/share/elasticsearch"
          }
        },
        {
          "name": "es_admin",
          "options": {
            "description": "Elasticsearch admin",
            "default": "elastic"
          }
        },
        {
          "name": "es_pass",
          "options": {
            "description": "Elasticsearch admin password",
            "default": "changeme"
          }
        },
        {
          "name": "es_owner",
          "options": {
            "description": "Elasticsearch owner",
            "default": "elasticsearch"
          }
        },
        {
          "name": "es_group",
          "options": {
            "description": "Elasticsearch owner",
            "default": "elasticsearch"
          }
        },
        {
          "name": "ssl_verify",
          "options": {
            "description": "Elasticsearch admin password",
            "default": false
          }
        },
        {
          "name": "documented_super_roles",
          "options": {
            "description": "List of authorized super roles",
            "default": [
              "superuser"
            ]
          }
        },
        {
          "name": "elastic_ip",
          "options": {
            "description": "IP address of the elasticsearch instance",
            "default": "0.0.0.0"
          }
        },
        {
          "name": "elastic_port",
          "options": {
            "description": "Port address of the elasticsearch instance",
            "default": "9200"
          }
        },
        {
          "name": "es_home",
          "options": {
            "description": "Path to elasticsearch home directory",
            "default": "/usr/share/elasticsearch"
          }
        },
        {
          "name": "es_admin",
          "options": {
            "description": "Elasticsearch admin",
            "default": "elastic"
          }
        },
        {
          "name": "es_pass",
          "options": {
            "description": "Elasticsearch admin password",
            "default": "changeme"
          }
        },
        {
          "name": "es_owner",
          "options": {
            "description": "Elasticsearch owner",
            "default": "elasticsearch"
          }
        },
        {
          "name": "es_group",
          "options": {
            "description": "Elasticsearch owner",
            "default": "elasticsearch"
          }
        },
        {
          "name": "ssl_verify",
          "options": {
            "description": "Elasticsearch admin password",
            "default": false
          }
        },
        {
          "name": "elasticsearch_conf",
          "options": {
            "description": "Path to elasticsearch.yml",
            "default": "/etc/elasticsearch/elasticsearch.yml"
          }
        },
        {
          "name": "elasticsearch_conf",
          "options": {
            "description": "Path to elasticsearch.yml",
            "default": "/etc/elasticsearch/elasticsearch.yml"
          }
        },
        {
          "name": "documented_super_roles",
          "options": {
            "description": "List of authorized super roles",
            "default": [
              "superuser"
            ]
          }
        },
        {
          "name": "elastic_ip",
          "options": {
            "description": "IP address of the elasticsearch instance",
            "default": "0.0.0.0"
          }
        },
        {
          "name": "elastic_port",
          "options": {
            "description": "Port address of the elasticsearch instance",
            "default": "9200"
          }
        },
        {
          "name": "es_home",
          "options": {
            "description": "Path to elasticsearch home directory",
            "default": "/usr/share/elasticsearch"
          }
        },
        {
          "name": "es_admin",
          "options": {
            "description": "Elasticsearch admin",
            "default": "elastic"
          }
        },
        {
          "name": "es_pass",
          "options": {
            "description": "Elasticsearch admin password",
            "default": "changeme"
          }
        },
        {
          "name": "es_owner",
          "options": {
            "description": "Elasticsearch owner",
            "default": "elasticsearch"
          }
        },
        {
          "name": "es_group",
          "options": {
            "description": "Elasticsearch owner",
            "default": "elasticsearch"
          }
        },
        {
          "name": "ssl_verify",
          "options": {
            "description": "Elasticsearch admin password",
            "default": false
          }
        },
        {
          "name": "elasticsearch_conf",
          "options": {
            "description": "Path to elasticsearch.yml",
            "default": "/etc/elasticsearch/elasticsearch.yml"
          }
        },
        {
          "name": "documented_super_roles",
          "options": {
            "description": "List of authorized super roles",
            "default": [
              "superuser"
            ]
          }
        },
        {
          "name": "elastic_ip",
          "options": {
            "description": "IP address of the elasticsearch instance",
            "default": "0.0.0.0"
          }
        },
        {
          "name": "elastic_port",
          "options": {
            "description": "Port address of the elasticsearch instance",
            "default": "9200"
          }
        },
        {
          "name": "es_home",
          "options": {
            "description": "Path to elasticsearch home directory",
            "default": "/usr/share/elasticsearch"
          }
        },
        {
          "name": "es_admin",
          "options": {
            "description": "Elasticsearch admin",
            "default": "elastic"
          }
        },
        {
          "name": "es_pass",
          "options": {
            "description": "Elasticsearch admin password",
            "default": "changeme"
          }
        },
        {
          "name": "es_owner",
          "options": {
            "description": "Elasticsearch owner",
            "default": "elasticsearch"
          }
        },
        {
          "name": "es_group",
          "options": {
            "description": "Elasticsearch owner",
            "default": "elasticsearch"
          }
        },
        {
          "name": "ssl_verify",
          "options": {
            "description": "Elasticsearch admin password",
            "default": false
          }
        },
        {
          "name": "elasticsearch_conf",
          "options": {
            "description": "Path to elasticsearch.yml",
            "default": "/etc/elasticsearch/elasticsearch.yml"
          }
        },
        {
          "name": "elasticsearch_conf",
          "options": {
            "description": "Path to elasticsearch.yml",
            "default": "/etc/elasticsearch/elasticsearch.yml"
          }
        },
        {
          "name": "documented_super_roles",
          "options": {
            "description": "List of authorized super roles",
            "default": [
              "superuser"
            ]
          }
        },
        {
          "name": "elastic_ip",
          "options": {
            "description": "IP address of the elasticsearch instance",
            "default": "0.0.0.0"
          }
        },
        {
          "name": "elastic_port",
          "options": {
            "description": "Port address of the elasticsearch instance",
            "default": "9200"
          }
        },
        {
          "name": "es_home",
          "options": {
            "description": "Path to elasticsearch home directory",
            "default": "/usr/share/elasticsearch"
          }
        },
        {
          "name": "es_admin",
          "options": {
            "description": "Elasticsearch admin",
            "default": "elastic"
          }
        },
        {
          "name": "es_pass",
          "options": {
            "description": "Elasticsearch admin password",
            "default": "changeme"
          }
        },
        {
          "name": "es_owner",
          "options": {
            "description": "Elasticsearch owner",
            "default": "elasticsearch"
          }
        },
        {
          "name": "es_group",
          "options": {
            "description": "Elasticsearch owner",
            "default": "elasticsearch"
          }
        },
        {
          "name": "ssl_verify",
          "options": {
            "description": "Elasticsearch admin password",
            "default": false
          }
        },
        {
          "name": "elasticsearch_conf",
          "options": {
            "description": "Path to elasticsearch.yml",
            "default": "/etc/elasticsearch/elasticsearch.yml"
          }
        },
        {
          "name": "documented_super_roles",
          "options": {
            "description": "List of authorized super roles",
            "default": [
              "superuser"
            ]
          }
        },
        {
          "name": "elastic_ip",
          "options": {
            "description": "IP address of the elasticsearch instance",
            "default": "0.0.0.0"
          }
        },
        {
          "name": "elastic_port",
          "options": {
            "description": "Port address of the elasticsearch instance",
            "default": "9200"
          }
        },
        {
          "name": "es_home",
          "options": {
            "description": "Path to elasticsearch home directory",
            "default": "/usr/share/elasticsearch"
          }
        },
        {
          "name": "es_admin",
          "options": {
            "description": "Elasticsearch admin",
            "default": "elastic"
          }
        },
        {
          "name": "es_pass",
          "options": {
            "description": "Elasticsearch admin password",
            "default": "changeme"
          }
        },
        {
          "name": "es_owner",
          "options": {
            "description": "Elasticsearch owner",
            "default": "elasticsearch"
          }
        },
        {
          "name": "es_group",
          "options": {
            "description": "Elasticsearch owner",
            "default": "elasticsearch"
          }
        },
        {
          "name": "ssl_verify",
          "options": {
            "description": "Elasticsearch admin password",
            "default": false
          }
        },
        {
          "name": "elasticsearch_conf",
          "options": {
            "description": "Path to elasticsearch.yml",
            "default": "/etc/elasticsearch/elasticsearch.yml"
          }
        },
        {
          "name": "documented_super_roles",
          "options": {
            "description": "List of authorized super roles",
            "default": [
              "superuser"
            ]
          }
        },
        {
          "name": "elastic_ip",
          "options": {
            "description": "IP address of the elasticsearch instance",
            "default": "0.0.0.0"
          }
        },
        {
          "name": "elastic_port",
          "options": {
            "description": "Port address of the elasticsearch instance",
            "default": "9200"
          }
        },
        {
          "name": "es_home",
          "options": {
            "description": "Path to elasticsearch home directory",
            "default": "/usr/share/elasticsearch"
          }
        },
        {
          "name": "es_admin",
          "options": {
            "description": "Elasticsearch admin",
            "default": "elastic"
          }
        },
        {
          "name": "es_pass",
          "options": {
            "description": "Elasticsearch admin password",
            "default": "changeme"
          }
        },
        {
          "name": "es_owner",
          "options": {
            "description": "Elasticsearch owner",
            "default": "elasticsearch"
          }
        },
        {
          "name": "es_group",
          "options": {
            "description": "Elasticsearch owner",
            "default": "elasticsearch"
          }
        },
        {
          "name": "ssl_verify",
          "options": {
            "description": "Elasticsearch admin password",
            "default": false
          }
        },
        {
          "name": "elasticsearch_conf",
          "options": {
            "description": "Path to elasticsearch.yml",
            "default": "/etc/elasticsearch/elasticsearch.yml"
          }
        },
        {
          "name": "documented_super_roles",
          "options": {
            "description": "List of authorized super roles",
            "default": [
              "superuser"
            ]
          }
        },
        {
          "name": "elastic_ip",
          "options": {
            "description": "IP address of the elasticsearch instance",
            "default": "0.0.0.0"
          }
        },
        {
          "name": "elastic_port",
          "options": {
            "description": "Port address of the elasticsearch instance",
            "default": "9200"
          }
        },
        {
          "name": "es_home",
          "options": {
            "description": "Path to elasticsearch home directory",
            "default": "/usr/share/elasticsearch"
          }
        },
        {
          "name": "es_admin",
          "options": {
            "description": "Elasticsearch admin",
            "default": "elastic"
          }
        },
        {
          "name": "es_pass",
          "options": {
            "description": "Elasticsearch admin password",
            "default": "changeme"
          }
        },
        {
          "name": "es_owner",
          "options": {
            "description": "Elasticsearch owner",
            "default": "elasticsearch"
          }
        },
        {
          "name": "es_group",
          "options": {
            "description": "Elasticsearch owner",
            "default": "elasticsearch"
          }
        },
        {
          "name": "ssl_verify",
          "options": {
            "description": "Elasticsearch admin password",
            "default": false
          }
        },
        {
          "name": "elasticsearch_conf",
          "options": {
            "description": "Path to elasticsearch.yml",
            "default": "/etc/elasticsearch/elasticsearch.yml"
          }
        },
        {
          "name": "documented_super_roles",
          "options": {
            "description": "List of authorized super roles",
            "default": [
              "superuser"
            ]
          }
        },
        {
          "name": "elastic_ip",
          "options": {
            "description": "IP address of the elasticsearch instance",
            "default": "0.0.0.0"
          }
        },
        {
          "name": "elastic_port",
          "options": {
            "description": "Port address of the elasticsearch instance",
            "default": "9200"
          }
        },
        {
          "name": "es_home",
          "options": {
            "description": "Path to elasticsearch home directory",
            "default": "/usr/share/elasticsearch"
          }
        },
        {
          "name": "es_admin",
          "options": {
            "description": "Elasticsearch admin",
            "default": "elastic"
          }
        },
        {
          "name": "es_pass",
          "options": {
            "description": "Elasticsearch admin password",
            "default": "changeme"
          }
        },
        {
          "name": "es_owner",
          "options": {
            "description": "Elasticsearch owner",
            "default": "elasticsearch"
          }
        },
        {
          "name": "es_group",
          "options": {
            "description": "Elasticsearch owner",
            "default": "elasticsearch"
          }
        },
        {
          "name": "ssl_verify",
          "options": {
            "description": "Elasticsearch admin password",
            "default": false
          }
        },
        {
          "name": "elasticsearch_conf",
          "options": {
            "description": "Path to elasticsearch.yml",
            "default": "/etc/elasticsearch/elasticsearch.yml"
          }
        },
        {
          "name": "auditd_log_file",
          "options": {
            "description": "Path to the auditd log file",
            "default": "/var/log/audit/audit.log"
          }
        },
        {
          "name": "elasticsearch_conf",
          "options": {
            "description": "Path to elasticsearch.yml",
            "default": "/etc/elasticsearch/elasticsearch.yml"
          }
        },
        {
          "name": "audit_rule_id",
          "options": {
            "description": "Audit Rule ID",
            "default": "elasticsearch-config"
          }
        },
        {
          "name": "elastic_ip",
          "options": {
            "description": "IP address of the elasticsearch instance",
            "default": "0.0.0.0"
          }
        },
        {
          "name": "elastic_port",
          "options": {
            "description": "Port address of the elasticsearch instance",
            "default": "9200"
          }
        },
        {
          "name": "es_home",
          "options": {
            "description": "Path to elasticsearch home directory",
            "default": "/usr/share/elasticsearch"
          }
        },
        {
          "name": "es_admin",
          "options": {
            "description": "Elasticsearch admin",
            "default": "elastic"
          }
        },
        {
          "name": "es_pass",
          "options": {
            "description": "Elasticsearch admin password",
            "default": "changeme"
          }
        },
        {
          "name": "es_owner",
          "options": {
            "description": "Elasticsearch owner",
            "default": "elasticsearch"
          }
        },
        {
          "name": "es_group",
          "options": {
            "description": "Elasticsearch owner",
            "default": "elasticsearch"
          }
        },
        {
          "name": "elasticsearch_conf",
          "options": {
            "description": "Path to elasticsearch.yml",
            "default": "/etc/elasticsearch/elasticsearch.yml"
          }
        },
        {
          "name": "elastic_ip",
          "options": {
            "description": "IP address of the elasticsearch instance",
            "default": "0.0.0.0"
          }
        },
        {
          "name": "elastic_port",
          "options": {
            "description": "Port address of the elasticsearch instance",
            "default": "9200"
          }
        },
        {
          "name": "es_admin",
          "options": {
            "description": "Elasticsearch admin",
            "default": "elastic"
          }
        },
        {
          "name": "es_pass",
          "options": {
            "description": "Elasticsearch admin password",
            "default": "changeme"
          }
        },
        {
          "name": "ssl_verify",
          "options": {
            "description": "Elasticsearch admin password",
            "default": false
          }
        },
        {
          "name": "elasticsearch_conf",
          "options": {
            "description": "Path to elasticsearch.yml",
            "default": "/etc/elasticsearch/elasticsearch.yml"
          }
        },
        {
          "name": "es_owner",
          "options": {
            "description": "Elasticsearch owner",
            "default": "elasticsearch"
          }
        },
        {
          "name": "es_group",
          "options": {
            "description": "Elasticsearch owner",
            "default": "elasticsearch"
          }
        },
        {
          "name": "elastic_ip",
          "options": {
            "description": "IP address of the elasticsearch instance",
            "default": "0.0.0.0"
          }
        },
        {
          "name": "elastic_port",
          "options": {
            "description": "Port address of the elasticsearch instance",
            "default": "9200"
          }
        },
        {
          "name": "es_admin",
          "options": {
            "description": "Elasticsearch admin",
            "default": "elastic"
          }
        },
        {
          "name": "es_pass",
          "options": {
            "description": "Elasticsearch admin password",
            "default": "changeme"
          }
        },
        {
          "name": "ssl_verify",
          "options": {
            "description": "Elasticsearch admin password",
            "default": false
          }
        },
        {
          "name": "es_logs_dir",
          "options": {
            "description": "Path elasticsearch logs folder",
            "default": "/var/log/elasticsearch"
          }
        },
        {
          "name": "elastic_ip",
          "options": {
            "description": "IP address of the elasticsearch instance",
            "default": "0.0.0.0"
          }
        },
        {
          "name": "elastic_port",
          "options": {
            "description": "Port address of the elasticsearch instance",
            "default": "9200"
          }
        },
        {
          "name": "es_admin",
          "options": {
            "description": "Elasticsearch admin",
            "default": "elastic"
          }
        },
        {
          "name": "es_pass",
          "options": {
            "description": "Elasticsearch admin password",
            "default": "changeme"
          }
        },
        {
          "name": "ssl_verify",
          "options": {
            "description": "Elasticsearch admin password",
            "default": false
          }
        },
        {
          "name": "rsyslog_conf",
          "options": {
            "description": "Path to rsyslog.conf",
            "default": "/etc/rsyslog.conf"
          }
        },
        {
          "name": "log_aggregation_system",
          "options": {
            "description": "URI to the log aggregation system",
            "default": "logagg.site.mil"
          }
        },
        {
          "name": "es_logs_dir",
          "options": {
            "description": "Path elasticsearch logs folder",
            "default": "/var/log/elasticsearch"
          }
        },
        {
          "name": "nice_level",
          "options": {
            "description": "organizational determined nice level for elasticsearch",
            "default": 1
          }
        },
        {
          "name": "elasticsearch_conf",
          "options": {
            "description": "Path to elasticsearch.yml",
            "default": "/etc/elasticsearch/elasticsearch.yml"
          }
        },
        {
          "name": "audit_rule_id",
          "options": {
            "description": "Audit Rule ID",
            "default": "elasticsearch-config"
          }
        },
        {
          "name": "elastic_ip",
          "options": {
            "description": "IP address of the elasticsearch instance",
            "default": "0.0.0.0"
          }
        },
        {
          "name": "elastic_port",
          "options": {
            "description": "Port address of the elasticsearch instance",
            "default": "9200"
          }
        },
        {
          "name": "es_admin",
          "options": {
            "description": "Elasticsearch admin",
            "default": "elastic"
          }
        },
        {
          "name": "es_pass",
          "options": {
            "description": "Elasticsearch admin password",
            "default": "changeme"
          }
        },
        {
          "name": "ssl_verify",
          "options": {
            "description": "Elasticsearch admin password",
            "default": false
          }
        },
        {
          "name": "elasticsearch_conf",
          "options": {
            "description": "Path to elasticsearch.yml",
            "default": "/etc/elasticsearch/elasticsearch.yml"
          }
        },
        {
          "name": "elastic_ip",
          "options": {
            "description": "IP address of the elasticsearch instance",
            "default": "0.0.0.0"
          }
        },
        {
          "name": "elastic_port",
          "options": {
            "description": "Port address of the elasticsearch instance",
            "default": "9200"
          }
        },
        {
          "name": "es_admin",
          "options": {
            "description": "Elasticsearch admin",
            "default": "elastic"
          }
        },
        {
          "name": "es_pass",
          "options": {
            "description": "Elasticsearch admin password",
            "default": "changeme"
          }
        },
        {
          "name": "ssl_verify",
          "options": {
            "description": "Elasticsearch admin password",
            "default": false
          }
        },
        {
          "name": "elasticsearch_conf",
          "options": {
            "description": "Path to elasticsearch.yml",
            "default": "/etc/elasticsearch/elasticsearch.yml"
          }
        },
        {
          "name": "elastic_ip",
          "options": {
            "description": "IP address of the elasticsearch instance",
            "default": "0.0.0.0"
          }
        },
        {
          "name": "elastic_port",
          "options": {
            "description": "Port address of the elasticsearch instance",
            "default": "9200"
          }
        },
        {
          "name": "es_admin",
          "options": {
            "description": "Elasticsearch admin",
            "default": "elastic"
          }
        },
        {
          "name": "es_pass",
          "options": {
            "description": "Elasticsearch admin password",
            "default": "changeme"
          }
        },
        {
          "name": "ssl_verify",
          "options": {
            "description": "Elasticsearch admin password",
            "default": false
          }
        },
        {
          "name": "elasticsearch_conf",
          "options": {
            "description": "Path to elasticsearch.yml",
            "default": "/etc/elasticsearch/elasticsearch.yml"
          }
        },
        {
          "name": "elastic_ip",
          "options": {
            "description": "IP address of the elasticsearch instance",
            "default": "0.0.0.0"
          }
        },
        {
          "name": "elastic_port",
          "options": {
            "description": "Port address of the elasticsearch instance",
            "default": "9200"
          }
        },
        {
          "name": "es_admin",
          "options": {
            "description": "Elasticsearch admin",
            "default": "elastic"
          }
        },
        {
          "name": "es_pass",
          "options": {
            "description": "Elasticsearch admin password",
            "default": "changeme"
          }
        },
        {
          "name": "ssl_verify",
          "options": {
            "description": "Elasticsearch admin password",
            "default": false
          }
        },
        {
          "name": "elasticsearch_conf",
          "options": {
            "description": "Path to elasticsearch.yml",
            "default": "/etc/elasticsearch/elasticsearch.yml"
          }
        },
        {
          "name": "elastic_ip",
          "options": {
            "description": "IP address of the elasticsearch instance",
            "default": "0.0.0.0"
          }
        },
        {
          "name": "elastic_port",
          "options": {
            "description": "Port address of the elasticsearch instance",
            "default": "9200"
          }
        },
        {
          "name": "es_admin",
          "options": {
            "description": "Elasticsearch admin",
            "default": "elastic"
          }
        },
        {
          "name": "es_pass",
          "options": {
            "description": "Elasticsearch admin password",
            "default": "changeme"
          }
        },
        {
          "name": "ssl_verify",
          "options": {
            "description": "Elasticsearch admin password",
            "default": false
          }
        },
        {
          "name": "elasticsearch_conf",
          "options": {
            "description": "Path to elasticsearch.yml",
            "default": "/etc/elasticsearch/elasticsearch.yml"
          }
        },
        {
          "name": "approved_cipher_suites",
          "options": {
            "description": "List of NSA-approved or FIPS validated cipher suites",
            "default": [
              "TLS_ECDHE_RSA_WITH_AES_128_CBC_SHA256",
              "TLS_ECDHE_ECDSA_WITH_AES_128_CBC_SHA256",
              "TLS_ECDHE_ECDSA_WITH_AES_128_CBC_SHA",
              "TLS_ECDHE_RSA_WITH_AES_128_CBC_SHA",
              "TLS_RSA_WITH_AES_128_CBC_SHA256",
              "TLS_RSA_WITH_AES_128_CBC_SHA"
            ]
          }
        },
        {
          "name": "elastic_ip",
          "options": {
            "description": "IP address of the elasticsearch instance",
            "default": "0.0.0.0"
          }
        },
        {
          "name": "elastic_port",
          "options": {
            "description": "Port address of the elasticsearch instance",
            "default": "9200"
          }
        },
        {
          "name": "es_admin",
          "options": {
            "description": "Elasticsearch admin",
            "default": "elastic"
          }
        },
        {
          "name": "es_pass",
          "options": {
            "description": "Elasticsearch admin password",
            "default": "changeme"
          }
        },
        {
          "name": "ssl_verify",
          "options": {
            "description": "Elasticsearch admin password",
            "default": false
          }
        },
        {
          "name": "elasticsearch_conf",
          "options": {
            "description": "Path to elasticsearch.yml",
            "default": "/etc/elasticsearch/elasticsearch.yml"
          }
        },
        {
          "name": "approved_cipher_suites",
          "options": {
            "description": "List of NSA-approved or FIPS validated cipher suites",
            "default": [
              "TLS_ECDHE_RSA_WITH_AES_128_CBC_SHA256",
              "TLS_ECDHE_ECDSA_WITH_AES_128_CBC_SHA256",
              "TLS_ECDHE_ECDSA_WITH_AES_128_CBC_SHA",
              "TLS_ECDHE_RSA_WITH_AES_128_CBC_SHA",
              "TLS_RSA_WITH_AES_128_CBC_SHA256",
              "TLS_RSA_WITH_AES_128_CBC_SHA"
            ]
          }
        },
        {
          "name": "elastic_ip",
          "options": {
            "description": "IP address of the elasticsearch instance",
            "default": "0.0.0.0"
          }
        },
        {
          "name": "elastic_port",
          "options": {
            "description": "Port address of the elasticsearch instance",
            "default": "9200"
          }
        },
        {
          "name": "es_admin",
          "options": {
            "description": "Elasticsearch admin",
            "default": "elastic"
          }
        },
        {
          "name": "es_pass",
          "options": {
            "description": "Elasticsearch admin password",
            "default": "changeme"
          }
        },
        {
          "name": "ssl_verify",
          "options": {
            "description": "Elasticsearch admin password",
            "default": false
          }
        },
        {
          "name": "elasticsearch_conf",
          "options": {
            "description": "Path to elasticsearch.yml",
            "default": "/etc/elasticsearch/elasticsearch.yml"
          }
        },
        {
          "name": "approved_cipher_suites",
          "options": {
            "description": "List of NSA-approved or FIPS validated cipher suites",
            "default": [
              "TLS_ECDHE_RSA_WITH_AES_128_CBC_SHA256",
              "TLS_ECDHE_ECDSA_WITH_AES_128_CBC_SHA256",
              "TLS_ECDHE_ECDSA_WITH_AES_128_CBC_SHA",
              "TLS_ECDHE_RSA_WITH_AES_128_CBC_SHA",
              "TLS_RSA_WITH_AES_128_CBC_SHA256",
              "TLS_RSA_WITH_AES_128_CBC_SHA"
            ]
          }
        },
        {
          "name": "elastic_ip",
          "options": {
            "description": "IP address of the elasticsearch instance",
            "default": "0.0.0.0"
          }
        },
        {
          "name": "elastic_port",
          "options": {
            "description": "Port address of the elasticsearch instance",
            "default": "9200"
          }
        },
        {
          "name": "es_admin",
          "options": {
            "description": "Elasticsearch admin",
            "default": "elastic"
          }
        },
        {
          "name": "es_pass",
          "options": {
            "description": "Elasticsearch admin password",
            "default": "changeme"
          }
        },
        {
          "name": "ssl_verify",
          "options": {
            "description": "Elasticsearch admin password",
            "default": false
          }
        },
        {
          "name": "elasticsearch_conf",
          "options": {
            "description": "Path to elasticsearch.yml",
            "default": "/etc/elasticsearch/elasticsearch.yml"
          }
        },
        {
          "name": "approved_cipher_suites",
          "options": {
            "description": "List of NSA-approved or FIPS validated cipher suites",
            "default": [
              "TLS_ECDHE_RSA_WITH_AES_128_CBC_SHA256",
              "TLS_ECDHE_ECDSA_WITH_AES_128_CBC_SHA256",
              "TLS_ECDHE_ECDSA_WITH_AES_128_CBC_SHA",
              "TLS_ECDHE_RSA_WITH_AES_128_CBC_SHA",
              "TLS_RSA_WITH_AES_128_CBC_SHA256",
              "TLS_RSA_WITH_AES_128_CBC_SHA"
            ]
          }
        },
        {
          "name": "elastic_ip",
          "options": {
            "description": "IP address of the elasticsearch instance",
            "default": "0.0.0.0"
          }
        },
        {
          "name": "elastic_port",
          "options": {
            "description": "Port address of the elasticsearch instance",
            "default": "9200"
          }
        },
        {
          "name": "es_admin",
          "options": {
            "description": "Elasticsearch admin",
            "default": "elastic"
          }
        },
        {
          "name": "es_pass",
          "options": {
            "description": "Elasticsearch admin password",
            "default": "changeme"
          }
        },
        {
          "name": "ssl_verify",
          "options": {
            "description": "Elasticsearch admin password",
            "default": false
          }
        },
        {
          "name": "elasticsearch_conf",
          "options": {
            "description": "Path to elasticsearch.yml",
            "default": "/etc/elasticsearch/elasticsearch.yml"
          }
        },
        {
          "name": "approved_cipher_suites",
          "options": {
            "description": "List of NSA-approved or FIPS validated cipher suites",
            "default": [
              "TLS_ECDHE_RSA_WITH_AES_128_CBC_SHA256",
              "TLS_ECDHE_ECDSA_WITH_AES_128_CBC_SHA256",
              "TLS_ECDHE_ECDSA_WITH_AES_128_CBC_SHA",
              "TLS_ECDHE_RSA_WITH_AES_128_CBC_SHA",
              "TLS_RSA_WITH_AES_128_CBC_SHA256",
              "TLS_RSA_WITH_AES_128_CBC_SHA"
            ]
          }
        },
        {
          "name": "elastic_ip",
          "options": {
            "description": "IP address of the elasticsearch instance",
            "default": "0.0.0.0"
          }
        },
        {
          "name": "elastic_port",
          "options": {
            "description": "Port address of the elasticsearch instance",
            "default": "9200"
          }
        },
        {
          "name": "es_admin",
          "options": {
            "description": "Elasticsearch admin",
            "default": "elastic"
          }
        },
        {
          "name": "es_pass",
          "options": {
            "description": "Elasticsearch admin password",
            "default": "changeme"
          }
        },
        {
          "name": "ssl_verify",
          "options": {
            "description": "Elasticsearch admin password",
            "default": false
          }
        },
        {
          "name": "elasticsearch_conf",
          "options": {
            "description": "Path to elasticsearch.yml",
            "default": "/etc/elasticsearch/elasticsearch.yml"
          }
        },
        {
          "name": "approved_cipher_suites",
          "options": {
            "description": "List of NSA-approved or FIPS validated cipher suites",
            "default": [
              "TLS_ECDHE_RSA_WITH_AES_128_CBC_SHA256",
              "TLS_ECDHE_ECDSA_WITH_AES_128_CBC_SHA256",
              "TLS_ECDHE_ECDSA_WITH_AES_128_CBC_SHA",
              "TLS_ECDHE_RSA_WITH_AES_128_CBC_SHA",
              "TLS_RSA_WITH_AES_128_CBC_SHA256",
              "TLS_RSA_WITH_AES_128_CBC_SHA"
            ]
          }
        },
        {
          "name": "elastic_ip",
          "options": {
            "description": "IP address of the elasticsearch instance",
            "default": "0.0.0.0"
          }
        },
        {
          "name": "elastic_port",
          "options": {
            "description": "Port address of the elasticsearch instance",
            "default": "9200"
          }
        },
        {
          "name": "es_admin",
          "options": {
            "description": "Elasticsearch admin",
            "default": "elastic"
          }
        },
        {
          "name": "es_pass",
          "options": {
            "description": "Elasticsearch admin password",
            "default": "changeme"
          }
        },
        {
          "name": "ssl_verify",
          "options": {
            "description": "Elasticsearch admin password",
            "default": false
          }
        },
        {
          "name": "elasticsearch_conf",
          "options": {
            "description": "Path to elasticsearch.yml",
            "default": "/etc/elasticsearch/elasticsearch.yml"
          }
        },
        {
          "name": "elastic_ip",
          "options": {
            "description": "IP address of the elasticsearch instance",
            "default": "0.0.0.0"
          }
        },
        {
          "name": "elastic_port",
          "options": {
            "description": "Port address of the elasticsearch instance",
            "default": "9200"
          }
        },
        {
          "name": "es_admin",
          "options": {
            "description": "Elasticsearch admin",
            "default": "elastic"
          }
        },
        {
          "name": "es_pass",
          "options": {
            "description": "Elasticsearch admin password",
            "default": "changeme"
          }
        },
        {
          "name": "ssl_verify",
          "options": {
            "description": "Elasticsearch admin password",
            "default": false
          }
        },
        {
          "name": "elasticsearch_conf",
          "options": {
            "description": "Path to elasticsearch.yml",
            "default": "/etc/elasticsearch/elasticsearch.yml"
          }
        },
        {
          "name": "elastic_ip",
          "options": {
            "description": "IP address of the elasticsearch instance",
            "default": "0.0.0.0"
          }
        },
        {
          "name": "elastic_port",
          "options": {
            "description": "Port address of the elasticsearch instance",
            "default": "9200"
          }
        },
        {
          "name": "es_admin",
          "options": {
            "description": "Elasticsearch admin",
            "default": "elastic"
          }
        },
        {
          "name": "es_pass",
          "options": {
            "description": "Elasticsearch admin password",
            "default": "changeme"
          }
        },
        {
          "name": "ssl_verify",
          "options": {
            "description": "Elasticsearch admin password",
            "default": false
          }
        },
        {
          "name": "elasticsearch_conf",
          "options": {
            "description": "Path to elasticsearch.yml",
            "default": "/etc/elasticsearch/elasticsearch.yml"
          }
        },
        {
          "name": "elastic_ip",
          "options": {
            "description": "IP address of the elasticsearch instance",
            "default": "0.0.0.0"
          }
        },
        {
          "name": "elastic_port",
          "options": {
            "description": "Port address of the elasticsearch instance",
            "default": "9200"
          }
        },
        {
          "name": "elasticsearch_conf",
          "options": {
            "description": "Path to elasticsearch.yml",
            "default": "/etc/elasticsearch/elasticsearch.yml"
          }
        },
        {
          "name": "elastic_port",
          "options": {
            "description": "Port address of the elasticsearch instance",
            "default": "9200"
          }
        },
        {
          "name": "es_admin",
          "options": {
            "description": "Elasticsearch admin",
            "default": "elastic"
          }
        },
        {
          "name": "es_pass",
          "options": {
            "description": "Elasticsearch admin password",
            "default": "changeme"
          }
        },
        {
          "name": "ssl_verify",
          "options": {
            "description": "Elasticsearch admin password",
            "default": false
          }
        },
        {
          "name": "documented_super_roles",
          "options": {
            "description": "List of authorized super roles",
            "default": [
              "superuser"
            ]
          }
        },
        {
          "name": "elasticsearch_conf",
          "options": {
            "description": "Path to elasticsearch.yml",
            "default": "/etc/elasticsearch/elasticsearch.yml"
          }
        },
        {
          "name": "elastic_ip",
          "options": {
            "description": "IP address of the elasticsearch instance",
            "default": "0.0.0.0"
          }
        },
        {
          "name": "elastic_port",
          "options": {
            "description": "Port address of the elasticsearch instance",
            "default": "9200"
          }
        },
        {
          "name": "es_admin",
          "options": {
            "description": "Elasticsearch admin",
            "default": "elastic"
          }
        },
        {
          "name": "es_pass",
          "options": {
            "description": "Elasticsearch admin password",
            "default": "changeme"
          }
        },
        {
          "name": "ssl_verify",
          "options": {
            "description": "Elasticsearch admin password",
            "default": false
          }
        },
        {
          "name": "documented_super_roles",
          "options": {
            "description": "List of authorized super roles",
            "default": [
              "superuser"
            ]
          }
        },
        {
          "name": "elasticsearch_conf",
          "options": {
            "description": "Path to elasticsearch.yml",
            "default": "/etc/elasticsearch/elasticsearch.yml"
          }
        },
        {
          "name": "elastic_ip",
          "options": {
            "description": "IP address of the elasticsearch instance",
            "default": "0.0.0.0"
          }
        },
        {
          "name": "elastic_port",
          "options": {
            "description": "Port address of the elasticsearch instance",
            "default": "9200"
          }
        },
        {
          "name": "es_admin",
          "options": {
            "description": "Elasticsearch admin",
            "default": "elastic"
          }
        },
        {
          "name": "es_pass",
          "options": {
            "description": "Elasticsearch admin password",
            "default": "changeme"
          }
        },
        {
          "name": "ssl_verify",
          "options": {
            "description": "Elasticsearch admin password",
            "default": false
          }
        },
        {
          "name": "documented_super_roles",
          "options": {
            "description": "List of authorized super roles",
            "default": [
              "superuser"
            ]
          }
        },
        {
          "name": "elastic_ip",
          "options": {
            "description": "IP address of the elasticsearch instance",
            "default": "0.0.0.0"
          }
        },
        {
          "name": "elastic_port",
          "options": {
            "description": "Port address of the elasticsearch instance",
            "default": "9200"
          }
        },
        {
          "name": "elasticsearch_conf",
          "options": {
            "description": "Path to elasticsearch.yml",
            "default": "/etc/elasticsearch/elasticsearch.yml"
          }
        },
        {
          "name": "elastic_port",
          "options": {
            "description": "Port address of the elasticsearch instance",
            "default": "9200"
          }
        },
        {
          "name": "es_admin",
          "options": {
            "description": "Elasticsearch admin",
            "default": "elastic"
          }
        },
        {
          "name": "es_pass",
          "options": {
            "description": "Elasticsearch admin password",
            "default": "changeme"
          }
        },
        {
          "name": "ssl_verify",
          "options": {
            "description": "Elasticsearch admin password",
            "default": false
          }
        },
        {
          "name": "documented_super_roles",
          "options": {
            "description": "List of authorized super roles",
            "default": [
              "superuser"
            ]
          }
        },
        {
          "name": "elasticsearch_conf",
          "options": {
            "description": "Path to elasticsearch.yml",
            "default": "/etc/elasticsearch/elasticsearch.yml"
          }
        },
        {
          "name": "es_included_logevents",
          "options": {
            "description": "List of events to be logged",
            "default": [
              "access_denied",
              "anonymous_access_denied",
              "authentication_failed",
              "connection_denied",
              "tampered_request",
              "run_as_denied",
              "run_as_granted"
            ]
          }
        },
        {
          "name": "es_excluded_logevents",
          "options": {
            "description": "List of events to be logged",
            "default": [
              "access_granted"
            ]
          }
        },
        {
          "name": "elastic_ip",
          "options": {
            "description": "IP address of the elasticsearch instance",
            "default": "0.0.0.0"
          }
        },
        {
          "name": "elastic_port",
          "options": {
            "description": "Port address of the elasticsearch instance",
            "default": "9200"
          }
        },
        {
          "name": "es_admin",
          "options": {
            "description": "Elasticsearch admin",
            "default": "elastic"
          }
        },
        {
          "name": "es_pass",
          "options": {
            "description": "Elasticsearch admin password",
            "default": "changeme"
          }
        },
        {
          "name": "ssl_verify",
          "options": {
            "description": "Elasticsearch admin password",
            "default": false
          }
        },
        {
          "name": "elasticsearch_conf",
          "options": {
            "description": "Path to elasticsearch.yml",
            "default": "/etc/elasticsearch/elasticsearch.yml"
          }
        },
        {
          "name": "es_included_logevents",
          "options": {
            "description": "List of events to be logged",
            "default": [
              "access_denied",
              "anonymous_access_denied",
              "authentication_failed",
              "connection_denied",
              "tampered_request",
              "run_as_denied",
              "run_as_granted"
            ]
          }
        },
        {
          "name": "es_excluded_logevents",
          "options": {
            "description": "List of events to be logged",
            "default": [
              "access_granted"
            ]
          }
        },
        {
          "name": "elastic_ip",
          "options": {
            "description": "IP address of the elasticsearch instance",
            "default": "0.0.0.0"
          }
        },
        {
          "name": "elastic_port",
          "options": {
            "description": "Port address of the elasticsearch instance",
            "default": "9200"
          }
        },
        {
          "name": "es_admin",
          "options": {
            "description": "Elasticsearch admin",
            "default": "elastic"
          }
        },
        {
          "name": "es_pass",
          "options": {
            "description": "Elasticsearch admin password",
            "default": "changeme"
          }
        },
        {
          "name": "ssl_verify",
          "options": {
            "description": "Elasticsearch admin password",
            "default": false
          }
        },
        {
          "name": "elasticsearch_conf",
          "options": {
            "description": "Path to elasticsearch.yml",
            "default": "/etc/elasticsearch/elasticsearch.yml"
          }
        },
        {
          "name": "es_included_logevents",
          "options": {
            "description": "List of events to be logged",
            "default": [
              "access_denied",
              "anonymous_access_denied",
              "authentication_failed",
              "connection_denied",
              "tampered_request",
              "run_as_denied",
              "run_as_granted"
            ]
          }
        },
        {
          "name": "es_excluded_logevents",
          "options": {
            "description": "List of events to be logged",
            "default": [
              "access_granted"
            ]
          }
        },
        {
          "name": "elastic_ip",
          "options": {
            "description": "IP address of the elasticsearch instance",
            "default": "0.0.0.0"
          }
        },
        {
          "name": "elastic_port",
          "options": {
            "description": "Port address of the elasticsearch instance",
            "default": "9200"
          }
        },
        {
          "name": "es_admin",
          "options": {
            "description": "Elasticsearch admin",
            "default": "elastic"
          }
        },
        {
          "name": "es_pass",
          "options": {
            "description": "Elasticsearch admin password",
            "default": "changeme"
          }
        },
        {
          "name": "ssl_verify",
          "options": {
            "description": "Elasticsearch admin password",
            "default": false
          }
        },
        {
          "name": "elasticsearch_conf",
          "options": {
            "description": "Path to elasticsearch.yml",
            "default": "/etc/elasticsearch/elasticsearch.yml"
          }
        },
        {
          "name": "es_included_logevents",
          "options": {
            "description": "List of events to be logged",
            "default": [
              "access_denied",
              "anonymous_access_denied",
              "authentication_failed",
              "connection_denied",
              "tampered_request",
              "run_as_denied",
              "run_as_granted"
            ]
          }
        },
        {
          "name": "es_excluded_logevents",
          "options": {
            "description": "List of events to be logged",
            "default": [
              "access_granted"
            ]
          }
        },
        {
          "name": "elastic_ip",
          "options": {
            "description": "IP address of the elasticsearch instance",
            "default": "0.0.0.0"
          }
        },
        {
          "name": "elastic_port",
          "options": {
            "description": "Port address of the elasticsearch instance",
            "default": "9200"
          }
        },
        {
          "name": "es_admin",
          "options": {
            "description": "Elasticsearch admin",
            "default": "elastic"
          }
        },
        {
          "name": "es_pass",
          "options": {
            "description": "Elasticsearch admin password",
            "default": "changeme"
          }
        },
        {
          "name": "ssl_verify",
          "options": {
            "description": "Elasticsearch admin password",
            "default": false
          }
        },
        {
          "name": "elasticsearch_conf",
          "options": {
            "description": "Path to elasticsearch.yml",
            "default": "/etc/elasticsearch/elasticsearch.yml"
          }
        },
        {
          "name": "es_included_logevents",
          "options": {
            "description": "List of events to be logged",
            "default": [
              "access_denied",
              "anonymous_access_denied",
              "authentication_failed",
              "connection_denied",
              "tampered_request",
              "run_as_denied",
              "run_as_granted"
            ]
          }
        },
        {
          "name": "es_excluded_logevents",
          "options": {
            "description": "List of events to be logged",
            "default": [
              "access_granted"
            ]
          }
        },
        {
          "name": "elastic_ip",
          "options": {
            "description": "IP address of the elasticsearch instance",
            "default": "0.0.0.0"
          }
        },
        {
          "name": "elastic_port",
          "options": {
            "description": "Port address of the elasticsearch instance",
            "default": "9200"
          }
        },
        {
          "name": "es_admin",
          "options": {
            "description": "Elasticsearch admin",
            "default": "elastic"
          }
        },
        {
          "name": "es_pass",
          "options": {
            "description": "Elasticsearch admin password",
            "default": "changeme"
          }
        },
        {
          "name": "ssl_verify",
          "options": {
            "description": "Elasticsearch admin password",
            "default": false
          }
        },
        {
          "name": "elasticsearch_conf",
          "options": {
            "description": "Path to elasticsearch.yml",
            "default": "/etc/elasticsearch/elasticsearch.yml"
          }
        },
        {
          "name": "es_included_logevents",
          "options": {
            "description": "List of events to be logged",
            "default": [
              "access_denied",
              "anonymous_access_denied",
              "authentication_failed",
              "connection_denied",
              "tampered_request",
              "run_as_denied",
              "run_as_granted"
            ]
          }
        },
        {
          "name": "es_excluded_logevents",
          "options": {
            "description": "List of events to be logged",
            "default": [
              "access_granted"
            ]
          }
        },
        {
          "name": "elastic_ip",
          "options": {
            "description": "IP address of the elasticsearch instance",
            "default": "0.0.0.0"
          }
        },
        {
          "name": "elastic_port",
          "options": {
            "description": "Port address of the elasticsearch instance",
            "default": "9200"
          }
        },
        {
          "name": "es_admin",
          "options": {
            "description": "Elasticsearch admin",
            "default": "elastic"
          }
        },
        {
          "name": "es_pass",
          "options": {
            "description": "Elasticsearch admin password",
            "default": "changeme"
          }
        },
        {
          "name": "ssl_verify",
          "options": {
            "description": "Elasticsearch admin password",
            "default": false
          }
        },
        {
          "name": "elasticsearch_conf",
          "options": {
            "description": "Path to elasticsearch.yml",
            "default": "/etc/elasticsearch/elasticsearch.yml"
          }
        },
        {
          "name": "es_included_logevents",
          "options": {
            "description": "List of events to be logged",
            "default": [
              "access_denied",
              "anonymous_access_denied",
              "authentication_failed",
              "connection_denied",
              "tampered_request",
              "run_as_denied",
              "run_as_granted"
            ]
          }
        },
        {
          "name": "es_excluded_logevents",
          "options": {
            "description": "List of events to be logged",
            "default": [
              "access_granted"
            ]
          }
        },
        {
          "name": "elastic_ip",
          "options": {
            "description": "IP address of the elasticsearch instance",
            "default": "0.0.0.0"
          }
        },
        {
          "name": "elastic_port",
          "options": {
            "description": "Port address of the elasticsearch instance",
            "default": "9200"
          }
        },
        {
          "name": "es_admin",
          "options": {
            "description": "Elasticsearch admin",
            "default": "elastic"
          }
        },
        {
          "name": "es_pass",
          "options": {
            "description": "Elasticsearch admin password",
            "default": "changeme"
          }
        },
        {
          "name": "ssl_verify",
          "options": {
            "description": "Elasticsearch admin password",
            "default": false
          }
        },
        {
          "name": "elasticsearch_conf",
          "options": {
            "description": "Path to elasticsearch.yml",
            "default": "/etc/elasticsearch/elasticsearch.yml"
          }
        },
        {
          "name": "es_included_logevents",
          "options": {
            "description": "List of events to be logged",
            "default": [
              "access_denied",
              "anonymous_access_denied",
              "authentication_failed",
              "connection_denied",
              "tampered_request",
              "run_as_denied",
              "run_as_granted"
            ]
          }
        },
        {
          "name": "es_excluded_logevents",
          "options": {
            "description": "List of events to be logged",
            "default": [
              "access_granted"
            ]
          }
        },
        {
          "name": "elastic_ip",
          "options": {
            "description": "IP address of the elasticsearch instance",
            "default": "0.0.0.0"
          }
        },
        {
          "name": "elastic_port",
          "options": {
            "description": "Port address of the elasticsearch instance",
            "default": "9200"
          }
        },
        {
          "name": "es_admin",
          "options": {
            "description": "Elasticsearch admin",
            "default": "elastic"
          }
        },
        {
          "name": "es_pass",
          "options": {
            "description": "Elasticsearch admin password",
            "default": "changeme"
          }
        },
        {
          "name": "ssl_verify",
          "options": {
            "description": "Elasticsearch admin password",
            "default": false
          }
        },
        {
          "name": "elasticsearch_conf",
          "options": {
            "description": "Path to elasticsearch.yml",
            "default": "/etc/elasticsearch/elasticsearch.yml"
          }
        },
        {
          "name": "es_included_logevents",
          "options": {
            "description": "List of events to be logged",
            "default": [
              "access_denied",
              "anonymous_access_denied",
              "authentication_failed",
              "connection_denied",
              "tampered_request",
              "run_as_denied",
              "run_as_granted"
            ]
          }
        },
        {
          "name": "es_excluded_logevents",
          "options": {
            "description": "List of events to be logged",
            "default": [
              "access_granted"
            ]
          }
        },
        {
          "name": "elastic_ip",
          "options": {
            "description": "IP address of the elasticsearch instance",
            "default": "0.0.0.0"
          }
        },
        {
          "name": "elastic_port",
          "options": {
            "description": "Port address of the elasticsearch instance",
            "default": "9200"
          }
        },
        {
          "name": "es_admin",
          "options": {
            "description": "Elasticsearch admin",
            "default": "elastic"
          }
        },
        {
          "name": "es_pass",
          "options": {
            "description": "Elasticsearch admin password",
            "default": "changeme"
          }
        },
        {
          "name": "ssl_verify",
          "options": {
            "description": "Elasticsearch admin password",
            "default": false
          }
        },
        {
          "name": "elasticsearch_conf",
          "options": {
            "description": "Path to elasticsearch.yml",
            "default": "/etc/elasticsearch/elasticsearch.yml"
          }
        },
        {
          "name": "es_included_logevents",
          "options": {
            "description": "List of events to be logged",
            "default": [
              "access_denied",
              "anonymous_access_denied",
              "authentication_failed",
              "connection_denied",
              "tampered_request",
              "run_as_denied",
              "run_as_granted"
            ]
          }
        },
        {
          "name": "es_excluded_logevents",
          "options": {
            "description": "List of events to be logged",
            "default": [
              "access_granted"
            ]
          }
        },
        {
          "name": "elastic_ip",
          "options": {
            "description": "IP address of the elasticsearch instance",
            "default": "0.0.0.0"
          }
        },
        {
          "name": "elastic_port",
          "options": {
            "description": "Port address of the elasticsearch instance",
            "default": "9200"
          }
        },
        {
          "name": "es_admin",
          "options": {
            "description": "Elasticsearch admin",
            "default": "elastic"
          }
        },
        {
          "name": "es_pass",
          "options": {
            "description": "Elasticsearch admin password",
            "default": "changeme"
          }
        },
        {
          "name": "ssl_verify",
          "options": {
            "description": "Elasticsearch admin password",
            "default": false
          }
        },
        {
          "name": "elasticsearch_conf",
          "options": {
            "description": "Path to elasticsearch.yml",
            "default": "/etc/elasticsearch/elasticsearch.yml"
          }
        },
        {
          "name": "es_included_logevents",
          "options": {
            "description": "List of events to be logged",
            "default": [
              "access_denied",
              "anonymous_access_denied",
              "authentication_failed",
              "connection_denied",
              "tampered_request",
              "run_as_denied",
              "run_as_granted"
            ]
          }
        },
        {
          "name": "es_excluded_logevents",
          "options": {
            "description": "List of events to be logged",
            "default": [
              "access_granted"
            ]
          }
        },
        {
          "name": "elastic_ip",
          "options": {
            "description": "IP address of the elasticsearch instance",
            "default": "0.0.0.0"
          }
        },
        {
          "name": "elastic_port",
          "options": {
            "description": "Port address of the elasticsearch instance",
            "default": "9200"
          }
        },
        {
          "name": "es_admin",
          "options": {
            "description": "Elasticsearch admin",
            "default": "elastic"
          }
        },
        {
          "name": "es_pass",
          "options": {
            "description": "Elasticsearch admin password",
            "default": "changeme"
          }
        },
        {
          "name": "ssl_verify",
          "options": {
            "description": "Elasticsearch admin password",
            "default": false
          }
        },
        {
          "name": "elasticsearch_conf",
          "options": {
            "description": "Path to elasticsearch.yml",
            "default": "/etc/elasticsearch/elasticsearch.yml"
          }
        },
        {
          "name": "es_included_logevents",
          "options": {
            "description": "List of events to be logged",
            "default": [
              "access_denied",
              "anonymous_access_denied",
              "authentication_failed",
              "connection_denied",
              "tampered_request",
              "run_as_denied",
              "run_as_granted"
            ]
          }
        },
        {
          "name": "es_excluded_logevents",
          "options": {
            "description": "List of events to be logged",
            "default": [
              "access_granted"
            ]
          }
        },
        {
          "name": "elastic_ip",
          "options": {
            "description": "IP address of the elasticsearch instance",
            "default": "0.0.0.0"
          }
        },
        {
          "name": "elastic_port",
          "options": {
            "description": "Port address of the elasticsearch instance",
            "default": "9200"
          }
        },
        {
          "name": "es_admin",
          "options": {
            "description": "Elasticsearch admin",
            "default": "elastic"
          }
        },
        {
          "name": "es_pass",
          "options": {
            "description": "Elasticsearch admin password",
            "default": "changeme"
          }
        },
        {
          "name": "ssl_verify",
          "options": {
            "description": "Elasticsearch admin password",
            "default": false
          }
        },
        {
          "name": "elasticsearch_conf",
          "options": {
            "description": "Path to elasticsearch.yml",
            "default": "/etc/elasticsearch/elasticsearch.yml"
          }
        },
        {
          "name": "es_included_logevents",
          "options": {
            "description": "List of events to be logged",
            "default": [
              "access_denied",
              "anonymous_access_denied",
              "authentication_failed",
              "connection_denied",
              "tampered_request",
              "run_as_denied",
              "run_as_granted"
            ]
          }
        },
        {
          "name": "es_excluded_logevents",
          "options": {
            "description": "List of events to be logged",
            "default": [
              "access_granted"
            ]
          }
        },
        {
          "name": "elastic_ip",
          "options": {
            "description": "IP address of the elasticsearch instance",
            "default": "0.0.0.0"
          }
        },
        {
          "name": "elastic_port",
          "options": {
            "description": "Port address of the elasticsearch instance",
            "default": "9200"
          }
        },
        {
          "name": "es_admin",
          "options": {
            "description": "Elasticsearch admin",
            "default": "elastic"
          }
        },
        {
          "name": "es_pass",
          "options": {
            "description": "Elasticsearch admin password",
            "default": "changeme"
          }
        },
        {
          "name": "ssl_verify",
          "options": {
            "description": "Elasticsearch admin password",
            "default": false
          }
        },
        {
          "name": "elasticsearch_conf",
          "options": {
            "description": "Path to elasticsearch.yml",
            "default": "/etc/elasticsearch/elasticsearch.yml"
          }
        },
        {
          "name": "es_included_logevents",
          "options": {
            "description": "List of events to be logged",
            "default": [
              "access_denied",
              "anonymous_access_denied",
              "authentication_failed",
              "connection_denied",
              "tampered_request",
              "run_as_denied",
              "run_as_granted"
            ]
          }
        },
        {
          "name": "es_excluded_logevents",
          "options": {
            "description": "List of events to be logged",
            "default": [
              "access_granted"
            ]
          }
        },
        {
          "name": "elastic_ip",
          "options": {
            "description": "IP address of the elasticsearch instance",
            "default": "0.0.0.0"
          }
        },
        {
          "name": "elastic_port",
          "options": {
            "description": "Port address of the elasticsearch instance",
            "default": "9200"
          }
        },
        {
          "name": "es_admin",
          "options": {
            "description": "Elasticsearch admin",
            "default": "elastic"
          }
        },
        {
          "name": "es_pass",
          "options": {
            "description": "Elasticsearch admin password",
            "default": "changeme"
          }
        },
        {
          "name": "ssl_verify",
          "options": {
            "description": "Elasticsearch admin password",
            "default": false
          }
        },
        {
          "name": "elasticsearch_conf",
          "options": {
            "description": "Path to elasticsearch.yml",
            "default": "/etc/elasticsearch/elasticsearch.yml"
          }
        },
        {
          "name": "es_included_logevents",
          "options": {
            "description": "List of events to be logged",
            "default": [
              "access_denied",
              "anonymous_access_denied",
              "authentication_failed",
              "connection_denied",
              "tampered_request",
              "run_as_denied",
              "run_as_granted"
            ]
          }
        },
        {
          "name": "es_excluded_logevents",
          "options": {
            "description": "List of events to be logged",
            "default": [
              "access_granted"
            ]
          }
        },
        {
          "name": "elastic_ip",
          "options": {
            "description": "IP address of the elasticsearch instance",
            "default": "0.0.0.0"
          }
        },
        {
          "name": "elastic_port",
          "options": {
            "description": "Port address of the elasticsearch instance",
            "default": "9200"
          }
        },
        {
          "name": "es_admin",
          "options": {
            "description": "Elasticsearch admin",
            "default": "elastic"
          }
        },
        {
          "name": "es_pass",
          "options": {
            "description": "Elasticsearch admin password",
            "default": "changeme"
          }
        },
        {
          "name": "ssl_verify",
          "options": {
            "description": "Elasticsearch admin password",
            "default": false
          }
        },
        {
          "name": "elasticsearch_conf",
          "options": {
            "description": "Path to elasticsearch.yml",
            "default": "/etc/elasticsearch/elasticsearch.yml"
          }
        },
        {
          "name": "es_included_logevents",
          "options": {
            "description": "List of events to be logged",
            "default": [
              "access_denied",
              "anonymous_access_denied",
              "authentication_failed",
              "connection_denied",
              "tampered_request",
              "run_as_denied",
              "run_as_granted"
            ]
          }
        },
        {
          "name": "es_excluded_logevents",
          "options": {
            "description": "List of events to be logged",
            "default": [
              "access_granted"
            ]
          }
        },
        {
          "name": "elastic_ip",
          "options": {
            "description": "IP address of the elasticsearch instance",
            "default": "0.0.0.0"
          }
        },
        {
          "name": "elastic_port",
          "options": {
            "description": "Port address of the elasticsearch instance",
            "default": "9200"
          }
        },
        {
          "name": "es_admin",
          "options": {
            "description": "Elasticsearch admin",
            "default": "elastic"
          }
        },
        {
          "name": "es_pass",
          "options": {
            "description": "Elasticsearch admin password",
            "default": "changeme"
          }
        },
        {
          "name": "ssl_verify",
          "options": {
            "description": "Elasticsearch admin password",
            "default": false
          }
        },
        {
          "name": "elasticsearch_conf",
          "options": {
            "description": "Path to elasticsearch.yml",
            "default": "/etc/elasticsearch/elasticsearch.yml"
          }
        },
        {
          "name": "es_included_logevents",
          "options": {
            "description": "List of events to be logged",
            "default": [
              "access_denied",
              "anonymous_access_denied",
              "authentication_failed",
              "connection_denied",
              "tampered_request",
              "run_as_denied",
              "run_as_granted"
            ]
          }
        },
        {
          "name": "es_excluded_logevents",
          "options": {
            "description": "List of events to be logged",
            "default": [
              "access_granted"
            ]
          }
        },
        {
          "name": "elastic_ip",
          "options": {
            "description": "IP address of the elasticsearch instance",
            "default": "0.0.0.0"
          }
        },
        {
          "name": "elastic_port",
          "options": {
            "description": "Port address of the elasticsearch instance",
            "default": "9200"
          }
        },
        {
          "name": "es_admin",
          "options": {
            "description": "Elasticsearch admin",
            "default": "elastic"
          }
        },
        {
          "name": "es_pass",
          "options": {
            "description": "Elasticsearch admin password",
            "default": "changeme"
          }
        },
        {
          "name": "ssl_verify",
          "options": {
            "description": "Elasticsearch admin password",
            "default": false
          }
        },
        {
          "name": "elasticsearch_conf",
          "options": {
            "description": "Path to elasticsearch.yml",
            "default": "/etc/elasticsearch/elasticsearch.yml"
          }
        },
        {
          "name": "es_included_logevents",
          "options": {
            "description": "List of events to be logged",
            "default": [
              "access_denied",
              "anonymous_access_denied",
              "authentication_failed",
              "connection_denied",
              "tampered_request",
              "run_as_denied",
              "run_as_granted"
            ]
          }
        },
        {
          "name": "es_excluded_logevents",
          "options": {
            "description": "List of events to be logged",
            "default": [
              "access_granted"
            ]
          }
        },
        {
          "name": "elastic_ip",
          "options": {
            "description": "IP address of the elasticsearch instance",
            "default": "0.0.0.0"
          }
        },
        {
          "name": "elastic_port",
          "options": {
            "description": "Port address of the elasticsearch instance",
            "default": "9200"
          }
        },
        {
          "name": "es_admin",
          "options": {
            "description": "Elasticsearch admin",
            "default": "elastic"
          }
        },
        {
          "name": "es_pass",
          "options": {
            "description": "Elasticsearch admin password",
            "default": "changeme"
          }
        },
        {
          "name": "ssl_verify",
          "options": {
            "description": "Elasticsearch admin password",
            "default": false
          }
        },
        {
          "name": "elasticsearch_conf",
          "options": {
            "description": "Path to elasticsearch.yml",
            "default": "/etc/elasticsearch/elasticsearch.yml"
          }
        },
        {
          "name": "es_included_logevents",
          "options": {
            "description": "List of events to be logged",
            "default": [
              "access_denied",
              "anonymous_access_denied",
              "authentication_failed",
              "connection_denied",
              "tampered_request",
              "run_as_denied",
              "run_as_granted"
            ]
          }
        },
        {
          "name": "es_excluded_logevents",
          "options": {
            "description": "List of events to be logged",
            "default": [
              "access_granted"
            ]
          }
        },
        {
          "name": "elastic_ip",
          "options": {
            "description": "IP address of the elasticsearch instance",
            "default": "0.0.0.0"
          }
        },
        {
          "name": "elastic_port",
          "options": {
            "description": "Port address of the elasticsearch instance",
            "default": "9200"
          }
        },
        {
          "name": "es_admin",
          "options": {
            "description": "Elasticsearch admin",
            "default": "elastic"
          }
        },
        {
          "name": "es_pass",
          "options": {
            "description": "Elasticsearch admin password",
            "default": "changeme"
          }
        },
        {
          "name": "ssl_verify",
          "options": {
            "description": "Elasticsearch admin password",
            "default": false
          }
        },
        {
          "name": "documented_super_roles",
          "options": {
            "description": "List of authorized super roles",
            "default": [
              "superuser"
            ]
          }
        },
        {
          "name": "elastic_ip",
          "options": {
            "description": "IP address of the elasticsearch instance",
            "default": "0.0.0.0"
          }
        },
        {
          "name": "elastic_port",
          "options": {
            "description": "Port address of the elasticsearch instance",
            "default": "9200"
          }
        },
        {
          "name": "es_admin",
          "options": {
            "description": "Elasticsearch admin",
            "default": "elastic"
          }
        },
        {
          "name": "es_pass",
          "options": {
            "description": "Elasticsearch admin password",
            "default": "changeme"
          }
        },
        {
          "name": "ssl_verify",
          "options": {
            "description": "Elasticsearch admin password",
            "default": false
          }
        },
        {
          "name": "elasticsearch_conf",
          "options": {
            "description": "Path to elasticsearch.yml",
            "default": "/etc/elasticsearch/elasticsearch.yml"
          }
        },
        {
          "name": "documented_super_roles",
          "options": {
            "description": "List of authorized super roles",
            "default": [
              "superuser"
            ]
          }
        },
        {
          "name": "elastic_ip",
          "options": {
            "description": "IP address of the elasticsearch instance",
            "default": "0.0.0.0"
          }
        },
        {
          "name": "elastic_port",
          "options": {
            "description": "Port address of the elasticsearch instance",
            "default": "9200"
          }
        },
        {
          "name": "es_admin",
          "options": {
            "description": "Elasticsearch admin",
            "default": "elastic"
          }
        },
        {
          "name": "es_pass",
          "options": {
            "description": "Elasticsearch admin password",
            "default": "changeme"
          }
        },
        {
          "name": "ssl_verify",
          "options": {
            "description": "Elasticsearch admin password",
            "default": false
          }
        },
        {
          "name": "elasticsearch_conf",
          "options": {
            "description": "Path to elasticsearch.yml",
            "default": "/etc/elasticsearch/elasticsearch.yml"
          }
        },
        {
          "name": "documented_super_roles",
          "options": {
            "description": "List of authorized super roles",
            "default": [
              "superuser"
            ]
          }
        },
        {
          "name": "elastic_ip",
          "options": {
            "description": "IP address of the elasticsearch instance",
            "default": "0.0.0.0"
          }
        },
        {
          "name": "elastic_port",
          "options": {
            "description": "Port address of the elasticsearch instance",
            "default": "9200"
          }
        },
        {
          "name": "es_admin",
          "options": {
            "description": "Elasticsearch admin",
            "default": "elastic"
          }
        },
        {
          "name": "es_pass",
          "options": {
            "description": "Elasticsearch admin password",
            "default": "changeme"
          }
        },
        {
          "name": "ssl_verify",
          "options": {
            "description": "Elasticsearch admin password",
            "default": false
          }
        },
        {
          "name": "elasticsearch_conf",
          "options": {
            "description": "Path to elasticsearch.yml",
            "default": "/etc/elasticsearch/elasticsearch.yml"
          }
        },
        {
          "name": "documented_super_roles",
          "options": {
            "description": "List of authorized super roles",
            "default": [
              "superuser"
            ]
          }
        },
        {
          "name": "elastic_ip",
          "options": {
            "description": "IP address of the elasticsearch instance",
            "default": "0.0.0.0"
          }
        },
        {
          "name": "elastic_port",
          "options": {
            "description": "Port address of the elasticsearch instance",
            "default": "9200"
          }
        },
        {
          "name": "es_admin",
          "options": {
            "description": "Elasticsearch admin",
            "default": "elastic"
          }
        },
        {
          "name": "es_pass",
          "options": {
            "description": "Elasticsearch admin password",
            "default": "changeme"
          }
        },
        {
          "name": "elasticsearch_conf",
          "options": {
            "description": "Path to elasticsearch.yml",
            "default": "/etc/elasticsearch/elasticsearch.yml"
          }
        },
        {
          "name": "documented_super_roles",
          "options": {
            "description": "List of authorized super roles",
            "default": [
              "superuser"
            ]
          }
        },
        {
          "name": "elastic_ip",
          "options": {
            "description": "IP address of the elasticsearch instance",
            "default": "0.0.0.0"
          }
        },
        {
          "name": "elastic_port",
          "options": {
            "description": "Port address of the elasticsearch instance",
            "default": "9200"
          }
        },
        {
          "name": "es_admin",
          "options": {
            "description": "Elasticsearch admin",
            "default": "elastic"
          }
        },
        {
          "name": "es_pass",
          "options": {
            "description": "Elasticsearch admin password",
            "default": "changeme"
          }
        },
        {
          "name": "ssl_verify",
          "options": {
            "description": "Elasticsearch admin password",
            "default": false
          }
        },
        {
          "name": "elasticsearch_conf",
          "options": {
            "description": "Path to elasticsearch.yml",
            "default": "/etc/elasticsearch/elasticsearch.yml"
          }
        },
        {
          "name": "documented_super_roles",
          "options": {
            "description": "List of authorized super roles",
            "default": [
              "superuser"
            ]
          }
        },
        {
          "name": "elastic_ip",
          "options": {
            "description": "IP address of the elasticsearch instance",
            "default": "0.0.0.0"
          }
        },
        {
          "name": "elastic_port",
          "options": {
            "description": "Port address of the elasticsearch instance",
            "default": "9200"
          }
        },
        {
          "name": "es_admin",
          "options": {
            "description": "Elasticsearch admin",
            "default": "elastic"
          }
        },
        {
          "name": "es_pass",
          "options": {
            "description": "Elasticsearch admin password",
            "default": "changeme"
          }
        },
        {
          "name": "ssl_verify",
          "options": {
            "description": "Elasticsearch admin password",
            "default": false
          }
        },
        {
          "name": "elasticsearch_conf",
          "options": {
            "description": "Path to elasticsearch.yml",
            "default": "/etc/elasticsearch/elasticsearch.yml"
          }
        },
        {
          "name": "documented_super_roles",
          "options": {
            "description": "List of authorized super roles",
            "default": [
              "superuser"
            ]
          }
        },
        {
          "name": "elastic_ip",
          "options": {
            "description": "IP address of the elasticsearch instance",
            "default": "0.0.0.0"
          }
        },
        {
          "name": "elastic_port",
          "options": {
            "description": "Port address of the elasticsearch instance",
            "default": "9200"
          }
        },
        {
          "name": "es_admin",
          "options": {
            "description": "Elasticsearch admin",
            "default": "elastic"
          }
        },
        {
          "name": "es_pass",
          "options": {
            "description": "Elasticsearch admin password",
            "default": "changeme"
          }
        },
        {
          "name": "ssl_verify",
          "options": {
            "description": "Elasticsearch admin password",
            "default": false
          }
        },
        {
          "name": "elasticsearch_conf",
          "options": {
            "description": "Path to elasticsearch.yml",
            "default": "/etc/elasticsearch/elasticsearch.yml"
          }
        },
        {
          "name": "documented_super_roles",
          "options": {
            "description": "List of authorized super roles",
            "default": [
              "superuser"
            ]
          }
        },
        {
          "name": "elastic_ip",
          "options": {
            "description": "IP address of the elasticsearch instance",
            "default": "0.0.0.0"
          }
        },
        {
          "name": "elastic_port",
          "options": {
            "description": "Port address of the elasticsearch instance",
            "default": "9200"
          }
        },
        {
          "name": "es_admin",
          "options": {
            "description": "Elasticsearch admin",
            "default": "elastic"
          }
        },
        {
          "name": "es_pass",
          "options": {
            "description": "Elasticsearch admin password",
            "default": "changeme"
          }
        },
        {
          "name": "ssl_verify",
          "options": {
            "description": "Elasticsearch admin password",
            "default": false
          }
        },
        {
          "name": "elasticsearch_conf",
          "options": {
            "description": "Path to elasticsearch.yml",
            "default": "/etc/elasticsearch/elasticsearch.yml"
          }
        },
        {
          "name": "documented_super_roles",
          "options": {
            "description": "List of authorized super roles",
            "default": [
              "superuser"
            ]
          }
        },
        {
          "name": "elastic_ip",
          "options": {
            "description": "IP address of the elasticsearch instance",
            "default": "0.0.0.0"
          }
        },
        {
          "name": "elastic_port",
          "options": {
            "description": "Port address of the elasticsearch instance",
            "default": "9200"
          }
        },
        {
          "name": "es_admin",
          "options": {
            "description": "Elasticsearch admin",
            "default": "elastic"
          }
        },
        {
          "name": "es_pass",
          "options": {
            "description": "Elasticsearch admin password",
            "default": "changeme"
          }
        },
        {
          "name": "ssl_verify",
          "options": {
            "description": "Elasticsearch admin password",
            "default": false
          }
        },
        {
          "name": "elasticsearch_conf",
          "options": {
            "description": "Path to elasticsearch.yml",
            "default": "/etc/elasticsearch/elasticsearch.yml"
          }
        },
        {
          "name": "elastic_ip",
          "options": {
            "description": "IP address of the elasticsearch instance",
            "default": "0.0.0.0"
          }
        },
        {
          "name": "elastic_port",
          "options": {
            "description": "Port address of the elasticsearch instance",
            "default": "9200"
          }
        },
        {
          "name": "es_admin",
          "options": {
            "description": "Elasticsearch admin",
            "default": "elastic"
          }
        },
        {
          "name": "es_pass",
          "options": {
            "description": "Elasticsearch admin password",
            "default": "changeme"
          }
        },
        {
          "name": "ssl_verify",
          "options": {
            "description": "Elasticsearch admin password",
            "default": false
          }
        },
        {
          "name": "elastic_ip",
          "options": {
            "description": "IP address of the elasticsearch instance",
            "default": "0.0.0.0"
          }
        },
        {
          "name": "elastic_port",
          "options": {
            "description": "Port address of the elasticsearch instance",
            "default": "9200"
          }
        },
        {
          "name": "es_admin",
          "options": {
            "description": "Elasticsearch admin",
            "default": "elastic"
          }
        },
        {
          "name": "es_pass",
          "options": {
            "description": "Elasticsearch admin password",
            "default": "changeme"
          }
        },
        {
          "name": "ssl_verify",
          "options": {
            "description": "Elasticsearch admin password",
            "default": false
          }
        },
        {
          "name": "elastic_ip",
          "options": {
            "description": "IP address of the elasticsearch instance",
            "default": "0.0.0.0"
          }
        },
        {
          "name": "elastic_port",
          "options": {
            "description": "Port address of the elasticsearch instance",
            "default": "9200"
          }
        },
        {
          "name": "es_admin",
          "options": {
            "description": "Elasticsearch admin",
            "default": "elastic"
          }
        },
        {
          "name": "es_pass",
          "options": {
            "description": "Elasticsearch admin password",
            "default": "changeme"
          }
        },
        {
          "name": "ssl_verify",
          "options": {
            "description": "Elasticsearch admin password",
            "default": false
          }
        },
        {
          "name": "auditd_log_file",
          "options": {
            "description": "Path to the auditd log file",
            "default": "/var/log/audit/audit.log"
          }
        },
        {
          "name": "auditd_space_left_threshold_precent",
          "options": {
            "description": "Percent of space left in audit partition to trigger action \n  eg. 25 => action is triggered when 25 percentage of partition space is left",
            "default": 25
          }
        },
        {
          "name": "auditd_log_file",
          "options": {
            "description": "Path to the auditd log file",
            "default": "/var/log/audit/audit.log"
          }
        },
        {
          "name": "auditd_space_left_threshold_precent",
          "options": {
            "description": "Percent of space left in audit partition to trigger action \n  eg. 25 => action is triggered when 25 percentage of partition space is left",
            "default": 25
          }
        },
        {
          "name": "auditd_log_file",
          "options": {
            "description": "Path to the auditd log file",
            "default": "/var/log/audit/audit.log"
          }
        },
        {
          "name": "auditd_space_left_threshold_precent",
          "options": {
            "description": "Percent of space left in audit partition to trigger action \n  eg. 25 => action is triggered when 25 percentage of partition space is left",
            "default": 25
          }
        },
        {
          "name": "auditd_log_file",
          "options": {
            "description": "Path to the auditd log file",
            "default": "/var/log/audit/audit.log"
          }
        },
        {
          "name": "auditd_space_left_threshold_precent",
          "options": {
            "description": "Percent of space left in audit partition to trigger action \n  eg. 25 => action is triggered when 25 percentage of partition space is left",
            "default": 25
          }
        },
        {
          "name": "auditd_log_file",
          "options": {
            "description": "Path to the auditd log file",
            "default": "/var/log/audit/audit.log"
          }
        },
        {
          "name": "auditd_space_left_threshold_precent",
          "options": {
            "description": "Percent of space left in audit partition to trigger action \n  eg. 25 => action is triggered when 25 percentage of partition space is left",
            "default": 25
          }
        },
        {
          "name": "elastic_ip",
          "options": {
            "description": "IP address of the elasticsearch instance",
            "default": "0.0.0.0"
          }
        },
        {
          "name": "elastic_port",
          "options": {
            "description": "Port address of the elasticsearch instance",
            "default": "9200"
          }
        },
        {
          "name": "elasticsearch_conf",
          "options": {
            "description": "Path to elasticsearch.yml",
            "default": "/etc/elasticsearch/elasticsearch.yml"
          }
        },
        {
          "name": "managed_access_points",
          "options": {
            "description": "List of managed access points",
            "default": [
              "10.0.2.15"
            ]
          }
        },
        {
          "name": "es_admin",
          "options": {
            "description": "Elasticsearch admin",
            "default": "elastic"
          }
        },
        {
          "name": "es_pass",
          "options": {
            "description": "Elasticsearch admin password",
            "default": "changeme"
          }
        },
        {
          "name": "ssl_verify",
          "options": {
            "description": "Elasticsearch admin password",
            "default": false
          }
        },
        {
          "name": "elastic_ip",
          "options": {
            "description": "IP address of the elasticsearch instance",
            "default": "0.0.0.0"
          }
        },
        {
          "name": "elastic_port",
          "options": {
            "description": "Port address of the elasticsearch instance",
            "default": "9200"
          }
        },
        {
          "name": "elasticsearch_conf",
          "options": {
            "description": "Path to elasticsearch.yml",
            "default": "/etc/elasticsearch/elasticsearch.yml"
          }
        },
        {
          "name": "managed_access_points",
          "options": {
            "description": "List of managed access points",
            "default": [
              "10.0.2.15"
            ]
          }
        },
        {
          "name": "es_admin",
          "options": {
            "description": "Elasticsearch admin",
            "default": "elastic"
          }
        },
        {
          "name": "es_pass",
          "options": {
            "description": "Elasticsearch admin password",
            "default": "changeme"
          }
        },
        {
          "name": "ssl_verify",
          "options": {
            "description": "Elasticsearch admin password",
            "default": false
          }
        },
        {
          "name": "ssl_verify",
          "options": {
            "description": "Elasticsearch admin password",
            "default": false
          }
        },
        {
          "name": "elastic_ip",
          "options": {
            "description": "IP address of the elasticsearch instance",
            "default": "0.0.0.0"
          }
        },
        {
          "name": "elastic_port",
          "options": {
            "description": "Port address of the elasticsearch instance",
            "default": "9200"
          }
        },
        {
          "name": "elasticsearch_conf",
          "options": {
            "description": "Path to elasticsearch.yml",
            "default": "/etc/elasticsearch/elasticsearch.yml"
          }
        },
        {
          "name": "managed_access_points",
          "options": {
            "description": "List of managed access points",
            "default": [
              "10.0.2.15"
            ]
          }
        },
        {
          "name": "es_admin",
          "options": {
            "description": "Elasticsearch admin",
            "default": "elastic"
          }
        },
        {
          "name": "es_pass",
          "options": {
            "description": "Elasticsearch admin password",
            "default": "changeme"
          }
        },
        {
          "name": "ssl_verify",
          "options": {
            "description": "Elasticsearch admin password",
            "default": false
          }
        },
        {
          "name": "elastic_ip",
          "options": {
            "description": "IP address of the elasticsearch instance",
            "default": "0.0.0.0"
          }
        },
        {
          "name": "elastic_port",
          "options": {
            "description": "Port address of the elasticsearch instance",
            "default": "9200"
          }
        },
        {
          "name": "elasticsearch_conf",
          "options": {
            "description": "Path to elasticsearch.yml",
            "default": "/etc/elasticsearch/elasticsearch.yml"
          }
        },
        {
          "name": "managed_access_points",
          "options": {
            "description": "List of managed access points",
            "default": [
              "10.0.2.15"
            ]
          }
        },
        {
          "name": "es_admin",
          "options": {
            "description": "Elasticsearch admin",
            "default": "elastic"
          }
        },
        {
          "name": "es_pass",
          "options": {
            "description": "Elasticsearch admin password",
            "default": "changeme"
          }
        },
        {
          "name": "ssl_verify",
          "options": {
            "description": "Elasticsearch admin password",
            "default": false
          }
        },
        {
          "name": "elastic_ip",
          "options": {
            "description": "IP address of the elasticsearch instance",
            "default": "0.0.0.0"
          }
        },
        {
          "name": "elastic_port",
          "options": {
            "description": "Port address of the elasticsearch instance",
            "default": "9200"
          }
        },
        {
          "name": "elasticsearch_conf",
          "options": {
            "description": "Path to elasticsearch.yml",
            "default": "/etc/elasticsearch/elasticsearch.yml"
          }
        },
        {
          "name": "managed_access_points",
          "options": {
            "description": "List of managed access points",
            "default": [
              "10.0.2.15"
            ]
          }
        },
        {
          "name": "es_admin",
          "options": {
            "description": "Elasticsearch admin",
            "default": "elastic"
          }
        },
        {
          "name": "es_pass",
          "options": {
            "description": "Elasticsearch admin password",
            "default": "changeme"
          }
        },
        {
          "name": "ssl_verify",
          "options": {
            "description": "Elasticsearch admin password",
            "default": false
          }
        },
        {
          "name": "elastic_ip",
          "options": {
            "description": "IP address of the elasticsearch instance",
            "default": "0.0.0.0"
          }
        },
        {
          "name": "elastic_port",
          "options": {
            "description": "Port address of the elasticsearch instance",
            "default": "9200"
          }
        },
        {
          "name": "elasticsearch_conf",
          "options": {
            "description": "Path to elasticsearch.yml",
            "default": "/etc/elasticsearch/elasticsearch.yml"
          }
        },
        {
          "name": "managed_access_points",
          "options": {
            "description": "List of managed access points",
            "default": [
              "10.0.2.15"
            ]
          }
        },
        {
          "name": "es_admin",
          "options": {
            "description": "Elasticsearch admin",
            "default": "elastic"
          }
        },
        {
          "name": "es_pass",
          "options": {
            "description": "Elasticsearch admin password",
            "default": "changeme"
          }
        },
        {
          "name": "ssl_verify",
          "options": {
            "description": "Elasticsearch admin password",
            "default": false
          }
        },
        {
          "name": "elastic_ip",
          "options": {
            "description": "IP address of the elasticsearch instance",
            "default": "0.0.0.0"
          }
        },
        {
          "name": "elastic_port",
          "options": {
            "description": "Port address of the elasticsearch instance",
            "default": "9200"
          }
        },
        {
          "name": "elasticsearch_conf",
          "options": {
            "description": "Path to elasticsearch.yml",
            "default": "/etc/elasticsearch/elasticsearch.yml"
          }
        },
        {
          "name": "managed_access_points",
          "options": {
            "description": "List of managed access points",
            "default": [
              "10.0.2.15"
            ]
          }
        },
        {
          "name": "es_admin",
          "options": {
            "description": "Elasticsearch admin",
            "default": "elastic"
          }
        },
        {
          "name": "es_pass",
          "options": {
            "description": "Elasticsearch admin password",
            "default": "changeme"
          }
        },
        {
          "name": "ssl_verify",
          "options": {
            "description": "Elasticsearch admin password",
            "default": false
          }
        },
        {
          "name": "ssl_verify",
          "options": {
            "description": "Elasticsearch admin password",
            "default": false
          }
        },
        {
          "name": "elastic_ip",
          "options": {
            "description": "IP address of the elasticsearch instance",
            "default": "0.0.0.0"
          }
        },
        {
          "name": "elastic_port",
          "options": {
            "description": "Port address of the elasticsearch instance",
            "default": "9200"
          }
        },
        {
          "name": "elasticsearch_conf",
          "options": {
            "description": "Path to elasticsearch.yml",
            "default": "/etc/elasticsearch/elasticsearch.yml"
          }
        },
        {
          "name": "managed_access_points",
          "options": {
            "description": "List of managed access points",
            "default": [
              "10.0.2.15"
            ]
          }
        },
        {
          "name": "es_admin",
          "options": {
            "description": "Elasticsearch admin",
            "default": "elastic"
          }
        },
        {
          "name": "es_pass",
          "options": {
            "description": "Elasticsearch admin password",
            "default": "changeme"
          }
        },
        {
          "name": "ssl_verify",
          "options": {
            "description": "Elasticsearch admin password",
            "default": false
          }
        },
        {
          "name": "elastic_ip",
          "options": {
            "description": "IP address of the elasticsearch instance",
            "default": "0.0.0.0"
          }
        },
        {
          "name": "elastic_port",
          "options": {
            "description": "Port address of the elasticsearch instance",
            "default": "9200"
          }
        },
        {
          "name": "elasticsearch_conf",
          "options": {
            "description": "Path to elasticsearch.yml",
            "default": "/etc/elasticsearch/elasticsearch.yml"
          }
        },
        {
          "name": "managed_access_points",
          "options": {
            "description": "List of managed access points",
            "default": [
              "10.0.2.15"
            ]
          }
        },
        {
          "name": "es_admin",
          "options": {
            "description": "Elasticsearch admin",
            "default": "elastic"
          }
        },
        {
          "name": "es_pass",
          "options": {
            "description": "Elasticsearch admin password",
            "default": "changeme"
          }
        },
        {
          "name": "ssl_verify",
          "options": {
            "description": "Elasticsearch admin password",
            "default": false
          }
        },
        {
          "name": "elastic_ip",
          "options": {
            "description": "IP address of the elasticsearch instance",
            "default": "0.0.0.0"
          }
        },
        {
          "name": "elastic_port",
          "options": {
            "description": "Port address of the elasticsearch instance",
            "default": "9200"
          }
        },
        {
          "name": "elasticsearch_conf",
          "options": {
            "description": "Path to elasticsearch.yml",
            "default": "/etc/elasticsearch/elasticsearch.yml"
          }
        },
        {
          "name": "managed_access_points",
          "options": {
            "description": "List of managed access points",
            "default": [
              "10.0.2.15"
            ]
          }
        },
        {
          "name": "es_admin",
          "options": {
            "description": "Elasticsearch admin",
            "default": "elastic"
          }
        },
        {
          "name": "es_pass",
          "options": {
            "description": "Elasticsearch admin password",
            "default": "changeme"
          }
        },
        {
          "name": "ssl_verify",
          "options": {
            "description": "Elasticsearch admin password",
            "default": false
          }
        },
        {
          "name": "es_owner",
          "options": {
            "description": "Elasticsearch owner",
            "default": "elasticsearch"
          }
        },
        {
          "name": "es_group",
          "options": {
            "description": "Elasticsearch owner",
            "default": "elasticsearch"
          }
        },
        {
          "name": "elastic_ip",
          "options": {
            "description": "IP address of the elasticsearch instance",
            "default": "0.0.0.0"
          }
        },
        {
          "name": "elastic_port",
          "options": {
            "description": "Port address of the elasticsearch instance",
            "default": "9200"
          }
        },
        {
          "name": "es_admin",
          "options": {
            "description": "Elasticsearch admin",
            "default": "elastic"
          }
        },
        {
          "name": "es_pass",
          "options": {
            "description": "Elasticsearch admin password",
            "default": "changeme"
          }
        },
        {
          "name": "ssl_verify",
          "options": {
            "description": "Elasticsearch admin password",
            "default": false
          }
        },
        {
          "name": "es_logs_dir",
          "options": {
            "description": "Path elasticsearch logs folder",
            "default": "/var/log/elasticsearch"
          }
        },
        {
          "name": "es_owner",
          "options": {
            "description": "Elasticsearch owner",
            "default": "elasticsearch"
          }
        },
        {
          "name": "es_group",
          "options": {
            "description": "Elasticsearch owner",
            "default": "elasticsearch"
          }
        },
        {
          "name": "elastic_ip",
          "options": {
            "description": "IP address of the elasticsearch instance",
            "default": "0.0.0.0"
          }
        },
        {
          "name": "elastic_port",
          "options": {
            "description": "Port address of the elasticsearch instance",
            "default": "9200"
          }
        },
        {
          "name": "es_admin",
          "options": {
            "description": "Elasticsearch admin",
            "default": "elastic"
          }
        },
        {
          "name": "es_pass",
          "options": {
            "description": "Elasticsearch admin password",
            "default": "changeme"
          }
        },
        {
          "name": "ssl_verify",
          "options": {
            "description": "Elasticsearch admin password",
            "default": false
          }
        },
        {
          "name": "es_logs_dir",
          "options": {
            "description": "Path elasticsearch logs folder",
            "default": "/var/log/elasticsearch"
          }
        },
        {
          "name": "elastic_ip",
          "options": {
            "description": "IP address of the elasticsearch instance",
            "default": "0.0.0.0"
          }
        },
        {
          "name": "elastic_port",
          "options": {
            "description": "Port address of the elasticsearch instance",
            "default": "9200"
          }
        },
        {
          "name": "es_admin",
          "options": {
            "description": "Elasticsearch admin",
            "default": "elastic"
          }
        },
        {
          "name": "es_pass",
          "options": {
            "description": "Elasticsearch admin password",
            "default": "changeme"
          }
        },
        {
          "name": "ssl_verify",
          "options": {
            "description": "Elasticsearch admin password",
            "default": false
          }
        },
        {
          "name": "elastic_ip",
          "options": {
            "description": "IP address of the elasticsearch instance",
            "default": "0.0.0.0"
          }
        },
        {
          "name": "elastic_port",
          "options": {
            "description": "Port address of the elasticsearch instance",
            "default": "9200"
          }
        },
        {
          "name": "es_admin",
          "options": {
            "description": "Elasticsearch admin",
            "default": "elastic"
          }
        },
        {
          "name": "es_pass",
          "options": {
            "description": "Elasticsearch admin password",
            "default": "changeme"
          }
        },
        {
          "name": "ssl_verify",
          "options": {
            "description": "Elasticsearch admin password",
            "default": false
          }
        },
        {
          "name": "elastic_ip",
          "options": {
            "description": "IP address of the elasticsearch instance",
            "default": "0.0.0.0"
          }
        },
        {
          "name": "elastic_port",
          "options": {
            "description": "Port address of the elasticsearch instance",
            "default": "9200"
          }
        },
        {
          "name": "es_admin",
          "options": {
            "description": "Elasticsearch admin",
            "default": "elastic"
          }
        },
        {
          "name": "es_pass",
          "options": {
            "description": "Elasticsearch admin password",
            "default": "changeme"
          }
        },
        {
          "name": "ssl_verify",
          "options": {
            "description": "Elasticsearch admin password",
            "default": false
          }
        },
        {
          "name": "elastic_ip",
          "options": {
            "description": "IP address of the elasticsearch instance",
            "default": "0.0.0.0"
          }
        },
        {
          "name": "elastic_port",
          "options": {
            "description": "Port address of the elasticsearch instance",
            "default": "9200"
          }
        },
        {
          "name": "es_admin",
          "options": {
            "description": "Elasticsearch admin",
            "default": "elastic"
          }
        },
        {
          "name": "es_pass",
          "options": {
            "description": "Elasticsearch admin password",
            "default": "changeme"
          }
        },
        {
          "name": "ssl_verify",
          "options": {
            "description": "Elasticsearch admin password",
            "default": false
          }
        },
        {
          "name": "elastic_ip",
          "options": {
            "description": "IP address of the elasticsearch instance",
            "default": "0.0.0.0"
          }
        },
        {
          "name": "elastic_port",
          "options": {
            "description": "Port address of the elasticsearch instance",
            "default": "9200"
          }
        },
        {
          "name": "es_admin",
          "options": {
            "description": "Elasticsearch admin",
            "default": "elastic"
          }
        },
        {
          "name": "es_pass",
          "options": {
            "description": "Elasticsearch admin password",
            "default": "changeme"
          }
        },
        {
          "name": "ssl_verify",
          "options": {
            "description": "Elasticsearch admin password",
            "default": false
          }
        },
        {
          "name": "elastic_ip",
          "options": {
            "description": "IP address of the elasticsearch instance",
            "default": "0.0.0.0"
          }
        },
        {
          "name": "elastic_port",
          "options": {
            "description": "Port address of the elasticsearch instance",
            "default": "9200"
          }
        },
        {
          "name": "es_admin",
          "options": {
            "description": "Elasticsearch admin",
            "default": "elastic"
          }
        },
        {
          "name": "es_pass",
          "options": {
            "description": "Elasticsearch admin password",
            "default": "changeme"
          }
        },
        {
          "name": "ssl_verify",
          "options": {
            "description": "Elasticsearch admin password",
            "default": false
          }
        },
        {
          "name": "elastic_ip",
          "options": {
            "description": "IP address of the elasticsearch instance",
            "default": "0.0.0.0"
          }
        },
        {
          "name": "elastic_port",
          "options": {
            "description": "Port address of the elasticsearch instance",
            "default": "9200"
          }
        },
        {
          "name": "es_admin",
          "options": {
            "description": "Elasticsearch admin",
            "default": "elastic"
          }
        },
        {
          "name": "es_pass",
          "options": {
            "description": "Elasticsearch admin password",
            "default": "changeme"
          }
        },
        {
          "name": "ssl_verify",
          "options": {
            "description": "Elasticsearch admin password",
            "default": false
          }
        },
        {
          "name": "elastic_ip",
          "options": {
            "description": "IP address of the elasticsearch instance",
            "default": "0.0.0.0"
          }
        },
        {
          "name": "elastic_port",
          "options": {
            "description": "Port address of the elasticsearch instance",
            "default": "9200"
          }
        },
        {
          "name": "es_admin",
          "options": {
            "description": "Elasticsearch admin",
            "default": "elastic"
          }
        },
        {
          "name": "es_pass",
          "options": {
            "description": "Elasticsearch admin password",
            "default": "changeme"
          }
        },
        {
          "name": "ssl_verify",
          "options": {
            "description": "Elasticsearch admin password",
            "default": false
          }
        },
        {
          "name": "elastic_ip",
          "options": {
            "description": "IP address of the elasticsearch instance",
            "default": "0.0.0.0"
          }
        },
        {
          "name": "elastic_port",
          "options": {
            "description": "Port address of the elasticsearch instance",
            "default": "9200"
          }
        },
        {
          "name": "es_admin",
          "options": {
            "description": "Elasticsearch admin",
            "default": "elastic"
          }
        },
        {
          "name": "es_pass",
          "options": {
            "description": "Elasticsearch admin password",
            "default": "changeme"
          }
        },
        {
          "name": "ssl_verify",
          "options": {
            "description": "Elasticsearch admin password",
            "default": false
          }
        },
        {
          "name": "elastic_ip",
          "options": {
            "description": "IP address of the elasticsearch instance",
            "default": "0.0.0.0"
          }
        },
        {
          "name": "elastic_port",
          "options": {
            "description": "Port address of the elasticsearch instance",
            "default": "9200"
          }
        },
        {
          "name": "es_admin",
          "options": {
            "description": "Elasticsearch admin",
            "default": "elastic"
          }
        },
        {
          "name": "es_pass",
          "options": {
            "description": "Elasticsearch admin password",
            "default": "changeme"
          }
        },
        {
          "name": "ssl_verify",
          "options": {
            "description": "Elasticsearch admin password",
            "default": false
          }
        },
        {
          "name": "elastic_ip",
          "options": {
            "description": "IP address of the elasticsearch instance",
            "default": "0.0.0.0"
          }
        },
        {
          "name": "elastic_port",
          "options": {
            "description": "Port address of the elasticsearch instance",
            "default": "9200"
          }
        },
        {
          "name": "es_admin",
          "options": {
            "description": "Elasticsearch admin",
            "default": "elastic"
          }
        },
        {
          "name": "es_pass",
          "options": {
            "description": "Elasticsearch admin password",
            "default": "changeme"
          }
        },
        {
          "name": "ssl_verify",
          "options": {
            "description": "Elasticsearch admin password",
            "default": false
          }
        },
        {
          "name": "elastic_ip",
          "options": {
            "description": "IP address of the elasticsearch instance",
            "default": "0.0.0.0"
          }
        },
        {
          "name": "elastic_port",
          "options": {
            "description": "Port address of the elasticsearch instance",
            "default": "9200"
          }
        },
        {
          "name": "es_admin",
          "options": {
            "description": "Elasticsearch admin",
            "default": "elastic"
          }
        },
        {
          "name": "es_pass",
          "options": {
            "description": "Elasticsearch admin password",
            "default": "changeme"
          }
        },
        {
          "name": "ssl_verify",
          "options": {
            "description": "Elasticsearch admin password",
            "default": false
          }
        },
        {
          "name": "elastic_ip",
          "options": {
            "description": "IP address of the elasticsearch instance",
            "default": "0.0.0.0"
          }
        },
        {
          "name": "elastic_port",
          "options": {
            "description": "Port address of the elasticsearch instance",
            "default": "9200"
          }
        },
        {
          "name": "es_admin",
          "options": {
            "description": "Elasticsearch admin",
            "default": "elastic"
          }
        },
        {
          "name": "es_pass",
          "options": {
            "description": "Elasticsearch admin password",
            "default": "changeme"
          }
        },
        {
          "name": "ssl_verify",
          "options": {
            "description": "Elasticsearch admin password",
            "default": false
          }
        },
        {
          "name": "elastic_ip",
          "options": {
            "description": "IP address of the elasticsearch instance",
            "default": "0.0.0.0"
          }
        },
        {
          "name": "elastic_port",
          "options": {
            "description": "Port address of the elasticsearch instance",
            "default": "9200"
          }
        },
        {
          "name": "es_admin",
          "options": {
            "description": "Elasticsearch admin",
            "default": "elastic"
          }
        },
        {
          "name": "es_pass",
          "options": {
            "description": "Elasticsearch admin password",
            "default": "changeme"
          }
        },
        {
          "name": "ssl_verify",
          "options": {
            "description": "Elasticsearch admin password",
            "default": false
          }
        },
        {
          "name": "elastic_ip",
          "options": {
            "description": "IP address of the elasticsearch instance",
            "default": "0.0.0.0"
          }
        },
        {
          "name": "elastic_port",
          "options": {
            "description": "Port address of the elasticsearch instance",
            "default": "9200"
          }
        },
        {
          "name": "es_admin",
          "options": {
            "description": "Elasticsearch admin",
            "default": "elastic"
          }
        },
        {
          "name": "es_pass",
          "options": {
            "description": "Elasticsearch admin password",
            "default": "changeme"
          }
        },
        {
          "name": "ssl_verify",
          "options": {
            "description": "Elasticsearch admin password",
            "default": false
          }
        },
        {
          "name": "elastic_ip",
          "options": {
            "description": "IP address of the elasticsearch instance",
            "default": "0.0.0.0"
          }
        },
        {
          "name": "elastic_port",
          "options": {
            "description": "Port address of the elasticsearch instance",
            "default": "9200"
          }
        },
        {
          "name": "es_admin",
          "options": {
            "description": "Elasticsearch admin",
            "default": "elastic"
          }
        },
        {
          "name": "es_pass",
          "options": {
            "description": "Elasticsearch admin password",
            "default": "changeme"
          }
        },
        {
          "name": "ssl_verify",
          "options": {
            "description": "Elasticsearch admin password",
            "default": false
          }
        },
        {
          "name": "elastic_ip",
          "options": {
            "description": "IP address of the elasticsearch instance",
            "default": "0.0.0.0"
          }
        },
        {
          "name": "elastic_port",
          "options": {
            "description": "Port address of the elasticsearch instance",
            "default": "9200"
          }
        },
        {
          "name": "es_admin",
          "options": {
            "description": "Elasticsearch admin",
            "default": "elastic"
          }
        },
        {
          "name": "es_pass",
          "options": {
            "description": "Elasticsearch admin password",
            "default": "changeme"
          }
        },
        {
          "name": "ssl_verify",
          "options": {
            "description": "Elasticsearch admin password",
            "default": false
          }
        },
        {
          "name": "elastic_ip",
          "options": {
            "description": "IP address of the elasticsearch instance",
            "default": "0.0.0.0"
          }
        },
        {
          "name": "elastic_port",
          "options": {
            "description": "Port address of the elasticsearch instance",
            "default": "9200"
          }
        },
        {
          "name": "es_admin",
          "options": {
            "description": "Elasticsearch admin",
            "default": "elastic"
          }
        },
        {
          "name": "es_pass",
          "options": {
            "description": "Elasticsearch admin password",
            "default": "changeme"
          }
        },
        {
          "name": "ssl_verify",
          "options": {
            "description": "Elasticsearch admin password",
            "default": false
          }
        },
        {
          "name": "elastic_ip",
          "options": {
            "description": "IP address of the elasticsearch instance",
            "default": "0.0.0.0"
          }
        },
        {
          "name": "elastic_port",
          "options": {
            "description": "Port address of the elasticsearch instance",
            "default": "9200"
          }
        },
        {
          "name": "es_admin",
          "options": {
            "description": "Elasticsearch admin",
            "default": "elastic"
          }
        },
        {
          "name": "es_pass",
          "options": {
            "description": "Elasticsearch admin password",
            "default": "changeme"
          }
        },
        {
          "name": "ssl_verify",
          "options": {
            "description": "Elasticsearch admin password",
            "default": false
          }
        },
        {
          "name": "elastic_ip",
          "options": {
            "description": "IP address of the elasticsearch instance",
            "default": "0.0.0.0"
          }
        },
        {
          "name": "elastic_port",
          "options": {
            "description": "Port address of the elasticsearch instance",
            "default": "9200"
          }
        },
        {
          "name": "es_admin",
          "options": {
            "description": "Elasticsearch admin",
            "default": "elastic"
          }
        },
        {
          "name": "es_pass",
          "options": {
            "description": "Elasticsearch admin password",
            "default": "changeme"
          }
        },
        {
          "name": "ssl_verify",
          "options": {
            "description": "Elasticsearch admin password",
            "default": false
          }
        },
        {
          "name": "elastic_ip",
          "options": {
            "description": "IP address of the elasticsearch instance",
            "default": "0.0.0.0"
          }
        },
        {
          "name": "elastic_port",
          "options": {
            "description": "Port address of the elasticsearch instance",
            "default": "9200"
          }
        },
        {
          "name": "es_admin",
          "options": {
            "description": "Elasticsearch admin",
            "default": "elastic"
          }
        },
        {
          "name": "es_pass",
          "options": {
            "description": "Elasticsearch admin password",
            "default": "changeme"
          }
        },
        {
          "name": "ssl_verify",
          "options": {
            "description": "Elasticsearch admin password",
            "default": false
          }
        },
        {
          "name": "elastic_ip",
          "options": {
            "description": "IP address of the elasticsearch instance",
            "default": "0.0.0.0"
          }
        },
        {
          "name": "elastic_port",
          "options": {
            "description": "Port address of the elasticsearch instance",
            "default": "9200"
          }
        },
        {
          "name": "es_admin",
          "options": {
            "description": "Elasticsearch admin",
            "default": "elastic"
          }
        },
        {
          "name": "es_pass",
          "options": {
            "description": "Elasticsearch admin password",
            "default": "changeme"
          }
        },
        {
          "name": "ssl_verify",
          "options": {
            "description": "Elasticsearch admin password",
            "default": false
          }
        },
        {
          "name": "elastic_ip",
          "options": {
            "description": "IP address of the elasticsearch instance",
            "default": "0.0.0.0"
          }
        },
        {
          "name": "elastic_port",
          "options": {
            "description": "Port address of the elasticsearch instance",
            "default": "9200"
          }
        },
        {
          "name": "es_admin",
          "options": {
            "description": "Elasticsearch admin",
            "default": "elastic"
          }
        },
        {
          "name": "es_pass",
          "options": {
            "description": "Elasticsearch admin password",
            "default": "changeme"
          }
        },
        {
          "name": "ssl_verify",
          "options": {
            "description": "Elasticsearch admin password",
            "default": false
          }
        },
        {
          "name": "elastic_ip",
          "options": {
            "description": "IP address of the elasticsearch instance",
            "default": "0.0.0.0"
          }
        },
        {
          "name": "elastic_port",
          "options": {
            "description": "Port address of the elasticsearch instance",
            "default": "9200"
          }
        },
        {
          "name": "es_admin",
          "options": {
            "description": "Elasticsearch admin",
            "default": "elastic"
          }
        },
        {
          "name": "es_pass",
          "options": {
            "description": "Elasticsearch admin password",
            "default": "changeme"
          }
        },
        {
          "name": "ssl_verify",
          "options": {
            "description": "Elasticsearch admin password",
            "default": false
          }
        },
        {
          "name": "elastic_ip",
          "options": {
            "description": "IP address of the elasticsearch instance",
            "default": "0.0.0.0"
          }
        },
        {
          "name": "elastic_port",
          "options": {
            "description": "Port address of the elasticsearch instance",
            "default": "9200"
          }
        },
        {
          "name": "es_admin",
          "options": {
            "description": "Elasticsearch admin",
            "default": "elastic"
          }
        },
        {
          "name": "es_pass",
          "options": {
            "description": "Elasticsearch admin password",
            "default": "changeme"
          }
        },
        {
          "name": "ssl_verify",
          "options": {
            "description": "Elasticsearch admin password",
            "default": false
          }
        },
        {
          "name": "elastic_ip",
          "options": {
            "description": "IP address of the elasticsearch instance",
            "default": "0.0.0.0"
          }
        },
        {
          "name": "elastic_port",
          "options": {
            "description": "Port address of the elasticsearch instance",
            "default": "9200"
          }
        },
        {
          "name": "es_admin",
          "options": {
            "description": "Elasticsearch admin",
            "default": "elastic"
          }
        },
        {
          "name": "es_pass",
          "options": {
            "description": "Elasticsearch admin password",
            "default": "changeme"
          }
        },
        {
          "name": "ssl_verify",
          "options": {
            "description": "Elasticsearch admin password",
            "default": false
          }
        },
        {
          "name": "elastic_ip",
          "options": {
            "description": "IP address of the elasticsearch instance",
            "default": "0.0.0.0"
          }
        },
        {
          "name": "elastic_port",
          "options": {
            "description": "Port address of the elasticsearch instance",
            "default": "9200"
          }
        },
        {
          "name": "es_admin",
          "options": {
            "description": "Elasticsearch admin",
            "default": "elastic"
          }
        },
        {
          "name": "es_pass",
          "options": {
            "description": "Elasticsearch admin password",
            "default": "changeme"
          }
        },
        {
          "name": "ssl_verify",
          "options": {
            "description": "Elasticsearch admin password",
            "default": false
          }
        },
        {
          "name": "elastic_ip",
          "options": {
            "description": "IP address of the elasticsearch instance",
            "default": "0.0.0.0"
          }
        },
        {
          "name": "elastic_port",
          "options": {
            "description": "Port address of the elasticsearch instance",
            "default": "9200"
          }
        },
        {
          "name": "es_admin",
          "options": {
            "description": "Elasticsearch admin",
            "default": "elastic"
          }
        },
        {
          "name": "es_pass",
          "options": {
            "description": "Elasticsearch admin password",
            "default": "changeme"
          }
        },
        {
          "name": "ssl_verify",
          "options": {
            "description": "Elasticsearch admin password",
            "default": false
          }
        },
        {
          "name": "elastic_ip",
          "options": {
            "description": "IP address of the elasticsearch instance",
            "default": "0.0.0.0"
          }
        },
        {
          "name": "elastic_port",
          "options": {
            "description": "Port address of the elasticsearch instance",
            "default": "9200"
          }
        },
        {
          "name": "es_admin",
          "options": {
            "description": "Elasticsearch admin",
            "default": "elastic"
          }
        },
        {
          "name": "es_pass",
          "options": {
            "description": "Elasticsearch admin password",
            "default": "changeme"
          }
        },
        {
          "name": "ssl_verify",
          "options": {
            "description": "Elasticsearch admin password",
            "default": false
          }
        },
        {
          "name": "elastic_ip",
          "options": {
            "description": "IP address of the elasticsearch instance",
            "default": "0.0.0.0"
          }
        },
        {
          "name": "elastic_port",
          "options": {
            "description": "Port address of the elasticsearch instance",
            "default": "9200"
          }
        },
        {
          "name": "es_admin",
          "options": {
            "description": "Elasticsearch admin",
            "default": "elastic"
          }
        },
        {
          "name": "es_pass",
          "options": {
            "description": "Elasticsearch admin password",
            "default": "changeme"
          }
        },
        {
          "name": "ssl_verify",
          "options": {
            "description": "Elasticsearch admin password",
            "default": false
          }
        },
        {
          "name": "elastic_ip",
          "options": {
            "description": "IP address of the elasticsearch instance",
            "default": "0.0.0.0"
          }
        },
        {
          "name": "elastic_port",
          "options": {
            "description": "Port address of the elasticsearch instance",
            "default": "9200"
          }
        },
        {
          "name": "es_admin",
          "options": {
            "description": "Elasticsearch admin",
            "default": "elastic"
          }
        },
        {
          "name": "es_pass",
          "options": {
            "description": "Elasticsearch admin password",
            "default": "changeme"
          }
        },
        {
          "name": "ssl_verify",
          "options": {
            "description": "Elasticsearch admin password",
            "default": false
          }
        },
        {
          "name": "elastic_ip",
          "options": {
            "description": "IP address of the elasticsearch instance",
            "default": "0.0.0.0"
          }
        },
        {
          "name": "elastic_port",
          "options": {
            "description": "Port address of the elasticsearch instance",
            "default": "9200"
          }
        },
        {
          "name": "es_admin",
          "options": {
            "description": "Elasticsearch admin",
            "default": "elastic"
          }
        },
        {
          "name": "es_pass",
          "options": {
            "description": "Elasticsearch admin password",
            "default": "changeme"
          }
        },
        {
          "name": "ssl_verify",
          "options": {
            "description": "Elasticsearch admin password",
            "default": false
          }
        },
        {
          "name": "elastic_ip",
          "options": {
            "description": "IP address of the elasticsearch instance",
            "default": "0.0.0.0"
          }
        },
        {
          "name": "elastic_port",
          "options": {
            "description": "Port address of the elasticsearch instance",
            "default": "9200"
          }
        },
        {
          "name": "es_admin",
          "options": {
            "description": "Elasticsearch admin",
            "default": "elastic"
          }
        },
        {
          "name": "es_pass",
          "options": {
            "description": "Elasticsearch admin password",
            "default": "changeme"
          }
        },
        {
          "name": "ssl_verify",
          "options": {
            "description": "Elasticsearch admin password",
            "default": false
          }
        },
        {
          "name": "elastic_ip",
          "options": {
            "description": "IP address of the elasticsearch instance",
            "default": "0.0.0.0"
          }
        },
        {
          "name": "elastic_port",
          "options": {
            "description": "Port address of the elasticsearch instance",
            "default": "9200"
          }
        },
        {
          "name": "es_admin",
          "options": {
            "description": "Elasticsearch admin",
            "default": "elastic"
          }
        },
        {
          "name": "es_pass",
          "options": {
            "description": "Elasticsearch admin password",
            "default": "changeme"
          }
        },
        {
          "name": "ssl_verify",
          "options": {
            "description": "Elasticsearch admin password",
            "default": false
          }
        },
        {
          "name": "documented_super_roles",
          "options": {
            "description": "List of authorized super roles",
            "default": [
              "superuser"
            ]
          }
        },
        {
          "name": "elastic_ip",
          "options": {
            "description": "IP address of the elasticsearch instance",
            "default": "0.0.0.0"
          }
        },
        {
          "name": "elastic_port",
          "options": {
            "description": "Port address of the elasticsearch instance",
            "default": "9200"
          }
        },
        {
          "name": "es_home",
          "options": {
            "description": "Path to elasticsearch home directory",
            "default": "/usr/share/elasticsearch"
          }
        },
        {
          "name": "es_admin",
          "options": {
            "description": "Elasticsearch admin",
            "default": "elastic"
          }
        },
        {
          "name": "es_pass",
          "options": {
            "description": "Elasticsearch admin password",
            "default": "changeme"
          }
        },
        {
          "name": "es_owner",
          "options": {
            "description": "Elasticsearch owner",
            "default": "elasticsearch"
          }
        },
        {
          "name": "es_group",
          "options": {
            "description": "Elasticsearch owner",
            "default": "elasticsearch"
          }
        },
        {
          "name": "managed_access_points",
          "options": {
            "description": "List of managed access points",
            "default": [
              "10.0.2.15"
            ]
          }
        },
        {
          "name": "ssl_verify",
          "options": {
            "description": "Elasticsearch admin password",
            "default": false
          }
        },
        {
          "name": "elasticsearch_conf",
          "options": {
            "description": "Path to elasticsearch.yml",
            "default": "/etc/elasticsearch/elasticsearch.yml"
          }
        },
        {
          "name": "documented_super_roles",
          "options": {
            "description": "List of authorized super roles",
            "default": [
              "superuser"
            ]
          }
        },
        {
          "name": "elastic_ip",
          "options": {
            "description": "IP address of the elasticsearch instance",
            "default": "0.0.0.0"
          }
        },
        {
          "name": "elastic_port",
          "options": {
            "description": "Port address of the elasticsearch instance",
            "default": "9200"
          }
        },
        {
          "name": "es_home",
          "options": {
            "description": "Path elasticsearch home folder",
            "default": "/usr/share/elasticsearch"
          }
        },
        {
          "name": "es_admin",
          "options": {
            "description": "Elasticsearch admin",
            "default": "elastic"
          }
        },
        {
          "name": "es_pass",
          "options": {
            "description": "Elasticsearch admin password",
            "default": "changeme"
          }
        },
        {
          "name": "es_owner",
          "options": {
            "description": "Elasticsearch owner",
            "default": "elasticsearch"
          }
        },
        {
          "name": "es_group",
          "options": {
            "description": "Elasticsearch owner",
            "default": "elasticsearch"
          }
        },
        {
          "name": "elasticsearch_conf",
          "options": {
            "description": "Path to elasticsearch.yml",
            "default": "/etc/elasticsearch/elasticsearch.yml"
          }
        },
        {
          "name": "es_included_logevents",
          "options": {
            "description": "List of events to be logged",
            "default": [
              "access_denied",
              "anonymous_access_denied",
              "authentication_failed",
              "connection_denied",
              "tampered_request",
              "run_as_denied",
              "run_as_granted"
            ]
          }
        },
        {
          "name": "es_excluded_logevents",
          "options": {
            "description": "List of events to be logged",
            "default": [
              "access_granted"
            ]
          }
        },
        {
          "name": "ssl_verify",
          "options": {
            "description": "Elasticsearch admin password",
            "default": false
          }
        },
        {
          "name": "documented_super_roles",
          "options": {
            "description": "List of authorized super roles",
            "default": [
              "superuser"
            ]
          }
        },
        {
          "name": "elastic_ip",
          "options": {
            "description": "IP address of the elasticsearch instance",
            "default": "0.0.0.0"
          }
        },
        {
          "name": "elastic_port",
          "options": {
            "description": "Port address of the elasticsearch instance",
            "default": "9200"
          }
        },
        {
          "name": "es_home",
          "options": {
            "description": "Path elasticsearch home folder",
            "default": "/usr/share/elasticsearch"
          }
        },
        {
          "name": "es_admin",
          "options": {
            "description": "Elasticsearch admin",
            "default": "elastic"
          }
        },
        {
          "name": "es_pass",
          "options": {
            "description": "Elasticsearch admin password",
            "default": "changeme"
          }
        },
        {
          "name": "es_owner",
          "options": {
            "description": "Elasticsearch owner",
            "default": "elasticsearch"
          }
        },
        {
          "name": "es_group",
          "options": {
            "description": "Elasticsearch owner",
            "default": "elasticsearch"
          }
        },
        {
          "name": "elasticsearch_conf",
          "options": {
            "description": "Path to elasticsearch.yml",
            "default": "/etc/elasticsearch/elasticsearch.yml"
          }
        },
        {
          "name": "es_included_logevents",
          "options": {
            "description": "List of events to be logged",
            "default": [
              "access_denied",
              "anonymous_access_denied",
              "authentication_failed",
              "connection_denied",
              "tampered_request",
              "run_as_denied",
              "run_as_granted"
            ]
          }
        },
        {
          "name": "es_excluded_logevents",
          "options": {
            "description": "List of events to be logged",
            "default": [
              "access_granted"
            ]
          }
        },
        {
          "name": "ssl_verify",
          "options": {
            "description": "Elasticsearch admin password",
            "default": false
          }
        },
        {
          "name": "documented_super_roles",
          "options": {
            "description": "List of authorized super roles",
            "default": [
              "superuser"
            ]
          }
        },
        {
          "name": "elastic_ip",
          "options": {
            "description": "IP address of the elasticsearch instance",
            "default": "0.0.0.0"
          }
        },
        {
          "name": "elastic_port",
          "options": {
            "description": "Port address of the elasticsearch instance",
            "default": "9200"
          }
        },
        {
          "name": "es_home",
          "options": {
            "description": "Path elasticsearch home folder",
            "default": "/usr/share/elasticsearch"
          }
        },
        {
          "name": "es_admin",
          "options": {
            "description": "Elasticsearch admin",
            "default": "elastic"
          }
        },
        {
          "name": "es_pass",
          "options": {
            "description": "Elasticsearch admin password",
            "default": "changeme"
          }
        },
        {
          "name": "es_owner",
          "options": {
            "description": "Elasticsearch owner",
            "default": "elasticsearch"
          }
        },
        {
          "name": "es_group",
          "options": {
            "description": "Elasticsearch owner",
            "default": "elasticsearch"
          }
        },
        {
          "name": "elasticsearch_conf",
          "options": {
            "description": "Path to elasticsearch.yml",
            "default": "/etc/elasticsearch/elasticsearch.yml"
          }
        },
        {
          "name": "es_included_logevents",
          "options": {
            "description": "List of events to be logged",
            "default": [
              "access_denied",
              "anonymous_access_denied",
              "authentication_failed",
              "connection_denied",
              "tampered_request",
              "run_as_denied",
              "run_as_granted"
            ]
          }
        },
        {
          "name": "es_excluded_logevents",
          "options": {
            "description": "List of events to be logged",
            "default": [
              "access_granted"
            ]
          }
        },
        {
          "name": "ssl_verify",
          "options": {
            "description": "Elasticsearch admin password",
            "default": false
          }
        },
        {
          "name": "documented_super_roles",
          "options": {
            "description": "List of authorized super roles",
            "default": [
              "superuser"
            ]
          }
        },
        {
          "name": "elastic_ip",
          "options": {
            "description": "IP address of the elasticsearch instance",
            "default": "0.0.0.0"
          }
        },
        {
          "name": "elastic_port",
          "options": {
            "description": "Port address of the elasticsearch instance",
            "default": "9200"
          }
        },
        {
          "name": "es_home",
          "options": {
            "description": "Path elasticsearch home folder",
            "default": "/usr/share/elasticsearch"
          }
        },
        {
          "name": "es_admin",
          "options": {
            "description": "Elasticsearch admin",
            "default": "elastic"
          }
        },
        {
          "name": "es_pass",
          "options": {
            "description": "Elasticsearch admin password",
            "default": "changeme"
          }
        },
        {
          "name": "es_owner",
          "options": {
            "description": "Elasticsearch owner",
            "default": "elasticsearch"
          }
        },
        {
          "name": "es_group",
          "options": {
            "description": "Elasticsearch owner",
            "default": "elasticsearch"
          }
        },
        {
          "name": "elasticsearch_conf",
          "options": {
            "description": "Path to elasticsearch.yml",
            "default": "/etc/elasticsearch/elasticsearch.yml"
          }
        },
        {
          "name": "es_included_logevents",
          "options": {
            "description": "List of events to be logged",
            "default": [
              "access_denied",
              "anonymous_access_denied",
              "authentication_failed",
              "connection_denied",
              "tampered_request",
              "run_as_denied",
              "run_as_granted"
            ]
          }
        },
        {
          "name": "es_excluded_logevents",
          "options": {
            "description": "List of events to be logged",
            "default": [
              "access_granted"
            ]
          }
        },
        {
          "name": "ssl_verify",
          "options": {
            "description": "Elasticsearch admin password",
            "default": false
          }
        },
        {
          "name": "documented_super_roles",
          "options": {
            "description": "List of authorized super roles",
            "default": [
              "superuser"
            ]
          }
        },
        {
          "name": "elastic_ip",
          "options": {
            "description": "IP address of the elasticsearch instance",
            "default": "0.0.0.0"
          }
        },
        {
          "name": "elastic_port",
          "options": {
            "description": "Port address of the elasticsearch instance",
            "default": "9200"
          }
        },
        {
          "name": "es_home",
          "options": {
            "description": "Path elasticsearch home folder",
            "default": "/usr/share/elasticsearch"
          }
        },
        {
          "name": "es_admin",
          "options": {
            "description": "Elasticsearch admin",
            "default": "elastic"
          }
        },
        {
          "name": "es_pass",
          "options": {
            "description": "Elasticsearch admin password",
            "default": "changeme"
          }
        },
        {
          "name": "ssl_verify",
          "options": {
            "description": "Elasticsearch admin password",
            "default": false
          }
        },
        {
          "name": "es_owner",
          "options": {
            "description": "Elasticsearch owner",
            "default": "elasticsearch"
          }
        },
        {
          "name": "es_group",
          "options": {
            "description": "Elasticsearch owner",
            "default": "elasticsearch"
          }
        },
        {
          "name": "elasticsearch_conf",
          "options": {
            "description": "Path to elasticsearch.yml",
            "default": "/etc/elasticsearch/elasticsearch.yml"
          }
        },
        {
          "name": "es_included_logevents",
          "options": {
            "description": "List of events to be logged",
            "default": [
              "access_denied",
              "anonymous_access_denied",
              "authentication_failed",
              "connection_denied",
              "tampered_request",
              "run_as_denied",
              "run_as_granted"
            ]
          }
        },
        {
          "name": "es_excluded_logevents",
          "options": {
            "description": "List of events to be logged",
            "default": [
              "access_granted"
            ]
          }
        },
        {
          "name": "documented_super_roles",
          "options": {
            "description": "List of authorized super roles",
            "default": [
              "superuser"
            ]
          }
        },
        {
          "name": "elastic_ip",
          "options": {
            "description": "IP address of the elasticsearch instance",
            "default": "0.0.0.0"
          }
        },
        {
          "name": "elastic_port",
          "options": {
            "description": "Port address of the elasticsearch instance",
            "default": "9200"
          }
        },
        {
          "name": "es_home",
          "options": {
            "description": "Path elasticsearch home folder",
            "default": "/usr/share/elasticsearch"
          }
        },
        {
          "name": "es_admin",
          "options": {
            "description": "Elasticsearch admin",
            "default": "elastic"
          }
        },
        {
          "name": "es_pass",
          "options": {
            "description": "Elasticsearch admin password",
            "default": "changeme"
          }
        },
        {
          "name": "es_owner",
          "options": {
            "description": "Elasticsearch owner",
            "default": "elasticsearch"
          }
        },
        {
          "name": "es_group",
          "options": {
            "description": "Elasticsearch owner",
            "default": "elasticsearch"
          }
        },
        {
          "name": "elasticsearch_conf",
          "options": {
            "description": "Path to elasticsearch.yml",
            "default": "/etc/elasticsearch/elasticsearch.yml"
          }
        },
        {
          "name": "es_included_logevents",
          "options": {
            "description": "List of events to be logged",
            "default": [
              "access_denied",
              "anonymous_access_denied",
              "authentication_failed",
              "connection_denied",
              "tampered_request",
              "run_as_denied",
              "run_as_granted"
            ]
          }
        },
        {
          "name": "es_excluded_logevents",
          "options": {
            "description": "List of events to be logged",
            "default": [
              "access_granted"
            ]
          }
        },
        {
          "name": "ssl_verify",
          "options": {
            "description": "Elasticsearch admin password",
            "default": false
          }
        },
        {
          "name": "documented_super_roles",
          "options": {
            "description": "List of authorized super roles",
            "default": [
              "superuser"
            ]
          }
        },
        {
          "name": "elastic_ip",
          "options": {
            "description": "IP address of the elasticsearch instance",
            "default": "0.0.0.0"
          }
        },
        {
          "name": "elastic_port",
          "options": {
            "description": "Port address of the elasticsearch instance",
            "default": "9200"
          }
        },
        {
          "name": "es_home",
          "options": {
            "description": "Path elasticsearch home folder",
            "default": "/usr/share/elasticsearch"
          }
        },
        {
          "name": "es_admin",
          "options": {
            "description": "Elasticsearch admin",
            "default": "elastic"
          }
        },
        {
          "name": "es_pass",
          "options": {
            "description": "Elasticsearch admin password",
            "default": "changeme"
          }
        },
        {
          "name": "es_owner",
          "options": {
            "description": "Elasticsearch owner",
            "default": "elasticsearch"
          }
        },
        {
          "name": "es_group",
          "options": {
            "description": "Elasticsearch owner",
            "default": "elasticsearch"
          }
        },
        {
          "name": "elasticsearch_conf",
          "options": {
            "description": "Path to elasticsearch.yml",
            "default": "/etc/elasticsearch/elasticsearch.yml"
          }
        },
        {
          "name": "es_included_logevents",
          "options": {
            "description": "List of events to be logged",
            "default": [
              "access_denied",
              "anonymous_access_denied",
              "authentication_failed",
              "connection_denied",
              "tampered_request",
              "run_as_denied",
              "run_as_granted"
            ]
          }
        },
        {
          "name": "es_excluded_logevents",
          "options": {
            "description": "List of events to be logged",
            "default": [
              "access_granted"
            ]
          }
        },
        {
          "name": "ssl_verify",
          "options": {
            "description": "Elasticsearch admin password",
            "default": false
          }
        },
        {
          "name": "documented_super_roles",
          "options": {
            "description": "List of authorized super roles",
            "default": [
              "superuser"
            ]
          }
        },
        {
          "name": "elastic_ip",
          "options": {
            "description": "IP address of the elasticsearch instance",
            "default": "0.0.0.0"
          }
        },
        {
          "name": "elastic_port",
          "options": {
            "description": "Port address of the elasticsearch instance",
            "default": "9200"
          }
        },
        {
          "name": "es_home",
          "options": {
            "description": "Path elasticsearch home folder",
            "default": "/usr/share/elasticsearch"
          }
        },
        {
          "name": "es_admin",
          "options": {
            "description": "Elasticsearch admin",
            "default": "elastic"
          }
        },
        {
          "name": "es_pass",
          "options": {
            "description": "Elasticsearch admin password",
            "default": "changeme"
          }
        },
        {
          "name": "es_owner",
          "options": {
            "description": "Elasticsearch owner",
            "default": "elasticsearch"
          }
        },
        {
          "name": "es_group",
          "options": {
            "description": "Elasticsearch owner",
            "default": "elasticsearch"
          }
        },
        {
          "name": "elasticsearch_conf",
          "options": {
            "description": "Path to elasticsearch.yml",
            "default": "/etc/elasticsearch/elasticsearch.yml"
          }
        },
        {
          "name": "es_included_logevents",
          "options": {
            "description": "List of events to be logged",
            "default": [
              "access_denied",
              "anonymous_access_denied",
              "authentication_failed",
              "connection_denied",
              "tampered_request",
              "run_as_denied",
              "run_as_granted"
            ]
          }
        },
        {
          "name": "es_excluded_logevents",
          "options": {
            "description": "List of events to be logged",
            "default": [
              "access_granted"
            ]
          }
        },
        {
          "name": "ssl_verify",
          "options": {
            "description": "Elasticsearch admin password",
            "default": false
          }
        },
        {
          "name": "documented_super_roles",
          "options": {
            "description": "List of authorized super roles",
            "default": [
              "superuser"
            ]
          }
        },
        {
          "name": "elastic_ip",
          "options": {
            "description": "IP address of the elasticsearch instance",
            "default": "0.0.0.0"
          }
        },
        {
          "name": "elastic_port",
          "options": {
            "description": "Port address of the elasticsearch instance",
            "default": "9200"
          }
        },
        {
          "name": "es_home",
          "options": {
            "description": "Path elasticsearch home folder",
            "default": "/usr/share/elasticsearch"
          }
        },
        {
          "name": "es_admin",
          "options": {
            "description": "Elasticsearch admin",
            "default": "elastic"
          }
        },
        {
          "name": "es_pass",
          "options": {
            "description": "Elasticsearch admin password",
            "default": "changeme"
          }
        },
        {
          "name": "es_owner",
          "options": {
            "description": "Elasticsearch owner",
            "default": "elasticsearch"
          }
        },
        {
          "name": "es_group",
          "options": {
            "description": "Elasticsearch owner",
            "default": "elasticsearch"
          }
        },
        {
          "name": "elasticsearch_conf",
          "options": {
            "description": "Path to elasticsearch.yml",
            "default": "/etc/elasticsearch/elasticsearch.yml"
          }
        },
        {
          "name": "es_included_logevents",
          "options": {
            "description": "List of events to be logged",
            "default": [
              "access_denied",
              "anonymous_access_denied",
              "authentication_failed",
              "connection_denied",
              "tampered_request",
              "run_as_denied",
              "run_as_granted"
            ]
          }
        },
        {
          "name": "es_excluded_logevents",
          "options": {
            "description": "List of events to be logged",
            "default": [
              "access_granted"
            ]
          }
        },
        {
          "name": "ssl_verify",
          "options": {
            "description": "Elasticsearch admin password",
            "default": false
          }
        },
        {
          "name": "documented_super_roles",
          "options": {
            "description": "List of authorized super roles",
            "default": [
              "superuser"
            ]
          }
        },
        {
          "name": "elastic_ip",
          "options": {
            "description": "IP address of the elasticsearch instance",
            "default": "0.0.0.0"
          }
        },
        {
          "name": "elastic_port",
          "options": {
            "description": "Port address of the elasticsearch instance",
            "default": "9200"
          }
        },
        {
          "name": "es_home",
          "options": {
            "description": "Path elasticsearch home folder",
            "default": "/usr/share/elasticsearch"
          }
        },
        {
          "name": "es_admin",
          "options": {
            "description": "Elasticsearch admin",
            "default": "elastic"
          }
        },
        {
          "name": "es_pass",
          "options": {
            "description": "Elasticsearch admin password",
            "default": "changeme"
          }
        },
        {
          "name": "es_owner",
          "options": {
            "description": "Elasticsearch owner",
            "default": "elasticsearch"
          }
        },
        {
          "name": "es_group",
          "options": {
            "description": "Elasticsearch owner",
            "default": "elasticsearch"
          }
        },
        {
          "name": "elasticsearch_conf",
          "options": {
            "description": "Path to elasticsearch.yml",
            "default": "/etc/elasticsearch/elasticsearch.yml"
          }
        },
        {
          "name": "es_included_logevents",
          "options": {
            "description": "List of events to be logged",
            "default": [
              "access_denied",
              "anonymous_access_denied",
              "authentication_failed",
              "connection_denied",
              "tampered_request",
              "run_as_denied",
              "run_as_granted"
            ]
          }
        },
        {
          "name": "es_excluded_logevents",
          "options": {
            "description": "List of events to be logged",
            "default": [
              "access_granted"
            ]
          }
        },
        {
          "name": "ssl_verify",
          "options": {
            "description": "Elasticsearch admin password",
            "default": false
          }
        },
        {
          "name": "documented_super_roles",
          "options": {
            "description": "List of authorized super roles",
            "default": [
              "superuser"
            ]
          }
        },
        {
          "name": "elastic_ip",
          "options": {
            "description": "IP address of the elasticsearch instance",
            "default": "0.0.0.0"
          }
        },
        {
          "name": "elastic_port",
          "options": {
            "description": "Port address of the elasticsearch instance",
            "default": "9200"
          }
        },
        {
          "name": "es_home",
          "options": {
            "description": "Path elasticsearch home folder",
            "default": "/usr/share/elasticsearch"
          }
        },
        {
          "name": "es_admin",
          "options": {
            "description": "Elasticsearch admin",
            "default": "elastic"
          }
        },
        {
          "name": "es_pass",
          "options": {
            "description": "Elasticsearch admin password",
            "default": "changeme"
          }
        },
        {
          "name": "es_owner",
          "options": {
            "description": "Elasticsearch owner",
            "default": "elasticsearch"
          }
        },
        {
          "name": "es_group",
          "options": {
            "description": "Elasticsearch owner",
            "default": "elasticsearch"
          }
        },
        {
          "name": "elasticsearch_conf",
          "options": {
            "description": "Path to elasticsearch.yml",
            "default": "/etc/elasticsearch/elasticsearch.yml"
          }
        },
        {
          "name": "es_included_logevents",
          "options": {
            "description": "List of events to be logged",
            "default": [
              "access_denied",
              "anonymous_access_denied",
              "authentication_failed",
              "connection_denied",
              "tampered_request",
              "run_as_denied",
              "run_as_granted"
            ]
          }
        },
        {
          "name": "es_excluded_logevents",
          "options": {
            "description": "List of events to be logged",
            "default": [
              "access_granted"
            ]
          }
        },
        {
          "name": "ssl_verify",
          "options": {
            "description": "Elasticsearch admin password",
            "default": false
          }
        },
        {
          "name": "elastic_ip",
          "options": {
            "description": "IP address of the elasticsearch instance",
            "default": "0.0.0.0"
          }
        },
        {
          "name": "elastic_port",
          "options": {
            "description": "Port address of the elasticsearch instance",
            "default": "9200"
          }
        },
        {
          "name": "es_admin",
          "options": {
            "description": "Elasticsearch admin",
            "default": "elastic"
          }
        },
        {
          "name": "es_pass",
          "options": {
            "description": "Elasticsearch admin password",
            "default": "changeme"
          }
        },
        {
          "name": "ssl_verify",
          "options": {
            "description": "Elasticsearch admin password",
            "default": false
          }
        },
        {
          "name": "elastic_ip",
          "options": {
            "description": "IP address of the elasticsearch instance",
            "default": "0.0.0.0"
          }
        },
        {
          "name": "elastic_port",
          "options": {
            "description": "Port address of the elasticsearch instance",
            "default": "9200"
          }
        },
        {
          "name": "es_admin",
          "options": {
            "description": "Elasticsearch admin",
            "default": "elastic"
          }
        },
        {
          "name": "es_pass",
          "options": {
            "description": "Elasticsearch admin password",
            "default": "changeme"
          }
        },
        {
          "name": "ssl_verify",
          "options": {
            "description": "Elasticsearch admin password",
            "default": false
          }
        },
        {
          "name": "elastic_ip",
          "options": {
            "description": "IP address of the elasticsearch instance",
            "default": "0.0.0.0"
          }
        },
        {
          "name": "elastic_port",
          "options": {
            "description": "Port address of the elasticsearch instance",
            "default": "9200"
          }
        },
        {
          "name": "es_admin",
          "options": {
            "description": "Elasticsearch admin",
            "default": "elastic"
          }
        },
        {
          "name": "es_pass",
          "options": {
            "description": "Elasticsearch admin password",
            "default": "changeme"
          }
        },
        {
          "name": "ssl_verify",
          "options": {
            "description": "Elasticsearch admin password",
            "default": false
          }
        },
        {
          "name": "elastic_ip",
          "options": {
            "description": "IP address of the elasticsearch instance",
            "default": "0.0.0.0"
          }
        },
        {
          "name": "elastic_port",
          "options": {
            "description": "Port address of the elasticsearch instance",
            "default": "9200"
          }
        },
        {
          "name": "es_admin",
          "options": {
            "description": "Elasticsearch admin",
            "default": "elastic"
          }
        },
        {
          "name": "es_pass",
          "options": {
            "description": "Elasticsearch admin password",
            "default": "changeme"
          }
        },
        {
          "name": "ssl_verify",
          "options": {
            "description": "Elasticsearch admin password",
            "default": false
          }
        },
        {
          "name": "elastic_ip",
          "options": {
            "description": "IP address of the elasticsearch instance",
            "default": "0.0.0.0"
          }
        },
        {
          "name": "elastic_port",
          "options": {
            "description": "Port address of the elasticsearch instance",
            "default": "9200"
          }
        },
        {
          "name": "es_admin",
          "options": {
            "description": "Elasticsearch admin",
            "default": "elastic"
          }
        },
        {
          "name": "es_pass",
          "options": {
            "description": "Elasticsearch admin password",
            "default": "changeme"
          }
        },
        {
          "name": "ssl_verify",
          "options": {
            "description": "Elasticsearch admin password",
            "default": false
          }
        },
        {
          "name": "elastic_ip",
          "options": {
            "description": "IP address of the elasticsearch instance",
            "default": "0.0.0.0"
          }
        },
        {
          "name": "elastic_port",
          "options": {
            "description": "Port address of the elasticsearch instance",
            "default": "9200"
          }
        },
        {
          "name": "es_admin",
          "options": {
            "description": "Elasticsearch admin",
            "default": "elastic"
          }
        },
        {
          "name": "es_pass",
          "options": {
            "description": "Elasticsearch admin password",
            "default": "changeme"
          }
        },
        {
          "name": "ssl_verify",
          "options": {
            "description": "Elasticsearch admin password",
            "default": false
          }
        },
        {
          "name": "elastic_ip",
          "options": {
            "description": "IP address of the elasticsearch instance",
            "default": "0.0.0.0"
          }
        },
        {
          "name": "elastic_port",
          "options": {
            "description": "Port address of the elasticsearch instance",
            "default": "9200"
          }
        },
        {
          "name": "es_admin",
          "options": {
            "description": "Elasticsearch admin",
            "default": "elastic"
          }
        },
        {
          "name": "es_pass",
          "options": {
            "description": "Elasticsearch admin password",
            "default": "changeme"
          }
        },
        {
          "name": "ssl_verify",
          "options": {
            "description": "Elasticsearch admin password",
            "default": false
          }
        }
      ],
      "groups": [
        {
          "id": "controls/ssl+certs+http/V-26681.rb",
          "controls": [
            "V-26681"
          ]
        },
        {
          "id": "controls/ssl+certs+http/V-26924.rb",
          "controls": [
            "V-26924"
          ]
        },
        {
          "id": "controls/ssl+certs+http/V-27130.rb",
          "controls": [
            "V-27130"
          ]
        },
        {
          "id": "controls/ssl+certs+http/V-27015.rb",
          "controls": [
            "V-27015"
          ]
        },
        {
          "id": "controls/ssl+certs+http/V-26682.rb",
          "controls": [
            "V-26682"
          ]
        },
        {
          "id": "controls/virtualization/V-27027.rb",
          "controls": [
            "V-27027"
          ]
        },
        {
          "id": "controls/virtualization/V-26830.rb",
          "controls": [
            "V-26830"
          ]
        },
        {
          "id": "controls/virtualization/V-27029.rb",
          "controls": [
            "V-27029"
          ]
        },
        {
          "id": "controls/virtualization/V-27025.rb",
          "controls": [
            "V-27025"
          ]
        },
        {
          "id": "controls/nodes/V-27037.rb",
          "controls": [
            "V-27037"
          ]
        },
        {
          "id": "controls/nodes/V-27067.rb",
          "controls": [
            "V-27067"
          ]
        },
        {
          "id": "controls/nodes/V-27021.rb",
          "controls": [
            "V-27021"
          ]
        },
        {
          "id": "controls/ssl+tsl+certs+http/V-27062.rb",
          "controls": [
            "V-27062"
          ]
        },
        {
          "id": "controls/ssl+tsl+certs+http/V-26910.rb",
          "controls": [
            "V-26910"
          ]
        },
        {
          "id": "controls/ssl+tsl+certs+http/V-27063.rb",
          "controls": [
            "V-27063"
          ]
        },
        {
          "id": "controls/ssl+tsl+certs+http/V-26954.rb",
          "controls": [
            "V-26954"
          ]
        },
        {
          "id": "controls/ssl+tsl+certs+http/V-27059.rb",
          "controls": [
            "V-27059"
          ]
        },
        {
          "id": "controls/ssl+tsl+certs+http/V-26908.rb",
          "controls": [
            "V-26908"
          ]
        },
        {
          "id": "controls/ssl+tsl+certs+http/V-26948.rb",
          "controls": [
            "V-26948"
          ]
        },
        {
          "id": "controls/ssl+tsl+certs+http/V-26912.rb",
          "controls": [
            "V-26912"
          ]
        },
        {
          "id": "controls/ssl+tsl+certs+http/V-26953.rb",
          "controls": [
            "V-26953"
          ]
        },
        {
          "id": "controls/ssl+tsl+certs+http/V-27060.rb",
          "controls": [
            "V-27060"
          ]
        },
        {
          "id": "controls/ssl+tsl+certs+http/V-27030.rb",
          "controls": [
            "V-27030"
          ]
        },
        {
          "id": "controls/ssl+tsl+certs+http/V-27061.rb",
          "controls": [
            "V-27061"
          ]
        },
        {
          "id": "controls/ssl+tsl+certs+http/V-27092.rb",
          "controls": [
            "V-27092"
          ]
        },
        {
          "id": "controls/ssl+tsl+certs+http/V-26907.rb",
          "controls": [
            "V-26907"
          ]
        },
        {
          "id": "controls/ssl+tsl+certs+http/V-26894.rb",
          "controls": [
            "V-26894"
          ]
        },
        {
          "id": "controls/permenant-not-a-finding/V-26971.rb",
          "controls": [
            "V-26971"
          ]
        },
        {
          "id": "controls/permenant-not-a-finding/V-27017.rb",
          "controls": [
            "V-27017"
          ]
        },
        {
          "id": "controls/permenant-not-a-finding/V-26965.rb",
          "controls": [
            "V-26965"
          ]
        },
        {
          "id": "controls/permenant-not-a-finding/V-26666.rb",
          "controls": [
            "V-26666"
          ]
        },
        {
          "id": "controls/permenant-not-a-finding/V-26680.rb",
          "controls": [
            "V-26680"
          ]
        },
        {
          "id": "controls/permenant-not-a-finding/V-27016.rb",
          "controls": [
            "V-27016"
          ]
        },
        {
          "id": "controls/permenant-not-a-finding/V-27146.rb",
          "controls": [
            "V-27146"
          ]
        },
        {
          "id": "controls/permenant-not-a-finding/V-27128.rb",
          "controls": [
            "V-27128"
          ]
        },
        {
          "id": "controls/permenant-not-a-finding/V-27019.rb",
          "controls": [
            "V-27019"
          ]
        },
        {
          "id": "controls/permenant-not-a-finding/V-27018.rb",
          "controls": [
            "V-27018"
          ]
        },
        {
          "id": "controls/permenant-not-a-finding/V-26969.rb",
          "controls": [
            "V-26969"
          ]
        },
        {
          "id": "controls/permenant-not-a-finding/V-27114.rb",
          "controls": [
            "V-27114"
          ]
        },
        {
          "id": "controls/permenant-not-a-finding/V-27171.rb",
          "controls": [
            "V-27171"
          ]
        },
        {
          "id": "controls/permenant-not-a-finding/V-26671.rb",
          "controls": [
            "V-26671"
          ]
        },
        {
          "id": "controls/permenant-not-a-finding/V-27020.rb",
          "controls": [
            "V-27020"
          ]
        },
        {
          "id": "controls/rsyslog/V-26893.rb",
          "controls": [
            "V-26893"
          ]
        },
        {
          "id": "controls/rsyslog/V-27152.rb",
          "controls": [
            "V-27152"
          ]
        },
        {
          "id": "controls/rsyslog/V-27073.rb",
          "controls": [
            "V-27073"
          ]
        },
        {
          "id": "controls/rsyslog/V-26871.rb",
          "controls": [
            "V-26871"
          ]
        },
        {
          "id": "controls/rsyslog/V-26888.rb",
          "controls": [
            "V-26888"
          ]
        },
        {
          "id": "controls/rsyslog/V-26891.rb",
          "controls": [
            "V-26891"
          ]
        },
        {
          "id": "controls/rsyslog/V-26890.rb",
          "controls": [
            "V-26890"
          ]
        },
        {
          "id": "controls/rsyslog/V-26976.rb",
          "controls": [
            "V-26976"
          ]
        },
        {
          "id": "controls/home+role/V-26945.rb",
          "controls": [
            "V-26945"
          ]
        },
        {
          "id": "controls/home+role/V-26672.rb",
          "controls": [
            "V-26672"
          ]
        },
        {
          "id": "controls/home+role/V-26961.rb",
          "controls": [
            "V-26961"
          ]
        },
        {
          "id": "controls/home+role/V-26821.rb",
          "controls": [
            "V-26821"
          ]
        },
        {
          "id": "controls/home+role/V-26934.rb",
          "controls": [
            "V-26934"
          ]
        },
        {
          "id": "controls/home+role/V-29189.rb",
          "controls": [
            "V-29189"
          ]
        },
        {
          "id": "controls/home+role/V-27159.rb",
          "controls": [
            "V-27159"
          ]
        },
        {
          "id": "controls/home+role/V-26938.rb",
          "controls": [
            "V-26938"
          ]
        },
        {
          "id": "controls/home+role/V-26751.rb",
          "controls": [
            "V-26751"
          ]
        },
        {
          "id": "controls/single/V-27147.rb",
          "controls": [
            "V-27147"
          ]
        },
        {
          "id": "controls/single/V-27066.rb",
          "controls": [
            "V-27066"
          ]
        },
        {
          "id": "controls/single/V-27172.rb",
          "controls": [
            "V-27172"
          ]
        },
        {
          "id": "controls/single/V-26882.rb",
          "controls": [
            "V-26882"
          ]
        },
        {
          "id": "controls/single/V-30590.rb",
          "controls": [
            "V-30590"
          ]
        },
        {
          "id": "controls/single/V-26949.rb",
          "controls": [
            "V-26949"
          ]
        },
        {
          "id": "controls/single/V-26928.rb",
          "controls": [
            "V-26928"
          ]
        },
        {
          "id": "controls/single/V-27165.rb",
          "controls": [
            "V-27165"
          ]
        },
        {
          "id": "controls/single/V-27160.rb",
          "controls": [
            "V-27160"
          ]
        },
        {
          "id": "controls/single/V-26686.rb",
          "controls": [
            "V-26686"
          ]
        },
        {
          "id": "controls/single/V-27041.rb",
          "controls": [
            "V-27041"
          ]
        },
        {
          "id": "controls/single/V-26952.rb",
          "controls": [
            "V-26952"
          ]
        },
        {
          "id": "controls/audit+ad+ldap+pki/V-26706.rb",
          "controls": [
            "V-26706"
          ]
        },
        {
          "id": "controls/audit+ad+ldap+pki/V-26703.rb",
          "controls": [
            "V-26703"
          ]
        },
        {
          "id": "controls/audit+ad+ldap+pki/V-30570.rb",
          "controls": [
            "V-30570"
          ]
        },
        {
          "id": "controls/audit+ad+ldap+pki/V-26731.rb",
          "controls": [
            "V-26731"
          ]
        },
        {
          "id": "controls/not configurable/V-26676.rb",
          "controls": [
            "V-26676"
          ]
        },
        {
          "id": "controls/not configurable/V-26737.rb",
          "controls": [
            "V-26737"
          ]
        },
        {
          "id": "controls/not configurable/V-27137.rb",
          "controls": [
            "V-27137"
          ]
        },
        {
          "id": "controls/not configurable/V-27166.rb",
          "controls": [
            "V-27166"
          ]
        },
        {
          "id": "controls/not configurable/V-27179.rb",
          "controls": [
            "V-27179"
          ]
        },
        {
          "id": "controls/not configurable/V-27178.rb",
          "controls": [
            "V-27178"
          ]
        },
        {
          "id": "controls/not configurable/V-26929.rb",
          "controls": [
            "V-26929"
          ]
        },
        {
          "id": "controls/not configurable/V-26943.rb",
          "controls": [
            "V-26943"
          ]
        },
        {
          "id": "controls/not configurable/V-26664.rb",
          "controls": [
            "V-26664"
          ]
        },
        {
          "id": "controls/not configurable/V-30589.rb",
          "controls": [
            "V-30589"
          ]
        },
        {
          "id": "controls/not configurable/V-26932.rb",
          "controls": [
            "V-26932"
          ]
        },
        {
          "id": "controls/not configurable/V-26917.rb",
          "controls": [
            "V-26917"
          ]
        },
        {
          "id": "controls/not configurable/V-27105.rb",
          "controls": [
            "V-27105"
          ]
        },
        {
          "id": "controls/not configurable/V-27065.rb",
          "controls": [
            "V-27065"
          ]
        },
        {
          "id": "controls/certs+cipher_suites+http/V-27153.rb",
          "controls": [
            "V-27153"
          ]
        },
        {
          "id": "controls/certs+cipher_suites+http/V-26935.rb",
          "controls": [
            "V-26935"
          ]
        },
        {
          "id": "controls/certs+cipher_suites+http/V-27155.rb",
          "controls": [
            "V-27155"
          ]
        },
        {
          "id": "controls/certs+cipher_suites+http/V-27154.rb",
          "controls": [
            "V-27154"
          ]
        },
        {
          "id": "controls/certs+cipher_suites+http/V-27150.rb",
          "controls": [
            "V-27150"
          ]
        },
        {
          "id": "controls/certs+cipher_suites+http/V-27140.rb",
          "controls": [
            "V-27140"
          ]
        },
        {
          "id": "controls/tls/V-26678.rb",
          "controls": [
            "V-26678"
          ]
        },
        {
          "id": "controls/tls/V-27170.rb",
          "controls": [
            "V-27170"
          ]
        },
        {
          "id": "controls/tls/V-26675.rb",
          "controls": [
            "V-26675"
          ]
        },
        {
          "id": "controls/ad+ldap+pki+role/V-26733.rb",
          "controls": [
            "V-26733"
          ]
        },
        {
          "id": "controls/ad+ldap+pki+role/V-30593.rb",
          "controls": [
            "V-30593"
          ]
        },
        {
          "id": "controls/ad+ldap+pki+role/V-30592.rb",
          "controls": [
            "V-30592"
          ]
        },
        {
          "id": "controls/ad+ldap+pki+role/V-26750.rb",
          "controls": [
            "V-26750"
          ]
        },
        {
          "id": "controls/audit/V-26860.rb",
          "controls": [
            "V-26860"
          ]
        },
        {
          "id": "controls/audit/V-26904.rb",
          "controls": [
            "V-26904"
          ]
        },
        {
          "id": "controls/audit/V-26864.rb",
          "controls": [
            "V-26864"
          ]
        },
        {
          "id": "controls/audit/V-27085.rb",
          "controls": [
            "V-27085"
          ]
        },
        {
          "id": "controls/audit/V-26900.rb",
          "controls": [
            "V-26900"
          ]
        },
        {
          "id": "controls/audit/V-26887.rb",
          "controls": [
            "V-26887"
          ]
        },
        {
          "id": "controls/audit/V-26896.rb",
          "controls": [
            "V-26896"
          ]
        },
        {
          "id": "controls/audit/V-26851.rb",
          "controls": [
            "V-26851"
          ]
        },
        {
          "id": "controls/audit/V-26901.rb",
          "controls": [
            "V-26901"
          ]
        },
        {
          "id": "controls/audit/V-26845.rb",
          "controls": [
            "V-26845"
          ]
        },
        {
          "id": "controls/audit/V-26905.rb",
          "controls": [
            "V-26905"
          ]
        },
        {
          "id": "controls/audit/V-27168.rb",
          "controls": [
            "V-27168"
          ]
        },
        {
          "id": "controls/audit/V-26868.rb",
          "controls": [
            "V-26868"
          ]
        },
        {
          "id": "controls/audit/V-26849.rb",
          "controls": [
            "V-26849"
          ]
        },
        {
          "id": "controls/audit/V-27064.rb",
          "controls": [
            "V-27064"
          ]
        },
        {
          "id": "controls/audit/V-26947.rb",
          "controls": [
            "V-26947"
          ]
        },
        {
          "id": "controls/audit/V-26906.rb",
          "controls": [
            "V-26906"
          ]
        },
        {
          "id": "controls/audit/V-26847.rb",
          "controls": [
            "V-26847"
          ]
        },
        {
          "id": "controls/audit/V-26903.rb",
          "controls": [
            "V-26903"
          ]
        },
        {
          "id": "controls/tls+role/V-26677.rb",
          "controls": [
            "V-26677"
          ]
        },
        {
          "id": "controls/tls+role/V-26673.rb",
          "controls": [
            "V-26673"
          ]
        },
        {
          "id": "controls/tls+role/V-26791.rb",
          "controls": [
            "V-26791"
          ]
        },
        {
          "id": "controls/tls+role/V-26779.rb",
          "controls": [
            "V-26779"
          ]
        },
        {
          "id": "controls/tls+role/V-26679.rb",
          "controls": [
            "V-26679"
          ]
        },
        {
          "id": "controls/tls+role/V-26734.rb",
          "controls": [
            "V-26734"
          ]
        },
        {
          "id": "controls/tls+role/V-26674.rb",
          "controls": [
            "V-26674"
          ]
        },
        {
          "id": "controls/tls+role/V-27135.rb",
          "controls": [
            "V-27135"
          ]
        },
        {
          "id": "controls/tls+role/V-27034.rb",
          "controls": [
            "V-27034"
          ]
        },
        {
          "id": "controls/scripts/V-27036.rb",
          "controls": [
            "V-27036"
          ]
        },
        {
          "id": "controls/scripts/V-27039.rb",
          "controls": [
            "V-27039"
          ]
        },
        {
          "id": "controls/scripts/V-27040.rb",
          "controls": [
            "V-27040"
          ]
        },
        {
          "id": "controls/auditd/V-26974.rb",
          "controls": [
            "V-26974"
          ]
        },
        {
          "id": "controls/auditd/V-26970.rb",
          "controls": [
            "V-26970"
          ]
        },
        {
          "id": "controls/auditd/V-26889.rb",
          "controls": [
            "V-26889"
          ]
        },
        {
          "id": "controls/auditd/V-26968.rb",
          "controls": [
            "V-26968"
          ]
        },
        {
          "id": "controls/auditd/V-26967.rb",
          "controls": [
            "V-26967"
          ]
        },
        {
          "id": "controls/ip_fil/V-26790.rb",
          "controls": [
            "V-26790"
          ]
        },
        {
          "id": "controls/ip_fil/V-26685.rb",
          "controls": [
            "V-26685"
          ]
        },
        {
          "id": "controls/ip_fil/V-26777.rb",
          "controls": [
            "V-26777"
          ]
        },
        {
          "id": "controls/ip_fil/V-26776.rb",
          "controls": [
            "V-26776"
          ]
        },
        {
          "id": "controls/ip_fil/V-26688.rb",
          "controls": [
            "V-26688"
          ]
        },
        {
          "id": "controls/ip_fil/V-26687.rb",
          "controls": [
            "V-26687"
          ]
        },
        {
          "id": "controls/ip_fil/V-27035.rb",
          "controls": [
            "V-27035"
          ]
        },
        {
          "id": "controls/ip_fil/V-26775.rb",
          "controls": [
            "V-26775"
          ]
        },
        {
          "id": "controls/ip_fil/V-26786.rb",
          "controls": [
            "V-26786"
          ]
        },
        {
          "id": "controls/ip_fil/V-26962.rb",
          "controls": [
            "V-26962"
          ]
        },
        {
          "id": "controls/log/V-27163.rb",
          "controls": [
            "V-27163"
          ]
        },
        {
          "id": "controls/log/V-27148.rb",
          "controls": [
            "V-27148"
          ]
        },
        {
          "id": "controls/ad+ldap+pki/V-26914.rb",
          "controls": [
            "V-26914"
          ]
        },
        {
          "id": "controls/ad+ldap+pki/V-26920.rb",
          "controls": [
            "V-26920"
          ]
        },
        {
          "id": "controls/ad+ldap+pki/V-26732.rb",
          "controls": [
            "V-26732"
          ]
        },
        {
          "id": "controls/ad+ldap+pki/V-26883.rb",
          "controls": [
            "V-26883"
          ]
        },
        {
          "id": "controls/ad+ldap+pki/V-26930.rb",
          "controls": [
            "V-26930"
          ]
        },
        {
          "id": "controls/ad+ldap+pki/V-26925.rb",
          "controls": [
            "V-26925"
          ]
        },
        {
          "id": "controls/ad+ldap+pki/V-26886.rb",
          "controls": [
            "V-26886"
          ]
        },
        {
          "id": "controls/ad+ldap+pki/V-26915.rb",
          "controls": [
            "V-26915"
          ]
        },
        {
          "id": "controls/ad+ldap+pki/V-26855.rb",
          "controls": [
            "V-26855"
          ]
        },
        {
          "id": "controls/ad+ldap+pki/V-26921.rb",
          "controls": [
            "V-26921"
          ]
        },
        {
          "id": "controls/ad+ldap+pki/V-30576.rb",
          "controls": [
            "V-30576"
          ]
        },
        {
          "id": "controls/ad+ldap+pki/V-26748.rb",
          "controls": [
            "V-26748"
          ]
        },
        {
          "id": "controls/ad+ldap+pki/V-26918.rb",
          "controls": [
            "V-26918"
          ]
        },
        {
          "id": "controls/ad+ldap+pki/V-30574.rb",
          "controls": [
            "V-30574"
          ]
        },
        {
          "id": "controls/ad+ldap+pki/V-26699.rb",
          "controls": [
            "V-26699"
          ]
        },
        {
          "id": "controls/ad+ldap+pki/V-30583.rb",
          "controls": [
            "V-30583"
          ]
        },
        {
          "id": "controls/ad+ldap+pki/V-26879.rb",
          "controls": [
            "V-26879"
          ]
        },
        {
          "id": "controls/ad+ldap+pki/V-30582.rb",
          "controls": [
            "V-30582"
          ]
        },
        {
          "id": "controls/ad+ldap+pki/V-26919.rb",
          "controls": [
            "V-26919"
          ]
        },
        {
          "id": "controls/ad+ldap+pki/V-26909.rb",
          "controls": [
            "V-26909"
          ]
        },
        {
          "id": "controls/ad+ldap+pki/V-30575.rb",
          "controls": [
            "V-30575"
          ]
        },
        {
          "id": "controls/ad+ldap+pki/V-26926.rb",
          "controls": [
            "V-26926"
          ]
        },
        {
          "id": "controls/ad+ldap+pki/V-26827.rb",
          "controls": [
            "V-26827"
          ]
        },
        {
          "id": "controls/ad+ldap+pki/V-26916.rb",
          "controls": [
            "V-26916"
          ]
        },
        {
          "id": "controls/ad+ldap+pki/V-26856.rb",
          "controls": [
            "V-26856"
          ]
        },
        {
          "id": "controls/ad+ldap+pki/V-26922.rb",
          "controls": [
            "V-26922"
          ]
        },
        {
          "id": "controls/ad+ldap+pki/V-26881.rb",
          "controls": [
            "V-26881"
          ]
        },
        {
          "id": "controls/ad+ldap+pki/V-26972.rb",
          "controls": [
            "V-26972"
          ]
        },
        {
          "id": "controls/ad+ldap+pki/V-26923.rb",
          "controls": [
            "V-26923"
          ]
        },
        {
          "id": "controls/ad+ldap+pki/V-26701.rb",
          "controls": [
            "V-26701"
          ]
        },
        {
          "id": "controls/ad+ldap+pki/V-26913.rb",
          "controls": [
            "V-26913"
          ]
        },
        {
          "id": "controls/ad+ldap+pki/V-26853.rb",
          "controls": [
            "V-26853"
          ]
        },
        {
          "id": "controls/ad+ldap+pki/V-26937.rb",
          "controls": [
            "V-26937"
          ]
        },
        {
          "id": "controls/ad+ldap+pki/V-26884.rb",
          "controls": [
            "V-26884"
          ]
        },
        {
          "id": "controls/role+ip_fil/V-26735.rb",
          "controls": [
            "V-26735"
          ]
        },
        {
          "id": "controls/audit+home+role/V-26684.rb",
          "controls": [
            "V-26684"
          ]
        },
        {
          "id": "controls/audit+home+role/V-26940.rb",
          "controls": [
            "V-26940"
          ]
        },
        {
          "id": "controls/audit+home+role/V-26820.rb",
          "controls": [
            "V-26820"
          ]
        },
        {
          "id": "controls/audit+home+role/V-27089.rb",
          "controls": [
            "V-27089"
          ]
        },
        {
          "id": "controls/audit+home+role/V-26902.rb",
          "controls": [
            "V-26902"
          ]
        },
        {
          "id": "controls/audit+home+role/V-26730.rb",
          "controls": [
            "V-26730"
          ]
        },
        {
          "id": "controls/audit+home+role/V-27145.rb",
          "controls": [
            "V-27145"
          ]
        },
        {
          "id": "controls/audit+home+role/V-26782.rb",
          "controls": [
            "V-26782"
          ]
        },
        {
          "id": "controls/audit+home+role/V-26705.rb",
          "controls": [
            "V-26705"
          ]
        },
        {
          "id": "controls/audit+home+role/V-26933.rb",
          "controls": [
            "V-26933"
          ]
        },
        {
          "id": "controls/audit+home+role/V-27164.rb",
          "controls": [
            "V-27164"
          ]
        },
        {
          "id": "controls/pki/V-26975.rb",
          "controls": [
            "V-26975"
          ]
        },
        {
          "id": "controls/pki/V-26978.rb",
          "controls": [
            "V-26978"
          ]
        },
        {
          "id": "controls/pki/V-26977.rb",
          "controls": [
            "V-26977"
          ]
        },
        {
          "id": "controls/pki/V-26980.rb",
          "controls": [
            "V-26980"
          ]
        },
        {
          "id": "controls/pki/V-26973.rb",
          "controls": [
            "V-26973"
          ]
        },
        {
          "id": "controls/pki/V-26981.rb",
          "controls": [
            "V-26981"
          ]
        },
        {
          "id": "controls/pki/V-26927.rb",
          "controls": [
            "V-26927"
          ]
        }
      ],
      "controls": [
        {
          "id": "V-26681",
          "title": "Applications providing remote access capabilities must utilize\napproved cryptography to protect the confidentiality of remote access sessions.",
          "desc": "Use SSL / TLS communication for all networked access to Elasticsearch\nand connected components such as Kibana and Logstash.  X-Pack Security should\nbe configured with organizational approved cryptography.",
          "impact": 0.5,
          "refs": [],
          "tags": {
            "nist": [
              "AC-17 (2)",
              "Rev_4"
            ],
            "severity": "medium",
            "rid": "SV-33881r1_rule",
            "gtitle": "SRG-APP-000014",
            "cci": "CCI-000068",
            "check": "Application must utilize approved cryptography to protect\nremote access sessions.\n\nAs the application administrator (usually elasticsearch), check the xpack.ssl\nsettings are set to the correct values.\n\n$cat elasticsearch.yml | grep xpack.ssl\n\nxpack.ssl.key:                     <server_key>.key\nxpack.ssl.certificate:             <server_certificate>.crt\nxpack.ssl.certificate_authorities: [ <approved_ca>.crt' ]\n\nIf these setting are not set or the underlying certificate and keys are not\ncorrect, this is a finding.\n\n$cat elasticsearch.yml | grep xpack.security.http.ssl.enabled: true\n\nIf this setting is not present or set to true, this is a finding.\n\nAs a elasticsearch user, check that non-secure http traffic does not response\nwith 200 status:\n\n$curl -H 'Content-Type: application/json' -u <TEST_USER> -p <TEST_CREDENTIALS>\nhttp://<elasticsearchIP:9200>/\n\nIf a 200 response comes back, this is a finding.",
            "fix": "Implement protective measures when providing remote access.\n\n\nSee the official documentation for the complete  guide on establishing SSL\nconfiguration: https://www.elastic.co/guide/en/x-pack/current/ssl-tls.html"
          },
          "code": "control \"V-26681\" do\n  title \"Applications providing remote access capabilities must utilize\napproved cryptography to protect the confidentiality of remote access sessions.\"\n  desc  \"Use SSL / TLS communication for all networked access to Elasticsearch\nand connected components such as Kibana and Logstash.  X-Pack Security should\nbe configured with organizational approved cryptography.\"\n  impact 0.5\n  tag \"nist\": [\"AC-17 (2)\", \"Rev_4\"]\n  tag \"severity\": \"medium\"\n  tag \"rid\": \"SV-33881r1_rule\"\n  tag \"gtitle\": \"SRG-APP-000014\"\n  tag \"cci\": \"CCI-000068\"\n  tag \"check\": \"Application must utilize approved cryptography to protect\nremote access sessions.\n\nAs the application administrator (usually elasticsearch), check the xpack.ssl\nsettings are set to the correct values.\n\n$cat elasticsearch.yml | grep xpack.ssl\n\nxpack.ssl.key:                     <server_key>.key\nxpack.ssl.certificate:             <server_certificate>.crt\nxpack.ssl.certificate_authorities: [ <approved_ca>.crt' ]\n\nIf these setting are not set or the underlying certificate and keys are not\ncorrect, this is a finding.\n\n$cat elasticsearch.yml | grep xpack.security.http.ssl.enabled: true\n\nIf this setting is not present or set to true, this is a finding.\n\nAs a elasticsearch user, check that non-secure http traffic does not response\nwith 200 status:\n\n$curl -H 'Content-Type: application/json' -u <TEST_USER> -p <TEST_CREDENTIALS>\nhttp://<elasticsearchIP:9200>/\n\nIf a 200 response comes back, this is a finding.\"\n  tag \"fix\": \"Implement protective measures when providing remote access.\n\n\nSee the official documentation for the complete  guide on establishing SSL\nconfiguration: https://www.elastic.co/guide/en/x-pack/current/ssl-tls.html\"\n\n\n  begin\n    es_handle = es_helper(url:\"https://#{ELASTIC_IP}:#{ELASTIC_PORT}\",\n                    username: ES_ADMIN,\n                    password: ES_PASS,\n                    ssl_verify: SSL_VERIFY )\n\n    describe \"No nodes found\" do\n      subject { es_handle.nodes.nil? }\n      it { should_not be_truthy }\n    end if es_handle.nodes.nil?\n\n    es_handle.nodes.each do |node|\n      describe \"SSL Settings for Node: #{node.name}\" do\n        subject { node }\n        its(\"http_ssl.enabled\") { should eq 'true' }\n      end\n    end unless es_handle.nodes.nil?\n\n    describe yaml(ELASTICSEARCH_CONF) do\n      its(['xpack.ssl.key']) { should_not be_nil }\n      its(['xpack.ssl.certificate']) { should_not be_nil }\n      its(['xpack.ssl.certificate_authorities']) { should_not be_nil }\n      its(['xpack.security.http.ssl.enabled']) { should eq true }\n    end\n\n    describe command(\"openssl rsa -in #{yaml(ELASTICSEARCH_CONF)['xpack.ssl.key']} -check -noout\") do\n      its('stdout'){ should match /RSA key ok/ }\n    end\n\n    describe x509_certificate(yaml(ELASTICSEARCH_CONF)['xpack.ssl.certificate']) do\n      it { should be_certificate }\n      it { should be_valid }\n    end\n\n    if yaml(ELASTICSEARCH_CONF)['xpack.ssl.certificate_authorities'].is_a?(Array)\n      yaml(ELASTICSEARCH_CONF)['xpack.ssl.certificate_authorities'].each do |cert|\n        describe x509_certificate(cert) do\n          it { should be_certificate }\n          it { should be_valid }\n        end\n      end\n    else\n      describe x509_certificate(yaml(ELASTICSEARCH_CONF)['xpack.ssl.certificate_authorities']) do\n        it { should be_certificate }\n        it { should be_valid }\n      end\n    end\n\n    describe es_handle do \n      it { should_not have_http_access }\n    end\n\n  rescue Exception => msg\n    describe \"Exception: #{msg}\" do\n      it { should be_nil}\n    end\n  end\nend\n",
          "source_location": {
            "line": 41,
            "ref": "../elasticsearch-inspec/controls/ssl+certs+http/V-26681.rb"
          },
          "results": [
            {
              "status": "passed",
              "code_desc": "SSL Settings for Node: package-centos-72 http_ssl.enabled should eq \"true\"",
              "run_time": 0.000965,
              "start_time": "2018-02-11 14:26:23 -0500"
            },
            {
              "status": "passed",
              "code_desc": "YAML /etc/elasticsearch/elasticsearch.yml [\"xpack.ssl.key\"] should not be nil",
              "run_time": 0.000093,
              "start_time": "2018-02-11 14:26:23 -0500"
            },
            {
              "status": "passed",
              "code_desc": "YAML /etc/elasticsearch/elasticsearch.yml [\"xpack.ssl.certificate\"] should not be nil",
              "run_time": 0.000061,
              "start_time": "2018-02-11 14:26:23 -0500"
            },
            {
              "status": "passed",
              "code_desc": "YAML /etc/elasticsearch/elasticsearch.yml [\"xpack.ssl.certificate_authorities\"] should not be nil",
              "run_time": 0.000055,
              "start_time": "2018-02-11 14:26:23 -0500"
            },
            {
              "status": "passed",
              "code_desc": "YAML /etc/elasticsearch/elasticsearch.yml [\"xpack.security.http.ssl.enabled\"] should eq true",
              "run_time": 0.000071,
              "start_time": "2018-02-11 14:26:23 -0500"
            },
            {
              "status": "passed",
              "code_desc": "Command openssl rsa -in /etc/elasticsearch/x-pack/elastic/elastic.key -check -noout stdout should match /RSA key ok/",
              "run_time": 0.024372,
              "start_time": "2018-02-11 14:26:23 -0500"
            },
            {
              "status": "passed",
              "code_desc": "x509_certificate /etc/elasticsearch/x-pack/elastic/elastic.crt should be certificate",
              "run_time": 0.000172,
              "start_time": "2018-02-11 14:26:23 -0500"
            },
            {
              "status": "passed",
              "code_desc": "x509_certificate /etc/elasticsearch/x-pack/elastic/elastic.crt should be valid",
              "run_time": 0.000106,
              "start_time": "2018-02-11 14:26:23 -0500"
            },
            {
              "status": "passed",
              "code_desc": "x509_certificate /etc/elasticsearch/x-pack/ca/ca.crt should be certificate",
              "run_time": 0.000066,
              "start_time": "2018-02-11 14:26:23 -0500"
            },
            {
              "status": "passed",
              "code_desc": "x509_certificate /etc/elasticsearch/x-pack/ca/ca.crt should be valid",
              "run_time": 0.000084,
              "start_time": "2018-02-11 14:26:23 -0500"
            },
            {
              "status": "passed",
              "code_desc": "Elasticsearch Cluster https://0.0.0.0:9200 should not have http access",
              "run_time": 0.020446,
              "start_time": "2018-02-11 14:26:23 -0500"
            }
          ]
        },
        {
          "id": "V-26924",
          "title": "The application must support organizational requirements to enforce\npassword encryption for transmission.",
          "desc": "Use SSL / TLS communication for all networked access to Elasticsearch\nand connected components such as Kibana and Logstash.  X-Pack Security should\nbe configured with organizational approved cryptography.",
          "impact": 0.5,
          "refs": [],
          "tags": {
            "nist": [
              "IA-5 (1) (c)",
              "Rev_4"
            ],
            "severity": "medium",
            "rid": "SV-34204r1_rule",
            "gtitle": "SRG-APP-000172",
            "cci": "CCI-000197",
            "check": "Application must utilize approved cryptography to protect\nremote access sessions.\n\nAs the application administrator (usually elasticsearch), check the xpack.ssl\nsettings are set to the correct values.\n\n$cat elasticsearch.yml | grep xpack.ssl\n\nxpack.ssl.key:                     <server_key>.key\nxpack.ssl.certificate:             <server_certificate>.crt\nxpack.ssl.certificate_authorities: [ <approved_ca>.crt' ]\n\nIf these setting are not set or the underlying certificate and keys are not\ncorrect, this is a finding.\n\n$cat elasticsearch.yml | grep xpack.security.http.ssl.enabled: true\n\nIf this setting is not present or set to true, this is a finding.\n\nAs a elasticsearch user, check that non-secure http traffic does not response\nwith 200 status:\n\n$curl -H 'Content-Type: application/json' -u <TEST_USER> -p <TEST_CREDENTIALS>\nhttp://<elasticsearchIP:9200>/\n\nIf a 200 response comes back, this is a finding.",
            "fix": "Implement protective measures when enforcing password encryption\nfor transmission.\n\n See the official documentation for the complete  guide on establishing SSL\nconfiguration: https://www.elastic.co/guide/en/x-pack/current/ssl-tls.html"
          },
          "code": "control \"V-26924\" do\n  title \"The application must support organizational requirements to enforce\npassword encryption for transmission.\"\n  desc  \"Use SSL / TLS communication for all networked access to Elasticsearch\nand connected components such as Kibana and Logstash.  X-Pack Security should\nbe configured with organizational approved cryptography.\"\n  impact 0.5\n  tag \"nist\": [\"IA-5 (1) (c)\", \"Rev_4\"]\n  tag \"severity\": \"medium\"\n  tag \"rid\": \"SV-34204r1_rule\"\n  tag \"gtitle\": \"SRG-APP-000172\"\n  tag \"cci\": \"CCI-000197\"\n  tag \"check\": \"Application must utilize approved cryptography to protect\nremote access sessions.\n\nAs the application administrator (usually elasticsearch), check the xpack.ssl\nsettings are set to the correct values.\n\n$cat elasticsearch.yml | grep xpack.ssl\n\nxpack.ssl.key:                     <server_key>.key\nxpack.ssl.certificate:             <server_certificate>.crt\nxpack.ssl.certificate_authorities: [ <approved_ca>.crt' ]\n\nIf these setting are not set or the underlying certificate and keys are not\ncorrect, this is a finding.\n\n$cat elasticsearch.yml | grep xpack.security.http.ssl.enabled: true\n\nIf this setting is not present or set to true, this is a finding.\n\nAs a elasticsearch user, check that non-secure http traffic does not response\nwith 200 status:\n\n$curl -H 'Content-Type: application/json' -u <TEST_USER> -p <TEST_CREDENTIALS>\nhttp://<elasticsearchIP:9200>/\n\nIf a 200 response comes back, this is a finding.\"\n  tag \"fix\": \"Implement protective measures when enforcing password encryption\nfor transmission.\n\n See the official documentation for the complete  guide on establishing SSL\nconfiguration: https://www.elastic.co/guide/en/x-pack/current/ssl-tls.html\"\n\n  begin\n    es_handle = es_helper(url:\"https://#{ELASTIC_IP}:#{ELASTIC_PORT}\",\n                    username: ES_ADMIN,\n                    password: ES_PASS,\n                    ssl_verify: SSL_VERIFY )\n\n    describe \"No nodes found\" do\n      subject { es_handle.nodes.nil? }\n      it { should_not be_truthy }\n    end if es_handle.nodes.nil?\n\n    es_handle.nodes.each do |node|\n      describe \"SSL Settings for Node: #{node.name}\" do\n        subject { node }\n        its(\"http_ssl.enabled\") { should eq 'true' }\n      end\n    end unless es_handle.nodes.nil?\n\n    describe yaml(ELASTICSEARCH_CONF) do\n      its(['xpack.ssl.key']) { should_not be_nil }\n      its(['xpack.ssl.certificate']) { should_not be_nil }\n      its(['xpack.ssl.certificate_authorities']) { should_not be_nil }\n      its(['xpack.security.http.ssl.enabled']) { should eq true }\n    end\n\n    describe command(\"openssl rsa -in #{yaml(ELASTICSEARCH_CONF)['xpack.ssl.key']} -check -noout\") do\n      its('stdout'){ should match /RSA key ok/ }\n    end\n\n    describe x509_certificate(yaml(ELASTICSEARCH_CONF)['xpack.ssl.certificate']) do\n      it { should be_certificate }\n      it { should be_valid }\n    end\n\n    if yaml(ELASTICSEARCH_CONF)['xpack.ssl.certificate_authorities'].is_a?(Array)\n      yaml(ELASTICSEARCH_CONF)['xpack.ssl.certificate_authorities'].each do |cert|\n        describe x509_certificate(cert) do\n          it { should be_certificate }\n          it { should be_valid }\n        end\n      end\n    else\n      describe x509_certificate(yaml(ELASTICSEARCH_CONF)['xpack.ssl.certificate_authorities']) do\n        it { should be_certificate }\n        it { should be_valid }\n      end\n    end\n\n    describe es_handle do \n      it { should_not have_http_access }\n    end\n\n  rescue Exception => msg\n    describe \"Exception: #{msg}\" do\n      it { should be_nil}\n    end\n  end\nend",
          "source_location": {
            "line": 41,
            "ref": "../elasticsearch-inspec/controls/ssl+certs+http/V-26924.rb"
          },
          "results": [
            {
              "status": "passed",
              "code_desc": "SSL Settings for Node: package-centos-72 http_ssl.enabled should eq \"true\"",
              "run_time": 0.000166,
              "start_time": "2018-02-11 14:26:23 -0500"
            },
            {
              "status": "passed",
              "code_desc": "YAML /etc/elasticsearch/elasticsearch.yml [\"xpack.ssl.key\"] should not be nil",
              "run_time": 0.00009,
              "start_time": "2018-02-11 14:26:23 -0500"
            },
            {
              "status": "passed",
              "code_desc": "YAML /etc/elasticsearch/elasticsearch.yml [\"xpack.ssl.certificate\"] should not be nil",
              "run_time": 0.000071,
              "start_time": "2018-02-11 14:26:23 -0500"
            },
            {
              "status": "passed",
              "code_desc": "YAML /etc/elasticsearch/elasticsearch.yml [\"xpack.ssl.certificate_authorities\"] should not be nil",
              "run_time": 0.000068,
              "start_time": "2018-02-11 14:26:23 -0500"
            },
            {
              "status": "passed",
              "code_desc": "YAML /etc/elasticsearch/elasticsearch.yml [\"xpack.security.http.ssl.enabled\"] should eq true",
              "run_time": 0.000078,
              "start_time": "2018-02-11 14:26:23 -0500"
            },
            {
              "status": "passed",
              "code_desc": "Command openssl rsa -in /etc/elasticsearch/x-pack/elastic/elastic.key -check -noout stdout should match /RSA key ok/",
              "run_time": 0.021375,
              "start_time": "2018-02-11 14:26:23 -0500"
            },
            {
              "status": "passed",
              "code_desc": "x509_certificate /etc/elasticsearch/x-pack/elastic/elastic.crt should be certificate",
              "run_time": 0.000113,
              "start_time": "2018-02-11 14:26:23 -0500"
            },
            {
              "status": "passed",
              "code_desc": "x509_certificate /etc/elasticsearch/x-pack/elastic/elastic.crt should be valid",
              "run_time": 0.000084,
              "start_time": "2018-02-11 14:26:23 -0500"
            },
            {
              "status": "passed",
              "code_desc": "x509_certificate /etc/elasticsearch/x-pack/ca/ca.crt should be certificate",
              "run_time": 0.000098,
              "start_time": "2018-02-11 14:26:23 -0500"
            },
            {
              "status": "passed",
              "code_desc": "x509_certificate /etc/elasticsearch/x-pack/ca/ca.crt should be valid",
              "run_time": 0.000062,
              "start_time": "2018-02-11 14:26:23 -0500"
            },
            {
              "status": "passed",
              "code_desc": "Elasticsearch Cluster https://0.0.0.0:9200 should not have http access",
              "run_time": 0.018415,
              "start_time": "2018-02-11 14:26:23 -0500"
            }
          ]
        },
        {
          "id": "V-27130",
          "title": "The application must establish a trusted communications path between\nthe user and organizational-defined security functions within the information\nsystem.",
          "desc": "Use SSL / TLS communication for all networked access to Elasticsearch\nand connected components such as Kibana and Logstash.  X-Pack Security should\nbe configured with organizational approved cryptography.",
          "impact": 0.5,
          "refs": [],
          "tags": {
            "nist": [
              "SC-11",
              "Rev_4"
            ],
            "severity": "medium",
            "rid": "SV-34428r1_rule",
            "gtitle": "SRG-APP-000191",
            "cci": "CCI-001135",
            "check": "Application must utilize approved cryptography to protect the\ncommunication path between entities.\n\nAs the application administrator (usually elasticsearch), check the xpack.ssl\nsettings are set to the correct values.\n\n$cat elasticsearch.yml | grep xpack.ssl\n\nxpack.ssl.key:                     <server_key>.key\nxpack.ssl.certificate:             <server_certificate>.crt\nxpack.ssl.certificate_authorities: [ <approved_ca>.crt' ]\n\nIf these setting are not set or the underlying certificate and keys are not\ncorrect, this is a finding.\n\n$cat elasticsearch.yml | grep xpack.security.http.ssl.enabled: true\n\nIf this setting is not present or set to true, this is a finding.\n\nAs a elasticsearch user, check that non-secure http traffic does not response\nwith 200 status:\n\n$curl -H 'Content-Type: application/json' -u <TEST_USER> -p <TEST_CREDENTIALS>\nhttp://<elasticsearchIP:9200>/\n\nIf a 200 response comes back, this is a finding.",
            "fix": "Implement protective measures when establishing a trusted\ncommunication path between entities.\n\n See the official documentation for the complete  guide on establishing SSL\nconfiguration: https://www.elastic.co/guide/en/x-pack/current/ssl-tls.html"
          },
          "code": "control \"V-27130\" do\n  title \"The application must establish a trusted communications path between\nthe user and organizational-defined security functions within the information\nsystem.\"\n  desc  \"Use SSL / TLS communication for all networked access to Elasticsearch\nand connected components such as Kibana and Logstash.  X-Pack Security should\nbe configured with organizational approved cryptography.\"\n  impact 0.5\n  tag \"nist\": [\"SC-11\", \"Rev_4\"]\n  tag \"severity\": \"medium\"\n  tag \"rid\": \"SV-34428r1_rule\"\n  tag \"gtitle\": \"SRG-APP-000191\"\n  tag \"cci\": \"CCI-001135\"\n  tag \"check\": \"Application must utilize approved cryptography to protect the\ncommunication path between entities.\n\nAs the application administrator (usually elasticsearch), check the xpack.ssl\nsettings are set to the correct values.\n\n$cat elasticsearch.yml | grep xpack.ssl\n\nxpack.ssl.key:                     <server_key>.key\nxpack.ssl.certificate:             <server_certificate>.crt\nxpack.ssl.certificate_authorities: [ <approved_ca>.crt' ]\n\nIf these setting are not set or the underlying certificate and keys are not\ncorrect, this is a finding.\n\n$cat elasticsearch.yml | grep xpack.security.http.ssl.enabled: true\n\nIf this setting is not present or set to true, this is a finding.\n\nAs a elasticsearch user, check that non-secure http traffic does not response\nwith 200 status:\n\n$curl -H 'Content-Type: application/json' -u <TEST_USER> -p <TEST_CREDENTIALS>\nhttp://<elasticsearchIP:9200>/\n\nIf a 200 response comes back, this is a finding.\"\n  tag \"fix\": \"Implement protective measures when establishing a trusted\ncommunication path between entities.\n\n See the official documentation for the complete  guide on establishing SSL\nconfiguration: https://www.elastic.co/guide/en/x-pack/current/ssl-tls.html\"\n\n\n  begin\n    es_handle = es_helper(url:\"https://#{ELASTIC_IP}:#{ELASTIC_PORT}\",\n                    username: ES_ADMIN,\n                    password: ES_PASS,\n                    ssl_verify: SSL_VERIFY )\n\n    describe \"No nodes found\" do\n      subject { es_handle.nodes.nil? }\n      it { should_not be_truthy }\n    end if es_handle.nodes.nil?\n\n    es_handle.nodes.each do |node|\n      describe \"SSL Settings for Node: #{node.name}\" do\n        subject { node }\n        its(\"http_ssl.enabled\") { should eq 'true' }\n      end\n    end unless es_handle.nodes.nil?\n\n    describe yaml(ELASTICSEARCH_CONF) do\n      its(['xpack.ssl.key']) { should_not be_nil }\n      its(['xpack.ssl.certificate']) { should_not be_nil }\n      its(['xpack.ssl.certificate_authorities']) { should_not be_nil }\n      its(['xpack.security.http.ssl.enabled']) { should eq true }\n    end\n\n    describe command(\"openssl rsa -in #{yaml(ELASTICSEARCH_CONF)['xpack.ssl.key']} -check -noout\") do\n      its('stdout'){ should match /RSA key ok/ }\n    end\n\n    describe x509_certificate(yaml(ELASTICSEARCH_CONF)['xpack.ssl.certificate']) do\n      it { should be_certificate }\n      it { should be_valid }\n    end\n\n    if yaml(ELASTICSEARCH_CONF)['xpack.ssl.certificate_authorities'].is_a?(Array)\n      yaml(ELASTICSEARCH_CONF)['xpack.ssl.certificate_authorities'].each do |cert|\n        describe x509_certificate(cert) do\n          it { should be_certificate }\n          it { should be_valid }\n        end\n      end\n    else\n      describe x509_certificate(yaml(ELASTICSEARCH_CONF)['xpack.ssl.certificate_authorities']) do\n        it { should be_certificate }\n        it { should be_valid }\n      end\n    end\n\n    describe es_handle do \n      it { should_not have_http_access }\n    end\n\n  rescue Exception => msg\n    describe \"Exception: #{msg}\" do\n      it { should be_nil}\n    end\n  end\nend\n",
          "source_location": {
            "line": 41,
            "ref": "../elasticsearch-inspec/controls/ssl+certs+http/V-27130.rb"
          },
          "results": [
            {
              "status": "passed",
              "code_desc": "SSL Settings for Node: package-centos-72 http_ssl.enabled should eq \"true\"",
              "run_time": 0.000172,
              "start_time": "2018-02-11 14:26:23 -0500"
            },
            {
              "status": "passed",
              "code_desc": "YAML /etc/elasticsearch/elasticsearch.yml [\"xpack.ssl.key\"] should not be nil",
              "run_time": 0.000082,
              "start_time": "2018-02-11 14:26:23 -0500"
            },
            {
              "status": "passed",
              "code_desc": "YAML /etc/elasticsearch/elasticsearch.yml [\"xpack.ssl.certificate\"] should not be nil",
              "run_time": 0.000059,
              "start_time": "2018-02-11 14:26:23 -0500"
            },
            {
              "status": "passed",
              "code_desc": "YAML /etc/elasticsearch/elasticsearch.yml [\"xpack.ssl.certificate_authorities\"] should not be nil",
              "run_time": 0.000062,
              "start_time": "2018-02-11 14:26:23 -0500"
            },
            {
              "status": "passed",
              "code_desc": "YAML /etc/elasticsearch/elasticsearch.yml [\"xpack.security.http.ssl.enabled\"] should eq true",
              "run_time": 0.000071,
              "start_time": "2018-02-11 14:26:23 -0500"
            },
            {
              "status": "passed",
              "code_desc": "Command openssl rsa -in /etc/elasticsearch/x-pack/elastic/elastic.key -check -noout stdout should match /RSA key ok/",
              "run_time": 0.021102,
              "start_time": "2018-02-11 14:26:23 -0500"
            },
            {
              "status": "passed",
              "code_desc": "x509_certificate /etc/elasticsearch/x-pack/elastic/elastic.crt should be certificate",
              "run_time": 0.000163,
              "start_time": "2018-02-11 14:26:23 -0500"
            },
            {
              "status": "passed",
              "code_desc": "x509_certificate /etc/elasticsearch/x-pack/elastic/elastic.crt should be valid",
              "run_time": 0.000084,
              "start_time": "2018-02-11 14:26:23 -0500"
            },
            {
              "status": "passed",
              "code_desc": "x509_certificate /etc/elasticsearch/x-pack/ca/ca.crt should be certificate",
              "run_time": 0.000064,
              "start_time": "2018-02-11 14:26:23 -0500"
            },
            {
              "status": "passed",
              "code_desc": "x509_certificate /etc/elasticsearch/x-pack/ca/ca.crt should be valid",
              "run_time": 0.000063,
              "start_time": "2018-02-11 14:26:23 -0500"
            },
            {
              "status": "passed",
              "code_desc": "Elasticsearch Cluster https://0.0.0.0:9200 should not have http access",
              "run_time": 0.020351,
              "start_time": "2018-02-11 14:26:23 -0500"
            }
          ]
        },
        {
          "id": "V-27015",
          "title": "Application must ensure  authentication of both client and server\nduring the entire session. An example of this is SSL Mutual Authentication.",
          "desc": "Configure PKI authentication, TLS/SSL, IP filtering; which are key\nfeatures of X-Pack Security. This should ensure that authentication and\ncommunication within Elasticsearch is SSL Mutual Authentication.",
          "impact": 0.5,
          "refs": [],
          "tags": {
            "nist": [
              "SC-23",
              "Rev_4"
            ],
            "severity": "medium",
            "rid": "SV-34309r1_rule",
            "gtitle": "SRG-APP-000219",
            "cci": "CCI-001184",
            "check": "Application must utilize approved cryptography to ensure\nauthentication of both client and server during the entire session..\n\nAs the application administrator (usually elasticsearch), check the xpack.ssl\nsettings are set to the correct values.\n\n$cat elasticsearch.yml | grep xpack.ssl\n\nxpack.ssl.key:                     <server_key>.key\nxpack.ssl.certificate:             <server_certificate>.crt\nxpack.ssl.certificate_authorities: [ <approved_ca>.crt' ]\n\nIf these setting are not set or the underlying certificate and keys are not\ncorrect, this is a finding.\n\n$cat elasticsearch.yml | grep xpack.security.http.ssl.enabled: true\n\nIf this setting is not present or set to false, this is a finding.\n\nAs a elasticsearch user, check that non-secure http traffic does not response\nwith 200 status:\n\n$curl -H 'Content-Type: application/json' -u <TEST_USER> -p <TEST_CREDENTIALS>\nhttp://<elasticsearchIP:9200>/\n\nIf a 200 response comes back, this is a finding.",
            "fix": "Ensure authentication of both client and server during the entire\nsession.\n\n See the official documentation for the complete  guide on establishing SSL\nconfiguration: https://www.elastic.co/guide/en/x-pack/current/ssl-tls.html"
          },
          "code": "control \"V-27015\" do\n  title \"Application must ensure  authentication of both client and server\nduring the entire session. An example of this is SSL Mutual Authentication.\"\n  desc  \"Configure PKI authentication, TLS/SSL, IP filtering; which are key\nfeatures of X-Pack Security. This should ensure that authentication and\ncommunication within Elasticsearch is SSL Mutual Authentication.\"\n  impact 0.5\n  tag \"nist\": [\"SC-23\", \"Rev_4\"]\n  tag \"severity\": \"medium\"\n  tag \"rid\": \"SV-34309r1_rule\"\n  tag \"gtitle\": \"SRG-APP-000219\"\n  tag \"cci\": \"CCI-001184\"\n  tag \"check\": \"Application must utilize approved cryptography to ensure\nauthentication of both client and server during the entire session..\n\nAs the application administrator (usually elasticsearch), check the xpack.ssl\nsettings are set to the correct values.\n\n$cat elasticsearch.yml | grep xpack.ssl\n\nxpack.ssl.key:                     <server_key>.key\nxpack.ssl.certificate:             <server_certificate>.crt\nxpack.ssl.certificate_authorities: [ <approved_ca>.crt' ]\n\nIf these setting are not set or the underlying certificate and keys are not\ncorrect, this is a finding.\n\n$cat elasticsearch.yml | grep xpack.security.http.ssl.enabled: true\n\nIf this setting is not present or set to false, this is a finding.\n\nAs a elasticsearch user, check that non-secure http traffic does not response\nwith 200 status:\n\n$curl -H 'Content-Type: application/json' -u <TEST_USER> -p <TEST_CREDENTIALS>\nhttp://<elasticsearchIP:9200>/\n\nIf a 200 response comes back, this is a finding.\"\n  tag \"fix\": \"Ensure authentication of both client and server during the entire\nsession.\n\n See the official documentation for the complete  guide on establishing SSL\nconfiguration: https://www.elastic.co/guide/en/x-pack/current/ssl-tls.html\"\n\n  begin\n    es_handle = es_helper(url:\"https://#{ELASTIC_IP}:#{ELASTIC_PORT}\",\n                    username: ES_ADMIN,\n                    password: ES_PASS,\n                    ssl_verify: SSL_VERIFY )\n\n    describe \"No nodes found\" do\n      subject { es_handle.nodes.nil? }\n      it { should_not be_truthy }\n    end if es_handle.nodes.nil?\n\n    es_handle.nodes.each do |node|\n      describe \"SSL Settings for Node: #{node.name}\" do\n        subject { node }\n        its(\"http_ssl.enabled\") { should eq 'true' }\n      end\n    end unless es_handle.nodes.nil?\n\n    describe yaml(ELASTICSEARCH_CONF) do\n      its(['xpack.ssl.key']) { should_not be_nil }\n      its(['xpack.ssl.certificate']) { should_not be_nil }\n      its(['xpack.ssl.certificate_authorities']) { should_not be_nil }\n      its(['xpack.security.http.ssl.enabled']) { should eq true }\n    end\n\n    describe command(\"openssl rsa -in #{yaml(ELASTICSEARCH_CONF)['xpack.ssl.key']} -check -noout\") do\n      its('stdout'){ should match /RSA key ok/ }\n    end\n\n    describe x509_certificate(yaml(ELASTICSEARCH_CONF)['xpack.ssl.certificate']) do\n      it { should be_certificate }\n      it { should be_valid }\n    end\n\n    if yaml(ELASTICSEARCH_CONF)['xpack.ssl.certificate_authorities'].is_a?(Array)\n      yaml(ELASTICSEARCH_CONF)['xpack.ssl.certificate_authorities'].each do |cert|\n        describe x509_certificate(cert) do\n          it { should be_certificate }\n          it { should be_valid }\n        end\n      end\n    else\n      describe x509_certificate(yaml(ELASTICSEARCH_CONF)['xpack.ssl.certificate_authorities']) do\n        it { should be_certificate }\n        it { should be_valid }\n      end\n    end\n\n    describe es_handle do \n      it { should_not have_http_access }\n    end\n\n  rescue Exception => msg\n    describe \"Exception: #{msg}\" do\n      it { should be_nil}\n    end\n  end\nend\n",
          "source_location": {
            "line": 42,
            "ref": "../elasticsearch-inspec/controls/ssl+certs+http/V-27015.rb"
          },
          "results": [
            {
              "status": "passed",
              "code_desc": "SSL Settings for Node: package-centos-72 http_ssl.enabled should eq \"true\"",
              "run_time": 0.000136,
              "start_time": "2018-02-11 14:26:23 -0500"
            },
            {
              "status": "passed",
              "code_desc": "YAML /etc/elasticsearch/elasticsearch.yml [\"xpack.ssl.key\"] should not be nil",
              "run_time": 0.000076,
              "start_time": "2018-02-11 14:26:23 -0500"
            },
            {
              "status": "passed",
              "code_desc": "YAML /etc/elasticsearch/elasticsearch.yml [\"xpack.ssl.certificate\"] should not be nil",
              "run_time": 0.000071,
              "start_time": "2018-02-11 14:26:23 -0500"
            },
            {
              "status": "passed",
              "code_desc": "YAML /etc/elasticsearch/elasticsearch.yml [\"xpack.ssl.certificate_authorities\"] should not be nil",
              "run_time": 0.000057,
              "start_time": "2018-02-11 14:26:23 -0500"
            },
            {
              "status": "passed",
              "code_desc": "YAML /etc/elasticsearch/elasticsearch.yml [\"xpack.security.http.ssl.enabled\"] should eq true",
              "run_time": 0.000067,
              "start_time": "2018-02-11 14:26:23 -0500"
            },
            {
              "status": "passed",
              "code_desc": "Command openssl rsa -in /etc/elasticsearch/x-pack/elastic/elastic.key -check -noout stdout should match /RSA key ok/",
              "run_time": 0.029185,
              "start_time": "2018-02-11 14:26:23 -0500"
            },
            {
              "status": "passed",
              "code_desc": "x509_certificate /etc/elasticsearch/x-pack/elastic/elastic.crt should be certificate",
              "run_time": 0.000107,
              "start_time": "2018-02-11 14:26:23 -0500"
            },
            {
              "status": "passed",
              "code_desc": "x509_certificate /etc/elasticsearch/x-pack/elastic/elastic.crt should be valid",
              "run_time": 0.00008,
              "start_time": "2018-02-11 14:26:23 -0500"
            },
            {
              "status": "passed",
              "code_desc": "x509_certificate /etc/elasticsearch/x-pack/ca/ca.crt should be certificate",
              "run_time": 0.000065,
              "start_time": "2018-02-11 14:26:23 -0500"
            },
            {
              "status": "passed",
              "code_desc": "x509_certificate /etc/elasticsearch/x-pack/ca/ca.crt should be valid",
              "run_time": 0.000081,
              "start_time": "2018-02-11 14:26:23 -0500"
            },
            {
              "status": "passed",
              "code_desc": "Elasticsearch Cluster https://0.0.0.0:9200 should not have http access",
              "run_time": 0.019803,
              "start_time": "2018-02-11 14:26:23 -0500"
            }
          ]
        },
        {
          "id": "V-26682",
          "title": "Applications providing remote access connectivity must use\ncryptography to protect the integrity of the remote access session.",
          "desc": "Use SSL / TLS communication for all networked access to Elasticsearch\nand connected components such as Kibana and Logstash.  X-Pack Security should\nbe configured with organizational approved cryptography.",
          "impact": 0.5,
          "refs": [],
          "tags": {
            "nist": [
              "AC-17 (2)",
              "Rev_4"
            ],
            "severity": "medium",
            "rid": "SV-33882r1_rule",
            "gtitle": "SRG-APP-000015",
            "cci": "CCI-001453",
            "check": "Application must utilize approved cryptography to protect\nremote access sessions.\n\nAs the application administrator (usually elasticsearch), check the xpack.ssl\nsettings are set to the correct values.\n\n$cat elasticsearch.yml | grep xpack.ssl\n\nxpack.ssl.key:                     <server_key>.key\nxpack.ssl.certificate:             <server_certificate>.crt\nxpack.ssl.certificate_authorities: [ <approved_ca>.crt' ]\n\nIf these setting are not set or the underlying certificate and keys are not\ncorrect, this is a finding.\n\n$cat elasticsearch.yml | grep xpack.security.http.ssl.enabled: true\n\nIf this setting is not present or set to true, this is a finding.\n\nAs a elasticsearch user, check that non-secure http traffic does not response\nwith 200 status:\n\n$curl -H 'Content-Type: application/json' -u <TEST_USER> -p <TEST_CREDENTIALS>\nhttp://<elasticsearchIP:9200>/\n\nIf a 200 response comes back, this is a finding.",
            "fix": "Implement protective measures when providing remote access.\n\n\nSee the official documentation for the complete  guide on establishing SSL\nconfiguration: https://www.elastic.co/guide/en/x-pack/current/ssl-tls.html"
          },
          "code": "control \"V-26682\" do\n  title \"Applications providing remote access connectivity must use\ncryptography to protect the integrity of the remote access session.\"\n  desc  \"Use SSL / TLS communication for all networked access to Elasticsearch\nand connected components such as Kibana and Logstash.  X-Pack Security should\nbe configured with organizational approved cryptography.\"\n  impact 0.5\n  tag \"nist\": [\"AC-17 (2)\", \"Rev_4\"]\n  tag \"severity\": \"medium\"\n  tag \"rid\": \"SV-33882r1_rule\"\n  tag \"gtitle\": \"SRG-APP-000015\"\n  tag \"cci\": \"CCI-001453\"\n  tag \"check\": \"Application must utilize approved cryptography to protect\nremote access sessions.\n\nAs the application administrator (usually elasticsearch), check the xpack.ssl\nsettings are set to the correct values.\n\n$cat elasticsearch.yml | grep xpack.ssl\n\nxpack.ssl.key:                     <server_key>.key\nxpack.ssl.certificate:             <server_certificate>.crt\nxpack.ssl.certificate_authorities: [ <approved_ca>.crt' ]\n\nIf these setting are not set or the underlying certificate and keys are not\ncorrect, this is a finding.\n\n$cat elasticsearch.yml | grep xpack.security.http.ssl.enabled: true\n\nIf this setting is not present or set to true, this is a finding.\n\nAs a elasticsearch user, check that non-secure http traffic does not response\nwith 200 status:\n\n$curl -H 'Content-Type: application/json' -u <TEST_USER> -p <TEST_CREDENTIALS>\nhttp://<elasticsearchIP:9200>/\n\nIf a 200 response comes back, this is a finding.\"\n  tag \"fix\": \"Implement protective measures when providing remote access.\n\n\nSee the official documentation for the complete  guide on establishing SSL\nconfiguration: https://www.elastic.co/guide/en/x-pack/current/ssl-tls.html\"\n\n  begin\n    es_handle = es_helper(url:\"https://#{ELASTIC_IP}:#{ELASTIC_PORT}\",\n                    username: ES_ADMIN,\n                    password: ES_PASS,\n                    ssl_verify: SSL_VERIFY )\n\n    describe \"No nodes found\" do\n      subject { es_handle.nodes.nil? }\n      it { should_not be_truthy }\n    end if es_handle.nodes.nil?\n\n    es_handle.nodes.each do |node|\n      describe \"SSL Settings for Node: #{node.name}\" do\n        subject { node }\n        its(\"http_ssl.enabled\") { should eq 'true' }\n      end\n    end unless es_handle.nodes.nil?\n\n    describe yaml(ELASTICSEARCH_CONF) do\n      its(['xpack.ssl.key']) { should_not be_nil }\n      its(['xpack.ssl.certificate']) { should_not be_nil }\n      its(['xpack.ssl.certificate_authorities']) { should_not be_nil }\n      its(['xpack.security.http.ssl.enabled']) { should eq true }\n    end\n\n    describe command(\"openssl rsa -in #{yaml(ELASTICSEARCH_CONF)['xpack.ssl.key']} -check -noout\") do\n      its('stdout'){ should match /RSA key ok/ }\n    end\n\n    describe x509_certificate(yaml(ELASTICSEARCH_CONF)['xpack.ssl.certificate']) do\n      it { should be_certificate }\n      it { should be_valid }\n    end\n\n    if yaml(ELASTICSEARCH_CONF)['xpack.ssl.certificate_authorities'].is_a?(Array)\n      yaml(ELASTICSEARCH_CONF)['xpack.ssl.certificate_authorities'].each do |cert|\n        describe x509_certificate(cert) do\n          it { should be_certificate }\n          it { should be_valid }\n        end\n      end\n    else\n      describe x509_certificate(yaml(ELASTICSEARCH_CONF)['xpack.ssl.certificate_authorities']) do\n        it { should be_certificate }\n        it { should be_valid }\n      end\n    end\n\n    describe es_handle do \n      it { should_not have_http_access }\n    end\n\n  rescue Exception => msg\n    describe \"Exception: #{msg}\" do\n      it { should be_nil}\n    end\n  end\nend\n",
          "source_location": {
            "line": 41,
            "ref": "../elasticsearch-inspec/controls/ssl+certs+http/V-26682.rb"
          },
          "results": [
            {
              "status": "passed",
              "code_desc": "SSL Settings for Node: package-centos-72 http_ssl.enabled should eq \"true\"",
              "run_time": 0.000153,
              "start_time": "2018-02-11 14:26:23 -0500"
            },
            {
              "status": "passed",
              "code_desc": "YAML /etc/elasticsearch/elasticsearch.yml [\"xpack.ssl.key\"] should not be nil",
              "run_time": 0.000078,
              "start_time": "2018-02-11 14:26:23 -0500"
            },
            {
              "status": "passed",
              "code_desc": "YAML /etc/elasticsearch/elasticsearch.yml [\"xpack.ssl.certificate\"] should not be nil",
              "run_time": 0.00006,
              "start_time": "2018-02-11 14:26:23 -0500"
            },
            {
              "status": "passed",
              "code_desc": "YAML /etc/elasticsearch/elasticsearch.yml [\"xpack.ssl.certificate_authorities\"] should not be nil",
              "run_time": 0.000055,
              "start_time": "2018-02-11 14:26:23 -0500"
            },
            {
              "status": "passed",
              "code_desc": "YAML /etc/elasticsearch/elasticsearch.yml [\"xpack.security.http.ssl.enabled\"] should eq true",
              "run_time": 0.000079,
              "start_time": "2018-02-11 14:26:23 -0500"
            },
            {
              "status": "passed",
              "code_desc": "Command openssl rsa -in /etc/elasticsearch/x-pack/elastic/elastic.key -check -noout stdout should match /RSA key ok/",
              "run_time": 0.020756,
              "start_time": "2018-02-11 14:26:23 -0500"
            },
            {
              "status": "passed",
              "code_desc": "x509_certificate /etc/elasticsearch/x-pack/elastic/elastic.crt should be certificate",
              "run_time": 0.000096,
              "start_time": "2018-02-11 14:26:23 -0500"
            },
            {
              "status": "passed",
              "code_desc": "x509_certificate /etc/elasticsearch/x-pack/elastic/elastic.crt should be valid",
              "run_time": 0.000076,
              "start_time": "2018-02-11 14:26:23 -0500"
            },
            {
              "status": "passed",
              "code_desc": "x509_certificate /etc/elasticsearch/x-pack/ca/ca.crt should be certificate",
              "run_time": 0.000109,
              "start_time": "2018-02-11 14:26:23 -0500"
            },
            {
              "status": "passed",
              "code_desc": "x509_certificate /etc/elasticsearch/x-pack/ca/ca.crt should be valid",
              "run_time": 0.000074,
              "start_time": "2018-02-11 14:26:23 -0500"
            },
            {
              "status": "passed",
              "code_desc": "Elasticsearch Cluster https://0.0.0.0:9200 should not have http access",
              "run_time": 0.022046,
              "start_time": "2018-02-11 14:26:23 -0500"
            }
          ]
        },
        {
          "id": "V-27027",
          "title": "Applications must meet organizational requirements to implement an\ninformation system isolation boundary that minimizes the number of non-security\nfunctions included within the boundary containing security functions.",
          "desc": "If desired, install Elasticsearch on virtual machines or other\ncontainer technology to further encapsulate the privileges and resources\nallocated to the system",
          "impact": 0.5,
          "refs": [],
          "tags": {
            "nist": [
              "SC-3 (3)",
              "Rev_3"
            ],
            "severity": "medium",
            "rid": "SV-34321r1_rule",
            "gtitle": "SRG-APP-000236",
            "cci": "CCI-001087",
            "check": "If organizational required, install elasticsearch on virtual\nmachines or other container technology to further encapsulate the privileges\nand resources allocated to the system.",
            "fix": "Encapsulate elasticsearch to virtual resources as organizational\nrequired."
          },
          "code": "control \"V-27027\" do\n  title \"Applications must meet organizational requirements to implement an\ninformation system isolation boundary that minimizes the number of non-security\nfunctions included within the boundary containing security functions.\"\n  desc  \"If desired, install Elasticsearch on virtual machines or other\ncontainer technology to further encapsulate the privileges and resources\nallocated to the system\"\n  impact 0.5\n  tag \"nist\": [\"SC-3 (3)\", \"Rev_3\"]\n  tag \"severity\": \"medium\"\n  tag \"rid\": \"SV-34321r1_rule\"\n  tag \"gtitle\": \"SRG-APP-000236\"\n  tag \"cci\": \"CCI-001087\"\n  tag \"check\": \"If organizational required, install elasticsearch on virtual\nmachines or other container technology to further encapsulate the privileges\nand resources allocated to the system.\"\n  tag \"fix\": \"Encapsulate elasticsearch to virtual resources as organizational\nrequired.\"\n\n  begin\n    describe virtualization do\n      its('role') { should eq 'guest' }\n    end\n\n  rescue Exception => msg\n    describe \"Exception: #{msg}\" do\n      it { should be_nil}\n    end\n  end\nend",
          "source_location": {
            "line": 5,
            "ref": "../elasticsearch-inspec/controls/virtualization/V-27027.rb"
          },
          "results": [
            {
              "status": "passed",
              "code_desc": "Virtualization Detection role should eq \"guest\"",
              "run_time": 0.000164,
              "start_time": "2018-02-11 14:26:23 -0500"
            }
          ]
        },
        {
          "id": "V-26830",
          "title": "Applications must be able to function within separate processing\ndomains (virtualized systems), when specified, so as to enable finer-grained\nallocation of user privileges.",
          "desc": "If desired, install Elasticsearch on virtual machines or other\ncontainer technology to further encapsulate the privileges and resources\nallocated to the system",
          "impact": 0.5,
          "refs": [],
          "tags": {
            "nist": [
              "AC-6 (4)",
              "Rev_3"
            ],
            "severity": "medium",
            "rid": "SV-34080r1_rule",
            "gtitle": "SRG-APP-000064",
            "cci": "CCI-000226",
            "check": "If organizational required, install elasticsearch on virtual\nmachines or other container technology to further encapsulate the privileges\nand resources allocated to the system.",
            "fix": "Encapsulate elasticsearch to virtual resources as organizational\nrequired."
          },
          "code": "control \"V-26830\" do\n  title \"Applications must be able to function within separate processing\ndomains (virtualized systems), when specified, so as to enable finer-grained\nallocation of user privileges.\"\n  desc  \"If desired, install Elasticsearch on virtual machines or other\ncontainer technology to further encapsulate the privileges and resources\nallocated to the system\"\n  impact 0.5\n  tag \"nist\": [\"AC-6 (4)\", \"Rev_3\"]\n  tag \"severity\": \"medium\"\n  tag \"rid\": \"SV-34080r1_rule\"\n  tag \"gtitle\": \"SRG-APP-000064\"\n  tag \"cci\": \"CCI-000226\"\n  tag \"check\": \"If organizational required, install elasticsearch on virtual\nmachines or other container technology to further encapsulate the privileges\nand resources allocated to the system.\"\n  tag \"fix\": \"Encapsulate elasticsearch to virtual resources as organizational\nrequired.\"\n\n  begin\n    describe virtualization do\n      its('role') { should eq 'guest' }\n    end\n\n  rescue Exception => msg\n    describe \"Exception: #{msg}\" do\n      it { should be_nil}\n    end\n  end\nend",
          "source_location": {
            "line": 5,
            "ref": "../elasticsearch-inspec/controls/virtualization/V-26830.rb"
          },
          "results": [
            {
              "status": "passed",
              "code_desc": "Virtualization Detection role should eq \"guest\"",
              "run_time": 0.000084,
              "start_time": "2018-02-11 14:26:23 -0500"
            }
          ]
        },
        {
          "id": "V-27029",
          "title": "Applications must meet organizational requirements to implement\nsecurity functions as a layered structure minimizing interactions between\nlayers of the design and avoiding any dependence by lower layers on the\nfunctionality or correctness of higher layers.",
          "desc": "If desired, install Elasticsearch on virtual machines or other\ncontainer technology to further encapsulate the privileges and resources\nallocated to the system",
          "impact": 0.5,
          "refs": [],
          "tags": {
            "nist": [
              "SC-3 (5)",
              "Rev_4"
            ],
            "severity": "medium",
            "rid": "SV-34323r1_rule",
            "gtitle": "SRG-APP-000238",
            "cci": "CCI-001089",
            "check": "If organizational required, install elasticsearch on virtual\nmachines or other container technology to further encapsulate the privileges\nand resources allocated to the system.",
            "fix": "Encapsulate elasticsearch to virtual resources as organizational\nrequired."
          },
          "code": "control \"V-27029\" do\n  title \"Applications must meet organizational requirements to implement\nsecurity functions as a layered structure minimizing interactions between\nlayers of the design and avoiding any dependence by lower layers on the\nfunctionality or correctness of higher layers.\"\n  desc  \"If desired, install Elasticsearch on virtual machines or other\ncontainer technology to further encapsulate the privileges and resources\nallocated to the system\"\n  impact 0.5\n  tag \"nist\": [\"SC-3 (5)\", \"Rev_4\"]\n  tag \"severity\": \"medium\"\n  tag \"rid\": \"SV-34323r1_rule\"\n  tag \"gtitle\": \"SRG-APP-000238\"\n  tag \"cci\": \"CCI-001089\"\n  tag \"check\": \"If organizational required, install elasticsearch on virtual\nmachines or other container technology to further encapsulate the privileges\nand resources allocated to the system.\"\n  tag \"fix\": \"Encapsulate elasticsearch to virtual resources as organizational\nrequired.\"\n\n  begin\n    describe virtualization do\n      its('role') { should eq 'guest' }\n    end\n\n  rescue Exception => msg\n    describe \"Exception: #{msg}\" do\n      it { should be_nil}\n    end\n  end\nend\n",
          "source_location": {
            "line": 5,
            "ref": "../elasticsearch-inspec/controls/virtualization/V-27029.rb"
          },
          "results": [
            {
              "status": "passed",
              "code_desc": "Virtualization Detection role should eq \"guest\"",
              "run_time": 0.000079,
              "start_time": "2018-02-11 14:26:23 -0500"
            }
          ]
        },
        {
          "id": "V-27025",
          "title": "Applications must isolate security functions from non-security\nfunctions by means of an isolation boundary (implemented via partitions and\ndomains) controlling access to and protecting the integrity of, the hardware,\nsoftware, and firmware that perform those security functions. The application\nmust isolate security functions from non-security functions.",
          "desc": "If desired, install Elasticsearch on virtual machines or other\ncontainer technology to further encapsulate the privileges and resources\nallocated to the system",
          "impact": 0.5,
          "refs": [],
          "tags": {
            "nist": [
              "SC-3",
              "Rev_4"
            ],
            "severity": "medium",
            "rid": "SV-34319r1_rule",
            "gtitle": "SRG-APP-000233",
            "cci": "CCI-001084",
            "check": "If organizational required, install elasticsearch on virtual\nmachines or other container technology to further encapsulate the privileges\nand resources allocated to the system.",
            "fix": "Encapsulate elasticsearch to virtual resources as organizational\nrequired."
          },
          "code": "control \"V-27025\" do\n  title \"Applications must isolate security functions from non-security\nfunctions by means of an isolation boundary (implemented via partitions and\ndomains) controlling access to and protecting the integrity of, the hardware,\nsoftware, and firmware that perform those security functions. The application\nmust isolate security functions from non-security functions.\"\n  desc  \"If desired, install Elasticsearch on virtual machines or other\ncontainer technology to further encapsulate the privileges and resources\nallocated to the system\"\n  impact 0.5\n  tag \"nist\": [\"SC-3\", \"Rev_4\"]\n  tag \"severity\": \"medium\"\n  tag \"rid\": \"SV-34319r1_rule\"\n  tag \"gtitle\": \"SRG-APP-000233\"\n  tag \"cci\": \"CCI-001084\"\n  tag \"check\": \"If organizational required, install elasticsearch on virtual\nmachines or other container technology to further encapsulate the privileges\nand resources allocated to the system.\"\n  tag \"fix\": \"Encapsulate elasticsearch to virtual resources as organizational\nrequired.\"\n\n  begin\n    describe virtualization do\n      its('role') { should eq 'guest' }\n    end\n\n  rescue Exception => msg\n    describe \"Exception: #{msg}\" do\n      it { should be_nil}\n    end\n  end\nend\n",
          "source_location": {
            "line": 5,
            "ref": "../elasticsearch-inspec/controls/virtualization/V-27025.rb"
          },
          "results": [
            {
              "status": "passed",
              "code_desc": "Virtualization Detection role should eq \"guest\"",
              "run_time": 0.000125,
              "start_time": "2018-02-11 14:26:23 -0500"
            }
          ]
        },
        {
          "id": "V-27037",
          "title": "Applications must preserve any organization-defined system state\ninformation in the event of a system failure.",
          "desc": "Elastic components should be installed on multiple physical and rack\nseparated machines to ensure application built to handle failures.",
          "impact": 0.5,
          "refs": [],
          "tags": {
            "nist": [
              "SC-24",
              "Rev_4"
            ],
            "severity": "medium",
            "rid": "SV-34331r1_rule",
            "gtitle": "SRG-APP-000226",
            "cci": "CCI-001665",
            "check": "Elasticsearch is designed to be deployed across a number of\nnodes, across physical machines and racks.  A single elasticsearch node, is\ndesigned to fail, and the cluster is built to handle this failure, replicating\nany lost data, updating its system state, and continue processing.\n\nAs an elasticsearch administrator test; verify runtime environment within\n_culster stats have at least 3 master nodes, 2 data, and replication minimum of\nat least 1.\n\n$curl -H 'Content-Type: application/json' -u <TEST_USER>:<TEST_CREDENTIALS>\n-XGET 'http://<elasticsearch>:9200/_cluster/stats'\n- indices.shards.index.replication.min:1\n- nodes.count.total:3\n- nodes.count.data:2\n\nIf these cluster stats do not meet the minimum, this is a finding. ",
            "fix": "Elastic components should be installed on multiple physical and\nrack separated machines to ensure application built to handle failures.\n\nSee the official documentation for RPM installation at:\nhttps://www.elastic.co/guide/en/elasticsearch/reference/current/rpm.html"
          },
          "code": "control \"V-27037\" do\n  title \"Applications must preserve any organization-defined system state\ninformation in the event of a system failure.\"\n  desc  \"Elastic components should be installed on multiple physical and rack\nseparated machines to ensure application built to handle failures.\"\n  impact 0.5\n  tag \"nist\": [\"SC-24\", \"Rev_4\"]\n  tag \"severity\": \"medium\"\n  tag \"rid\": \"SV-34331r1_rule\"\n  tag \"gtitle\": \"SRG-APP-000226\"\n  tag \"cci\": \"CCI-001665\"\n  tag \"check\": \"Elasticsearch is designed to be deployed across a number of\nnodes, across physical machines and racks.  A single elasticsearch node, is\ndesigned to fail, and the cluster is built to handle this failure, replicating\nany lost data, updating its system state, and continue processing.\n\nAs an elasticsearch administrator test; verify runtime environment within\n_culster stats have at least 3 master nodes, 2 data, and replication minimum of\nat least 1.\n\n$curl -H 'Content-Type: application/json' -u <TEST_USER>:<TEST_CREDENTIALS>\n-XGET 'http://<elasticsearch>:9200/_cluster/stats'\n- indices.shards.index.replication.min:1\n- nodes.count.total:3\n- nodes.count.data:2\n\nIf these cluster stats do not meet the minimum, this is a finding. \"\n  tag \"fix\": \"Elastic components should be installed on multiple physical and\nrack separated machines to ensure application built to handle failures.\n\nSee the official documentation for RPM installation at:\nhttps://www.elastic.co/guide/en/elasticsearch/reference/current/rpm.html\"\n\n  begin\n\n    es_handle = es_helper(url:\"https://#{ELASTIC_IP}:#{ELASTIC_PORT}\",\n                    username: ES_ADMIN,\n                    password: ES_PASS,\n                    ssl_verify: SSL_VERIFY )\n\n    describe \"No nodes found\" do\n      subject { es_handle.nodes.nil? }\n      it { should_not be_truthy }\n    end if es_handle.nodes.nil?\n\n\n    describe \"For the cluster total nodes\" do\n      subject { es_handle.cluster_stats['nodes']['count']['total'] }\n      it { should cmp >= 3 }\n    end\n\n    describe \"For the cluster data nodes\" do\n      subject { es_handle.cluster_stats['nodes']['count']['data'] }\n      it { should cmp >= 2 }\n    end\n\n    describe \"For the cluster replication minimum\" do\n      subject { es_handle.cluster_stats['indices']['shards']['index']['replication']['min'] }\n      it { should cmp >= 1 }\n    end\n\n  rescue Exception => msg\n    describe \"Exception: #{msg}\" do\n      it { should be_nil}\n    end\n  end\nend\n",
          "source_location": {
            "line": 34,
            "ref": "../elasticsearch-inspec/controls/nodes/V-27037.rb"
          },
          "results": [
            {
              "status": "failed",
              "code_desc": "For the cluster total nodes should cmp >= 3",
              "run_time": 0.102865,
              "start_time": "2018-02-11 14:26:23 -0500"
            },
            {
              "status": "failed",
              "code_desc": "For the cluster data nodes should cmp >= 2",
              "run_time": 0.113128,
              "start_time": "2018-02-11 14:26:23 -0500"
            },
            {
              "status": "failed",
              "code_desc": "For the cluster replication minimum should cmp >= 1",
              "run_time": 0.085015,
              "start_time": "2018-02-11 14:26:23 -0500"
            }
          ]
        },
        {
          "id": "V-27067",
          "title": "Applications must support the requirement to activate an alarm and/or\nautomatically shut down the information system if an application component\nfailure is detected.  This can include conducting a graceful application\nshutdown to avoid losing information.",
          "desc": "Configure automated alarms to proactively notify when the security or\nstability of the system is threatened",
          "impact": 0.5,
          "refs": [],
          "tags": {
            "nist": [
              "SI-13 (4) (b)",
              "Rev_4"
            ],
            "severity": "medium",
            "rid": "SV-34362r1_rule",
            "gtitle": "SRG-APP-000268",
            "cci": "CCI-001328",
            "check": "Elasticsearch is designed to be deployed across a number of\nnodes, across physical machines and racks.  A single elasticsearch node, is\ndesigned to fail, and the cluster is built to handle this failure, replicating\nany lost data, updating its system state, and continue processing.\n\nAs an elasticsearch administrator test; verify runtime environment within\n_culster stats have at least 3 master nodes, 2 data, and replication minimum of\nat least 1.\n\n$curl -H 'Content-Type: application/json' -u <TEST_USER>:<TEST_CREDENTIALS>\n-XGET 'http://<elasticsearch>:9200/_cluster/stats'\n- indices.shards.index.replication.min:1\n- nodes.count.total:3\n- nodes.count.data:2\n\nIf these cluster stats do not meet the minimum, this is a finding. ",
            "fix": "Elastic components should be installed on multiple physical and\nrack separated machines to ensure application built to handle component\nfailures.\n\nSee the official documentation for RPM installation at:\nhttps://www.elastic.co/guide/en/elasticsearch/reference/current/rpm.html"
          },
          "code": "control \"V-27067\" do\n  title \"Applications must support the requirement to activate an alarm and/or\nautomatically shut down the information system if an application component\nfailure is detected.  This can include conducting a graceful application\nshutdown to avoid losing information.\"\n  desc  \"Configure automated alarms to proactively notify when the security or\nstability of the system is threatened\"\n  impact 0.5\n  tag \"nist\": [\"SI-13 (4) (b)\", \"Rev_4\"]\n  tag \"severity\": \"medium\"\n  tag \"rid\": \"SV-34362r1_rule\"\n  tag \"gtitle\": \"SRG-APP-000268\"\n  tag \"cci\": \"CCI-001328\"\n  tag \"check\": \"Elasticsearch is designed to be deployed across a number of\nnodes, across physical machines and racks.  A single elasticsearch node, is\ndesigned to fail, and the cluster is built to handle this failure, replicating\nany lost data, updating its system state, and continue processing.\n\nAs an elasticsearch administrator test; verify runtime environment within\n_culster stats have at least 3 master nodes, 2 data, and replication minimum of\nat least 1.\n\n$curl -H 'Content-Type: application/json' -u <TEST_USER>:<TEST_CREDENTIALS>\n-XGET 'http://<elasticsearch>:9200/_cluster/stats'\n- indices.shards.index.replication.min:1\n- nodes.count.total:3\n- nodes.count.data:2\n\nIf these cluster stats do not meet the minimum, this is a finding. \"\n  tag \"fix\": \"Elastic components should be installed on multiple physical and\nrack separated machines to ensure application built to handle component\nfailures.\n\nSee the official documentation for RPM installation at:\nhttps://www.elastic.co/guide/en/elasticsearch/reference/current/rpm.html\"\n\n  begin\n\n    es_handle = es_helper(url:\"https://#{ELASTIC_IP}:#{ELASTIC_PORT}\",\n                    username: ES_ADMIN,\n                    password: ES_PASS,\n                    ssl_verify: SSL_VERIFY )\n\n    describe \"No nodes found\" do\n      subject { es_handle.nodes.nil? }\n      it { should_not be_truthy }\n    end if es_handle.nodes.nil?\n\n\n    describe \"For the cluster total nodes\" do\n      subject { es_handle.cluster_stats['nodes']['count']['total'] }\n      it { should cmp >= 3 }\n    end\n\n    describe \"For the cluster data nodes\" do\n      subject { es_handle.cluster_stats['nodes']['count']['data'] }\n      it { should cmp >= 2 }\n    end\n\n    describe \"For the cluster replication minimum\" do\n      subject { es_handle.cluster_stats['indices']['shards']['index']['replication']['min'] }\n      it { should cmp >= 1 }\n    end\n\n  rescue Exception => msg\n    describe \"Exception: #{msg}\" do\n      it { should be_nil}\n    end\n  end\nend\n",
          "source_location": {
            "line": 35,
            "ref": "../elasticsearch-inspec/controls/nodes/V-27067.rb"
          },
          "results": [
            {
              "status": "failed",
              "code_desc": "For the cluster total nodes should cmp >= 3",
              "run_time": 0.07708,
              "start_time": "2018-02-11 14:26:23 -0500"
            },
            {
              "status": "failed",
              "code_desc": "For the cluster data nodes should cmp >= 2",
              "run_time": 0.087158,
              "start_time": "2018-02-11 14:26:23 -0500"
            },
            {
              "status": "failed",
              "code_desc": "For the cluster replication minimum should cmp >= 1",
              "run_time": 0.100202,
              "start_time": "2018-02-11 14:26:23 -0500"
            }
          ]
        },
        {
          "id": "V-27021",
          "title": "Applications must be built to fail to a known safe state for defined\ntypes of failures.",
          "desc": "Elastic components should be installed on multiple physical and rack\nseparated machines to ensure application built to handle failures.",
          "impact": 0.5,
          "refs": [],
          "tags": {
            "nist": [
              "SC-24",
              "Rev_4"
            ],
            "severity": "medium",
            "rid": "SV-34315r1_rule",
            "gtitle": "SRG-APP-000225",
            "cci": "CCI-001190",
            "check": "Elasticsearch is designed to be deployed across a number of\nnodes, across physical machines and racks.  A single elasticsearch node, is\ndesigned to fail, and the cluster is built to handle this failure, replicating\nany lost data, updating its system state, and continue processing.\n\nAs an elasticsearch administrator test; verify runtime environment within\n_culster stats have at least 3 master nodes, 2 data, and replication minimum of\nat least 1.\n\n$curl -H 'Content-Type: application/json' -u <TEST_USER>:<TEST_CREDENTIALS>\n-XGET 'http://<elasticsearch>:9200/_cluster/stats'\n- indices.shards.index.replication.min:1\n- nodes.count.total:3\n- nodes.count.data:2\n\nIf these cluster stats do not meet the minimum, this is a finding. ",
            "fix": "Elastic components should be installed on multiple physical and\nrack separated machines to ensure application built to handle failures.\n\nSee the official documentation for RPM installation at:\nhttps://www.elastic.co/guide/en/elasticsearch/reference/current/rpm.html"
          },
          "code": "control \"V-27021\" do\n  title \"Applications must be built to fail to a known safe state for defined\ntypes of failures.\"\n  desc  \"Elastic components should be installed on multiple physical and rack\nseparated machines to ensure application built to handle failures.\"\n  impact 0.5\n  tag \"nist\": [\"SC-24\", \"Rev_4\"]\n  tag \"severity\": \"medium\"\n  tag \"rid\": \"SV-34315r1_rule\"\n  tag \"gtitle\": \"SRG-APP-000225\"\n  tag \"cci\": \"CCI-001190\"\n  tag \"check\": \"Elasticsearch is designed to be deployed across a number of\nnodes, across physical machines and racks.  A single elasticsearch node, is\ndesigned to fail, and the cluster is built to handle this failure, replicating\nany lost data, updating its system state, and continue processing.\n\nAs an elasticsearch administrator test; verify runtime environment within\n_culster stats have at least 3 master nodes, 2 data, and replication minimum of\nat least 1.\n\n$curl -H 'Content-Type: application/json' -u <TEST_USER>:<TEST_CREDENTIALS>\n-XGET 'http://<elasticsearch>:9200/_cluster/stats'\n- indices.shards.index.replication.min:1\n- nodes.count.total:3\n- nodes.count.data:2\n\nIf these cluster stats do not meet the minimum, this is a finding. \"\n  tag \"fix\": \"Elastic components should be installed on multiple physical and\nrack separated machines to ensure application built to handle failures.\n\nSee the official documentation for RPM installation at:\nhttps://www.elastic.co/guide/en/elasticsearch/reference/current/rpm.html\"\n\n  begin\n\n    es_handle = es_helper(url:\"https://#{ELASTIC_IP}:#{ELASTIC_PORT}\",\n                    username: ES_ADMIN,\n                    password: ES_PASS,\n                    ssl_verify: SSL_VERIFY )\n\n    describe \"No nodes found\" do\n      subject { es_handle.nodes.nil? }\n      it { should_not be_truthy }\n    end if es_handle.nodes.nil?\n\n\n    describe \"For the cluster total nodes\" do\n      subject { es_handle.cluster_stats['nodes']['count']['total'] }\n      it { should cmp >= 3 }\n    end\n\n    describe \"For the cluster data nodes\" do\n      subject { es_handle.cluster_stats['nodes']['count']['data'] }\n      it { should cmp >= 2 }\n    end\n\n    describe \"For the cluster replication minimum\" do\n      subject { es_handle.cluster_stats['indices']['shards']['index']['replication']['min'] }\n      it { should cmp >= 1 }\n    end\n\n  rescue Exception => msg\n    describe \"Exception: #{msg}\" do\n      it { should be_nil}\n    end\n  end\nend\n",
          "source_location": {
            "line": 35,
            "ref": "../elasticsearch-inspec/controls/nodes/V-27021.rb"
          },
          "results": [
            {
              "status": "failed",
              "code_desc": "For the cluster total nodes should cmp >= 3",
              "run_time": 0.080874,
              "start_time": "2018-02-11 14:26:23 -0500"
            },
            {
              "status": "failed",
              "code_desc": "For the cluster data nodes should cmp >= 2",
              "run_time": 0.08309,
              "start_time": "2018-02-11 14:26:24 -0500"
            },
            {
              "status": "failed",
              "code_desc": "For the cluster replication minimum should cmp >= 1",
              "run_time": 0.079287,
              "start_time": "2018-02-11 14:26:24 -0500"
            }
          ]
        },
        {
          "id": "V-27062",
          "title": "Applications must maintain the confidentiality of information during\naggregation, packaging, and transformation in preparation for transmission.\nWhen transmitting data, applications need to leverage transmission protection\nmechanisms such as TLS, SSL VPNs, or IPSEC.  ",
          "desc": "Use SSL / TLS communication for all networked access to Elasticsearch\nand connected components such as Kibana and Logstash.  X-Pack Security should\nbe configured with organizational approved cryptography.",
          "impact": 0.5,
          "refs": [],
          "tags": {
            "nist": [
              "SC-9 (2)",
              "Rev_3"
            ],
            "severity": "medium",
            "rid": "SV-34357r1_rule",
            "gtitle": "SRG-APP-000230",
            "cci": "CCI-001132",
            "check": "Application must utilize approved cryptography to protect data\ntransmission.\n\nAs the application administrator (usually elasticsearch), check the xpack.ssl\nsettings are set to the correct values.\n\n$cat elasticsearch.yml | grep xpack.ssl\n\nxpack.ssl.key:                     <server_key>.key\nxpack.ssl.certificate:             <server_certificate>.crt\nxpack.ssl.certificate_authorities: [ <approved_ca>.crt' ]\n\nIf these setting are not set or the underlying certificate and keys are not\ncorrect, this is a finding.\n\n$cat elasticsearch.yml | grep xpack.security.http.ssl.enabled:\n\nIf this setting is set to false, this is a finding.\n\n$cat elasticsearch.yml | grep xpack.security.transport.ssl.enabled:\n\nIf this setting is set to false, this is a finding.\n\nAs a elasticsearch user, check that non-secure http traffic does not response\nwith 200 status:\n\n$curl -H 'Content-Type: application/json' -u <TEST_USER> -p <TEST_CREDENTIALS>\nhttp://<elasticsearchIP:9200>/\n\nIf a 200 response comes back, this is a finding.",
            "fix": "Implement protective measures during data transmission.\n\n See the official documentation for the complete  guide on establishing SSL\nconfiguration: https://www.elastic.co/guide/en/x-pack/current/ssl-tls.html"
          },
          "code": "control \"V-27062\" do\n  title \"Applications must maintain the confidentiality of information during\naggregation, packaging, and transformation in preparation for transmission.\nWhen transmitting data, applications need to leverage transmission protection\nmechanisms such as TLS, SSL VPNs, or IPSEC.  \"\n  desc  \"Use SSL / TLS communication for all networked access to Elasticsearch\nand connected components such as Kibana and Logstash.  X-Pack Security should\nbe configured with organizational approved cryptography.\"\n  impact 0.5\n  tag \"nist\": [\"SC-9 (2)\", \"Rev_3\"]\n  tag \"severity\": \"medium\"\n  tag \"rid\": \"SV-34357r1_rule\"\n  tag \"gtitle\": \"SRG-APP-000230\"\n  tag \"cci\": \"CCI-001132\"\n  tag \"check\": \"Application must utilize approved cryptography to protect data\ntransmission.\n\nAs the application administrator (usually elasticsearch), check the xpack.ssl\nsettings are set to the correct values.\n\n$cat elasticsearch.yml | grep xpack.ssl\n\nxpack.ssl.key:                     <server_key>.key\nxpack.ssl.certificate:             <server_certificate>.crt\nxpack.ssl.certificate_authorities: [ <approved_ca>.crt' ]\n\nIf these setting are not set or the underlying certificate and keys are not\ncorrect, this is a finding.\n\n$cat elasticsearch.yml | grep xpack.security.http.ssl.enabled:\n\nIf this setting is set to false, this is a finding.\n\n$cat elasticsearch.yml | grep xpack.security.transport.ssl.enabled:\n\nIf this setting is set to false, this is a finding.\n\nAs a elasticsearch user, check that non-secure http traffic does not response\nwith 200 status:\n\n$curl -H 'Content-Type: application/json' -u <TEST_USER> -p <TEST_CREDENTIALS>\nhttp://<elasticsearchIP:9200>/\n\nIf a 200 response comes back, this is a finding.\"\n  tag \"fix\": \"Implement protective measures during data transmission.\n\n See the official documentation for the complete  guide on establishing SSL\nconfiguration: https://www.elastic.co/guide/en/x-pack/current/ssl-tls.html\"\n\n  begin\n    es_handle = es_helper(url:\"https://#{ELASTIC_IP}:#{ELASTIC_PORT}\",\n                    username: ES_ADMIN,\n                    password: ES_PASS,\n                    ssl_verify: SSL_VERIFY )\n\n    describe \"No nodes found\" do\n      subject { es_handle.nodes.nil? }\n      it { should_not be_truthy }\n    end if es_handle.nodes.nil?\n\n    es_handle.nodes.each do |node|\n      describe \"SSL Settings for Node: #{node.name}\" do\n        subject { node }\n        its(\"http_ssl.enabled\") { should eq 'true' }\n        its(\"transport_ssl.enabled\") { should eq 'true' }\n      end\n    end unless es_handle.nodes.nil?\n\n    describe yaml(ELASTICSEARCH_CONF) do\n      its(['xpack.ssl.key']) { should_not be_nil }\n      its(['xpack.ssl.certificate']) { should_not be_nil }\n      its(['xpack.ssl.certificate_authorities']) { should_not be_nil }\n      its(['xpack.security.http.ssl.enabled']) { should eq true }\n      its(['xpack.security.transport.ssl.enabled']) { should eq true }\n    end\n\n    describe command(\"openssl rsa -in #{yaml(ELASTICSEARCH_CONF)['xpack.ssl.key']} -check -noout\") do\n      its('stdout'){ should match /RSA key ok/ }\n    end\n\n    describe x509_certificate(yaml(ELASTICSEARCH_CONF)['xpack.ssl.certificate']) do\n      it { should be_certificate }\n      it { should be_valid }\n    end\n\n    if yaml(ELASTICSEARCH_CONF)['xpack.ssl.certificate_authorities'].is_a?(Array)\n      yaml(ELASTICSEARCH_CONF)['xpack.ssl.certificate_authorities'].each do |cert|\n        describe x509_certificate(cert) do\n          it { should be_certificate }\n          it { should be_valid }\n        end\n      end\n    else\n      describe x509_certificate(yaml(ELASTICSEARCH_CONF)['xpack.ssl.certificate_authorities']) do\n        it { should be_certificate }\n        it { should be_valid }\n      end\n    end\n\n    describe es_handle do \n      it { should_not have_http_access }\n    end\n\n  rescue Exception => msg\n    describe \"Exception: #{msg}\" do\n      it { should be_nil}\n    end\n  end\nend\n",
          "source_location": {
            "line": 42,
            "ref": "../elasticsearch-inspec/controls/ssl+tsl+certs+http/V-27062.rb"
          },
          "results": [
            {
              "status": "passed",
              "code_desc": "SSL Settings for Node: package-centos-72 http_ssl.enabled should eq \"true\"",
              "run_time": 0.000135,
              "start_time": "2018-02-11 14:26:24 -0500"
            },
            {
              "status": "passed",
              "code_desc": "SSL Settings for Node: package-centos-72 transport_ssl.enabled should eq \"true\"",
              "run_time": 0.000079,
              "start_time": "2018-02-11 14:26:24 -0500"
            },
            {
              "status": "passed",
              "code_desc": "YAML /etc/elasticsearch/elasticsearch.yml [\"xpack.ssl.key\"] should not be nil",
              "run_time": 0.000082,
              "start_time": "2018-02-11 14:26:24 -0500"
            },
            {
              "status": "passed",
              "code_desc": "YAML /etc/elasticsearch/elasticsearch.yml [\"xpack.ssl.certificate\"] should not be nil",
              "run_time": 0.000065,
              "start_time": "2018-02-11 14:26:24 -0500"
            },
            {
              "status": "passed",
              "code_desc": "YAML /etc/elasticsearch/elasticsearch.yml [\"xpack.ssl.certificate_authorities\"] should not be nil",
              "run_time": 0.000072,
              "start_time": "2018-02-11 14:26:24 -0500"
            },
            {
              "status": "passed",
              "code_desc": "YAML /etc/elasticsearch/elasticsearch.yml [\"xpack.security.http.ssl.enabled\"] should eq true",
              "run_time": 0.000074,
              "start_time": "2018-02-11 14:26:24 -0500"
            },
            {
              "status": "passed",
              "code_desc": "YAML /etc/elasticsearch/elasticsearch.yml [\"xpack.security.transport.ssl.enabled\"] should eq true",
              "run_time": 0.000085,
              "start_time": "2018-02-11 14:26:24 -0500"
            },
            {
              "status": "passed",
              "code_desc": "Command openssl rsa -in /etc/elasticsearch/x-pack/elastic/elastic.key -check -noout stdout should match /RSA key ok/",
              "run_time": 0.018211,
              "start_time": "2018-02-11 14:26:24 -0500"
            },
            {
              "status": "passed",
              "code_desc": "x509_certificate /etc/elasticsearch/x-pack/elastic/elastic.crt should be certificate",
              "run_time": 0.000098,
              "start_time": "2018-02-11 14:26:24 -0500"
            },
            {
              "status": "passed",
              "code_desc": "x509_certificate /etc/elasticsearch/x-pack/elastic/elastic.crt should be valid",
              "run_time": 0.00008,
              "start_time": "2018-02-11 14:26:24 -0500"
            },
            {
              "status": "passed",
              "code_desc": "x509_certificate /etc/elasticsearch/x-pack/ca/ca.crt should be certificate",
              "run_time": 0.000061,
              "start_time": "2018-02-11 14:26:24 -0500"
            },
            {
              "status": "passed",
              "code_desc": "x509_certificate /etc/elasticsearch/x-pack/ca/ca.crt should be valid",
              "run_time": 0.000062,
              "start_time": "2018-02-11 14:26:24 -0500"
            },
            {
              "status": "passed",
              "code_desc": "Elasticsearch Cluster https://0.0.0.0:9200 should not have http access",
              "run_time": 0.020185,
              "start_time": "2018-02-11 14:26:24 -0500"
            }
          ]
        },
        {
          "id": "V-26910",
          "title": "Applications managing devices must authenticate devices before\nestablishing remote network connections using bidirectional authentication\nbetween devices that are cryptographically based.",
          "desc": "Use SSL / TLS communication for all networked access to Elasticsearch\nand connected components such as Kibana and Logstash.  X-Pack Security should\nbe configured with organizational approved cryptography.",
          "impact": 0.5,
          "refs": [],
          "tags": {
            "nist": [
              "IA-3 (1)",
              "Rev_3"
            ],
            "severity": "medium",
            "rid": "SV-34190r1_rule",
            "gtitle": "SRG-APP-000159",
            "cci": "CCI-000779",
            "check": "Application must utilize bidirectional authentication for\ncryptographic device communication.\n\nAs the application administrator (usually elasticsearch), check the xpack.ssl\nsettings are set to the correct values.\n\n$cat elasticsearch.yml | grep xpack.ssl\n\nxpack.ssl.key:                     <server_key>.key\nxpack.ssl.certificate:             <server_certificate>.crt\nxpack.ssl.certificate_authorities: [ <approved_ca>.crt' ]\n\nIf these setting are not set or the underlying certificate and keys are not\ncorrect, this is a finding.\n\n$cat elasticsearch.yml | grep xpack.security.http.ssl.enabled:\n\nIf this setting is set to false, this is a finding.\n\n$cat elasticsearch.yml | grep xpack.security.transport.ssl.enabled:\n\nIf this setting is set to false, this is a finding.\n\nAs a elasticsearch user, check that non-secure http traffic does not response\nwith 200 status:\n\n$curl -H 'Content-Type: application/json' -u <TEST_USER> -p <TEST_CREDENTIALS>\nhttp://<elasticsearchIP:9200>/\n\nIf a 200 response comes back, this is a finding.",
            "fix": "Implement bidirectional (client-server handshake) for\nestablishing cryptographic communication.\n\n See the official documentation for the complete  guide on establishing SSL\nconfiguration: https://www.elastic.co/guide/en/x-pack/current/ssl-tls.html"
          },
          "code": "control \"V-26910\" do\n  title \"Applications managing devices must authenticate devices before\nestablishing remote network connections using bidirectional authentication\nbetween devices that are cryptographically based.\"\n  desc  \"Use SSL / TLS communication for all networked access to Elasticsearch\nand connected components such as Kibana and Logstash.  X-Pack Security should\nbe configured with organizational approved cryptography.\"\n  impact 0.5\n  tag \"nist\": [\"IA-3 (1)\", \"Rev_3\"]\n  tag \"severity\": \"medium\"\n  tag \"rid\": \"SV-34190r1_rule\"\n  tag \"gtitle\": \"SRG-APP-000159\"\n  tag \"cci\": \"CCI-000779\"\n  tag \"check\": \"Application must utilize bidirectional authentication for\ncryptographic device communication.\n\nAs the application administrator (usually elasticsearch), check the xpack.ssl\nsettings are set to the correct values.\n\n$cat elasticsearch.yml | grep xpack.ssl\n\nxpack.ssl.key:                     <server_key>.key\nxpack.ssl.certificate:             <server_certificate>.crt\nxpack.ssl.certificate_authorities: [ <approved_ca>.crt' ]\n\nIf these setting are not set or the underlying certificate and keys are not\ncorrect, this is a finding.\n\n$cat elasticsearch.yml | grep xpack.security.http.ssl.enabled:\n\nIf this setting is set to false, this is a finding.\n\n$cat elasticsearch.yml | grep xpack.security.transport.ssl.enabled:\n\nIf this setting is set to false, this is a finding.\n\nAs a elasticsearch user, check that non-secure http traffic does not response\nwith 200 status:\n\n$curl -H 'Content-Type: application/json' -u <TEST_USER> -p <TEST_CREDENTIALS>\nhttp://<elasticsearchIP:9200>/\n\nIf a 200 response comes back, this is a finding.\"\n  tag \"fix\": \"Implement bidirectional (client-server handshake) for\nestablishing cryptographic communication.\n\n See the official documentation for the complete  guide on establishing SSL\nconfiguration: https://www.elastic.co/guide/en/x-pack/current/ssl-tls.html\"\n\n\n  begin\n    es_handle = es_helper(url:\"https://#{ELASTIC_IP}:#{ELASTIC_PORT}\",\n                    username: ES_ADMIN,\n                    password: ES_PASS,\n                    ssl_verify: SSL_VERIFY )\n\n    describe \"No nodes found\" do\n      subject { es_handle.nodes.nil? }\n      it { should_not be_truthy }\n    end if es_handle.nodes.nil?\n\n    es_handle.nodes.each do |node|\n      describe \"SSL Settings for Node: #{node.name}\" do\n        subject { node }\n        its(\"http_ssl.enabled\") { should eq 'true' }\n        its(\"transport_ssl.enabled\") { should eq 'true' }\n      end\n    end unless es_handle.nodes.nil?\n\n    describe yaml(ELASTICSEARCH_CONF) do\n      its(['xpack.ssl.key']) { should_not be_nil }\n      its(['xpack.ssl.certificate']) { should_not be_nil }\n      its(['xpack.ssl.certificate_authorities']) { should_not be_nil }\n      its(['xpack.security.http.ssl.enabled']) { should eq true }\n      its(['xpack.security.transport.ssl.enabled']) { should eq true }\n    end\n\n    describe command(\"openssl rsa -in #{yaml(ELASTICSEARCH_CONF)['xpack.ssl.key']} -check -noout\") do\n      its('stdout'){ should match /RSA key ok/ }\n    end\n\n    describe x509_certificate(yaml(ELASTICSEARCH_CONF)['xpack.ssl.certificate']) do\n      it { should be_certificate }\n      it { should be_valid }\n    end\n\n    if yaml(ELASTICSEARCH_CONF)['xpack.ssl.certificate_authorities'].is_a?(Array)\n      yaml(ELASTICSEARCH_CONF)['xpack.ssl.certificate_authorities'].each do |cert|\n        describe x509_certificate(cert) do\n          it { should be_certificate }\n          it { should be_valid }\n        end\n      end\n    else\n      describe x509_certificate(yaml(ELASTICSEARCH_CONF)['xpack.ssl.certificate_authorities']) do\n        it { should be_certificate }\n        it { should be_valid }\n      end\n    end\n\n    describe es_handle do \n      it { should_not have_http_access }\n    end\n\n  rescue Exception => msg\n    describe \"Exception: #{msg}\" do\n      it { should be_nil}\n    end\n  end\nend\n",
          "source_location": {
            "line": 41,
            "ref": "../elasticsearch-inspec/controls/ssl+tsl+certs+http/V-26910.rb"
          },
          "results": [
            {
              "status": "passed",
              "code_desc": "SSL Settings for Node: package-centos-72 http_ssl.enabled should eq \"true\"",
              "run_time": 0.000193,
              "start_time": "2018-02-11 14:26:24 -0500"
            },
            {
              "status": "passed",
              "code_desc": "SSL Settings for Node: package-centos-72 transport_ssl.enabled should eq \"true\"",
              "run_time": 0.000108,
              "start_time": "2018-02-11 14:26:24 -0500"
            },
            {
              "status": "passed",
              "code_desc": "YAML /etc/elasticsearch/elasticsearch.yml [\"xpack.ssl.key\"] should not be nil",
              "run_time": 0.000096,
              "start_time": "2018-02-11 14:26:24 -0500"
            },
            {
              "status": "passed",
              "code_desc": "YAML /etc/elasticsearch/elasticsearch.yml [\"xpack.ssl.certificate\"] should not be nil",
              "run_time": 0.00011,
              "start_time": "2018-02-11 14:26:24 -0500"
            },
            {
              "status": "passed",
              "code_desc": "YAML /etc/elasticsearch/elasticsearch.yml [\"xpack.ssl.certificate_authorities\"] should not be nil",
              "run_time": 0.000076,
              "start_time": "2018-02-11 14:26:24 -0500"
            },
            {
              "status": "passed",
              "code_desc": "YAML /etc/elasticsearch/elasticsearch.yml [\"xpack.security.http.ssl.enabled\"] should eq true",
              "run_time": 0.000091,
              "start_time": "2018-02-11 14:26:24 -0500"
            },
            {
              "status": "passed",
              "code_desc": "YAML /etc/elasticsearch/elasticsearch.yml [\"xpack.security.transport.ssl.enabled\"] should eq true",
              "run_time": 0.000179,
              "start_time": "2018-02-11 14:26:24 -0500"
            },
            {
              "status": "passed",
              "code_desc": "Command openssl rsa -in /etc/elasticsearch/x-pack/elastic/elastic.key -check -noout stdout should match /RSA key ok/",
              "run_time": 0.020445,
              "start_time": "2018-02-11 14:26:24 -0500"
            },
            {
              "status": "passed",
              "code_desc": "x509_certificate /etc/elasticsearch/x-pack/elastic/elastic.crt should be certificate",
              "run_time": 0.000111,
              "start_time": "2018-02-11 14:26:24 -0500"
            },
            {
              "status": "passed",
              "code_desc": "x509_certificate /etc/elasticsearch/x-pack/elastic/elastic.crt should be valid",
              "run_time": 0.000081,
              "start_time": "2018-02-11 14:26:24 -0500"
            },
            {
              "status": "passed",
              "code_desc": "x509_certificate /etc/elasticsearch/x-pack/ca/ca.crt should be certificate",
              "run_time": 0.000084,
              "start_time": "2018-02-11 14:26:24 -0500"
            },
            {
              "status": "passed",
              "code_desc": "x509_certificate /etc/elasticsearch/x-pack/ca/ca.crt should be valid",
              "run_time": 0.000065,
              "start_time": "2018-02-11 14:26:24 -0500"
            },
            {
              "status": "passed",
              "code_desc": "Elasticsearch Cluster https://0.0.0.0:9200 should not have http access",
              "run_time": 0.018273,
              "start_time": "2018-02-11 14:26:24 -0500"
            }
          ]
        },
        {
          "id": "V-27063",
          "title": "The application must check the validity of data inputs.",
          "desc": "Dynamic templates allows for user input to be processed without\nverifying it against a set of expected values. Turning off dynamic templates,\nand creating templates for input can handle type validation.",
          "impact": 0.5,
          "refs": [],
          "tags": {
            "nist": [
              "SI-10",
              "Rev_4"
            ],
            "severity": "medium",
            "rid": "SV-34358r1_rule",
            "gtitle": "SRG-APP-000251",
            "cci": "CCI-001310",
            "check": "Application must utilize approved cryptography to validate data\ninput.\n\nAs the application administrator (usually elasticsearch), check the xpack.ssl\nsettings are set to the correct values.\n\n$cat elasticsearch.yml | grep xpack.ssl\n\nxpack.ssl.key:                     <server_key>.key\nxpack.ssl.certificate:             <server_certificate>.crt\nxpack.ssl.certificate_authorities: [ <approved_ca>.crt' ]\n\nIf these setting are not set or the underlying certificate and keys are not\ncorrect, this is a finding.\n\n$cat elasticsearch.yml | grep xpack.security.http.ssl.enabled\n\nIf this setting is set to false, this is a finding.\n\n$cat elasticsearch.yml | grep xpack.security.transport.ssl.enabled\n\nIf this setting is set to false, this is a finding.\n\nAs a elasticsearch user, check that non-secure http traffic does not response\nwith 200 status:\n\n$curl -H 'Content-Type: application/json' -u <TEST_USER> -p <TEST_CREDENTIALS>\nhttp://<elasticsearchIP:9200>/\n\nIf a 200 response comes back, this is a finding.",
            "fix": "Implement protective measures to validate data inputs.\n\n See the official documentation for the complete  guide on establishing SSL\nconfiguration: https://www.elastic.co/guide/en/x-pack/current/ssl-tls.html"
          },
          "code": "control \"V-27063\" do\n  title \"The application must check the validity of data inputs.\"\n  desc  \"Dynamic templates allows for user input to be processed without\nverifying it against a set of expected values. Turning off dynamic templates,\nand creating templates for input can handle type validation.\"\n  impact 0.5\n  tag \"nist\": [\"SI-10\", \"Rev_4\"]\n  tag \"severity\": \"medium\"\n  tag \"rid\": \"SV-34358r1_rule\"\n  tag \"gtitle\": \"SRG-APP-000251\"\n  tag \"cci\": \"CCI-001310\"\n  tag \"check\": \"Application must utilize approved cryptography to validate data\ninput.\n\nAs the application administrator (usually elasticsearch), check the xpack.ssl\nsettings are set to the correct values.\n\n$cat elasticsearch.yml | grep xpack.ssl\n\nxpack.ssl.key:                     <server_key>.key\nxpack.ssl.certificate:             <server_certificate>.crt\nxpack.ssl.certificate_authorities: [ <approved_ca>.crt' ]\n\nIf these setting are not set or the underlying certificate and keys are not\ncorrect, this is a finding.\n\n$cat elasticsearch.yml | grep xpack.security.http.ssl.enabled\n\nIf this setting is set to false, this is a finding.\n\n$cat elasticsearch.yml | grep xpack.security.transport.ssl.enabled\n\nIf this setting is set to false, this is a finding.\n\nAs a elasticsearch user, check that non-secure http traffic does not response\nwith 200 status:\n\n$curl -H 'Content-Type: application/json' -u <TEST_USER> -p <TEST_CREDENTIALS>\nhttp://<elasticsearchIP:9200>/\n\nIf a 200 response comes back, this is a finding.\"\n  tag \"fix\": \"Implement protective measures to validate data inputs.\n\n See the official documentation for the complete  guide on establishing SSL\nconfiguration: https://www.elastic.co/guide/en/x-pack/current/ssl-tls.html\"\n\n  begin\n    es_handle = es_helper(url:\"https://#{ELASTIC_IP}:#{ELASTIC_PORT}\",\n                    username: ES_ADMIN,\n                    password: ES_PASS,\n                    ssl_verify: SSL_VERIFY )\n\n    describe \"No nodes found\" do\n      subject { es_handle.nodes.nil? }\n      it { should_not be_truthy }\n    end if es_handle.nodes.nil?\n\n    es_handle.nodes.each do |node|\n      describe \"SSL Settings for Node: #{node.name}\" do\n        subject { node }\n        its(\"http_ssl.enabled\") { should eq 'true' }\n        its(\"transport_ssl.enabled\") { should eq 'true' }\n      end\n    end unless es_handle.nodes.nil?\n\n    describe yaml(ELASTICSEARCH_CONF) do\n      its(['xpack.ssl.key']) { should_not be_nil }\n      its(['xpack.ssl.certificate']) { should_not be_nil }\n      its(['xpack.ssl.certificate_authorities']) { should_not be_nil }\n      its(['xpack.security.http.ssl.enabled']) { should eq true }\n      its(['xpack.security.transport.ssl.enabled']) { should eq true }\n    end\n\n    describe command(\"openssl rsa -in #{yaml(ELASTICSEARCH_CONF)['xpack.ssl.key']} -check -noout\") do\n      its('stdout'){ should match /RSA key ok/ }\n    end\n\n    describe x509_certificate(yaml(ELASTICSEARCH_CONF)['xpack.ssl.certificate']) do\n      it { should be_certificate }\n      it { should be_valid }\n    end\n\n    if yaml(ELASTICSEARCH_CONF)['xpack.ssl.certificate_authorities'].is_a?(Array)\n      yaml(ELASTICSEARCH_CONF)['xpack.ssl.certificate_authorities'].each do |cert|\n        describe x509_certificate(cert) do\n          it { should be_certificate }\n          it { should be_valid }\n        end\n      end\n    else\n      describe x509_certificate(yaml(ELASTICSEARCH_CONF)['xpack.ssl.certificate_authorities']) do\n        it { should be_certificate }\n        it { should be_valid }\n      end\n    end\n\n    describe es_handle do \n      it { should_not have_http_access }\n    end\n\n  rescue Exception => msg\n    describe \"Exception: #{msg}\" do\n      it { should be_nil}\n    end\n  end\nend\n",
          "source_location": {
            "line": 41,
            "ref": "../elasticsearch-inspec/controls/ssl+tsl+certs+http/V-27063.rb"
          },
          "results": [
            {
              "status": "passed",
              "code_desc": "SSL Settings for Node: package-centos-72 http_ssl.enabled should eq \"true\"",
              "run_time": 0.000116,
              "start_time": "2018-02-11 14:26:24 -0500"
            },
            {
              "status": "passed",
              "code_desc": "SSL Settings for Node: package-centos-72 transport_ssl.enabled should eq \"true\"",
              "run_time": 0.00008,
              "start_time": "2018-02-11 14:26:24 -0500"
            },
            {
              "status": "passed",
              "code_desc": "YAML /etc/elasticsearch/elasticsearch.yml [\"xpack.ssl.key\"] should not be nil",
              "run_time": 0.000069,
              "start_time": "2018-02-11 14:26:24 -0500"
            },
            {
              "status": "passed",
              "code_desc": "YAML /etc/elasticsearch/elasticsearch.yml [\"xpack.ssl.certificate\"] should not be nil",
              "run_time": 0.000071,
              "start_time": "2018-02-11 14:26:24 -0500"
            },
            {
              "status": "passed",
              "code_desc": "YAML /etc/elasticsearch/elasticsearch.yml [\"xpack.ssl.certificate_authorities\"] should not be nil",
              "run_time": 0.000057,
              "start_time": "2018-02-11 14:26:24 -0500"
            },
            {
              "status": "passed",
              "code_desc": "YAML /etc/elasticsearch/elasticsearch.yml [\"xpack.security.http.ssl.enabled\"] should eq true",
              "run_time": 0.000062,
              "start_time": "2018-02-11 14:26:24 -0500"
            },
            {
              "status": "passed",
              "code_desc": "YAML /etc/elasticsearch/elasticsearch.yml [\"xpack.security.transport.ssl.enabled\"] should eq true",
              "run_time": 0.000064,
              "start_time": "2018-02-11 14:26:24 -0500"
            },
            {
              "status": "passed",
              "code_desc": "Command openssl rsa -in /etc/elasticsearch/x-pack/elastic/elastic.key -check -noout stdout should match /RSA key ok/",
              "run_time": 0.019149,
              "start_time": "2018-02-11 14:26:24 -0500"
            },
            {
              "status": "passed",
              "code_desc": "x509_certificate /etc/elasticsearch/x-pack/elastic/elastic.crt should be certificate",
              "run_time": 0.000108,
              "start_time": "2018-02-11 14:26:24 -0500"
            },
            {
              "status": "passed",
              "code_desc": "x509_certificate /etc/elasticsearch/x-pack/elastic/elastic.crt should be valid",
              "run_time": 0.000107,
              "start_time": "2018-02-11 14:26:24 -0500"
            },
            {
              "status": "passed",
              "code_desc": "x509_certificate /etc/elasticsearch/x-pack/ca/ca.crt should be certificate",
              "run_time": 0.000071,
              "start_time": "2018-02-11 14:26:24 -0500"
            },
            {
              "status": "passed",
              "code_desc": "x509_certificate /etc/elasticsearch/x-pack/ca/ca.crt should be valid",
              "run_time": 0.000073,
              "start_time": "2018-02-11 14:26:24 -0500"
            },
            {
              "status": "passed",
              "code_desc": "Elasticsearch Cluster https://0.0.0.0:9200 should not have http access",
              "run_time": 0.020692,
              "start_time": "2018-02-11 14:26:24 -0500"
            }
          ]
        },
        {
          "id": "V-26954",
          "title": "The application must employ strong identification and authentication\ntechniques when establishing non-local maintenance and diagnostic sessions",
          "desc": "Configure X-Pack Security to use an organizational approved FIPS 140-2\njava cryptography provider.",
          "impact": 0.5,
          "refs": [],
          "tags": {
            "nist": [
              "MA-4 c",
              "Rev_4"
            ],
            "severity": "medium",
            "rid": "SV-34237r1_rule",
            "gtitle": "SRG-APP-000185",
            "cci": "CCI-000877",
            "check": "Application must utilize approved cryptography to establish\nstrong identification and authentication techniques.\n\nAs the application administrator (usually elasticsearch), check the xpack.ssl\nsettings are set to the correct values.\n\n$cat elasticsearch.yml | grep xpack.ssl\n\nxpack.ssl.key:                     <server_key>.key\nxpack.ssl.certificate:             <server_certificate>.crt\nxpack.ssl.certificate_authorities: [ <approved_ca>.crt' ]\n\nIf these setting are not set or the underlying certificate and keys are not\ncorrect, this is a finding.\n\n$cat elasticsearch.yml | grep xpack.security.http.ssl.enabled:\n\nIf this setting is set to false, this is a finding.\n\n$cat elasticsearch.yml | grep xpack.security.transport.ssl.enabled:\n\nIf this setting is set to false, this is a finding.\n\nAs a elasticsearch user, check that non-secure http traffic does not response\nwith 200 status:\n\n$curl -H 'Content-Type: application/json' -u <TEST_USER> -p <TEST_CREDENTIALS>\nhttp://<elasticsearchIP:9200>/\n\nIf a 200 response comes back, this is a finding.",
            "fix": "Implement protective measures when identifying and authenticating\nnon-local sessions.\n\n See the official documentation for the complete  guide on establishing SSL\nconfiguration: https://www.elastic.co/guide/en/x-pack/current/ssl-tls.html"
          },
          "code": "control \"V-26954\" do\n  title \"The application must employ strong identification and authentication\ntechniques when establishing non-local maintenance and diagnostic sessions\"\n  desc  \"Configure X-Pack Security to use an organizational approved FIPS 140-2\njava cryptography provider.\"\n  impact 0.5\n  tag \"nist\": [\"MA-4 c\", \"Rev_4\"]\n  tag \"severity\": \"medium\"\n  tag \"rid\": \"SV-34237r1_rule\"\n  tag \"gtitle\": \"SRG-APP-000185\"\n  tag \"cci\": \"CCI-000877\"\n  tag \"check\": \"Application must utilize approved cryptography to establish\nstrong identification and authentication techniques.\n\nAs the application administrator (usually elasticsearch), check the xpack.ssl\nsettings are set to the correct values.\n\n$cat elasticsearch.yml | grep xpack.ssl\n\nxpack.ssl.key:                     <server_key>.key\nxpack.ssl.certificate:             <server_certificate>.crt\nxpack.ssl.certificate_authorities: [ <approved_ca>.crt' ]\n\nIf these setting are not set or the underlying certificate and keys are not\ncorrect, this is a finding.\n\n$cat elasticsearch.yml | grep xpack.security.http.ssl.enabled:\n\nIf this setting is set to false, this is a finding.\n\n$cat elasticsearch.yml | grep xpack.security.transport.ssl.enabled:\n\nIf this setting is set to false, this is a finding.\n\nAs a elasticsearch user, check that non-secure http traffic does not response\nwith 200 status:\n\n$curl -H 'Content-Type: application/json' -u <TEST_USER> -p <TEST_CREDENTIALS>\nhttp://<elasticsearchIP:9200>/\n\nIf a 200 response comes back, this is a finding.\"\n  tag \"fix\": \"Implement protective measures when identifying and authenticating\nnon-local sessions.\n\n See the official documentation for the complete  guide on establishing SSL\nconfiguration: https://www.elastic.co/guide/en/x-pack/current/ssl-tls.html\"\n\n  begin\n    es_handle = es_helper(url:\"https://#{ELASTIC_IP}:#{ELASTIC_PORT}\",\n                    username: ES_ADMIN,\n                    password: ES_PASS,\n                    ssl_verify: SSL_VERIFY )\n\n    describe \"No nodes found\" do\n      subject { es_handle.nodes.nil? }\n      it { should_not be_truthy }\n    end if es_handle.nodes.nil?\n\n    es_handle.nodes.each do |node|\n      describe \"SSL Settings for Node: #{node.name}\" do\n        subject { node }\n        its(\"http_ssl.enabled\") { should eq 'true' }\n        its(\"transport_ssl.enabled\") { should eq 'true' }\n      end\n    end unless es_handle.nodes.nil?\n\n    describe yaml(ELASTICSEARCH_CONF) do\n      its(['xpack.ssl.key']) { should_not be_nil }\n      its(['xpack.ssl.certificate']) { should_not be_nil }\n      its(['xpack.ssl.certificate_authorities']) { should_not be_nil }\n      its(['xpack.security.http.ssl.enabled']) { should eq true }\n      its(['xpack.security.transport.ssl.enabled']) { should eq true }\n    end\n\n    describe command(\"openssl rsa -in #{yaml(ELASTICSEARCH_CONF)['xpack.ssl.key']} -check -noout\") do\n      its('stdout'){ should match /RSA key ok/ }\n    end\n\n    describe x509_certificate(yaml(ELASTICSEARCH_CONF)['xpack.ssl.certificate']) do\n      it { should be_certificate }\n      it { should be_valid }\n    end\n\n    if yaml(ELASTICSEARCH_CONF)['xpack.ssl.certificate_authorities'].is_a?(Array)\n      yaml(ELASTICSEARCH_CONF)['xpack.ssl.certificate_authorities'].each do |cert|\n        describe x509_certificate(cert) do\n          it { should be_certificate }\n          it { should be_valid }\n        end\n      end\n    else\n      describe x509_certificate(yaml(ELASTICSEARCH_CONF)['xpack.ssl.certificate_authorities']) do\n        it { should be_certificate }\n        it { should be_valid }\n      end\n    end\n\n    describe es_handle do \n      it { should_not have_http_access }\n    end\n\n  rescue Exception => msg\n    describe \"Exception: #{msg}\" do\n      it { should be_nil}\n    end\n  end\nend\n",
          "source_location": {
            "line": 41,
            "ref": "../elasticsearch-inspec/controls/ssl+tsl+certs+http/V-26954.rb"
          },
          "results": [
            {
              "status": "passed",
              "code_desc": "SSL Settings for Node: package-centos-72 http_ssl.enabled should eq \"true\"",
              "run_time": 0.000125,
              "start_time": "2018-02-11 14:26:24 -0500"
            },
            {
              "status": "passed",
              "code_desc": "SSL Settings for Node: package-centos-72 transport_ssl.enabled should eq \"true\"",
              "run_time": 0.000084,
              "start_time": "2018-02-11 14:26:24 -0500"
            },
            {
              "status": "passed",
              "code_desc": "YAML /etc/elasticsearch/elasticsearch.yml [\"xpack.ssl.key\"] should not be nil",
              "run_time": 0.000078,
              "start_time": "2018-02-11 14:26:24 -0500"
            },
            {
              "status": "passed",
              "code_desc": "YAML /etc/elasticsearch/elasticsearch.yml [\"xpack.ssl.certificate\"] should not be nil",
              "run_time": 0.000067,
              "start_time": "2018-02-11 14:26:24 -0500"
            },
            {
              "status": "passed",
              "code_desc": "YAML /etc/elasticsearch/elasticsearch.yml [\"xpack.ssl.certificate_authorities\"] should not be nil",
              "run_time": 0.000079,
              "start_time": "2018-02-11 14:26:24 -0500"
            },
            {
              "status": "passed",
              "code_desc": "YAML /etc/elasticsearch/elasticsearch.yml [\"xpack.security.http.ssl.enabled\"] should eq true",
              "run_time": 0.000071,
              "start_time": "2018-02-11 14:26:24 -0500"
            },
            {
              "status": "passed",
              "code_desc": "YAML /etc/elasticsearch/elasticsearch.yml [\"xpack.security.transport.ssl.enabled\"] should eq true",
              "run_time": 0.000071,
              "start_time": "2018-02-11 14:26:24 -0500"
            },
            {
              "status": "passed",
              "code_desc": "Command openssl rsa -in /etc/elasticsearch/x-pack/elastic/elastic.key -check -noout stdout should match /RSA key ok/",
              "run_time": 0.021447,
              "start_time": "2018-02-11 14:26:24 -0500"
            },
            {
              "status": "passed",
              "code_desc": "x509_certificate /etc/elasticsearch/x-pack/elastic/elastic.crt should be certificate",
              "run_time": 0.000136,
              "start_time": "2018-02-11 14:26:24 -0500"
            },
            {
              "status": "passed",
              "code_desc": "x509_certificate /etc/elasticsearch/x-pack/elastic/elastic.crt should be valid",
              "run_time": 0.000093,
              "start_time": "2018-02-11 14:26:24 -0500"
            },
            {
              "status": "passed",
              "code_desc": "x509_certificate /etc/elasticsearch/x-pack/ca/ca.crt should be certificate",
              "run_time": 0.000073,
              "start_time": "2018-02-11 14:26:24 -0500"
            },
            {
              "status": "passed",
              "code_desc": "x509_certificate /etc/elasticsearch/x-pack/ca/ca.crt should be valid",
              "run_time": 0.000089,
              "start_time": "2018-02-11 14:26:24 -0500"
            },
            {
              "status": "passed",
              "code_desc": "Elasticsearch Cluster https://0.0.0.0:9200 should not have http access",
              "run_time": 0.020048,
              "start_time": "2018-02-11 14:26:24 -0500"
            }
          ]
        },
        {
          "id": "V-27059",
          "title": "The application must maintain the integrity of information during\naggregation, packaging, and transformation in preparation for transmission.",
          "desc": "Use SSL / TLS communication for all networked access to Elasticsearch",
          "impact": 0.5,
          "refs": [],
          "tags": {
            "nist": [
              "SC-8 (2)",
              "Rev_3"
            ],
            "severity": "medium",
            "rid": "SV-34354r1_rule",
            "gtitle": "SRG-APP-NA",
            "cci": "CCI-001129",
            "check": "Application must utilize approved cryptography to establish\nintegrity during preparation of data transmission.\n\nAs the application administrator (usually elasticsearch), check the xpack.ssl\nsettings are set to the correct values.\n\n$cat elasticsearch.yml | grep xpack.ssl\n\nxpack.ssl.key:                     <server_key>.key\nxpack.ssl.certificate:             <server_certificate>.crt\nxpack.ssl.certificate_authorities: [ <approved_ca>.crt' ]\n\nIf these setting are not set or the underlying certificate and keys are not\ncorrect, this is a finding.\n\n$cat elasticsearch.yml | grep xpack.security.http.ssl.enabled:\n\nIf this setting is set to false, this is a finding.\n\n$cat elasticsearch.yml | grep xpack.security.transport.ssl.enabled:\n\nIf this setting is set to false, this is a finding.\n\nAs a elasticsearch user, check that non-secure http traffic does not response\nwith 200 status:\n\n$curl -H 'Content-Type: application/json' -u <TEST_USER> -p <TEST_CREDENTIALS>\nhttp://<elasticsearchIP:9200>/\n\nIf a 200 response comes back, this is a finding.",
            "fix": "Implement integrity measures during preparation of data\ntransmission.\n\n See the official documentation for the complete  guide on establishing SSL\nconfiguration: https://www.elastic.co/guide/en/x-pack/current/ssl-tls.html"
          },
          "code": "control \"V-27059\" do\n  title \"The application must maintain the integrity of information during\naggregation, packaging, and transformation in preparation for transmission.\"\n  desc  \"Use SSL / TLS communication for all networked access to Elasticsearch\"\n  impact 0.5\n  tag \"nist\": [\"SC-8 (2)\", \"Rev_3\"]\n  tag \"severity\": \"medium\"\n  tag \"rid\": \"SV-34354r1_rule\"\n  tag \"gtitle\": \"SRG-APP-NA\"\n  tag \"cci\": \"CCI-001129\"\n  tag \"check\": \"Application must utilize approved cryptography to establish\nintegrity during preparation of data transmission.\n\nAs the application administrator (usually elasticsearch), check the xpack.ssl\nsettings are set to the correct values.\n\n$cat elasticsearch.yml | grep xpack.ssl\n\nxpack.ssl.key:                     <server_key>.key\nxpack.ssl.certificate:             <server_certificate>.crt\nxpack.ssl.certificate_authorities: [ <approved_ca>.crt' ]\n\nIf these setting are not set or the underlying certificate and keys are not\ncorrect, this is a finding.\n\n$cat elasticsearch.yml | grep xpack.security.http.ssl.enabled:\n\nIf this setting is set to false, this is a finding.\n\n$cat elasticsearch.yml | grep xpack.security.transport.ssl.enabled:\n\nIf this setting is set to false, this is a finding.\n\nAs a elasticsearch user, check that non-secure http traffic does not response\nwith 200 status:\n\n$curl -H 'Content-Type: application/json' -u <TEST_USER> -p <TEST_CREDENTIALS>\nhttp://<elasticsearchIP:9200>/\n\nIf a 200 response comes back, this is a finding.\"\n  tag \"fix\": \"Implement integrity measures during preparation of data\ntransmission.\n\n See the official documentation for the complete  guide on establishing SSL\nconfiguration: https://www.elastic.co/guide/en/x-pack/current/ssl-tls.html\"\n\n  begin\n    es_handle = es_helper(url:\"https://#{ELASTIC_IP}:#{ELASTIC_PORT}\",\n                    username: ES_ADMIN,\n                    password: ES_PASS,\n                    ssl_verify: SSL_VERIFY )\n\n    describe \"No nodes found\" do\n      subject { es_handle.nodes.nil? }\n      it { should_not be_truthy }\n    end if es_handle.nodes.nil?\n\n    es_handle.nodes.each do |node|\n      describe \"SSL Settings for Node: #{node.name}\" do\n        subject { node }\n        its(\"http_ssl.enabled\") { should eq 'true' }\n        its(\"transport_ssl.enabled\") { should eq 'true' }\n      end\n    end unless es_handle.nodes.nil?\n\n    describe yaml(ELASTICSEARCH_CONF) do\n      its(['xpack.ssl.key']) { should_not be_nil }\n      its(['xpack.ssl.certificate']) { should_not be_nil }\n      its(['xpack.ssl.certificate_authorities']) { should_not be_nil }\n      its(['xpack.security.http.ssl.enabled']) { should eq true }\n      its(['xpack.security.transport.ssl.enabled']) { should eq true }\n    end\n\n    describe command(\"openssl rsa -in #{yaml(ELASTICSEARCH_CONF)['xpack.ssl.key']} -check -noout\") do\n      its('stdout'){ should match /RSA key ok/ }\n    end\n\n    describe x509_certificate(yaml(ELASTICSEARCH_CONF)['xpack.ssl.certificate']) do\n      it { should be_certificate }\n      it { should be_valid }\n    end\n\n    if yaml(ELASTICSEARCH_CONF)['xpack.ssl.certificate_authorities'].is_a?(Array)\n      yaml(ELASTICSEARCH_CONF)['xpack.ssl.certificate_authorities'].each do |cert|\n        describe x509_certificate(cert) do\n          it { should be_certificate }\n          it { should be_valid }\n        end\n      end\n    else\n      describe x509_certificate(yaml(ELASTICSEARCH_CONF)['xpack.ssl.certificate_authorities']) do\n        it { should be_certificate }\n        it { should be_valid }\n      end\n    end\n\n    describe es_handle do \n      it { should_not have_http_access }\n    end\n\n  rescue Exception => msg\n    describe \"Exception: #{msg}\" do\n      it { should be_nil}\n    end\n  end\nend\n",
          "source_location": {
            "line": 41,
            "ref": "../elasticsearch-inspec/controls/ssl+tsl+certs+http/V-27059.rb"
          },
          "results": [
            {
              "status": "passed",
              "code_desc": "SSL Settings for Node: package-centos-72 http_ssl.enabled should eq \"true\"",
              "run_time": 0.000113,
              "start_time": "2018-02-11 14:26:24 -0500"
            },
            {
              "status": "passed",
              "code_desc": "SSL Settings for Node: package-centos-72 transport_ssl.enabled should eq \"true\"",
              "run_time": 0.000081,
              "start_time": "2018-02-11 14:26:24 -0500"
            },
            {
              "status": "passed",
              "code_desc": "YAML /etc/elasticsearch/elasticsearch.yml [\"xpack.ssl.key\"] should not be nil",
              "run_time": 0.000069,
              "start_time": "2018-02-11 14:26:24 -0500"
            },
            {
              "status": "passed",
              "code_desc": "YAML /etc/elasticsearch/elasticsearch.yml [\"xpack.ssl.certificate\"] should not be nil",
              "run_time": 0.000055,
              "start_time": "2018-02-11 14:26:24 -0500"
            },
            {
              "status": "passed",
              "code_desc": "YAML /etc/elasticsearch/elasticsearch.yml [\"xpack.ssl.certificate_authorities\"] should not be nil",
              "run_time": 0.000055,
              "start_time": "2018-02-11 14:26:24 -0500"
            },
            {
              "status": "passed",
              "code_desc": "YAML /etc/elasticsearch/elasticsearch.yml [\"xpack.security.http.ssl.enabled\"] should eq true",
              "run_time": 0.000067,
              "start_time": "2018-02-11 14:26:24 -0500"
            },
            {
              "status": "passed",
              "code_desc": "YAML /etc/elasticsearch/elasticsearch.yml [\"xpack.security.transport.ssl.enabled\"] should eq true",
              "run_time": 0.000082,
              "start_time": "2018-02-11 14:26:24 -0500"
            },
            {
              "status": "passed",
              "code_desc": "Command openssl rsa -in /etc/elasticsearch/x-pack/elastic/elastic.key -check -noout stdout should match /RSA key ok/",
              "run_time": 0.018168,
              "start_time": "2018-02-11 14:26:24 -0500"
            },
            {
              "status": "passed",
              "code_desc": "x509_certificate /etc/elasticsearch/x-pack/elastic/elastic.crt should be certificate",
              "run_time": 0.000098,
              "start_time": "2018-02-11 14:26:24 -0500"
            },
            {
              "status": "passed",
              "code_desc": "x509_certificate /etc/elasticsearch/x-pack/elastic/elastic.crt should be valid",
              "run_time": 0.000079,
              "start_time": "2018-02-11 14:26:24 -0500"
            },
            {
              "status": "passed",
              "code_desc": "x509_certificate /etc/elasticsearch/x-pack/ca/ca.crt should be certificate",
              "run_time": 0.00008,
              "start_time": "2018-02-11 14:26:24 -0500"
            },
            {
              "status": "passed",
              "code_desc": "x509_certificate /etc/elasticsearch/x-pack/ca/ca.crt should be valid",
              "run_time": 0.000066,
              "start_time": "2018-02-11 14:26:24 -0500"
            },
            {
              "status": "passed",
              "code_desc": "Elasticsearch Cluster https://0.0.0.0:9200 should not have http access",
              "run_time": 0.017759,
              "start_time": "2018-02-11 14:26:24 -0500"
            }
          ]
        },
        {
          "id": "V-26908",
          "title": "The application must use organizational-defined replay-resistant\nauthentication mechanisms for network access to non-privileged accounts.",
          "desc": "Configure PKI authentication, TLS/SSL, IP filtering; which are key\nfeatures of X-Pack Security. This should ensure that authentication and\ncommunication within Elasticsearch is replay resistant.",
          "impact": 0.5,
          "refs": [],
          "tags": {
            "nist": [
              "IA-2 (9)",
              "Rev_3"
            ],
            "severity": "medium",
            "rid": "SV-34188r1_rule",
            "gtitle": "SRG-APP-000157",
            "cci": "CCI-000776",
            "check": "Application must utilize approved cryptography to establish\nintegrity during preparation of data transmission.\n\nAs the application administrator (usually elasticsearch), check the xpack.ssl\nsettings are set to the correct values.\n\n$cat elasticsearch.yml | grep xpack.ssl\n\nxpack.ssl.key:                     <server_key>.key\nxpack.ssl.certificate:             <server_certificate>.crt\nxpack.ssl.certificate_authorities: [ <approved_ca>.crt' ]\n\nIf these setting are not set or the underlying certificate and keys are not\ncorrect, this is a finding.\n\n$cat elasticsearch.yml | grep xpack.security.http.ssl.enabled:\n\nIf this setting is set to false, this is a finding.\n\n$cat elasticsearch.yml | grep xpack.security.transport.ssl.enabled:\n\nIf this setting is set to false, this is a finding.\n\nAs a elasticsearch user, check that non-secure http traffic does not response\nwith 200 status:\n\n$curl -H 'Content-Type: application/json' -u <TEST_USER> -p <TEST_CREDENTIALS>\nhttp://<elasticsearchIP:9200>/\n\nIf a 200 response comes back, this is a finding.",
            "fix": "Implement integrity measures during preparation of data\ntransmission.\n\n See the official documentation for the complete  guide on establishing SSL\nconfiguration: https://www.elastic.co/guide/en/x-pack/current/ssl-tls.html"
          },
          "code": "control \"V-26908\" do\n  title \"The application must use organizational-defined replay-resistant\nauthentication mechanisms for network access to non-privileged accounts.\"\n  desc  \"Configure PKI authentication, TLS/SSL, IP filtering; which are key\nfeatures of X-Pack Security. This should ensure that authentication and\ncommunication within Elasticsearch is replay resistant.\"\n  impact 0.5\n  tag \"nist\": [\"IA-2 (9)\", \"Rev_3\"]\n  tag \"severity\": \"medium\"\n  tag \"rid\": \"SV-34188r1_rule\"\n  tag \"gtitle\": \"SRG-APP-000157\"\n  tag \"cci\": \"CCI-000776\"\n  tag \"check\": \"Application must utilize approved cryptography to establish\nintegrity during preparation of data transmission.\n\nAs the application administrator (usually elasticsearch), check the xpack.ssl\nsettings are set to the correct values.\n\n$cat elasticsearch.yml | grep xpack.ssl\n\nxpack.ssl.key:                     <server_key>.key\nxpack.ssl.certificate:             <server_certificate>.crt\nxpack.ssl.certificate_authorities: [ <approved_ca>.crt' ]\n\nIf these setting are not set or the underlying certificate and keys are not\ncorrect, this is a finding.\n\n$cat elasticsearch.yml | grep xpack.security.http.ssl.enabled:\n\nIf this setting is set to false, this is a finding.\n\n$cat elasticsearch.yml | grep xpack.security.transport.ssl.enabled:\n\nIf this setting is set to false, this is a finding.\n\nAs a elasticsearch user, check that non-secure http traffic does not response\nwith 200 status:\n\n$curl -H 'Content-Type: application/json' -u <TEST_USER> -p <TEST_CREDENTIALS>\nhttp://<elasticsearchIP:9200>/\n\nIf a 200 response comes back, this is a finding.\"\n  tag \"fix\": \"Implement integrity measures during preparation of data\ntransmission.\n\n See the official documentation for the complete  guide on establishing SSL\nconfiguration: https://www.elastic.co/guide/en/x-pack/current/ssl-tls.html\"\n\n  begin\n    es_handle = es_helper(url:\"https://#{ELASTIC_IP}:#{ELASTIC_PORT}\",\n                    username: ES_ADMIN,\n                    password: ES_PASS,\n                    ssl_verify: SSL_VERIFY )\n\n    describe \"No nodes found\" do\n      subject { es_handle.nodes.nil? }\n      it { should_not be_truthy }\n    end if es_handle.nodes.nil?\n\n    es_handle.nodes.each do |node|\n      describe \"SSL Settings for Node: #{node.name}\" do\n        subject { node }\n        its(\"http_ssl.enabled\") { should eq 'true' }\n        its(\"transport_ssl.enabled\") { should eq 'true' }\n      end\n    end unless es_handle.nodes.nil?\n\n    describe yaml(ELASTICSEARCH_CONF) do\n      its(['xpack.ssl.key']) { should_not be_nil }\n      its(['xpack.ssl.certificate']) { should_not be_nil }\n      its(['xpack.ssl.certificate_authorities']) { should_not be_nil }\n      its(['xpack.security.http.ssl.enabled']) { should eq true }\n      its(['xpack.security.transport.ssl.enabled']) { should eq true }\n    end\n\n    describe command(\"openssl rsa -in #{yaml(ELASTICSEARCH_CONF)['xpack.ssl.key']} -check -noout\") do\n      its('stdout'){ should match /RSA key ok/ }\n    end\n\n    describe x509_certificate(yaml(ELASTICSEARCH_CONF)['xpack.ssl.certificate']) do\n      it { should be_certificate }\n      it { should be_valid }\n    end\n\n    if yaml(ELASTICSEARCH_CONF)['xpack.ssl.certificate_authorities'].is_a?(Array)\n      yaml(ELASTICSEARCH_CONF)['xpack.ssl.certificate_authorities'].each do |cert|\n        describe x509_certificate(cert) do\n          it { should be_certificate }\n          it { should be_valid }\n        end\n      end\n    else\n      describe x509_certificate(yaml(ELASTICSEARCH_CONF)['xpack.ssl.certificate_authorities']) do\n        it { should be_certificate }\n        it { should be_valid }\n      end\n    end\n\n    describe es_handle do \n      it { should_not have_http_access }\n    end\n\n  rescue Exception => msg\n    describe \"Exception: #{msg}\" do\n      it { should be_nil}\n    end\n  end\nend\n",
          "source_location": {
            "line": 41,
            "ref": "../elasticsearch-inspec/controls/ssl+tsl+certs+http/V-26908.rb"
          },
          "results": [
            {
              "status": "passed",
              "code_desc": "SSL Settings for Node: package-centos-72 http_ssl.enabled should eq \"true\"",
              "run_time": 0.000139,
              "start_time": "2018-02-11 14:26:24 -0500"
            },
            {
              "status": "passed",
              "code_desc": "SSL Settings for Node: package-centos-72 transport_ssl.enabled should eq \"true\"",
              "run_time": 0.000074,
              "start_time": "2018-02-11 14:26:24 -0500"
            },
            {
              "status": "passed",
              "code_desc": "YAML /etc/elasticsearch/elasticsearch.yml [\"xpack.ssl.key\"] should not be nil",
              "run_time": 0.000068,
              "start_time": "2018-02-11 14:26:24 -0500"
            },
            {
              "status": "passed",
              "code_desc": "YAML /etc/elasticsearch/elasticsearch.yml [\"xpack.ssl.certificate\"] should not be nil",
              "run_time": 0.00006,
              "start_time": "2018-02-11 14:26:24 -0500"
            },
            {
              "status": "passed",
              "code_desc": "YAML /etc/elasticsearch/elasticsearch.yml [\"xpack.ssl.certificate_authorities\"] should not be nil",
              "run_time": 0.000057,
              "start_time": "2018-02-11 14:26:24 -0500"
            },
            {
              "status": "passed",
              "code_desc": "YAML /etc/elasticsearch/elasticsearch.yml [\"xpack.security.http.ssl.enabled\"] should eq true",
              "run_time": 0.000063,
              "start_time": "2018-02-11 14:26:24 -0500"
            },
            {
              "status": "passed",
              "code_desc": "YAML /etc/elasticsearch/elasticsearch.yml [\"xpack.security.transport.ssl.enabled\"] should eq true",
              "run_time": 0.000066,
              "start_time": "2018-02-11 14:26:24 -0500"
            },
            {
              "status": "passed",
              "code_desc": "Command openssl rsa -in /etc/elasticsearch/x-pack/elastic/elastic.key -check -noout stdout should match /RSA key ok/",
              "run_time": 0.019568,
              "start_time": "2018-02-11 14:26:24 -0500"
            },
            {
              "status": "passed",
              "code_desc": "x509_certificate /etc/elasticsearch/x-pack/elastic/elastic.crt should be certificate",
              "run_time": 0.000112,
              "start_time": "2018-02-11 14:26:24 -0500"
            },
            {
              "status": "passed",
              "code_desc": "x509_certificate /etc/elasticsearch/x-pack/elastic/elastic.crt should be valid",
              "run_time": 0.000091,
              "start_time": "2018-02-11 14:26:24 -0500"
            },
            {
              "status": "passed",
              "code_desc": "x509_certificate /etc/elasticsearch/x-pack/ca/ca.crt should be certificate",
              "run_time": 0.000096,
              "start_time": "2018-02-11 14:26:24 -0500"
            },
            {
              "status": "passed",
              "code_desc": "x509_certificate /etc/elasticsearch/x-pack/ca/ca.crt should be valid",
              "run_time": 0.000073,
              "start_time": "2018-02-11 14:26:24 -0500"
            },
            {
              "status": "passed",
              "code_desc": "Elasticsearch Cluster https://0.0.0.0:9200 should not have http access",
              "run_time": 0.018882,
              "start_time": "2018-02-11 14:26:24 -0500"
            }
          ]
        },
        {
          "id": "V-26948",
          "title": "Applications used for non-local maintenance sessions must protect\nthose sessions through the use of a strong authenticator tightly bound to the\nuser.",
          "desc": "Configure X-Pack to use an organizational approved FIPS 140-2 java\ncryptography provider.",
          "impact": 0.5,
          "refs": [],
          "tags": {
            "nist": [
              "MA-4 (4) (a)",
              "Rev_4"
            ],
            "severity": "medium",
            "rid": "SV-34231r1_rule",
            "gtitle": "SRG-APP-000183",
            "cci": "CCI-000884",
            "check": "Application must utilize approved cryptography to authenticate\nnon-local maintenance sessions.\n\n$cat elasticsearch.yml | grep xpack.ssl\n\nxpack.ssl.key:                     <server_key>.key\nxpack.ssl.certificate:             <server_certificate>.crt\nxpack.ssl.certificate_authorities: [ <approved_ca>.crt' ]\n\nIf these setting are not set or the underlying certificate and keys are not\ncorrect, this is a finding.\n\n$cat elasticsearch.yml | grep xpack.security.http.ssl.enabled:\n\nIf this setting is set to false, this is a finding.\n\n$cat elasticsearch.yml | grep xpack.security.transport.ssl.enabled:\n\nIf this setting is set to false, this is a finding.\n\nAs a elasticsearch user, check that non-secure http traffic does not response\nwith 200 status:\n\n$curl -H 'Content-Type: application/json' -u <TEST_USER> -p <TEST_CREDENTIALS>\nhttp://<elasticsearchIP:9200>/\n\nIf a 200 response comes back, this is a finding.",
            "fix": "Implement approved cryptography to authenticate non-local\nmaintenance sessions.\n\n See the official documentation for the complete  guide on establishing SSL\nconfiguration: https://www.elastic.co/guide/en/x-pack/current/ssl-tls.html"
          },
          "code": "control \"V-26948\" do\n  title \"Applications used for non-local maintenance sessions must protect\nthose sessions through the use of a strong authenticator tightly bound to the\nuser.\"\n  desc  \"Configure X-Pack to use an organizational approved FIPS 140-2 java\ncryptography provider.\"\n  impact 0.5\n  tag \"nist\": [\"MA-4 (4) (a)\", \"Rev_4\"]\n  tag \"severity\": \"medium\"\n  tag \"rid\": \"SV-34231r1_rule\"\n  tag \"gtitle\": \"SRG-APP-000183\"\n  tag \"cci\": \"CCI-000884\"\n  tag \"check\": \"Application must utilize approved cryptography to authenticate\nnon-local maintenance sessions.\n\n$cat elasticsearch.yml | grep xpack.ssl\n\nxpack.ssl.key:                     <server_key>.key\nxpack.ssl.certificate:             <server_certificate>.crt\nxpack.ssl.certificate_authorities: [ <approved_ca>.crt' ]\n\nIf these setting are not set or the underlying certificate and keys are not\ncorrect, this is a finding.\n\n$cat elasticsearch.yml | grep xpack.security.http.ssl.enabled:\n\nIf this setting is set to false, this is a finding.\n\n$cat elasticsearch.yml | grep xpack.security.transport.ssl.enabled:\n\nIf this setting is set to false, this is a finding.\n\nAs a elasticsearch user, check that non-secure http traffic does not response\nwith 200 status:\n\n$curl -H 'Content-Type: application/json' -u <TEST_USER> -p <TEST_CREDENTIALS>\nhttp://<elasticsearchIP:9200>/\n\nIf a 200 response comes back, this is a finding.\"\n  tag \"fix\": \"Implement approved cryptography to authenticate non-local\nmaintenance sessions.\n\n See the official documentation for the complete  guide on establishing SSL\nconfiguration: https://www.elastic.co/guide/en/x-pack/current/ssl-tls.html\"\n\n  begin\n    es_handle = es_helper(url:\"https://#{ELASTIC_IP}:#{ELASTIC_PORT}\",\n                    username: ES_ADMIN,\n                    password: ES_PASS,\n                    ssl_verify: SSL_VERIFY )\n\n    describe \"No nodes found\" do\n      subject { es_handle.nodes.nil? }\n      it { should_not be_truthy }\n    end if es_handle.nodes.nil?\n\n    es_handle.nodes.each do |node|\n      describe \"SSL Settings for Node: #{node.name}\" do\n        subject { node }\n        its(\"http_ssl.enabled\") { should eq 'true' }\n        its(\"transport_ssl.enabled\") { should eq 'true' }\n      end\n    end unless es_handle.nodes.nil?\n\n    describe yaml(ELASTICSEARCH_CONF) do\n      its(['xpack.ssl.key']) { should_not be_nil }\n      its(['xpack.ssl.certificate']) { should_not be_nil }\n      its(['xpack.ssl.certificate_authorities']) { should_not be_nil }\n      its(['xpack.security.http.ssl.enabled']) { should eq true }\n      its(['xpack.security.transport.ssl.enabled']) { should eq true }\n    end\n\n    describe command(\"openssl rsa -in #{yaml(ELASTICSEARCH_CONF)['xpack.ssl.key']} -check -noout\") do\n      its('stdout'){ should match /RSA key ok/ }\n    end\n\n    describe x509_certificate(yaml(ELASTICSEARCH_CONF)['xpack.ssl.certificate']) do\n      it { should be_certificate }\n      it { should be_valid }\n    end\n\n    if yaml(ELASTICSEARCH_CONF)['xpack.ssl.certificate_authorities'].is_a?(Array)\n      yaml(ELASTICSEARCH_CONF)['xpack.ssl.certificate_authorities'].each do |cert|\n        describe x509_certificate(cert) do\n          it { should be_certificate }\n          it { should be_valid }\n        end\n      end\n    else\n      describe x509_certificate(yaml(ELASTICSEARCH_CONF)['xpack.ssl.certificate_authorities']) do\n        it { should be_certificate }\n        it { should be_valid }\n      end\n    end\n\n    describe es_handle do \n      it { should_not have_http_access }\n    end\n\n  rescue Exception => msg\n    describe \"Exception: #{msg}\" do\n      it { should be_nil}\n    end\n  end\nend\n",
          "source_location": {
            "line": 42,
            "ref": "../elasticsearch-inspec/controls/ssl+tsl+certs+http/V-26948.rb"
          },
          "results": [
            {
              "status": "passed",
              "code_desc": "SSL Settings for Node: package-centos-72 http_ssl.enabled should eq \"true\"",
              "run_time": 0.000141,
              "start_time": "2018-02-11 14:26:24 -0500"
            },
            {
              "status": "passed",
              "code_desc": "SSL Settings for Node: package-centos-72 transport_ssl.enabled should eq \"true\"",
              "run_time": 0.000086,
              "start_time": "2018-02-11 14:26:24 -0500"
            },
            {
              "status": "passed",
              "code_desc": "YAML /etc/elasticsearch/elasticsearch.yml [\"xpack.ssl.key\"] should not be nil",
              "run_time": 0.000098,
              "start_time": "2018-02-11 14:26:24 -0500"
            },
            {
              "status": "passed",
              "code_desc": "YAML /etc/elasticsearch/elasticsearch.yml [\"xpack.ssl.certificate\"] should not be nil",
              "run_time": 0.000064,
              "start_time": "2018-02-11 14:26:24 -0500"
            },
            {
              "status": "passed",
              "code_desc": "YAML /etc/elasticsearch/elasticsearch.yml [\"xpack.ssl.certificate_authorities\"] should not be nil",
              "run_time": 0.000064,
              "start_time": "2018-02-11 14:26:24 -0500"
            },
            {
              "status": "passed",
              "code_desc": "YAML /etc/elasticsearch/elasticsearch.yml [\"xpack.security.http.ssl.enabled\"] should eq true",
              "run_time": 0.000078,
              "start_time": "2018-02-11 14:26:24 -0500"
            },
            {
              "status": "passed",
              "code_desc": "YAML /etc/elasticsearch/elasticsearch.yml [\"xpack.security.transport.ssl.enabled\"] should eq true",
              "run_time": 0.000067,
              "start_time": "2018-02-11 14:26:24 -0500"
            },
            {
              "status": "passed",
              "code_desc": "Command openssl rsa -in /etc/elasticsearch/x-pack/elastic/elastic.key -check -noout stdout should match /RSA key ok/",
              "run_time": 0.019098,
              "start_time": "2018-02-11 14:26:24 -0500"
            },
            {
              "status": "passed",
              "code_desc": "x509_certificate /etc/elasticsearch/x-pack/elastic/elastic.crt should be certificate",
              "run_time": 0.000144,
              "start_time": "2018-02-11 14:26:24 -0500"
            },
            {
              "status": "passed",
              "code_desc": "x509_certificate /etc/elasticsearch/x-pack/elastic/elastic.crt should be valid",
              "run_time": 0.000082,
              "start_time": "2018-02-11 14:26:24 -0500"
            },
            {
              "status": "passed",
              "code_desc": "x509_certificate /etc/elasticsearch/x-pack/ca/ca.crt should be certificate",
              "run_time": 0.000063,
              "start_time": "2018-02-11 14:26:24 -0500"
            },
            {
              "status": "passed",
              "code_desc": "x509_certificate /etc/elasticsearch/x-pack/ca/ca.crt should be valid",
              "run_time": 0.000082,
              "start_time": "2018-02-11 14:26:24 -0500"
            },
            {
              "status": "passed",
              "code_desc": "Elasticsearch Cluster https://0.0.0.0:9200 should not have http access",
              "run_time": 0.017969,
              "start_time": "2018-02-11 14:26:24 -0500"
            }
          ]
        },
        {
          "id": "V-26912",
          "title": "Applications managing network connectivity must have the capability to\nauthenticate devices before establishing network connections by using\nbidirectional authentication that is cryptographically based.",
          "desc": "Configure the centralized authentication service to enforce\norganizational policies such as valid certification path, trusted anchor.",
          "impact": 0.5,
          "refs": [],
          "tags": {
            "nist": [
              "IA-3 (2)",
              "Rev_3"
            ],
            "severity": "medium",
            "rid": "SV-34192r1_rule",
            "gtitle": "SRG-APP-000161",
            "cci": "CCI-000781",
            "check": "Application must utilize approved cryptography to authenticate\ndevices.\n\n$cat elasticsearch.yml | grep xpack.ssl\n\nxpack.ssl.key:                     <server_key>.key\nxpack.ssl.certificate:             <server_certificate>.crt\nxpack.ssl.certificate_authorities: [ <approved_ca>.crt' ]\n\nIf these setting are not set or the underlying certificate and keys are not\ncorrect, this is a finding.\n\n$cat elasticsearch.yml | grep xpack.security.http.ssl.enabled:\n\nIf this setting is set to false, this is a finding.\n\n$cat elasticsearch.yml | grep xpack.security.transport.ssl.enabled:\n\nIf this setting is set to false, this is a finding.\n\nAs a elasticsearch user, check that non-secure http traffic does not response\nwith 200 status:\n\n$curl -H 'Content-Type: application/json' -u <TEST_USER> -p <TEST_CREDENTIALS>\nhttp://<elasticsearchIP:9200>/\n\nIf a 200 response comes back, this is a finding.",
            "fix": "Implement approved cryptography to authenticate devices.\n\n See the official documentation for the complete  guide on establishing SSL\nconfiguration: https://www.elastic.co/guide/en/x-pack/current/ssl-tls.html"
          },
          "code": "control \"V-26912\" do\n  title \"Applications managing network connectivity must have the capability to\nauthenticate devices before establishing network connections by using\nbidirectional authentication that is cryptographically based.\"\n  desc  \"Configure the centralized authentication service to enforce\norganizational policies such as valid certification path, trusted anchor.\"\n  impact 0.5\n  tag \"nist\": [\"IA-3 (2)\", \"Rev_3\"]\n  tag \"severity\": \"medium\"\n  tag \"rid\": \"SV-34192r1_rule\"\n  tag \"gtitle\": \"SRG-APP-000161\"\n  tag \"cci\": \"CCI-000781\"\n  tag \"check\": \"Application must utilize approved cryptography to authenticate\ndevices.\n\n$cat elasticsearch.yml | grep xpack.ssl\n\nxpack.ssl.key:                     <server_key>.key\nxpack.ssl.certificate:             <server_certificate>.crt\nxpack.ssl.certificate_authorities: [ <approved_ca>.crt' ]\n\nIf these setting are not set or the underlying certificate and keys are not\ncorrect, this is a finding.\n\n$cat elasticsearch.yml | grep xpack.security.http.ssl.enabled:\n\nIf this setting is set to false, this is a finding.\n\n$cat elasticsearch.yml | grep xpack.security.transport.ssl.enabled:\n\nIf this setting is set to false, this is a finding.\n\nAs a elasticsearch user, check that non-secure http traffic does not response\nwith 200 status:\n\n$curl -H 'Content-Type: application/json' -u <TEST_USER> -p <TEST_CREDENTIALS>\nhttp://<elasticsearchIP:9200>/\n\nIf a 200 response comes back, this is a finding.\"\n  tag \"fix\": \"Implement approved cryptography to authenticate devices.\n\n See the official documentation for the complete  guide on establishing SSL\nconfiguration: https://www.elastic.co/guide/en/x-pack/current/ssl-tls.html\"\n\n  begin\n    es_handle = es_helper(url:\"https://#{ELASTIC_IP}:#{ELASTIC_PORT}\",\n                    username: ES_ADMIN,\n                    password: ES_PASS,\n                    ssl_verify: SSL_VERIFY )\n\n    describe \"No nodes found\" do\n      subject { es_handle.nodes.nil? }\n      it { should_not be_truthy }\n    end if es_handle.nodes.nil?\n\n    es_handle.nodes.each do |node|\n      describe \"SSL Settings for Node: #{node.name}\" do\n        subject { node }\n        its(\"http_ssl.enabled\") { should eq 'true' }\n        its(\"transport_ssl.enabled\") { should eq 'true' }\n      end\n    end unless es_handle.nodes.nil?\n\n    describe yaml(ELASTICSEARCH_CONF) do\n      its(['xpack.ssl.key']) { should_not be_nil }\n      its(['xpack.ssl.certificate']) { should_not be_nil }\n      its(['xpack.ssl.certificate_authorities']) { should_not be_nil }\n      its(['xpack.security.http.ssl.enabled']) { should eq true }\n      its(['xpack.security.transport.ssl.enabled']) { should eq true }\n    end\n\n    describe command(\"openssl rsa -in #{yaml(ELASTICSEARCH_CONF)['xpack.ssl.key']} -check -noout\") do\n      its('stdout'){ should match /RSA key ok/ }\n    end\n\n    describe x509_certificate(yaml(ELASTICSEARCH_CONF)['xpack.ssl.certificate']) do\n      it { should be_certificate }\n      it { should be_valid }\n    end\n\n    if yaml(ELASTICSEARCH_CONF)['xpack.ssl.certificate_authorities'].is_a?(Array)\n      yaml(ELASTICSEARCH_CONF)['xpack.ssl.certificate_authorities'].each do |cert|\n        describe x509_certificate(cert) do\n          it { should be_certificate }\n          it { should be_valid }\n        end\n      end\n    else\n      describe x509_certificate(yaml(ELASTICSEARCH_CONF)['xpack.ssl.certificate_authorities']) do\n        it { should be_certificate }\n        it { should be_valid }\n      end\n    end\n\n    describe es_handle do \n      it { should_not have_http_access }\n    end\n\n  rescue Exception => msg\n    describe \"Exception: #{msg}\" do\n      it { should be_nil}\n    end\n  end\nend\n",
          "source_location": {
            "line": 41,
            "ref": "../elasticsearch-inspec/controls/ssl+tsl+certs+http/V-26912.rb"
          },
          "results": [
            {
              "status": "passed",
              "code_desc": "SSL Settings for Node: package-centos-72 http_ssl.enabled should eq \"true\"",
              "run_time": 0.000123,
              "start_time": "2018-02-11 14:26:24 -0500"
            },
            {
              "status": "passed",
              "code_desc": "SSL Settings for Node: package-centos-72 transport_ssl.enabled should eq \"true\"",
              "run_time": 0.000084,
              "start_time": "2018-02-11 14:26:24 -0500"
            },
            {
              "status": "passed",
              "code_desc": "YAML /etc/elasticsearch/elasticsearch.yml [\"xpack.ssl.key\"] should not be nil",
              "run_time": 0.000082,
              "start_time": "2018-02-11 14:26:24 -0500"
            },
            {
              "status": "passed",
              "code_desc": "YAML /etc/elasticsearch/elasticsearch.yml [\"xpack.ssl.certificate\"] should not be nil",
              "run_time": 0.000065,
              "start_time": "2018-02-11 14:26:24 -0500"
            },
            {
              "status": "passed",
              "code_desc": "YAML /etc/elasticsearch/elasticsearch.yml [\"xpack.ssl.certificate_authorities\"] should not be nil",
              "run_time": 0.000083,
              "start_time": "2018-02-11 14:26:24 -0500"
            },
            {
              "status": "passed",
              "code_desc": "YAML /etc/elasticsearch/elasticsearch.yml [\"xpack.security.http.ssl.enabled\"] should eq true",
              "run_time": 0.000076,
              "start_time": "2018-02-11 14:26:24 -0500"
            },
            {
              "status": "passed",
              "code_desc": "YAML /etc/elasticsearch/elasticsearch.yml [\"xpack.security.transport.ssl.enabled\"] should eq true",
              "run_time": 0.000068,
              "start_time": "2018-02-11 14:26:24 -0500"
            },
            {
              "status": "passed",
              "code_desc": "Command openssl rsa -in /etc/elasticsearch/x-pack/elastic/elastic.key -check -noout stdout should match /RSA key ok/",
              "run_time": 0.020268,
              "start_time": "2018-02-11 14:26:24 -0500"
            },
            {
              "status": "passed",
              "code_desc": "x509_certificate /etc/elasticsearch/x-pack/elastic/elastic.crt should be certificate",
              "run_time": 0.000116,
              "start_time": "2018-02-11 14:26:24 -0500"
            },
            {
              "status": "passed",
              "code_desc": "x509_certificate /etc/elasticsearch/x-pack/elastic/elastic.crt should be valid",
              "run_time": 0.000091,
              "start_time": "2018-02-11 14:26:24 -0500"
            },
            {
              "status": "passed",
              "code_desc": "x509_certificate /etc/elasticsearch/x-pack/ca/ca.crt should be certificate",
              "run_time": 0.00007,
              "start_time": "2018-02-11 14:26:24 -0500"
            },
            {
              "status": "passed",
              "code_desc": "x509_certificate /etc/elasticsearch/x-pack/ca/ca.crt should be valid",
              "run_time": 0.000071,
              "start_time": "2018-02-11 14:26:24 -0500"
            },
            {
              "status": "passed",
              "code_desc": "Elasticsearch Cluster https://0.0.0.0:9200 should not have http access",
              "run_time": 0.019966,
              "start_time": "2018-02-11 14:26:24 -0500"
            }
          ]
        },
        {
          "id": "V-26953",
          "title": "The application must employ cryptographic mechanisms to protect the\nintegrity and confidentiality of non-local maintenance and diagnostic\ncommunications.",
          "desc": "Configure X-Pack Security to use an organizational approved FIPS 140-2\njava cryptography provider.",
          "impact": 0.5,
          "refs": [],
          "tags": {
            "nist": [
              "MA-4 (6)",
              "Rev_3"
            ],
            "severity": "medium",
            "rid": "SV-34236r1_rule",
            "gtitle": "SRG-APP-000184",
            "cci": "CCI-000888",
            "check": "Application must utilize approved cryptography to protect the\nintegrity and confidentiality.\nAs the application administrator (usually elasticsearch), check the xpack.ssl\nsettings are set to the correct values.\n\n$cat elasticsearch.yml | grep xpack.ssl\n\nxpack.ssl.key:                     <server_key>.key\nxpack.ssl.certificate:             <server_certificate>.crt\nxpack.ssl.certificate_authorities: [ <approved_ca>.crt' ]\n\nIf these setting are not set or the underlying certificate and keys are not\ncorrect, this is a finding.\n\n$cat elasticsearch.yml | grep xpack.security.http.ssl.enabled:\n\nIf this setting is set to false, this is a finding.\n\n$cat elasticsearch.yml | grep xpack.security.transport.ssl.enabled:\n\nIf this setting is set to false, this is a finding.\n\nAs a elasticsearch user, check that non-secure http traffic does not response\nwith 200 status:\n\n$curl -H 'Content-Type: application/json' -u <TEST_USER> -p <TEST_CREDENTIALS>\nhttp://<elasticsearchIP:9200>/\n\nIf a 200 response comes back, this is a finding.",
            "fix": "Implement protective measures when protecting integrity and\nconfidentiality.\n\n See the official documentation for the complete  guide on establishing SSL\nconfiguration: https://www.elastic.co/guide/en/x-pack/current/ssl-tls.html"
          },
          "code": "control \"V-26953\" do\n  title \"The application must employ cryptographic mechanisms to protect the\nintegrity and confidentiality of non-local maintenance and diagnostic\ncommunications.\"\n  desc  \"Configure X-Pack Security to use an organizational approved FIPS 140-2\njava cryptography provider.\"\n  impact 0.5\n  tag \"nist\": [\"MA-4 (6)\", \"Rev_3\"]\n  tag \"severity\": \"medium\"\n  tag \"rid\": \"SV-34236r1_rule\"\n  tag \"gtitle\": \"SRG-APP-000184\"\n  tag \"cci\": \"CCI-000888\"\n  tag \"check\": \"Application must utilize approved cryptography to protect the\nintegrity and confidentiality.\nAs the application administrator (usually elasticsearch), check the xpack.ssl\nsettings are set to the correct values.\n\n$cat elasticsearch.yml | grep xpack.ssl\n\nxpack.ssl.key:                     <server_key>.key\nxpack.ssl.certificate:             <server_certificate>.crt\nxpack.ssl.certificate_authorities: [ <approved_ca>.crt' ]\n\nIf these setting are not set or the underlying certificate and keys are not\ncorrect, this is a finding.\n\n$cat elasticsearch.yml | grep xpack.security.http.ssl.enabled:\n\nIf this setting is set to false, this is a finding.\n\n$cat elasticsearch.yml | grep xpack.security.transport.ssl.enabled:\n\nIf this setting is set to false, this is a finding.\n\nAs a elasticsearch user, check that non-secure http traffic does not response\nwith 200 status:\n\n$curl -H 'Content-Type: application/json' -u <TEST_USER> -p <TEST_CREDENTIALS>\nhttp://<elasticsearchIP:9200>/\n\nIf a 200 response comes back, this is a finding.\"\n  tag \"fix\": \"Implement protective measures when protecting integrity and\nconfidentiality.\n\n See the official documentation for the complete  guide on establishing SSL\nconfiguration: https://www.elastic.co/guide/en/x-pack/current/ssl-tls.html\"\n\n\n  begin\n    es_handle = es_helper(url:\"https://#{ELASTIC_IP}:#{ELASTIC_PORT}\",\n                    username: ES_ADMIN,\n                    password: ES_PASS,\n                    ssl_verify: SSL_VERIFY )\n\n    describe \"No nodes found\" do\n      subject { es_handle.nodes.nil? }\n      it { should_not be_truthy }\n    end if es_handle.nodes.nil?\n\n    es_handle.nodes.each do |node|\n      describe \"SSL Settings for Node: #{node.name}\" do\n        subject { node }\n        its(\"http_ssl.enabled\") { should eq 'true' }\n        its(\"transport_ssl.enabled\") { should eq 'true' }\n      end\n    end unless es_handle.nodes.nil?\n\n    describe yaml(ELASTICSEARCH_CONF) do\n      its(['xpack.ssl.key']) { should_not be_nil }\n      its(['xpack.ssl.certificate']) { should_not be_nil }\n      its(['xpack.ssl.certificate_authorities']) { should_not be_nil }\n      its(['xpack.security.http.ssl.enabled']) { should eq true }\n      its(['xpack.security.transport.ssl.enabled']) { should eq true }\n    end\n\n    describe command(\"openssl rsa -in #{yaml(ELASTICSEARCH_CONF)['xpack.ssl.key']} -check -noout\") do\n      its('stdout'){ should match /RSA key ok/ }\n    end\n\n    describe x509_certificate(yaml(ELASTICSEARCH_CONF)['xpack.ssl.certificate']) do\n      it { should be_certificate }\n      it { should be_valid }\n    end\n\n    if yaml(ELASTICSEARCH_CONF)['xpack.ssl.certificate_authorities'].is_a?(Array)\n      yaml(ELASTICSEARCH_CONF)['xpack.ssl.certificate_authorities'].each do |cert|\n        describe x509_certificate(cert) do\n          it { should be_certificate }\n          it { should be_valid }\n        end\n      end\n    else\n      describe x509_certificate(yaml(ELASTICSEARCH_CONF)['xpack.ssl.certificate_authorities']) do\n        it { should be_certificate }\n        it { should be_valid }\n      end\n    end\n\n    describe es_handle do \n      it { should_not have_http_access }\n    end\n\n  rescue Exception => msg\n    describe \"Exception: #{msg}\" do\n      it { should be_nil}\n    end\n  end\nend\n",
          "source_location": {
            "line": 41,
            "ref": "../elasticsearch-inspec/controls/ssl+tsl+certs+http/V-26953.rb"
          },
          "results": [
            {
              "status": "passed",
              "code_desc": "SSL Settings for Node: package-centos-72 http_ssl.enabled should eq \"true\"",
              "run_time": 0.000113,
              "start_time": "2018-02-11 14:26:24 -0500"
            },
            {
              "status": "passed",
              "code_desc": "SSL Settings for Node: package-centos-72 transport_ssl.enabled should eq \"true\"",
              "run_time": 0.000073,
              "start_time": "2018-02-11 14:26:24 -0500"
            },
            {
              "status": "passed",
              "code_desc": "YAML /etc/elasticsearch/elasticsearch.yml [\"xpack.ssl.key\"] should not be nil",
              "run_time": 0.000072,
              "start_time": "2018-02-11 14:26:24 -0500"
            },
            {
              "status": "passed",
              "code_desc": "YAML /etc/elasticsearch/elasticsearch.yml [\"xpack.ssl.certificate\"] should not be nil",
              "run_time": 0.00006,
              "start_time": "2018-02-11 14:26:24 -0500"
            },
            {
              "status": "passed",
              "code_desc": "YAML /etc/elasticsearch/elasticsearch.yml [\"xpack.ssl.certificate_authorities\"] should not be nil",
              "run_time": 0.000054,
              "start_time": "2018-02-11 14:26:24 -0500"
            },
            {
              "status": "passed",
              "code_desc": "YAML /etc/elasticsearch/elasticsearch.yml [\"xpack.security.http.ssl.enabled\"] should eq true",
              "run_time": 0.000066,
              "start_time": "2018-02-11 14:26:24 -0500"
            },
            {
              "status": "passed",
              "code_desc": "YAML /etc/elasticsearch/elasticsearch.yml [\"xpack.security.transport.ssl.enabled\"] should eq true",
              "run_time": 0.000059,
              "start_time": "2018-02-11 14:26:24 -0500"
            },
            {
              "status": "passed",
              "code_desc": "Command openssl rsa -in /etc/elasticsearch/x-pack/elastic/elastic.key -check -noout stdout should match /RSA key ok/",
              "run_time": 0.020047,
              "start_time": "2018-02-11 14:26:24 -0500"
            },
            {
              "status": "passed",
              "code_desc": "x509_certificate /etc/elasticsearch/x-pack/elastic/elastic.crt should be certificate",
              "run_time": 0.000107,
              "start_time": "2018-02-11 14:26:24 -0500"
            },
            {
              "status": "passed",
              "code_desc": "x509_certificate /etc/elasticsearch/x-pack/elastic/elastic.crt should be valid",
              "run_time": 0.000082,
              "start_time": "2018-02-11 14:26:24 -0500"
            },
            {
              "status": "passed",
              "code_desc": "x509_certificate /etc/elasticsearch/x-pack/ca/ca.crt should be certificate",
              "run_time": 0.000074,
              "start_time": "2018-02-11 14:26:24 -0500"
            },
            {
              "status": "passed",
              "code_desc": "x509_certificate /etc/elasticsearch/x-pack/ca/ca.crt should be valid",
              "run_time": 0.000061,
              "start_time": "2018-02-11 14:26:24 -0500"
            },
            {
              "status": "passed",
              "code_desc": "Elasticsearch Cluster https://0.0.0.0:9200 should not have http access",
              "run_time": 0.018432,
              "start_time": "2018-02-11 14:26:24 -0500"
            }
          ]
        },
        {
          "id": "V-27060",
          "title": "Applications must protect the confidentiality of transmitted\ninformation.",
          "desc": "Use SSL / TLS communication for all networked access to Elasticsearch\nand connected components such as Kibana and Logstash.  X-Pack Security should\nbe configured with organizational approved cryptography.",
          "impact": 0.5,
          "refs": [],
          "tags": {
            "nist": [
              "SC-9",
              "Rev_3"
            ],
            "severity": "medium",
            "rid": "SV-34355r1_rule",
            "gtitle": "SRG-APP-NA",
            "cci": "CCI-001130",
            "check": "Application must utilize approved cryptography to establish\nconfidentiality of transmitted data.\n\nAs the application administrator (usually elasticsearch), check the xpack.ssl\nsettings are set to the correct values.\n\n$cat elasticsearch.yml | grep xpack.ssl\n\nxpack.ssl.key:                     <server_key>.key\nxpack.ssl.certificate:             <server_certificate>.crt\nxpack.ssl.certificate_authorities: [ <approved_ca>.crt' ]\n\nIf these setting are not set or the underlying certificate and keys are not\ncorrect, this is a finding.\n\n$cat elasticsearch.yml | grep xpack.security.http.ssl.enabled:\n\nIf this setting is set to false, this is a finding.\n\n$cat elasticsearch.yml | grep xpack.security.transport.ssl.enabled:\n\nIf this setting is set to false, this is a finding.\n\nAs a elasticsearch user, check that non-secure http traffic does not response\nwith 200 status:\n\n$curl -H 'Content-Type: application/json' -u <TEST_USER> -p <TEST_CREDENTIALS>\nhttp://<elasticsearchIP:9200>/\n\nIf a 200 response comes back, this is a finding.",
            "fix": "Implement confidentiality measures of transmitted data.\n\n See the official documentation for the complete  guide on establishing SSL\nconfiguration: https://www.elastic.co/guide/en/x-pack/current/ssl-tls.html"
          },
          "code": "control \"V-27060\" do\n  title \"Applications must protect the confidentiality of transmitted\ninformation.\"\n  desc  \"Use SSL / TLS communication for all networked access to Elasticsearch\nand connected components such as Kibana and Logstash.  X-Pack Security should\nbe configured with organizational approved cryptography.\"\n  impact 0.5\n  tag \"nist\": [\"SC-9\", \"Rev_3\"]\n  tag \"severity\": \"medium\"\n  tag \"rid\": \"SV-34355r1_rule\"\n  tag \"gtitle\": \"SRG-APP-NA\"\n  tag \"cci\": \"CCI-001130\"\n  tag \"check\": \"Application must utilize approved cryptography to establish\nconfidentiality of transmitted data.\n\nAs the application administrator (usually elasticsearch), check the xpack.ssl\nsettings are set to the correct values.\n\n$cat elasticsearch.yml | grep xpack.ssl\n\nxpack.ssl.key:                     <server_key>.key\nxpack.ssl.certificate:             <server_certificate>.crt\nxpack.ssl.certificate_authorities: [ <approved_ca>.crt' ]\n\nIf these setting are not set or the underlying certificate and keys are not\ncorrect, this is a finding.\n\n$cat elasticsearch.yml | grep xpack.security.http.ssl.enabled:\n\nIf this setting is set to false, this is a finding.\n\n$cat elasticsearch.yml | grep xpack.security.transport.ssl.enabled:\n\nIf this setting is set to false, this is a finding.\n\nAs a elasticsearch user, check that non-secure http traffic does not response\nwith 200 status:\n\n$curl -H 'Content-Type: application/json' -u <TEST_USER> -p <TEST_CREDENTIALS>\nhttp://<elasticsearchIP:9200>/\n\nIf a 200 response comes back, this is a finding.\"\n  tag \"fix\": \"Implement confidentiality measures of transmitted data.\n\n See the official documentation for the complete  guide on establishing SSL\nconfiguration: https://www.elastic.co/guide/en/x-pack/current/ssl-tls.html\"\n\n  begin\n    es_handle = es_helper(url:\"https://#{ELASTIC_IP}:#{ELASTIC_PORT}\",\n                    username: ES_ADMIN,\n                    password: ES_PASS,\n                    ssl_verify: SSL_VERIFY )\n\n    describe \"No nodes found\" do\n      subject { es_handle.nodes.nil? }\n      it { should_not be_truthy }\n    end if es_handle.nodes.nil?\n\n    es_handle.nodes.each do |node|\n      describe \"SSL Settings for Node: #{node.name}\" do\n        subject { node }\n        its(\"http_ssl.enabled\") { should eq 'true' }\n        its(\"transport_ssl.enabled\") { should eq 'true' }\n      end\n    end unless es_handle.nodes.nil?\n\n    describe yaml(ELASTICSEARCH_CONF) do\n      its(['xpack.ssl.key']) { should_not be_nil }\n      its(['xpack.ssl.certificate']) { should_not be_nil }\n      its(['xpack.ssl.certificate_authorities']) { should_not be_nil }\n      its(['xpack.security.http.ssl.enabled']) { should eq true }\n      its(['xpack.security.transport.ssl.enabled']) { should eq true }\n    end\n\n    describe command(\"openssl rsa -in #{yaml(ELASTICSEARCH_CONF)['xpack.ssl.key']} -check -noout\") do\n      its('stdout'){ should match /RSA key ok/ }\n    end\n\n    describe x509_certificate(yaml(ELASTICSEARCH_CONF)['xpack.ssl.certificate']) do\n      it { should be_certificate }\n      it { should be_valid }\n    end\n\n    if yaml(ELASTICSEARCH_CONF)['xpack.ssl.certificate_authorities'].is_a?(Array)\n      yaml(ELASTICSEARCH_CONF)['xpack.ssl.certificate_authorities'].each do |cert|\n        describe x509_certificate(cert) do\n          it { should be_certificate }\n          it { should be_valid }\n        end\n      end\n    else\n      describe x509_certificate(yaml(ELASTICSEARCH_CONF)['xpack.ssl.certificate_authorities']) do\n        it { should be_certificate }\n        it { should be_valid }\n      end\n    end\n\n    describe es_handle do \n      it { should_not have_http_access }\n    end\n\n  rescue Exception => msg\n    describe \"Exception: #{msg}\" do\n      it { should be_nil}\n    end\n  end\nend\n",
          "source_location": {
            "line": 41,
            "ref": "../elasticsearch-inspec/controls/ssl+tsl+certs+http/V-27060.rb"
          },
          "results": [
            {
              "status": "passed",
              "code_desc": "SSL Settings for Node: package-centos-72 http_ssl.enabled should eq \"true\"",
              "run_time": 0.000153,
              "start_time": "2018-02-11 14:26:24 -0500"
            },
            {
              "status": "passed",
              "code_desc": "SSL Settings for Node: package-centos-72 transport_ssl.enabled should eq \"true\"",
              "run_time": 0.000078,
              "start_time": "2018-02-11 14:26:24 -0500"
            },
            {
              "status": "passed",
              "code_desc": "YAML /etc/elasticsearch/elasticsearch.yml [\"xpack.ssl.key\"] should not be nil",
              "run_time": 0.00007,
              "start_time": "2018-02-11 14:26:24 -0500"
            },
            {
              "status": "passed",
              "code_desc": "YAML /etc/elasticsearch/elasticsearch.yml [\"xpack.ssl.certificate\"] should not be nil",
              "run_time": 0.000074,
              "start_time": "2018-02-11 14:26:24 -0500"
            },
            {
              "status": "passed",
              "code_desc": "YAML /etc/elasticsearch/elasticsearch.yml [\"xpack.ssl.certificate_authorities\"] should not be nil",
              "run_time": 0.000056,
              "start_time": "2018-02-11 14:26:24 -0500"
            },
            {
              "status": "passed",
              "code_desc": "YAML /etc/elasticsearch/elasticsearch.yml [\"xpack.security.http.ssl.enabled\"] should eq true",
              "run_time": 0.000062,
              "start_time": "2018-02-11 14:26:24 -0500"
            },
            {
              "status": "passed",
              "code_desc": "YAML /etc/elasticsearch/elasticsearch.yml [\"xpack.security.transport.ssl.enabled\"] should eq true",
              "run_time": 0.000063,
              "start_time": "2018-02-11 14:26:24 -0500"
            },
            {
              "status": "passed",
              "code_desc": "Command openssl rsa -in /etc/elasticsearch/x-pack/elastic/elastic.key -check -noout stdout should match /RSA key ok/",
              "run_time": 0.018262,
              "start_time": "2018-02-11 14:26:24 -0500"
            },
            {
              "status": "passed",
              "code_desc": "x509_certificate /etc/elasticsearch/x-pack/elastic/elastic.crt should be certificate",
              "run_time": 0.0001,
              "start_time": "2018-02-11 14:26:24 -0500"
            },
            {
              "status": "passed",
              "code_desc": "x509_certificate /etc/elasticsearch/x-pack/elastic/elastic.crt should be valid",
              "run_time": 0.000096,
              "start_time": "2018-02-11 14:26:24 -0500"
            },
            {
              "status": "passed",
              "code_desc": "x509_certificate /etc/elasticsearch/x-pack/ca/ca.crt should be certificate",
              "run_time": 0.000064,
              "start_time": "2018-02-11 14:26:24 -0500"
            },
            {
              "status": "passed",
              "code_desc": "x509_certificate /etc/elasticsearch/x-pack/ca/ca.crt should be valid",
              "run_time": 0.000065,
              "start_time": "2018-02-11 14:26:24 -0500"
            },
            {
              "status": "passed",
              "code_desc": "Elasticsearch Cluster https://0.0.0.0:9200 should not have http access",
              "run_time": 0.020226,
              "start_time": "2018-02-11 14:26:24 -0500"
            }
          ]
        },
        {
          "id": "V-27030",
          "title": "The application must protect the integrity of information during the\nprocesses of data aggregation, packaging, and transformation in preparation for\ntransmission.",
          "desc": "Default system checksum are performed at multiple stages of data\naccess, if data is manipulated, the system invalidates the stored data.",
          "impact": 0.5,
          "refs": [],
          "tags": {
            "nist": [
              "SC-33",
              "Rev_3"
            ],
            "severity": "medium",
            "rid": "SV-34324r1_rule",
            "gtitle": "SRG-APP-000239",
            "cci": "CCI-001209",
            "check": "Application must utilize approved cryptography to protect the\nintegrity and confidentiality.\n\nAs the application administrator (usually elasticsearch), check the xpack.ssl\nsettings are set to the correct values.\n\n$cat elasticsearch.yml | grep xpack.ssl\n\nxpack.ssl.key:                     <server_key>.key\nxpack.ssl.certificate:             <server_certificate>.crt\nxpack.ssl.certificate_authorities: [ <approved_ca>.crt' ]\n\nIf these setting are not set or the underlying certificate and keys are not\ncorrect, this is a finding.\n\n$cat elasticsearch.yml | grep xpack.security.http.ssl.enabled:\n\nIf this setting is set to false, this is a finding.\n\n$cat elasticsearch.yml | grep xpack.security.transport.ssl.enabled:\n\nIf this setting is set to false, this is a finding.\n\nAs a elasticsearch user, check that non-secure http traffic does not response\nwith 200 status:\n\n$curl -H 'Content-Type: application/json' -u <TEST_USER> -p <TEST_CREDENTIALS>\nhttp://<elasticsearchIP:9200>/\n\nIf a 200 response comes back, this is a finding.",
            "fix": "Implement protective measures when protecting integrity and\nconfidentiality.\n\n See the official documentation for the complete  guide on establishing SSL\nconfiguration: https://www.elastic.co/guide/en/x-pack/current/ssl-tls.html"
          },
          "code": "control \"V-27030\" do\n  title \"The application must protect the integrity of information during the\nprocesses of data aggregation, packaging, and transformation in preparation for\ntransmission.\"\n  desc  \"Default system checksum are performed at multiple stages of data\naccess, if data is manipulated, the system invalidates the stored data.\"\n  impact 0.5\n  tag \"nist\": [\"SC-33\", \"Rev_3\"]\n  tag \"severity\": \"medium\"\n  tag \"rid\": \"SV-34324r1_rule\"\n  tag \"gtitle\": \"SRG-APP-000239\"\n  tag \"cci\": \"CCI-001209\"\n  tag \"check\": \"Application must utilize approved cryptography to protect the\nintegrity and confidentiality.\n\nAs the application administrator (usually elasticsearch), check the xpack.ssl\nsettings are set to the correct values.\n\n$cat elasticsearch.yml | grep xpack.ssl\n\nxpack.ssl.key:                     <server_key>.key\nxpack.ssl.certificate:             <server_certificate>.crt\nxpack.ssl.certificate_authorities: [ <approved_ca>.crt' ]\n\nIf these setting are not set or the underlying certificate and keys are not\ncorrect, this is a finding.\n\n$cat elasticsearch.yml | grep xpack.security.http.ssl.enabled:\n\nIf this setting is set to false, this is a finding.\n\n$cat elasticsearch.yml | grep xpack.security.transport.ssl.enabled:\n\nIf this setting is set to false, this is a finding.\n\nAs a elasticsearch user, check that non-secure http traffic does not response\nwith 200 status:\n\n$curl -H 'Content-Type: application/json' -u <TEST_USER> -p <TEST_CREDENTIALS>\nhttp://<elasticsearchIP:9200>/\n\nIf a 200 response comes back, this is a finding.\"\n  tag \"fix\": \"Implement protective measures when protecting integrity and\nconfidentiality.\n\n See the official documentation for the complete  guide on establishing SSL\nconfiguration: https://www.elastic.co/guide/en/x-pack/current/ssl-tls.html\"\n\n  begin\n    es_handle = es_helper(url:\"https://#{ELASTIC_IP}:#{ELASTIC_PORT}\",\n                    username: ES_ADMIN,\n                    password: ES_PASS,\n                    ssl_verify: SSL_VERIFY )\n\n    describe \"No nodes found\" do\n      subject { es_handle.nodes.nil? }\n      it { should_not be_truthy }\n    end if es_handle.nodes.nil?\n\n    es_handle.nodes.each do |node|\n      describe \"SSL Settings for Node: #{node.name}\" do\n        subject { node }\n        its(\"http_ssl.enabled\") { should eq 'true' }\n        its(\"transport_ssl.enabled\") { should eq 'true' }\n      end\n    end unless es_handle.nodes.nil?\n\n    describe yaml(ELASTICSEARCH_CONF) do\n      its(['xpack.ssl.key']) { should_not be_nil }\n      its(['xpack.ssl.certificate']) { should_not be_nil }\n      its(['xpack.ssl.certificate_authorities']) { should_not be_nil }\n      its(['xpack.security.http.ssl.enabled']) { should eq true }\n      its(['xpack.security.transport.ssl.enabled']) { should eq true }\n    end\n\n    describe command(\"openssl rsa -in #{yaml(ELASTICSEARCH_CONF)['xpack.ssl.key']} -check -noout\") do\n      its('stdout'){ should match /RSA key ok/ }\n    end\n\n    describe x509_certificate(yaml(ELASTICSEARCH_CONF)['xpack.ssl.certificate']) do\n      it { should be_certificate }\n      it { should be_valid }\n    end\n\n    if yaml(ELASTICSEARCH_CONF)['xpack.ssl.certificate_authorities'].is_a?(Array)\n      yaml(ELASTICSEARCH_CONF)['xpack.ssl.certificate_authorities'].each do |cert|\n        describe x509_certificate(cert) do\n          it { should be_certificate }\n          it { should be_valid }\n        end\n      end\n    else\n      describe x509_certificate(yaml(ELASTICSEARCH_CONF)['xpack.ssl.certificate_authorities']) do\n        it { should be_certificate }\n        it { should be_valid }\n      end\n    end\n\n    describe es_handle do \n      it { should_not have_http_access }\n    end\n\n  rescue Exception => msg\n    describe \"Exception: #{msg}\" do\n      it { should be_nil}\n    end\n  end\nend\n",
          "source_location": {
            "line": 41,
            "ref": "../elasticsearch-inspec/controls/ssl+tsl+certs+http/V-27030.rb"
          },
          "results": [
            {
              "status": "passed",
              "code_desc": "SSL Settings for Node: package-centos-72 http_ssl.enabled should eq \"true\"",
              "run_time": 0.000128,
              "start_time": "2018-02-11 14:26:24 -0500"
            },
            {
              "status": "passed",
              "code_desc": "SSL Settings for Node: package-centos-72 transport_ssl.enabled should eq \"true\"",
              "run_time": 0.000086,
              "start_time": "2018-02-11 14:26:24 -0500"
            },
            {
              "status": "passed",
              "code_desc": "YAML /etc/elasticsearch/elasticsearch.yml [\"xpack.ssl.key\"] should not be nil",
              "run_time": 0.000083,
              "start_time": "2018-02-11 14:26:24 -0500"
            },
            {
              "status": "passed",
              "code_desc": "YAML /etc/elasticsearch/elasticsearch.yml [\"xpack.ssl.certificate\"] should not be nil",
              "run_time": 0.000065,
              "start_time": "2018-02-11 14:26:24 -0500"
            },
            {
              "status": "passed",
              "code_desc": "YAML /etc/elasticsearch/elasticsearch.yml [\"xpack.ssl.certificate_authorities\"] should not be nil",
              "run_time": 0.000088,
              "start_time": "2018-02-11 14:26:24 -0500"
            },
            {
              "status": "passed",
              "code_desc": "YAML /etc/elasticsearch/elasticsearch.yml [\"xpack.security.http.ssl.enabled\"] should eq true",
              "run_time": 0.000073,
              "start_time": "2018-02-11 14:26:24 -0500"
            },
            {
              "status": "passed",
              "code_desc": "YAML /etc/elasticsearch/elasticsearch.yml [\"xpack.security.transport.ssl.enabled\"] should eq true",
              "run_time": 0.000069,
              "start_time": "2018-02-11 14:26:24 -0500"
            },
            {
              "status": "passed",
              "code_desc": "Command openssl rsa -in /etc/elasticsearch/x-pack/elastic/elastic.key -check -noout stdout should match /RSA key ok/",
              "run_time": 0.019152,
              "start_time": "2018-02-11 14:26:24 -0500"
            },
            {
              "status": "passed",
              "code_desc": "x509_certificate /etc/elasticsearch/x-pack/elastic/elastic.crt should be certificate",
              "run_time": 0.000098,
              "start_time": "2018-02-11 14:26:24 -0500"
            },
            {
              "status": "passed",
              "code_desc": "x509_certificate /etc/elasticsearch/x-pack/elastic/elastic.crt should be valid",
              "run_time": 0.000099,
              "start_time": "2018-02-11 14:26:24 -0500"
            },
            {
              "status": "passed",
              "code_desc": "x509_certificate /etc/elasticsearch/x-pack/ca/ca.crt should be certificate",
              "run_time": 0.000061,
              "start_time": "2018-02-11 14:26:24 -0500"
            },
            {
              "status": "passed",
              "code_desc": "x509_certificate /etc/elasticsearch/x-pack/ca/ca.crt should be valid",
              "run_time": 0.000061,
              "start_time": "2018-02-11 14:26:24 -0500"
            },
            {
              "status": "passed",
              "code_desc": "Elasticsearch Cluster https://0.0.0.0:9200 should not have http access",
              "run_time": 0.022897,
              "start_time": "2018-02-11 14:26:24 -0500"
            }
          ]
        },
        {
          "id": "V-27061",
          "title": "The application must employ cryptographic mechanisms preventing the\nunauthorized disclosure of information during transmission unless the\ntransmitted data is otherwise protected by alternative physical measures.",
          "desc": "Use SSL / TLS communication for all networked access to Elasticsearch\nand connected components such as Kibana and Logstash.  X-Pack Security should\nbe configured with organizational approved cryptography.",
          "impact": 0.5,
          "refs": [],
          "tags": {
            "nist": [
              "SC-9 (1)",
              "Rev_3"
            ],
            "severity": "medium",
            "rid": "SV-34356r1_rule",
            "gtitle": "SRG-APP-000264",
            "cci": "CCI-001131",
            "check": "Application must utilize approved cryptography to protect data\ntransmission.\n\nAs the application administrator (usually elasticsearch), check the xpack.ssl\nsettings are set to the correct values.\n\n$cat elasticsearch.yml | grep xpack.ssl\n\nxpack.ssl.key:                     <server_key>.key\nxpack.ssl.certificate:             <server_certificate>.crt\nxpack.ssl.certificate_authorities: [ <approved_ca>.crt' ]\n\nIf these setting are not set or the underlying certificate and keys are not\ncorrect, this is a finding.\n\n$cat elasticsearch.yml | grep xpack.security.http.ssl.enabled:\n\nIf this setting is set to false, this is a finding.\n\n$cat elasticsearch.yml | grep xpack.security.transport.ssl.enabled:\n\nIf this setting is set to false, this is a finding.\n\nAs a elasticsearch user, check that non-secure http traffic does not response\nwith 200 status:\n\n$curl -H 'Content-Type: application/json' -u <TEST_USER> -p <TEST_CREDENTIALS>\nhttp://<elasticsearchIP:9200>/\n\nIf a 200 response comes back, this is a finding.",
            "fix": "Implement protective measures during data transmission.\n\n See the official documentation for the complete  guide on establishing SSL\nconfiguration: https://www.elastic.co/guide/en/x-pack/current/ssl-tls.html"
          },
          "code": "control \"V-27061\" do\n  title \"The application must employ cryptographic mechanisms preventing the\nunauthorized disclosure of information during transmission unless the\ntransmitted data is otherwise protected by alternative physical measures.\"\n  desc  \"Use SSL / TLS communication for all networked access to Elasticsearch\nand connected components such as Kibana and Logstash.  X-Pack Security should\nbe configured with organizational approved cryptography.\"\n  impact 0.5\n  tag \"nist\": [\"SC-9 (1)\", \"Rev_3\"]\n  tag \"severity\": \"medium\"\n  tag \"rid\": \"SV-34356r1_rule\"\n  tag \"gtitle\": \"SRG-APP-000264\"\n  tag \"cci\": \"CCI-001131\"\n  tag \"check\": \"Application must utilize approved cryptography to protect data\ntransmission.\n\nAs the application administrator (usually elasticsearch), check the xpack.ssl\nsettings are set to the correct values.\n\n$cat elasticsearch.yml | grep xpack.ssl\n\nxpack.ssl.key:                     <server_key>.key\nxpack.ssl.certificate:             <server_certificate>.crt\nxpack.ssl.certificate_authorities: [ <approved_ca>.crt' ]\n\nIf these setting are not set or the underlying certificate and keys are not\ncorrect, this is a finding.\n\n$cat elasticsearch.yml | grep xpack.security.http.ssl.enabled:\n\nIf this setting is set to false, this is a finding.\n\n$cat elasticsearch.yml | grep xpack.security.transport.ssl.enabled:\n\nIf this setting is set to false, this is a finding.\n\nAs a elasticsearch user, check that non-secure http traffic does not response\nwith 200 status:\n\n$curl -H 'Content-Type: application/json' -u <TEST_USER> -p <TEST_CREDENTIALS>\nhttp://<elasticsearchIP:9200>/\n\nIf a 200 response comes back, this is a finding.\"\n  tag \"fix\": \"Implement protective measures during data transmission.\n\n See the official documentation for the complete  guide on establishing SSL\nconfiguration: https://www.elastic.co/guide/en/x-pack/current/ssl-tls.html\"\n\n\n  begin\n    es_handle = es_helper(url:\"https://#{ELASTIC_IP}:#{ELASTIC_PORT}\",\n                    username: ES_ADMIN,\n                    password: ES_PASS,\n                    ssl_verify: SSL_VERIFY )\n\n    describe \"No nodes found\" do\n      subject { es_handle.nodes.nil? }\n      it { should_not be_truthy }\n    end if es_handle.nodes.nil?\n\n    es_handle.nodes.each do |node|\n      describe \"SSL Settings for Node: #{node.name}\" do\n        subject { node }\n        its(\"http_ssl.enabled\") { should eq 'true' }\n        its(\"transport_ssl.enabled\") { should eq 'true' }\n      end\n    end unless es_handle.nodes.nil?\n\n    describe yaml(ELASTICSEARCH_CONF) do\n      its(['xpack.ssl.key']) { should_not be_nil }\n      its(['xpack.ssl.certificate']) { should_not be_nil }\n      its(['xpack.ssl.certificate_authorities']) { should_not be_nil }\n      its(['xpack.security.http.ssl.enabled']) { should eq true }\n      its(['xpack.security.transport.ssl.enabled']) { should eq true }\n    end\n\n    describe command(\"openssl rsa -in #{yaml(ELASTICSEARCH_CONF)['xpack.ssl.key']} -check -noout\") do\n      its('stdout'){ should match /RSA key ok/ }\n    end\n\n    describe x509_certificate(yaml(ELASTICSEARCH_CONF)['xpack.ssl.certificate']) do\n      it { should be_certificate }\n      it { should be_valid }\n    end\n\n    if yaml(ELASTICSEARCH_CONF)['xpack.ssl.certificate_authorities'].is_a?(Array)\n      yaml(ELASTICSEARCH_CONF)['xpack.ssl.certificate_authorities'].each do |cert|\n        describe x509_certificate(cert) do\n          it { should be_certificate }\n          it { should be_valid }\n        end\n      end\n    else\n      describe x509_certificate(yaml(ELASTICSEARCH_CONF)['xpack.ssl.certificate_authorities']) do\n        it { should be_certificate }\n        it { should be_valid }\n      end\n    end\n\n    describe es_handle do \n      it { should_not have_http_access }\n    end\n\n  rescue Exception => msg\n    describe \"Exception: #{msg}\" do\n      it { should be_nil}\n    end\n  end\nend\n",
          "source_location": {
            "line": 41,
            "ref": "../elasticsearch-inspec/controls/ssl+tsl+certs+http/V-27061.rb"
          },
          "results": [
            {
              "status": "passed",
              "code_desc": "SSL Settings for Node: package-centos-72 http_ssl.enabled should eq \"true\"",
              "run_time": 0.000117,
              "start_time": "2018-02-11 14:26:24 -0500"
            },
            {
              "status": "passed",
              "code_desc": "SSL Settings for Node: package-centos-72 transport_ssl.enabled should eq \"true\"",
              "run_time": 0.000091,
              "start_time": "2018-02-11 14:26:24 -0500"
            },
            {
              "status": "passed",
              "code_desc": "YAML /etc/elasticsearch/elasticsearch.yml [\"xpack.ssl.key\"] should not be nil",
              "run_time": 0.000072,
              "start_time": "2018-02-11 14:26:24 -0500"
            },
            {
              "status": "passed",
              "code_desc": "YAML /etc/elasticsearch/elasticsearch.yml [\"xpack.ssl.certificate\"] should not be nil",
              "run_time": 0.00006,
              "start_time": "2018-02-11 14:26:24 -0500"
            },
            {
              "status": "passed",
              "code_desc": "YAML /etc/elasticsearch/elasticsearch.yml [\"xpack.ssl.certificate_authorities\"] should not be nil",
              "run_time": 0.000067,
              "start_time": "2018-02-11 14:26:24 -0500"
            },
            {
              "status": "passed",
              "code_desc": "YAML /etc/elasticsearch/elasticsearch.yml [\"xpack.security.http.ssl.enabled\"] should eq true",
              "run_time": 0.000062,
              "start_time": "2018-02-11 14:26:24 -0500"
            },
            {
              "status": "passed",
              "code_desc": "YAML /etc/elasticsearch/elasticsearch.yml [\"xpack.security.transport.ssl.enabled\"] should eq true",
              "run_time": 0.000076,
              "start_time": "2018-02-11 14:26:24 -0500"
            },
            {
              "status": "passed",
              "code_desc": "Command openssl rsa -in /etc/elasticsearch/x-pack/elastic/elastic.key -check -noout stdout should match /RSA key ok/",
              "run_time": 0.018725,
              "start_time": "2018-02-11 14:26:24 -0500"
            },
            {
              "status": "passed",
              "code_desc": "x509_certificate /etc/elasticsearch/x-pack/elastic/elastic.crt should be certificate",
              "run_time": 0.000095,
              "start_time": "2018-02-11 14:26:24 -0500"
            },
            {
              "status": "passed",
              "code_desc": "x509_certificate /etc/elasticsearch/x-pack/elastic/elastic.crt should be valid",
              "run_time": 0.000077,
              "start_time": "2018-02-11 14:26:24 -0500"
            },
            {
              "status": "passed",
              "code_desc": "x509_certificate /etc/elasticsearch/x-pack/ca/ca.crt should be certificate",
              "run_time": 0.000064,
              "start_time": "2018-02-11 14:26:24 -0500"
            },
            {
              "status": "passed",
              "code_desc": "x509_certificate /etc/elasticsearch/x-pack/ca/ca.crt should be valid",
              "run_time": 0.000064,
              "start_time": "2018-02-11 14:26:24 -0500"
            },
            {
              "status": "passed",
              "code_desc": "Elasticsearch Cluster https://0.0.0.0:9200 should not have http access",
              "run_time": 0.019772,
              "start_time": "2018-02-11 14:26:24 -0500"
            }
          ]
        },
        {
          "id": "V-27092",
          "title": "For those instances where the organizational requires encrypted\ntraffic to be visible to information system monitoring tools, the application\ntransmitting the encrypted traffic must make provisions to allow that traffic\nto be visible to specific system monitoring tools.",
          "desc": "Use SSL / TLS communication for all networked access to Elasticsearch\nand connected components such as Kibana and Logstash.  X-Pack Security should\nbe configured with organizational approved cryptography.",
          "impact": 0.5,
          "refs": [],
          "tags": {
            "nist": [
              "SI-4 (10)",
              "Rev_3"
            ],
            "severity": "medium",
            "rid": "SV-34387r1_rule",
            "gtitle": "SRG-APP-000282",
            "cci": "CCI-001272",
            "check": "Application must utilize approved cryptography to protect\npasswords in transmission.\nAs the application administrator (usually elasticsearch), check the xpack.ssl\nsettings are set to the correct values.\n\n$cat elasticsearch.yml | grep xpack.ssl\n\nxpack.ssl.key:                     <server_key>.key\nxpack.ssl.certificate:             <server_certificate>.crt\nxpack.ssl.certificate_authorities: [ <approved_ca>.crt' ]\n\nIf these setting are not set or the underlying certificate and keys are not\ncorrect, this is a finding.\n\n$cat elasticsearch.yml | grep xpack.security.http.ssl.enabled:\n\nIf this setting is set to false, this is a finding.\n\n$cat elasticsearch.yml | grep xpack.security.transport.ssl.enabled:\n\nIf this setting is set to false, this is a finding.\n\nAs a elasticsearch user, check that non-secure http traffic does not response\nwith 200 status:\n\n$curl -H 'Content-Type: application/json' -u <TEST_USER> -p <TEST_CREDENTIALS>\nhttp://<elasticsearchIP:9200>/\n\nIf a 200 response comes back, this is a finding.",
            "fix": "Implement protective measures when enforcing password encryption\nfor transmission.\n\n See the official documentation for the complete  guide on establishing SSL\nconfiguration: https://www.elastic.co/guide/en/x-pack/current/ssl-tls.html"
          },
          "code": "control \"V-27092\" do\n  title \"For those instances where the organizational requires encrypted\ntraffic to be visible to information system monitoring tools, the application\ntransmitting the encrypted traffic must make provisions to allow that traffic\nto be visible to specific system monitoring tools.\"\n  desc  \"Use SSL / TLS communication for all networked access to Elasticsearch\nand connected components such as Kibana and Logstash.  X-Pack Security should\nbe configured with organizational approved cryptography.\"\n  impact 0.5\n  tag \"nist\": [\"SI-4 (10)\", \"Rev_3\"]\n  tag \"severity\": \"medium\"\n  tag \"rid\": \"SV-34387r1_rule\"\n  tag \"gtitle\": \"SRG-APP-000282\"\n  tag \"cci\": \"CCI-001272\"\n  tag \"check\": \"Application must utilize approved cryptography to protect\npasswords in transmission.\nAs the application administrator (usually elasticsearch), check the xpack.ssl\nsettings are set to the correct values.\n\n$cat elasticsearch.yml | grep xpack.ssl\n\nxpack.ssl.key:                     <server_key>.key\nxpack.ssl.certificate:             <server_certificate>.crt\nxpack.ssl.certificate_authorities: [ <approved_ca>.crt' ]\n\nIf these setting are not set or the underlying certificate and keys are not\ncorrect, this is a finding.\n\n$cat elasticsearch.yml | grep xpack.security.http.ssl.enabled:\n\nIf this setting is set to false, this is a finding.\n\n$cat elasticsearch.yml | grep xpack.security.transport.ssl.enabled:\n\nIf this setting is set to false, this is a finding.\n\nAs a elasticsearch user, check that non-secure http traffic does not response\nwith 200 status:\n\n$curl -H 'Content-Type: application/json' -u <TEST_USER> -p <TEST_CREDENTIALS>\nhttp://<elasticsearchIP:9200>/\n\nIf a 200 response comes back, this is a finding.\"\n  tag \"fix\": \"Implement protective measures when enforcing password encryption\nfor transmission.\n\n See the official documentation for the complete  guide on establishing SSL\nconfiguration: https://www.elastic.co/guide/en/x-pack/current/ssl-tls.html\"\n\n  begin\n    es_handle = es_helper(url:\"https://#{ELASTIC_IP}:#{ELASTIC_PORT}\",\n                    username: ES_ADMIN,\n                    password: ES_PASS,\n                    ssl_verify: SSL_VERIFY )\n\n    describe \"No nodes found\" do\n      subject { es_handle.nodes.nil? }\n      it { should_not be_truthy }\n    end if es_handle.nodes.nil?\n\n    es_handle.nodes.each do |node|\n      describe \"SSL Settings for Node: #{node.name}\" do\n        subject { node }\n        its(\"http_ssl.enabled\") { should eq 'true' }\n        its(\"transport_ssl.enabled\") { should eq 'true' }\n      end\n    end unless es_handle.nodes.nil?\n\n    describe yaml(ELASTICSEARCH_CONF) do\n      its(['xpack.ssl.key']) { should_not be_nil }\n      its(['xpack.ssl.certificate']) { should_not be_nil }\n      its(['xpack.ssl.certificate_authorities']) { should_not be_nil }\n      its(['xpack.security.http.ssl.enabled']) { should eq true }\n      its(['xpack.security.transport.ssl.enabled']) { should eq true }\n    end\n\n    describe command(\"openssl rsa -in #{yaml(ELASTICSEARCH_CONF)['xpack.ssl.key']} -check -noout\") do\n      its('stdout'){ should match /RSA key ok/ }\n    end\n\n    describe x509_certificate(yaml(ELASTICSEARCH_CONF)['xpack.ssl.certificate']) do\n      it { should be_certificate }\n      it { should be_valid }\n    end\n\n    if yaml(ELASTICSEARCH_CONF)['xpack.ssl.certificate_authorities'].is_a?(Array)\n      yaml(ELASTICSEARCH_CONF)['xpack.ssl.certificate_authorities'].each do |cert|\n        describe x509_certificate(cert) do\n          it { should be_certificate }\n          it { should be_valid }\n        end\n      end\n    else\n      describe x509_certificate(yaml(ELASTICSEARCH_CONF)['xpack.ssl.certificate_authorities']) do\n        it { should be_certificate }\n        it { should be_valid }\n      end\n    end\n\n    describe es_handle do \n      it { should_not have_http_access }\n    end\n\n  rescue Exception => msg\n    describe \"Exception: #{msg}\" do\n      it { should be_nil}\n    end\n  end\nend\n",
          "source_location": {
            "line": 42,
            "ref": "../elasticsearch-inspec/controls/ssl+tsl+certs+http/V-27092.rb"
          },
          "results": [
            {
              "status": "passed",
              "code_desc": "SSL Settings for Node: package-centos-72 http_ssl.enabled should eq \"true\"",
              "run_time": 0.00014,
              "start_time": "2018-02-11 14:26:24 -0500"
            },
            {
              "status": "passed",
              "code_desc": "SSL Settings for Node: package-centos-72 transport_ssl.enabled should eq \"true\"",
              "run_time": 0.000079,
              "start_time": "2018-02-11 14:26:24 -0500"
            },
            {
              "status": "passed",
              "code_desc": "YAML /etc/elasticsearch/elasticsearch.yml [\"xpack.ssl.key\"] should not be nil",
              "run_time": 0.000077,
              "start_time": "2018-02-11 14:26:24 -0500"
            },
            {
              "status": "passed",
              "code_desc": "YAML /etc/elasticsearch/elasticsearch.yml [\"xpack.ssl.certificate\"] should not be nil",
              "run_time": 0.000056,
              "start_time": "2018-02-11 14:26:24 -0500"
            },
            {
              "status": "passed",
              "code_desc": "YAML /etc/elasticsearch/elasticsearch.yml [\"xpack.ssl.certificate_authorities\"] should not be nil",
              "run_time": 0.000078,
              "start_time": "2018-02-11 14:26:24 -0500"
            },
            {
              "status": "passed",
              "code_desc": "YAML /etc/elasticsearch/elasticsearch.yml [\"xpack.security.http.ssl.enabled\"] should eq true",
              "run_time": 0.000151,
              "start_time": "2018-02-11 14:26:24 -0500"
            },
            {
              "status": "passed",
              "code_desc": "YAML /etc/elasticsearch/elasticsearch.yml [\"xpack.security.transport.ssl.enabled\"] should eq true",
              "run_time": 0.000109,
              "start_time": "2018-02-11 14:26:24 -0500"
            },
            {
              "status": "passed",
              "code_desc": "Command openssl rsa -in /etc/elasticsearch/x-pack/elastic/elastic.key -check -noout stdout should match /RSA key ok/",
              "run_time": 0.020579,
              "start_time": "2018-02-11 14:26:24 -0500"
            },
            {
              "status": "passed",
              "code_desc": "x509_certificate /etc/elasticsearch/x-pack/elastic/elastic.crt should be certificate",
              "run_time": 0.00013,
              "start_time": "2018-02-11 14:26:24 -0500"
            },
            {
              "status": "passed",
              "code_desc": "x509_certificate /etc/elasticsearch/x-pack/elastic/elastic.crt should be valid",
              "run_time": 0.000081,
              "start_time": "2018-02-11 14:26:24 -0500"
            },
            {
              "status": "passed",
              "code_desc": "x509_certificate /etc/elasticsearch/x-pack/ca/ca.crt should be certificate",
              "run_time": 0.000064,
              "start_time": "2018-02-11 14:26:24 -0500"
            },
            {
              "status": "passed",
              "code_desc": "x509_certificate /etc/elasticsearch/x-pack/ca/ca.crt should be valid",
              "run_time": 0.000065,
              "start_time": "2018-02-11 14:26:24 -0500"
            },
            {
              "status": "passed",
              "code_desc": "Elasticsearch Cluster https://0.0.0.0:9200 should not have http access",
              "run_time": 0.019537,
              "start_time": "2018-02-11 14:26:24 -0500"
            }
          ]
        },
        {
          "id": "V-26907",
          "title": "The application must use organizational-defined replay-resistant\nauthentication mechanisms for network access to privileged accounts.",
          "desc": "Configure PKI authentication, TLS/SSL, and cluster key features of\nX-pack Security so that authentication and communication within Elasticsearch\nis replay resistant.",
          "impact": 0.5,
          "refs": [],
          "tags": {
            "nist": [
              "IA-2 (8)",
              "Rev_3"
            ],
            "severity": "medium",
            "rid": "SV-34187r1_rule",
            "gtitle": "SRG-APP-000156",
            "cci": "CCI-000774",
            "check": "Application must utilize approved cryptography to authenticate\nnon-local maintenance sessions.\n\n$cat elasticsearch.yml | grep xpack.ssl\n\nxpack.ssl.key:                     <server_key>.key\nxpack.ssl.certificate:             <server_certificate>.crt\nxpack.ssl.certificate_authorities: [ <approved_ca>.crt' ]\n\nIf these setting are not set or the underlying certificate and keys are not\ncorrect, this is a finding.\n\n$cat elasticsearch.yml | grep xpack.security.http.ssl.enabled:\n\nIf this setting is set to false, this is a finding.\n\n$cat elasticsearch.yml | grep xpack.security.transport.ssl.enabled:\n\nIf this setting is set to false, this is a finding.\n\nAs a elasticsearch user, check that non-secure http traffic does not response\nwith 200 status:\n\n$curl -H 'Content-Type: application/json' -u <TEST_USER> -p <TEST_CREDENTIALS>\nhttp://<elasticsearchIP:9200>/\n\nIf a 200 response comes back, this is a finding.",
            "fix": "Implement approved cryptography to authenticate non-local\nmaintenance sessions.\n\n See the official documentation for the complete  guide on establishing SSL\nconfiguration: https://www.elastic.co/guide/en/x-pack/current/ssl-tls.html"
          },
          "code": "control \"V-26907\" do\n  title \"The application must use organizational-defined replay-resistant\nauthentication mechanisms for network access to privileged accounts.\"\n  desc  \"Configure PKI authentication, TLS/SSL, and cluster key features of\nX-pack Security so that authentication and communication within Elasticsearch\nis replay resistant.\"\n  impact 0.5\n  tag \"nist\": [\"IA-2 (8)\", \"Rev_3\"]\n  tag \"severity\": \"medium\"\n  tag \"rid\": \"SV-34187r1_rule\"\n  tag \"gtitle\": \"SRG-APP-000156\"\n  tag \"cci\": \"CCI-000774\"\n  tag \"check\": \"Application must utilize approved cryptography to authenticate\nnon-local maintenance sessions.\n\n$cat elasticsearch.yml | grep xpack.ssl\n\nxpack.ssl.key:                     <server_key>.key\nxpack.ssl.certificate:             <server_certificate>.crt\nxpack.ssl.certificate_authorities: [ <approved_ca>.crt' ]\n\nIf these setting are not set or the underlying certificate and keys are not\ncorrect, this is a finding.\n\n$cat elasticsearch.yml | grep xpack.security.http.ssl.enabled:\n\nIf this setting is set to false, this is a finding.\n\n$cat elasticsearch.yml | grep xpack.security.transport.ssl.enabled:\n\nIf this setting is set to false, this is a finding.\n\nAs a elasticsearch user, check that non-secure http traffic does not response\nwith 200 status:\n\n$curl -H 'Content-Type: application/json' -u <TEST_USER> -p <TEST_CREDENTIALS>\nhttp://<elasticsearchIP:9200>/\n\nIf a 200 response comes back, this is a finding.\"\n  tag \"fix\": \"Implement approved cryptography to authenticate non-local\nmaintenance sessions.\n\n See the official documentation for the complete  guide on establishing SSL\nconfiguration: https://www.elastic.co/guide/en/x-pack/current/ssl-tls.html\"\n\n  begin\n    es_handle = es_helper(url:\"https://#{ELASTIC_IP}:#{ELASTIC_PORT}\",\n                    username: ES_ADMIN,\n                    password: ES_PASS,\n                    ssl_verify: SSL_VERIFY )\n\n    describe \"No nodes found\" do\n      subject { es_handle.nodes.nil? }\n      it { should_not be_truthy }\n    end if es_handle.nodes.nil?\n\n    es_handle.nodes.each do |node|\n      describe \"SSL Settings for Node: #{node.name}\" do\n        subject { node }\n        its(\"http_ssl.enabled\") { should eq 'true' }\n        its(\"transport_ssl.enabled\") { should eq 'true' }\n      end\n    end unless es_handle.nodes.nil?\n\n    describe yaml(ELASTICSEARCH_CONF) do\n      its(['xpack.ssl.key']) { should_not be_nil }\n      its(['xpack.ssl.certificate']) { should_not be_nil }\n      its(['xpack.ssl.certificate_authorities']) { should_not be_nil }\n      its(['xpack.security.http.ssl.enabled']) { should eq true }\n      its(['xpack.security.transport.ssl.enabled']) { should eq true }\n    end\n\n    describe command(\"openssl rsa -in #{yaml(ELASTICSEARCH_CONF)['xpack.ssl.key']} -check -noout\") do\n      its('stdout'){ should match /RSA key ok/ }\n    end\n\n    describe x509_certificate(yaml(ELASTICSEARCH_CONF)['xpack.ssl.certificate']) do\n      it { should be_certificate }\n      it { should be_valid }\n    end\n\n    if yaml(ELASTICSEARCH_CONF)['xpack.ssl.certificate_authorities'].is_a?(Array)\n      yaml(ELASTICSEARCH_CONF)['xpack.ssl.certificate_authorities'].each do |cert|\n        describe x509_certificate(cert) do\n          it { should be_certificate }\n          it { should be_valid }\n        end\n      end\n    else\n      describe x509_certificate(yaml(ELASTICSEARCH_CONF)['xpack.ssl.certificate_authorities']) do\n        it { should be_certificate }\n        it { should be_valid }\n      end\n    end\n\n    describe es_handle do \n      it { should_not have_http_access }\n    end\n\n  rescue Exception => msg\n    describe \"Exception: #{msg}\" do\n      it { should be_nil}\n    end\n  end\nend\n",
          "source_location": {
            "line": 41,
            "ref": "../elasticsearch-inspec/controls/ssl+tsl+certs+http/V-26907.rb"
          },
          "results": [
            {
              "status": "passed",
              "code_desc": "SSL Settings for Node: package-centos-72 http_ssl.enabled should eq \"true\"",
              "run_time": 0.000163,
              "start_time": "2018-02-11 14:26:24 -0500"
            },
            {
              "status": "passed",
              "code_desc": "SSL Settings for Node: package-centos-72 transport_ssl.enabled should eq \"true\"",
              "run_time": 0.000117,
              "start_time": "2018-02-11 14:26:24 -0500"
            },
            {
              "status": "passed",
              "code_desc": "YAML /etc/elasticsearch/elasticsearch.yml [\"xpack.ssl.key\"] should not be nil",
              "run_time": 0.000177,
              "start_time": "2018-02-11 14:26:24 -0500"
            },
            {
              "status": "passed",
              "code_desc": "YAML /etc/elasticsearch/elasticsearch.yml [\"xpack.ssl.certificate\"] should not be nil",
              "run_time": 0.00011,
              "start_time": "2018-02-11 14:26:24 -0500"
            },
            {
              "status": "passed",
              "code_desc": "YAML /etc/elasticsearch/elasticsearch.yml [\"xpack.ssl.certificate_authorities\"] should not be nil",
              "run_time": 0.000098,
              "start_time": "2018-02-11 14:26:24 -0500"
            },
            {
              "status": "passed",
              "code_desc": "YAML /etc/elasticsearch/elasticsearch.yml [\"xpack.security.http.ssl.enabled\"] should eq true",
              "run_time": 0.000109,
              "start_time": "2018-02-11 14:26:24 -0500"
            },
            {
              "status": "passed",
              "code_desc": "YAML /etc/elasticsearch/elasticsearch.yml [\"xpack.security.transport.ssl.enabled\"] should eq true",
              "run_time": 0.000094,
              "start_time": "2018-02-11 14:26:24 -0500"
            },
            {
              "status": "passed",
              "code_desc": "Command openssl rsa -in /etc/elasticsearch/x-pack/elastic/elastic.key -check -noout stdout should match /RSA key ok/",
              "run_time": 0.020308,
              "start_time": "2018-02-11 14:26:24 -0500"
            },
            {
              "status": "passed",
              "code_desc": "x509_certificate /etc/elasticsearch/x-pack/elastic/elastic.crt should be certificate",
              "run_time": 0.000152,
              "start_time": "2018-02-11 14:26:24 -0500"
            },
            {
              "status": "passed",
              "code_desc": "x509_certificate /etc/elasticsearch/x-pack/elastic/elastic.crt should be valid",
              "run_time": 0.000097,
              "start_time": "2018-02-11 14:26:24 -0500"
            },
            {
              "status": "passed",
              "code_desc": "x509_certificate /etc/elasticsearch/x-pack/ca/ca.crt should be certificate",
              "run_time": 0.000082,
              "start_time": "2018-02-11 14:26:24 -0500"
            },
            {
              "status": "passed",
              "code_desc": "x509_certificate /etc/elasticsearch/x-pack/ca/ca.crt should be valid",
              "run_time": 0.000066,
              "start_time": "2018-02-11 14:26:24 -0500"
            },
            {
              "status": "passed",
              "code_desc": "Elasticsearch Cluster https://0.0.0.0:9200 should not have http access",
              "run_time": 0.022199,
              "start_time": "2018-02-11 14:26:24 -0500"
            }
          ]
        },
        {
          "id": "V-26894",
          "title": "The application must validate the binding of the reviewer identity to\nthe information at the transfer/release point prior to release/transfer from\none security domain to another security domain.",
          "desc": "Use SSL / TLS communication for all networked access to Elasticsearch\nand connected components such as Kibana and Logstash.  X-Pack Security should\nbe configured with organizational approved cryptography.",
          "impact": 0.5,
          "refs": [],
          "tags": {
            "nist": [
              "AU-10 (4) (a)",
              "Rev_4"
            ],
            "severity": "medium",
            "rid": "SV-34174r1_rule",
            "gtitle": "SRG-APP-000084",
            "cci": "CCI-001341",
            "check": "Application must utilize protective mechanisms when\nrecieving/transfering from one security domain to another.\n\nAs the application administrator (usually elasticsearch), check the xpack.ssl\nsettings are set to the correct values.\n\n$cat elasticsearch.yml | grep xpack.ssl\n\nxpack.ssl.key:                     <server_key>.key\nxpack.ssl.certificate:             <server_certificate>.crt\nxpack.ssl.certificate_authorities: [ <approved_ca>.crt' ]\n\nIf these setting are not set or the underlying certificate and keys are not\ncorrect, this is a finding.\n\n$cat elasticsearch.yml | grep xpack.security.http.ssl.enabled: true\n\nIf this setting is not present or set to true, this is a finding.\n\nAs a elasticsearch user, check that non-secure http traffic does not response\nwith 200 status:\n\n$curl -H 'Content-Type: application/json' -u <TEST_USER> -p <TEST_CREDENTIALS>\nhttp://<elasticsearchIP:9200>/\n\nIf a 200 response comes back, this is a finding.",
            "fix": "Implement protective measures against unauthorized disclosure and\nmodification prior to transfer/release of data between security domains.\n\nSee the official documentation for the complete  guide on establishing SSL\nconfiguration: https://www.elastic.co/guide/en/x-pack/current/ssl-tls.html"
          },
          "code": "control \"V-26894\" do\n  title \"The application must validate the binding of the reviewer identity to\nthe information at the transfer/release point prior to release/transfer from\none security domain to another security domain.\"\n  desc  \"Use SSL / TLS communication for all networked access to Elasticsearch\nand connected components such as Kibana and Logstash.  X-Pack Security should\nbe configured with organizational approved cryptography.\"\n  impact 0.5\n  tag \"nist\": [\"AU-10 (4) (a)\", \"Rev_4\"]\n  tag \"severity\": \"medium\"\n  tag \"rid\": \"SV-34174r1_rule\"\n  tag \"gtitle\": \"SRG-APP-000084\"\n  tag \"cci\": \"CCI-001341\"\n  tag \"check\": \"Application must utilize protective mechanisms when\nrecieving/transfering from one security domain to another.\n\nAs the application administrator (usually elasticsearch), check the xpack.ssl\nsettings are set to the correct values.\n\n$cat elasticsearch.yml | grep xpack.ssl\n\nxpack.ssl.key:                     <server_key>.key\nxpack.ssl.certificate:             <server_certificate>.crt\nxpack.ssl.certificate_authorities: [ <approved_ca>.crt' ]\n\nIf these setting are not set or the underlying certificate and keys are not\ncorrect, this is a finding.\n\n$cat elasticsearch.yml | grep xpack.security.http.ssl.enabled: true\n\nIf this setting is not present or set to true, this is a finding.\n\nAs a elasticsearch user, check that non-secure http traffic does not response\nwith 200 status:\n\n$curl -H 'Content-Type: application/json' -u <TEST_USER> -p <TEST_CREDENTIALS>\nhttp://<elasticsearchIP:9200>/\n\nIf a 200 response comes back, this is a finding.\"\n  tag \"fix\": \"Implement protective measures against unauthorized disclosure and\nmodification prior to transfer/release of data between security domains.\n\nSee the official documentation for the complete  guide on establishing SSL\nconfiguration: https://www.elastic.co/guide/en/x-pack/current/ssl-tls.html\"\n\n  begin\n    es_handle = es_helper(url:\"https://#{ELASTIC_IP}:#{ELASTIC_PORT}\",\n                    username: ES_ADMIN,\n                    password: ES_PASS,\n                    ssl_verify: SSL_VERIFY )\n\n    describe \"No nodes found\" do\n      subject { es_handle.nodes.nil? }\n      it { should_not be_truthy }\n    end if es_handle.nodes.nil?\n\n    es_handle.nodes.each do |node|\n      describe \"SSL Settings for Node: #{node.name}\" do\n        subject { node }\n        its(\"http_ssl.enabled\") { should eq 'true' }\n        its(\"transport_ssl.enabled\") { should eq 'true' }\n      end\n    end unless es_handle.nodes.nil?\n\n    describe yaml(ELASTICSEARCH_CONF) do\n      its(['xpack.ssl.key']) { should_not be_nil }\n      its(['xpack.ssl.certificate']) { should_not be_nil }\n      its(['xpack.ssl.certificate_authorities']) { should_not be_nil }\n      its(['xpack.security.http.ssl.enabled']) { should eq true }\n      its(['xpack.security.transport.ssl.enabled']) { should eq true }\n    end\n\n    describe command(\"openssl rsa -in #{yaml(ELASTICSEARCH_CONF)['xpack.ssl.key']} -check -noout\") do\n      its('stdout'){ should match /RSA key ok/ }\n    end\n\n    describe x509_certificate(yaml(ELASTICSEARCH_CONF)['xpack.ssl.certificate']) do\n      it { should be_certificate }\n      it { should be_valid }\n    end\n\n    if yaml(ELASTICSEARCH_CONF)['xpack.ssl.certificate_authorities'].is_a?(Array)\n      yaml(ELASTICSEARCH_CONF)['xpack.ssl.certificate_authorities'].each do |cert|\n        describe x509_certificate(cert) do\n          it { should be_certificate }\n          it { should be_valid }\n        end\n      end\n    else\n      describe x509_certificate(yaml(ELASTICSEARCH_CONF)['xpack.ssl.certificate_authorities']) do\n        it { should be_certificate }\n        it { should be_valid }\n      end\n    end\n\n    describe es_handle do \n      it { should_not have_http_access }\n    end\n\n  rescue Exception => msg\n    describe \"Exception: #{msg}\" do\n      it { should be_nil}\n    end\n  end\nend\n",
          "source_location": {
            "line": 41,
            "ref": "../elasticsearch-inspec/controls/ssl+tsl+certs+http/V-26894.rb"
          },
          "results": [
            {
              "status": "passed",
              "code_desc": "SSL Settings for Node: package-centos-72 http_ssl.enabled should eq \"true\"",
              "run_time": 0.000169,
              "start_time": "2018-02-11 14:26:24 -0500"
            },
            {
              "status": "passed",
              "code_desc": "SSL Settings for Node: package-centos-72 transport_ssl.enabled should eq \"true\"",
              "run_time": 0.000101,
              "start_time": "2018-02-11 14:26:24 -0500"
            },
            {
              "status": "passed",
              "code_desc": "YAML /etc/elasticsearch/elasticsearch.yml [\"xpack.ssl.key\"] should not be nil",
              "run_time": 0.000078,
              "start_time": "2018-02-11 14:26:24 -0500"
            },
            {
              "status": "passed",
              "code_desc": "YAML /etc/elasticsearch/elasticsearch.yml [\"xpack.ssl.certificate\"] should not be nil",
              "run_time": 0.00006,
              "start_time": "2018-02-11 14:26:24 -0500"
            },
            {
              "status": "passed",
              "code_desc": "YAML /etc/elasticsearch/elasticsearch.yml [\"xpack.ssl.certificate_authorities\"] should not be nil",
              "run_time": 0.000058,
              "start_time": "2018-02-11 14:26:24 -0500"
            },
            {
              "status": "passed",
              "code_desc": "YAML /etc/elasticsearch/elasticsearch.yml [\"xpack.security.http.ssl.enabled\"] should eq true",
              "run_time": 0.00007,
              "start_time": "2018-02-11 14:26:24 -0500"
            },
            {
              "status": "passed",
              "code_desc": "YAML /etc/elasticsearch/elasticsearch.yml [\"xpack.security.transport.ssl.enabled\"] should eq true",
              "run_time": 0.000061,
              "start_time": "2018-02-11 14:26:24 -0500"
            },
            {
              "status": "passed",
              "code_desc": "Command openssl rsa -in /etc/elasticsearch/x-pack/elastic/elastic.key -check -noout stdout should match /RSA key ok/",
              "run_time": 0.024078,
              "start_time": "2018-02-11 14:26:24 -0500"
            },
            {
              "status": "passed",
              "code_desc": "x509_certificate /etc/elasticsearch/x-pack/elastic/elastic.crt should be certificate",
              "run_time": 0.000135,
              "start_time": "2018-02-11 14:26:24 -0500"
            },
            {
              "status": "passed",
              "code_desc": "x509_certificate /etc/elasticsearch/x-pack/elastic/elastic.crt should be valid",
              "run_time": 0.000138,
              "start_time": "2018-02-11 14:26:24 -0500"
            },
            {
              "status": "passed",
              "code_desc": "x509_certificate /etc/elasticsearch/x-pack/ca/ca.crt should be certificate",
              "run_time": 0.000095,
              "start_time": "2018-02-11 14:26:24 -0500"
            },
            {
              "status": "passed",
              "code_desc": "x509_certificate /etc/elasticsearch/x-pack/ca/ca.crt should be valid",
              "run_time": 0.000082,
              "start_time": "2018-02-11 14:26:24 -0500"
            },
            {
              "status": "passed",
              "code_desc": "Elasticsearch Cluster https://0.0.0.0:9200 should not have http access",
              "run_time": 0.019367,
              "start_time": "2018-02-11 14:26:24 -0500"
            }
          ]
        },
        {
          "id": "V-26971",
          "title": "The application must support and must not impede organizational\nrequirements to conduct backups of information system documentation including\nsecurity-related documentation per organizational-defined frequency.",
          "desc": "This requirement is a permanent not a finding. No fix is required.",
          "impact": 0,
          "refs": [],
          "tags": {
            "nist": [
              "CP-9 (c)  ",
              "Rev_4"
            ],
            "severity": "medium",
            "rid": "SV-34258r1_rule",
            "gtitle": "SRG-APP-000147",
            "cci": "CCI-000539",
            "check": "Elasticsearch meets this requirement through design and\nimplementation.\n\nElasticsearch supports this requirement and cannot be configured to be out of\ncompliance. This is a permanent not a finding. ",
            "fix": "This requirement is a permanent not a finding. No fix is\nrequired."
          },
          "code": "control \"V-26971\" do\n  title \"The application must support and must not impede organizational\nrequirements to conduct backups of information system documentation including\nsecurity-related documentation per organizational-defined frequency.\"\n  desc  \"This requirement is a permanent not a finding. No fix is required.\"\n  impact 0.0\n  tag \"nist\": [\"CP-9 (c)  \", \"Rev_4\"]\n  tag \"severity\": \"medium\"\n  tag \"rid\": \"SV-34258r1_rule\"\n  tag \"gtitle\": \"SRG-APP-000147\"\n  tag \"cci\": \"CCI-000539\"\n  tag \"check\": \"Elasticsearch meets this requirement through design and\nimplementation.\n\nElasticsearch supports this requirement and cannot be configured to be out of\ncompliance. This is a permanent not a finding. \"\n  tag \"fix\": \"This requirement is a permanent not a finding. No fix is\nrequired.\"\n\n  only_if do\n    false\n  end\nend\n",
          "source_location": {
            "line": 5,
            "ref": "../elasticsearch-inspec/controls/permenant-not-a-finding/V-26971.rb"
          },
          "results": [
            {
              "status": "skipped",
              "code_desc": "Operating System Detection",
              "run_time": 0.000009,
              "start_time": "2018-02-11 14:26:24 -0500",
              "resource": "Operating System Detection",
              "skip_message": "Skipped control due to only_if condition."
            }
          ]
        },
        {
          "id": "V-27017",
          "title": "Applications providing a login capability must also provide a logout\nfunctionality to allow the user to manually terminate the session.",
          "desc": "This requirement is a permanent not a finding. No fix is required.",
          "impact": 0,
          "refs": [],
          "tags": {
            "nist": [
              "SC-23 (2)",
              "Rev_3"
            ],
            "severity": "medium",
            "rid": "SV-34311r1_rule",
            "gtitle": "SRG-APP-000221",
            "cci": "CCI-001186",
            "check": "Elasticsearch meets this requirement through design and\nimplementation.\n\nElasticsearch provides logout capability through REST API calls and terminates\nall session and network communication at the response of every call.  This is a\npermanent not a finding. ",
            "fix": "This requirement is a permanent not a finding. No fix is\nrequired."
          },
          "code": "control \"V-27017\" do\n  title \"Applications providing a login capability must also provide a logout\nfunctionality to allow the user to manually terminate the session.\"\n  desc  \"This requirement is a permanent not a finding. No fix is required.\"\n  impact 0.0\n  tag \"nist\": [\"SC-23 (2)\", \"Rev_3\"]\n  tag \"severity\": \"medium\"\n  tag \"rid\": \"SV-34311r1_rule\"\n  tag \"gtitle\": \"SRG-APP-000221\"\n  tag \"cci\": \"CCI-001186\"\n  tag \"check\": \"Elasticsearch meets this requirement through design and\nimplementation.\n\nElasticsearch provides logout capability through REST API calls and terminates\nall session and network communication at the response of every call.  This is a\npermanent not a finding. \"\n  tag \"fix\": \"This requirement is a permanent not a finding. No fix is\nrequired.\"\n\n  only_if do\n    false\n  end\nend\n",
          "source_location": {
            "line": 5,
            "ref": "../elasticsearch-inspec/controls/permenant-not-a-finding/V-27017.rb"
          },
          "results": [
            {
              "status": "skipped",
              "code_desc": "Operating System Detection",
              "run_time": 0.000003,
              "start_time": "2018-02-11 14:26:24 -0500",
              "resource": "Operating System Detection",
              "skip_message": "Skipped control due to only_if condition."
            }
          ]
        },
        {
          "id": "V-26965",
          "title": "Applications must implement transaction recovery for systems that are\ntransaction-based.",
          "desc": "Elasticsearch utilizes a transaction log to ensure the writes are\nrecorded during crash and can be replayed during a recovery phase.",
          "impact": 0,
          "refs": [],
          "tags": {
            "nist": [
              "CP-10 (2)",
              "Rev_4"
            ],
            "severity": "medium",
            "rid": "SV-34250r1_rule",
            "gtitle": "SRG-APP-000144",
            "cci": "CCI-000553",
            "check": "Elasticsearch utilizes a transaction log to ensure the writes\nare recorded during crash and can be replayed during a recovery phase.\n\nThis is a permanent not a finding.",
            "fix": "This requirement is a permanent not a finding. No fix is\nrequired."
          },
          "code": "control \"V-26965\" do\n  title \"Applications must implement transaction recovery for systems that are\ntransaction-based.\"\n  desc  \"Elasticsearch utilizes a transaction log to ensure the writes are\nrecorded during crash and can be replayed during a recovery phase.\"\n  impact 0.0\n  tag \"nist\": [\"CP-10 (2)\", \"Rev_4\"]\n  tag \"severity\": \"medium\"\n  tag \"rid\": \"SV-34250r1_rule\"\n  tag \"gtitle\": \"SRG-APP-000144\"\n  tag \"cci\": \"CCI-000553\"\n  tag \"check\": \"Elasticsearch utilizes a transaction log to ensure the writes\nare recorded during crash and can be replayed during a recovery phase.\n\nThis is a permanent not a finding.\"\n  tag \"fix\": \"This requirement is a permanent not a finding. No fix is\nrequired.\"\n\n  only_if do\n    false\n  end\nend\n",
          "source_location": {
            "line": 5,
            "ref": "../elasticsearch-inspec/controls/permenant-not-a-finding/V-26965.rb"
          },
          "results": [
            {
              "status": "skipped",
              "code_desc": "Operating System Detection",
              "run_time": 0.000002,
              "start_time": "2018-02-11 14:26:24 -0500",
              "resource": "Operating System Detection",
              "skip_message": "Skipped control due to only_if condition."
            }
          ]
        },
        {
          "id": "V-26666",
          "title": "The application must support the requirement to initiate a session\nlock after an organizational defined time period of system or application\ninactivity has transpired.",
          "desc": "The default session duration is set in the kibana.yml configuration\nfile. By default, sessions expire after 30 minutes. The timeout is specified in\nmilliseconds and is configurable.",
          "impact": 0,
          "refs": [],
          "tags": {
            "nist": [
              "AC-11 a",
              "Rev_4"
            ],
            "severity": "medium",
            "rid": "SV-33797r1_rule",
            "gtitle": "SRG-APP-000003",
            "cci": "CCI-000057",
            "check": "Elasticsearch meets this requirement through design and\nimplementation.\n\nElasticsearch provides a unique session through REST API calls and terminates\nall session and network communication at the response of every call.  A lock is\nnot needed since the session is already terminated.  This is a permanent not a\nfinding. ",
            "fix": "This requirement is a permanent not a finding. No fix is\nrequired."
          },
          "code": "control \"V-26666\" do\n  title \"The application must support the requirement to initiate a session\nlock after an organizational defined time period of system or application\ninactivity has transpired.\"\n  desc  \"The default session duration is set in the kibana.yml configuration\nfile. By default, sessions expire after 30 minutes. The timeout is specified in\nmilliseconds and is configurable.\"\n  impact 0.0\n  tag \"nist\": [\"AC-11 a\", \"Rev_4\"]\n  tag \"severity\": \"medium\"\n  tag \"rid\": \"SV-33797r1_rule\"\n  tag \"gtitle\": \"SRG-APP-000003\"\n  tag \"cci\": \"CCI-000057\"\n  tag \"check\": \"Elasticsearch meets this requirement through design and\nimplementation.\n\nElasticsearch provides a unique session through REST API calls and terminates\nall session and network communication at the response of every call.  A lock is\nnot needed since the session is already terminated.  This is a permanent not a\nfinding. \"\n  tag \"fix\": \"This requirement is a permanent not a finding. No fix is\nrequired.\"\n\n  only_if do\n    false\n  end\nend\n",
          "source_location": {
            "line": 5,
            "ref": "../elasticsearch-inspec/controls/permenant-not-a-finding/V-26666.rb"
          },
          "results": [
            {
              "status": "skipped",
              "code_desc": "Operating System Detection",
              "run_time": 0.000003,
              "start_time": "2018-02-11 14:26:24 -0500",
              "resource": "Operating System Detection",
              "skip_message": "Skipped control due to only_if condition."
            }
          ]
        },
        {
          "id": "V-26680",
          "title": "The application must display security attributes in human-readable\nform on each object output from the system to system output devices to identify\nan organizational-identified set of special dissemination, handling, or\ndistribution instructions using organizational-identified human readable,\nstandard naming conventions.",
          "desc": "The application controlled data model for security labels and markings\nshould be human readable and present in all stored and transferred data models.",
          "impact": 0,
          "refs": [],
          "tags": {
            "nist": [
              "AC-16 (5)",
              "Rev_4"
            ],
            "severity": "medium",
            "rid": "SV-33879r1_rule",
            "gtitle": "SRG-APP-000013",
            "cci": "CCI-001428",
            "check": "Elasticsearch meets this requirement through design and\nimplementation.\n\nElasticsearch supports this requirement and cannot be configured to be out of\ncompliance. This is a permanent not a finding. ",
            "fix": "This requirement is a permanent not a finding. No fix is\nrequired."
          },
          "code": "control \"V-26680\" do\n  title \"The application must display security attributes in human-readable\nform on each object output from the system to system output devices to identify\nan organizational-identified set of special dissemination, handling, or\ndistribution instructions using organizational-identified human readable,\nstandard naming conventions.\"\n  desc  \"The application controlled data model for security labels and markings\nshould be human readable and present in all stored and transferred data models.\"\n  impact 0.0\n  tag \"nist\": [\"AC-16 (5)\", \"Rev_4\"]\n  tag \"severity\": \"medium\"\n  tag \"rid\": \"SV-33879r1_rule\"\n  tag \"gtitle\": \"SRG-APP-000013\"\n  tag \"cci\": \"CCI-001428\"\n  tag \"check\": \"Elasticsearch meets this requirement through design and\nimplementation.\n\nElasticsearch supports this requirement and cannot be configured to be out of\ncompliance. This is a permanent not a finding. \"\n  tag \"fix\": \"This requirement is a permanent not a finding. No fix is\nrequired.\"\n\n  only_if do\n    false\n  end\nend\n",
          "source_location": {
            "line": 5,
            "ref": "../elasticsearch-inspec/controls/permenant-not-a-finding/V-26680.rb"
          },
          "results": [
            {
              "status": "skipped",
              "code_desc": "Operating System Detection",
              "run_time": 0.000003,
              "start_time": "2018-02-11 14:26:24 -0500",
              "resource": "Operating System Detection",
              "skip_message": "Skipped control due to only_if condition."
            }
          ]
        },
        {
          "id": "V-27016",
          "title": "Applications must terminate user sessions upon user logout or any\nother organizational or policy defined session termination events such as idle\ntime limit exceeded.",
          "desc": "This requirement is a permanent not a finding. No fix is required.",
          "impact": 0,
          "refs": [],
          "tags": {
            "nist": [
              "SC-23 (1)",
              "Rev_4"
            ],
            "severity": "medium",
            "rid": "SV-34310r1_rule",
            "gtitle": "SRG-APP-000220",
            "cci": "CCI-001185",
            "check": "Elasticsearch meets this requirement through design and\nimplementation.\n\nElasticsearch provides communication through REST API calls and terminates all\nsession and network communication at the response of every call.  This is a\npermanent not a finding. ",
            "fix": "This requirement is a permanent not a finding. No fix is\nrequired."
          },
          "code": "control \"V-27016\" do\n  title \"Applications must terminate user sessions upon user logout or any\nother organizational or policy defined session termination events such as idle\ntime limit exceeded.\"\n  desc  \"This requirement is a permanent not a finding. No fix is required.\"\n  impact 0.0\n  tag \"nist\": [\"SC-23 (1)\", \"Rev_4\"]\n  tag \"severity\": \"medium\"\n  tag \"rid\": \"SV-34310r1_rule\"\n  tag \"gtitle\": \"SRG-APP-000220\"\n  tag \"cci\": \"CCI-001185\"\n  tag \"check\": \"Elasticsearch meets this requirement through design and\nimplementation.\n\nElasticsearch provides communication through REST API calls and terminates all\nsession and network communication at the response of every call.  This is a\npermanent not a finding. \"\n  tag \"fix\": \"This requirement is a permanent not a finding. No fix is\nrequired.\"\n\n  only_if do\n    false\n  end\nend\n",
          "source_location": {
            "line": 5,
            "ref": "../elasticsearch-inspec/controls/permenant-not-a-finding/V-27016.rb"
          },
          "results": [
            {
              "status": "skipped",
              "code_desc": "Operating System Detection",
              "run_time": 0.000003,
              "start_time": "2018-02-11 14:26:24 -0500",
              "resource": "Operating System Detection",
              "skip_message": "Skipped control due to only_if condition."
            }
          ]
        },
        {
          "id": "V-27146",
          "title": "Applications must use internal system clocks to generate time stamps\nfor audit records.",
          "desc": "Utilize perimeter, application, centralized authentication, and\nrepository audit controls to audit the use of systems in real time with\nsufficient context.  X-Pack Security audit controls should be enabled to audit\nthe defaults of all HTTP/S based access to Elasticsearch.  All applications\nshould use HTTP/S  rather than Elasticsearch transport protocol.",
          "impact": 0,
          "refs": [],
          "tags": {
            "nist": [
              "AU-8 a",
              "Rev_4"
            ],
            "severity": "medium",
            "rid": "SV-34445r1_rule",
            "gtitle": "SRG-APP-000116",
            "cci": "CCI-000159",
            "check": "The Elasticsearch application's auditing system supports this\nrequirement and cannot be configured to be out of compliance. Every audit\nrecord in elasticsearch includes a timestamp.\n\nThis is a permanent not a finding.",
            "fix": "This requirement is a permanent not a finding. No fix is\nrequired."
          },
          "code": "control \"V-27146\" do\n  title \"Applications must use internal system clocks to generate time stamps\nfor audit records.\"\n  desc  \"Utilize perimeter, application, centralized authentication, and\nrepository audit controls to audit the use of systems in real time with\nsufficient context.  X-Pack Security audit controls should be enabled to audit\nthe defaults of all HTTP/S based access to Elasticsearch.  All applications\nshould use HTTP/S  rather than Elasticsearch transport protocol.\"\n  impact 0.0\n  tag \"nist\": [\"AU-8 a\", \"Rev_4\"]\n  tag \"severity\": \"medium\"\n  tag \"rid\": \"SV-34445r1_rule\"\n  tag \"gtitle\": \"SRG-APP-000116\"\n  tag \"cci\": \"CCI-000159\"\n  tag \"check\": \"The Elasticsearch application's auditing system supports this\nrequirement and cannot be configured to be out of compliance. Every audit\nrecord in elasticsearch includes a timestamp.\n\nThis is a permanent not a finding.\"\n  tag \"fix\": \"This requirement is a permanent not a finding. No fix is\nrequired.\"\n\n  only_if do\n    false\n  end\nend\n",
          "source_location": {
            "line": 5,
            "ref": "../elasticsearch-inspec/controls/permenant-not-a-finding/V-27146.rb"
          },
          "results": [
            {
              "status": "skipped",
              "code_desc": "Operating System Detection",
              "run_time": 0.000003,
              "start_time": "2018-02-11 14:26:24 -0500",
              "resource": "Operating System Detection",
              "skip_message": "Skipped control due to only_if condition."
            }
          ]
        },
        {
          "id": "V-27128",
          "title": "The application must terminate the network connection associated with\na communications session at the end of the session or after an\norganizational-defined time period of inactivity.",
          "desc": "Elasticsearch does not have sessions that need to be timed out, but\nconfigure Elasticsearch tcp socket keepalive settings to organizational\nmandates. And configure applications to use an appropriate scroll api in the\n_search API's for scroll time window to prevent bloat of server side resources.",
          "impact": 0,
          "refs": [],
          "tags": {
            "nist": [
              "SC-10",
              "Rev_4"
            ],
            "severity": "medium",
            "rid": "SV-34426r1_rule",
            "gtitle": "SRG-APP-000190",
            "cci": "CCI-001133",
            "check": "Elasticsearch meets this requirement through design and\nimplementation.\n\nElasticsearch provides communication through REST API calls and terminates all\nsession and network communication at the response of every call through a\nnetwork.  This is a permanent not a finding. ",
            "fix": "This requirement is a permanent not a finding. No fix is\nrequired."
          },
          "code": "control \"V-27128\" do\n  title \"The application must terminate the network connection associated with\na communications session at the end of the session or after an\norganizational-defined time period of inactivity.\"\n  desc  \"Elasticsearch does not have sessions that need to be timed out, but\nconfigure Elasticsearch tcp socket keepalive settings to organizational\nmandates. And configure applications to use an appropriate scroll api in the\n_search API's for scroll time window to prevent bloat of server side resources.\"\n  impact 0.0\n  tag \"nist\": [\"SC-10\", \"Rev_4\"]\n  tag \"severity\": \"medium\"\n  tag \"rid\": \"SV-34426r1_rule\"\n  tag \"gtitle\": \"SRG-APP-000190\"\n  tag \"cci\": \"CCI-001133\"\n  tag \"check\": \"Elasticsearch meets this requirement through design and\nimplementation.\n\nElasticsearch provides communication through REST API calls and terminates all\nsession and network communication at the response of every call through a\nnetwork.  This is a permanent not a finding. \"\n  tag \"fix\": \"This requirement is a permanent not a finding. No fix is\nrequired.\"\n\n  only_if do\n    false\n  end\nend\n",
          "source_location": {
            "line": 5,
            "ref": "../elasticsearch-inspec/controls/permenant-not-a-finding/V-27128.rb"
          },
          "results": [
            {
              "status": "skipped",
              "code_desc": "Operating System Detection",
              "run_time": 0.000002,
              "start_time": "2018-02-11 14:26:24 -0500",
              "resource": "Operating System Detection",
              "skip_message": "Skipped control due to only_if condition."
            }
          ]
        },
        {
          "id": "V-27019",
          "title": "Applications must recognize only system-generated session identifiers.",
          "desc": "This requirement is a permanent not a finding. No fix is required.",
          "impact": 0,
          "refs": [],
          "tags": {
            "nist": [
              "SC-23 (3)",
              "Rev_4"
            ],
            "severity": "medium",
            "rid": "SV-34313r1_rule",
            "gtitle": "SRG-APP-000223",
            "cci": "CCI-001664",
            "check": "Elasticsearch meets this requirement through design and\nimplementation.\n\nElasticsearch provides a unique session through REST API calls and terminates\nall session and network communication at the response of every call.  This is a\npermanent not a finding. ",
            "fix": "This requirement is a permanent not a finding. No fix is\nrequired."
          },
          "code": "control \"V-27019\" do\n  title \"Applications must recognize only system-generated session identifiers.\"\n  desc  \"This requirement is a permanent not a finding. No fix is required.\"\n  impact 0.0\n  tag \"nist\": [\"SC-23 (3)\", \"Rev_4\"]\n  tag \"severity\": \"medium\"\n  tag \"rid\": \"SV-34313r1_rule\"\n  tag \"gtitle\": \"SRG-APP-000223\"\n  tag \"cci\": \"CCI-001664\"\n  tag \"check\": \"Elasticsearch meets this requirement through design and\nimplementation.\n\nElasticsearch provides a unique session through REST API calls and terminates\nall session and network communication at the response of every call.  This is a\npermanent not a finding. \"\n  tag \"fix\": \"This requirement is a permanent not a finding. No fix is\nrequired.\"\n\n  only_if do\n    false\n  end\nend",
          "source_location": {
            "line": 5,
            "ref": "../elasticsearch-inspec/controls/permenant-not-a-finding/V-27019.rb"
          },
          "results": [
            {
              "status": "skipped",
              "code_desc": "Operating System Detection",
              "run_time": 0.000002,
              "start_time": "2018-02-11 14:26:24 -0500",
              "resource": "Operating System Detection",
              "skip_message": "Skipped control due to only_if condition."
            }
          ]
        },
        {
          "id": "V-27018",
          "title": "Applications must generate a unique session identifier for each\nsession.",
          "desc": "Utilize shield cluster keys as well as supported clients to prevent\nhijacking of connections or unexpected contention of updates. Elasticsearch\ndoes not have a concept of sessions, but with shield communication ids are\nunique, random, and signed to prevent tampering.",
          "impact": 0,
          "refs": [],
          "tags": {
            "nist": [
              "SC-23 (3)",
              "Rev_3"
            ],
            "severity": "medium",
            "rid": "SV-34312r1_rule",
            "gtitle": "SRG-APP-000222",
            "cci": "CCI-001187",
            "check": "Elasticsearch meets this requirement through design and\nimplementation.\n\nElasticsearch provides a unique session through REST API calls and terminates\nall session and network communication at the response of every call through a\nnetwork.  This is a permanent not a finding. ",
            "fix": "This requirement is a permanent not a finding. No fix is\nrequired."
          },
          "code": "control \"V-27018\" do\n  title \"Applications must generate a unique session identifier for each\nsession.\"\n  desc  \"Utilize shield cluster keys as well as supported clients to prevent\nhijacking of connections or unexpected contention of updates. Elasticsearch\ndoes not have a concept of sessions, but with shield communication ids are\nunique, random, and signed to prevent tampering.\"\n  impact 0.0\n  tag \"nist\": [\"SC-23 (3)\", \"Rev_3\"]\n  tag \"severity\": \"medium\"\n  tag \"rid\": \"SV-34312r1_rule\"\n  tag \"gtitle\": \"SRG-APP-000222\"\n  tag \"cci\": \"CCI-001187\"\n  tag \"check\": \"Elasticsearch meets this requirement through design and\nimplementation.\n\nElasticsearch provides a unique session through REST API calls and terminates\nall session and network communication at the response of every call through a\nnetwork.  This is a permanent not a finding. \"\n  tag \"fix\": \"This requirement is a permanent not a finding. No fix is\nrequired.\"\n\n  only_if do\n    false\n  end\nend\n",
          "source_location": {
            "line": 5,
            "ref": "../elasticsearch-inspec/controls/permenant-not-a-finding/V-27018.rb"
          },
          "results": [
            {
              "status": "skipped",
              "code_desc": "Operating System Detection",
              "run_time": 0.000003,
              "start_time": "2018-02-11 14:26:24 -0500",
              "resource": "Operating System Detection",
              "skip_message": "Skipped control due to only_if condition."
            }
          ]
        },
        {
          "id": "V-26969",
          "title": "The application must support and must not impede organizational\nrequirements to conduct backups of system-level information contained in the\ninformation system per organizational-defined frequency.",
          "desc": "This requirement is a permanent not a finding. No fix is required.",
          "impact": 0,
          "refs": [],
          "tags": {
            "nist": [
              "CP-9 (b)",
              "Rev_4"
            ],
            "severity": "medium",
            "rid": "SV-34256r1_rule",
            "gtitle": "SRG-APP-000146",
            "cci": "CCI-000537",
            "check": "Elasticsearch meets this requirement through design and\nimplementation.\n\nElasticsearch supports this requirement and cannot be configured to be out of\ncompliance. This is a permanent not a finding. ",
            "fix": "This requirement is a permanent not a finding. No fix is\nrequired."
          },
          "code": "control \"V-26969\" do\n  title \"The application must support and must not impede organizational\nrequirements to conduct backups of system-level information contained in the\ninformation system per organizational-defined frequency.\"\n  desc  \"This requirement is a permanent not a finding. No fix is required.\"\n  impact 0.0\n  tag \"nist\": [\"CP-9 (b)\", \"Rev_4\"]\n  tag \"severity\": \"medium\"\n  tag \"rid\": \"SV-34256r1_rule\"\n  tag \"gtitle\": \"SRG-APP-000146\"\n  tag \"cci\": \"CCI-000537\"\n  tag \"check\": \"Elasticsearch meets this requirement through design and\nimplementation.\n\nElasticsearch supports this requirement and cannot be configured to be out of\ncompliance. This is a permanent not a finding. \"\n  tag \"fix\": \"This requirement is a permanent not a finding. No fix is\nrequired.\"\n\n  only_if do\n    false\n  end\nend\n",
          "source_location": {
            "line": 5,
            "ref": "../elasticsearch-inspec/controls/permenant-not-a-finding/V-26969.rb"
          },
          "results": [
            {
              "status": "skipped",
              "code_desc": "Operating System Detection",
              "run_time": 0.000003,
              "start_time": "2018-02-11 14:26:24 -0500",
              "resource": "Operating System Detection",
              "skip_message": "Skipped control due to only_if condition."
            }
          ]
        },
        {
          "id": "V-27114",
          "title": "The application must terminate all sessions and network connections\nwhen non-local maintenance is completed.",
          "desc": "Cluster shutdown will end all session and network connection",
          "impact": 0,
          "refs": [],
          "tags": {
            "nist": [
              "MA-4 e",
              "Rev_4"
            ],
            "severity": "medium",
            "rid": "SV-34411r1_rule",
            "gtitle": "SRG-APP-000186",
            "cci": "CCI-000879",
            "check": "Elasticsearch meets this requirement through design and\nimplementation.\n\nElasticsearch provides non-local maintenance through REST API calls and\nterminates all session and network communication at the response of every call\nthrough a network.  This is a permanent not a finding. ",
            "fix": "This requirement is a permanent not a finding. No fix is\nrequired."
          },
          "code": "control \"V-27114\" do\n  title \"The application must terminate all sessions and network connections\nwhen non-local maintenance is completed.\"\n  desc  \"Cluster shutdown will end all session and network connection\"\n  impact 0.0\n  tag \"nist\": [\"MA-4 e\", \"Rev_4\"]\n  tag \"severity\": \"medium\"\n  tag \"rid\": \"SV-34411r1_rule\"\n  tag \"gtitle\": \"SRG-APP-000186\"\n  tag \"cci\": \"CCI-000879\"\n  tag \"check\": \"Elasticsearch meets this requirement through design and\nimplementation.\n\nElasticsearch provides non-local maintenance through REST API calls and\nterminates all session and network communication at the response of every call\nthrough a network.  This is a permanent not a finding. \"\n  tag \"fix\": \"This requirement is a permanent not a finding. No fix is\nrequired.\"\n\n  only_if do\n    false\n  end\nend\n",
          "source_location": {
            "line": 5,
            "ref": "../elasticsearch-inspec/controls/permenant-not-a-finding/V-27114.rb"
          },
          "results": [
            {
              "status": "skipped",
              "code_desc": "Operating System Detection",
              "run_time": 0.000002,
              "start_time": "2018-02-11 14:26:24 -0500",
              "resource": "Operating System Detection",
              "skip_message": "Skipped control due to only_if condition."
            }
          ]
        },
        {
          "id": "V-27171",
          "title": "The application must validate the integrity of security attributes\nexchanged between systems.",
          "desc": "The application controlled data model for security labels and markings\nshould be human readable and present in all stored and transferred data models.",
          "impact": 0,
          "refs": [],
          "tags": {
            "nist": [
              "SC-16 (1)",
              "Rev_4"
            ],
            "severity": "medium",
            "rid": "SV-34470r1_rule",
            "gtitle": "SRG-APP-000204",
            "cci": "CCI-001158",
            "check": "Elasticsearch meets this requirement through design and\nimplementation.\n\nElasticsearch supports this requirement and cannot be configured to be out of\ncompliance. This is a permanent not a finding. ",
            "fix": "This requirement is a permanent not a finding. No fix is\nrequired."
          },
          "code": "control \"V-27171\" do\n  title \"The application must validate the integrity of security attributes\nexchanged between systems.\"\n  desc  \"The application controlled data model for security labels and markings\nshould be human readable and present in all stored and transferred data models.\"\n  impact 0.0\n  tag \"nist\": [\"SC-16 (1)\", \"Rev_4\"]\n  tag \"severity\": \"medium\"\n  tag \"rid\": \"SV-34470r1_rule\"\n  tag \"gtitle\": \"SRG-APP-000204\"\n  tag \"cci\": \"CCI-001158\"\n  tag \"check\": \"Elasticsearch meets this requirement through design and\nimplementation.\n\nElasticsearch supports this requirement and cannot be configured to be out of\ncompliance. This is a permanent not a finding. \"\n  tag \"fix\": \"This requirement is a permanent not a finding. No fix is\nrequired.\"\n\n  only_if do\n    false\n  end\nend\n",
          "source_location": {
            "line": 5,
            "ref": "../elasticsearch-inspec/controls/permenant-not-a-finding/V-27171.rb"
          },
          "results": [
            {
              "status": "skipped",
              "code_desc": "Operating System Detection",
              "run_time": 0.000002,
              "start_time": "2018-02-11 14:26:24 -0500",
              "resource": "Operating System Detection",
              "skip_message": "Skipped control due to only_if condition."
            }
          ]
        },
        {
          "id": "V-26671",
          "title": "Applications must ensure that users can directly initiate session lock\nmechanisms which prevent further access to the system.",
          "desc": "Elasticsearch meets this requirement through design and\nimplementation.\n\nElasticsearch provides a unique session through REST API calls and terminates\nall session and network communication at the response of every call.  A lock is\nnot needed since the session is already terminated.  This is a permanent not a\nfinding.",
          "impact": 0,
          "refs": [],
          "tags": {
            "nist": [
              "AC-11 a",
              "Rev_4"
            ],
            "severity": "medium",
            "rid": "SV-33818r1_rule",
            "gtitle": "SRG-APP-000004",
            "cci": "CCI-000058",
            "check": "Elasticsearch meets this requirement through design and\nimplementation.\n\nElasticsearch provides a unique session through REST API calls and terminates\nall session and network communication at the response of every call.  A lock is\nnot needed since the session is already terminated.  This is a permanent not a\nfinding. ",
            "fix": "This requirement is a permanent not a finding. No fix is\nrequired."
          },
          "code": "control \"V-26671\" do\n  title \"Applications must ensure that users can directly initiate session lock\nmechanisms which prevent further access to the system.\"\n  desc  \"Elasticsearch meets this requirement through design and\nimplementation.\n\nElasticsearch provides a unique session through REST API calls and terminates\nall session and network communication at the response of every call.  A lock is\nnot needed since the session is already terminated.  This is a permanent not a\nfinding. \"\n  impact 0.0\n  tag \"nist\": [\"AC-11 a\", \"Rev_4\"]\n  tag \"severity\": \"medium\"\n  tag \"rid\": \"SV-33818r1_rule\"\n  tag \"gtitle\": \"SRG-APP-000004\"\n  tag \"cci\": \"CCI-000058\"\n  tag \"check\": \"Elasticsearch meets this requirement through design and\nimplementation.\n\nElasticsearch provides a unique session through REST API calls and terminates\nall session and network communication at the response of every call.  A lock is\nnot needed since the session is already terminated.  This is a permanent not a\nfinding. \"\n  tag \"fix\": \"This requirement is a permanent not a finding. No fix is\nrequired.\"\n\n  only_if do\n    false\n  end\nend\n",
          "source_location": {
            "line": 5,
            "ref": "../elasticsearch-inspec/controls/permenant-not-a-finding/V-26671.rb"
          },
          "results": [
            {
              "status": "skipped",
              "code_desc": "Operating System Detection",
              "run_time": 0.000003,
              "start_time": "2018-02-11 14:26:24 -0500",
              "resource": "Operating System Detection",
              "skip_message": "Skipped control due to only_if condition."
            }
          ]
        },
        {
          "id": "V-27020",
          "title": "Applications must generate unique session identifiers with\norganizational-defined randomness requirements.",
          "desc": "Utilize shield cluster keys as well as supported clients to prevent\nhijacking of connections or unexpected contention of updates. Elasticsearch\ndoes not have a concept of sessions, but with shield communication ids are\nunique, random, and signed to prevent tampering.",
          "impact": 0,
          "refs": [],
          "tags": {
            "nist": [
              "SC-23 (3)",
              "Rev_4"
            ],
            "severity": "medium",
            "rid": "SV-34314r1_rule",
            "gtitle": "SRG-APP-000224",
            "cci": "CCI-001188",
            "check": "Elasticsearch meets this requirement through design and\nimplementation.\n\nElasticsearch provides a unique session through REST API calls and terminates\nall session and network communication at the response of every call through a\nnetwork.  This is a permanent not a finding. ",
            "fix": "This requirement is a permanent not a finding. No fix is\nrequired."
          },
          "code": "control \"V-27020\" do\n  title \"Applications must generate unique session identifiers with\norganizational-defined randomness requirements.\"\n  desc  \"Utilize shield cluster keys as well as supported clients to prevent\nhijacking of connections or unexpected contention of updates. Elasticsearch\ndoes not have a concept of sessions, but with shield communication ids are\nunique, random, and signed to prevent tampering.\"\n  impact 0.0\n  tag \"nist\": [\"SC-23 (3)\", \"Rev_4\"]\n  tag \"severity\": \"medium\"\n  tag \"rid\": \"SV-34314r1_rule\"\n  tag \"gtitle\": \"SRG-APP-000224\"\n  tag \"cci\": \"CCI-001188\"\n  tag \"check\": \"Elasticsearch meets this requirement through design and\nimplementation.\n\nElasticsearch provides a unique session through REST API calls and terminates\nall session and network communication at the response of every call through a\nnetwork.  This is a permanent not a finding. \"\n  tag \"fix\": \"This requirement is a permanent not a finding. No fix is\nrequired.\"\n\n  only_if do\n    false\n  end\nend\n",
          "source_location": {
            "line": 5,
            "ref": "../elasticsearch-inspec/controls/permenant-not-a-finding/V-27020.rb"
          },
          "results": [
            {
              "status": "skipped",
              "code_desc": "Operating System Detection",
              "run_time": 0.000003,
              "start_time": "2018-02-11 14:26:24 -0500",
              "resource": "Operating System Detection",
              "skip_message": "Skipped control due to only_if condition."
            }
          ]
        },
        {
          "id": "V-26893",
          "title": "Applications must maintain reviewer/releaser identity and credentials\nwithin the established chain of custody for all information reviewed or\nreleased.",
          "desc": "The data models used by a system must maintain reviewer/releaser\nidentity and credentials within the object such that the information can be\nused for automated policy actions by applications and Elasticsearch for review\nor release.",
          "impact": 0.5,
          "refs": [],
          "tags": {
            "nist": [
              "AU-10 (3)",
              "Rev_4"
            ],
            "severity": "medium",
            "rid": "SV-34173r1_rule",
            "gtitle": "SRG-APP-000083",
            "cci": "CCI-001340",
            "check": "Moving audit records to a centralized location will assist in\nthe investigation and non-repudiation of audited actions. Verify 'rsyslog' is\nconfigured to send all messages to a log aggregation server.\n\nCheck the configuration of 'rsyslog' with the following command:\n\n# grep @ /etc/rsyslog.conf\n   *.* @@logagg.site.mil\n\nIf there are no lines in the '/etc/rsyslog.conf' file that contain the '@'\nor '@@' symbol(s), and the lines with the correct symbol(s) to send output to\nanother system do not cover all 'rsyslog' output, this is a finding.",
            "fix": "Modify the '/etc/rsyslog.conf' file to contain a configuration\nline to send all 'rsyslog' output to a log aggregation system:\n\n*.* @@&ltlog aggregation system name&gt\n\n"
          },
          "code": "control \"V-26893\" do\n  title \"Applications must maintain reviewer/releaser identity and credentials\nwithin the established chain of custody for all information reviewed or\nreleased.\"\n  desc  \"The data models used by a system must maintain reviewer/releaser\nidentity and credentials within the object such that the information can be\nused for automated policy actions by applications and Elasticsearch for review\nor release.\"\n  impact 0.5\n  tag \"nist\": [\"AU-10 (3)\", \"Rev_4\"]\n  tag \"severity\": \"medium\"\n  tag \"rid\": \"SV-34173r1_rule\"\n  tag \"gtitle\": \"SRG-APP-000083\"\n  tag \"cci\": \"CCI-001340\"\n  tag \"check\": \"Moving audit records to a centralized location will assist in\nthe investigation and non-repudiation of audited actions. Verify 'rsyslog' is\nconfigured to send all messages to a log aggregation server.\n\nCheck the configuration of 'rsyslog' with the following command:\n\n# grep @ /etc/rsyslog.conf\n   *.* @@logagg.site.mil\n\nIf there are no lines in the '/etc/rsyslog.conf' file that contain the '@'\nor '@@' symbol(s), and the lines with the correct symbol(s) to send output to\nanother system do not cover all 'rsyslog' output, this is a finding.\"\n  tag \"fix\": \"Modify the '/etc/rsyslog.conf' file to contain a configuration\nline to send all 'rsyslog' output to a log aggregation system:\n\n*.* @@&ltlog aggregation system name&gt\n\n\"\n  begin\n\n    describe service('rsyslog') do\n      it { should be_installed }\n      it { should be_running }\n    end\n    \n    describe \"#{RSYSLOG_CONF} configured with log aggregation server: #{LOG_AGGREGATION_SYSTEM}\" do\n      subject { !file(RSYSLOG_CONF).content.match(/@{1,2}#{LOG_AGGREGATION_SYSTEM}/).nil? }\n      it { should be true }\n    end\n\n  rescue Exception => msg\n    describe \"Exception: #{msg}\" do\n      it { should be_nil}\n    end\n  end\nend",
          "source_location": {
            "line": 17,
            "ref": "../elasticsearch-inspec/controls/rsyslog/V-26893.rb"
          },
          "results": [
            {
              "status": "passed",
              "code_desc": "Service rsyslog should be installed",
              "run_time": 0.060796,
              "start_time": "2018-02-11 14:26:24 -0500"
            },
            {
              "status": "passed",
              "code_desc": "Service rsyslog should be running",
              "run_time": 0.000113,
              "start_time": "2018-02-11 14:26:24 -0500"
            },
            {
              "status": "failed",
              "code_desc": "/etc/rsyslog.conf configured with log aggregation server: logagg.site.mil should equal true",
              "run_time": 0.019208,
              "start_time": "2018-02-11 14:26:24 -0500"
            }
          ]
        },
        {
          "id": "V-27152",
          "title": "The application must protect audit information from unauthorized\nmodification.",
          "desc": "Offload and centralize audit records retention to a separate system\nfrom the sources of audit records.",
          "impact": 0.5,
          "refs": [],
          "tags": {
            "nist": [
              "AU-9",
              "Rev_4"
            ],
            "severity": "medium",
            "rid": "SV-34451r1_rule",
            "gtitle": "SRG-APP-000119",
            "cci": "CCI-000163",
            "check": "Moving audit information off of the systems creating the audit\nevents protects the information from unauthorized modification. Verify\n'rsyslog' is configured to send all messages to a log aggregation server.\n\nCheck the configuration of 'rsyslog' with the following command:\n\n# grep @ /etc/rsyslog.conf\n   *.* @@logagg.site.mil\n\nIf there are no lines in the '/etc/rsyslog.conf' file that contain the '@'\nor '@@' symbol(s), and the lines with the correct symbol(s) to send output to\nanother system do not cover all 'rsyslog' output, this is a finding.",
            "fix": "Modify the '/etc/rsyslog.conf' file to contain a configuration\nline to send all 'rsyslog' output to a log aggregation system:\n\n*.* @@&ltlog aggregation system name&gt\n\n"
          },
          "code": "control \"V-27152\" do\n  title \"The application must protect audit information from unauthorized\nmodification.\"\n  desc  \"Offload and centralize audit records retention to a separate system\nfrom the sources of audit records.\"\n  impact 0.5\n  tag \"nist\": [\"AU-9\", \"Rev_4\"]\n  tag \"severity\": \"medium\"\n  tag \"rid\": \"SV-34451r1_rule\"\n  tag \"gtitle\": \"SRG-APP-000119\"\n  tag \"cci\": \"CCI-000163\"\n  tag \"check\": \"Moving audit information off of the systems creating the audit\nevents protects the information from unauthorized modification. Verify\n'rsyslog' is configured to send all messages to a log aggregation server.\n\nCheck the configuration of 'rsyslog' with the following command:\n\n# grep @ /etc/rsyslog.conf\n   *.* @@logagg.site.mil\n\nIf there are no lines in the '/etc/rsyslog.conf' file that contain the '@'\nor '@@' symbol(s), and the lines with the correct symbol(s) to send output to\nanother system do not cover all 'rsyslog' output, this is a finding.\"\n  tag \"fix\": \"Modify the '/etc/rsyslog.conf' file to contain a configuration\nline to send all 'rsyslog' output to a log aggregation system:\n\n*.* @@&ltlog aggregation system name&gt\n\n\"\n  begin\n\n    describe service('rsyslog') do\n      it { should be_installed }\n      it { should be_running }\n    end\n    \n    describe \"#{RSYSLOG_CONF} configured with log aggregation server: #{LOG_AGGREGATION_SYSTEM}\" do\n      subject { !file(RSYSLOG_CONF).content.match(/@{1,2}#{LOG_AGGREGATION_SYSTEM}/).nil? }\n      it { should be true }\n    end\n\n  rescue Exception => msg\n    describe \"Exception: #{msg}\" do\n      it { should be_nil}\n    end\n  end\nend\n",
          "source_location": {
            "line": 17,
            "ref": "../elasticsearch-inspec/controls/rsyslog/V-27152.rb"
          },
          "results": [
            {
              "status": "passed",
              "code_desc": "Service rsyslog should be installed",
              "run_time": 0.12116,
              "start_time": "2018-02-11 14:26:24 -0500"
            },
            {
              "status": "passed",
              "code_desc": "Service rsyslog should be running",
              "run_time": 0.000165,
              "start_time": "2018-02-11 14:26:25 -0500"
            },
            {
              "status": "failed",
              "code_desc": "/etc/rsyslog.conf configured with log aggregation server: logagg.site.mil should equal true",
              "run_time": 0.000183,
              "start_time": "2018-02-11 14:26:25 -0500"
            }
          ]
        },
        {
          "id": "V-27073",
          "title": "Applications must provide the capability to centralize the review and\nanalysis of audit records from multiple components within the system.",
          "desc": "Offload and centralize audit records retention to a separate system\nfrom the sources of audit records.",
          "impact": 0.5,
          "refs": [],
          "tags": {
            "nist": [
              "AU-6 (4)",
              "Rev_4"
            ],
            "severity": "medium",
            "rid": "SV-34368r1_rule",
            "gtitle": "SRG-APP-000111",
            "cci": "CCI-000154",
            "check": "Verify 'rsyslog' is configured to send all messages to a log\naggregation server.\n\nCheck the configuration of 'rsyslog' with the following command:\n\n# grep @ /etc/rsyslog.conf\n   *.* @@logagg.site.mil\n\nIf there are no lines in the '/etc/rsyslog.conf' file that contain the '@'\nor '@@' symbol(s), and the lines with the correct symbol(s) to send output to\nanother system do not cover all 'rsyslog' output, this is a finding.",
            "fix": "Modify the '/etc/rsyslog.conf' file to contain a configuration\nline to send all 'rsyslog' output to a log aggregation system:\n\n*.* @@&ltlog aggregation system name&gt\n\n"
          },
          "code": "control \"V-27073\" do\n  title \"Applications must provide the capability to centralize the review and\nanalysis of audit records from multiple components within the system.\"\n  desc  \"Offload and centralize audit records retention to a separate system\nfrom the sources of audit records.\"\n  impact 0.5\n  tag \"nist\": [\"AU-6 (4)\", \"Rev_4\"]\n  tag \"severity\": \"medium\"\n  tag \"rid\": \"SV-34368r1_rule\"\n  tag \"gtitle\": \"SRG-APP-000111\"\n  tag \"cci\": \"CCI-000154\"\n  tag \"check\": \"Verify 'rsyslog' is configured to send all messages to a log\naggregation server.\n\nCheck the configuration of 'rsyslog' with the following command:\n\n# grep @ /etc/rsyslog.conf\n   *.* @@logagg.site.mil\n\nIf there are no lines in the '/etc/rsyslog.conf' file that contain the '@'\nor '@@' symbol(s), and the lines with the correct symbol(s) to send output to\nanother system do not cover all 'rsyslog' output, this is a finding.\"\n  tag \"fix\": \"Modify the '/etc/rsyslog.conf' file to contain a configuration\nline to send all 'rsyslog' output to a log aggregation system:\n\n*.* @@&ltlog aggregation system name&gt\n\n\"\n  begin\n\n    describe service('rsyslog') do\n      it { should be_installed }\n      it { should be_running }\n    end\n    \n    describe \"#{RSYSLOG_CONF} configured with log aggregation server: #{LOG_AGGREGATION_SYSTEM}\" do\n      subject { !file(RSYSLOG_CONF).content.match(/@{1,2}#{LOG_AGGREGATION_SYSTEM}/).nil? }\n      it { should be true }\n    end\n\n  rescue Exception => msg\n    describe \"Exception: #{msg}\" do\n      it { should be_nil}\n    end\n  end\nend\n",
          "source_location": {
            "line": 17,
            "ref": "../elasticsearch-inspec/controls/rsyslog/V-27073.rb"
          },
          "results": [
            {
              "status": "passed",
              "code_desc": "Service rsyslog should be installed",
              "run_time": 0.04852,
              "start_time": "2018-02-11 14:26:25 -0500"
            },
            {
              "status": "passed",
              "code_desc": "Service rsyslog should be running",
              "run_time": 0.000151,
              "start_time": "2018-02-11 14:26:25 -0500"
            },
            {
              "status": "failed",
              "code_desc": "/etc/rsyslog.conf configured with log aggregation server: logagg.site.mil should equal true",
              "run_time": 0.000221,
              "start_time": "2018-02-11 14:26:25 -0500"
            }
          ]
        },
        {
          "id": "V-26871",
          "title": "To support DoD requirements to centrally manage the content of audit\nrecords, applications must provide the ability to write specified audit record\ncontent to a centralized audit log repository.  ",
          "desc": "Offload and centralize audit records retention to a separate system\nfrom the sources of audit records.",
          "impact": 0.5,
          "refs": [],
          "tags": {
            "nist": [
              "AU-3 (2)",
              "Rev_3"
            ],
            "severity": "medium",
            "rid": "SV-34151r1_rule",
            "gtitle": "SRG-APP-000102",
            "cci": "CCI-000136",
            "check": "Verify 'rsyslog' is configured to send specified messages to\na log aggregation server.\n\nCheck the configuration of 'rsyslog' with the following command:\n\n# grep @ /etc/rsyslog.conf\n   *.* @@logagg.site.mil\n\nIf there are no lines in the '/etc/rsyslog.conf' file that contain the '@'\nor '@@' symbol(s), and the lines with the correct symbol(s) to send output to\nanother system do not cover specified 'rsyslog' output, this is a finding.",
            "fix": "Modify the '/etc/rsyslog.conf' file to contain a configuration\nline to send specified 'rsyslog' output to a log aggregation system:\n\n*.* @@&ltlog aggregation system name&gt\n\n"
          },
          "code": "control \"V-26871\" do\n  title \"To support DoD requirements to centrally manage the content of audit\nrecords, applications must provide the ability to write specified audit record\ncontent to a centralized audit log repository.  \"\n  desc  \"Offload and centralize audit records retention to a separate system\nfrom the sources of audit records.\"\n  impact 0.5\n  tag \"nist\": [\"AU-3 (2)\", \"Rev_3\"]\n  tag \"severity\": \"medium\"\n  tag \"rid\": \"SV-34151r1_rule\"\n  tag \"gtitle\": \"SRG-APP-000102\"\n  tag \"cci\": \"CCI-000136\"\n  tag \"check\": \"Verify 'rsyslog' is configured to send specified messages to\na log aggregation server.\n\nCheck the configuration of 'rsyslog' with the following command:\n\n# grep @ /etc/rsyslog.conf\n   *.* @@logagg.site.mil\n\nIf there are no lines in the '/etc/rsyslog.conf' file that contain the '@'\nor '@@' symbol(s), and the lines with the correct symbol(s) to send output to\nanother system do not cover specified 'rsyslog' output, this is a finding.\"\n  tag \"fix\": \"Modify the '/etc/rsyslog.conf' file to contain a configuration\nline to send specified 'rsyslog' output to a log aggregation system:\n\n*.* @@&ltlog aggregation system name&gt\n\n\"\n  begin\n\n    describe service('rsyslog') do\n      it { should be_installed }\n      it { should be_running }\n    end\n    \n    describe \"#{RSYSLOG_CONF} configured with log aggregation server: #{LOG_AGGREGATION_SYSTEM}\" do\n      subject { !file(RSYSLOG_CONF).content.match(/@{1,2}#{LOG_AGGREGATION_SYSTEM}/).nil? }\n      it { should be true }\n    end\n\n  rescue Exception => msg\n    describe \"Exception: #{msg}\" do\n      it { should be_nil}\n    end\n  end\nend\n",
          "source_location": {
            "line": 17,
            "ref": "../elasticsearch-inspec/controls/rsyslog/V-26871.rb"
          },
          "results": [
            {
              "status": "passed",
              "code_desc": "Service rsyslog should be installed",
              "run_time": 0.047925,
              "start_time": "2018-02-11 14:26:25 -0500"
            },
            {
              "status": "passed",
              "code_desc": "Service rsyslog should be running",
              "run_time": 0.000109,
              "start_time": "2018-02-11 14:26:25 -0500"
            },
            {
              "status": "failed",
              "code_desc": "/etc/rsyslog.conf configured with log aggregation server: logagg.site.mil should equal true",
              "run_time": 0.000182,
              "start_time": "2018-02-11 14:26:25 -0500"
            }
          ]
        },
        {
          "id": "V-26888",
          "title": "The application must protect against an individual falsely denying\nhaving performed a particular action.",
          "desc": "Offload and centralize audit records retention to a separate system\nfrom the sources of audit records.",
          "impact": 0.5,
          "refs": [],
          "tags": {
            "nist": [
              "AU-10",
              "Rev_4"
            ],
            "severity": "medium",
            "rid": "SV-34168r1_rule",
            "gtitle": "SRG-APP-000080",
            "cci": "CCI-000166",
            "check": "Moving audit records to a centralized location will assist in\nthe investigation and non-repudiation of audited actions. Verify 'rsyslog' is\nconfigured to send all messages to a log aggregation server.\n\nCheck the configuration of 'rsyslog' with the following command:\n\n# grep @ /etc/rsyslog.conf\n   *.* @@logagg.site.mil\n\nIf there are no lines in the '/etc/rsyslog.conf' file that contain the '@'\nor '@@' symbol(s), and the lines with the correct symbol(s) to send output to\nanother system do not cover all 'rsyslog' output, this is a finding.",
            "fix": "Modify the '/etc/rsyslog.conf' file to contain a configuration\nline to send all 'rsyslog' output to a log aggregation system:\n\n*.* @@&ltlog aggregation system name&gt\n\n"
          },
          "code": "control \"V-26888\" do\n  title \"The application must protect against an individual falsely denying\nhaving performed a particular action.\"\n  desc  \"Offload and centralize audit records retention to a separate system\nfrom the sources of audit records.\"\n  impact 0.5\n  tag \"nist\": [\"AU-10\", \"Rev_4\"]\n  tag \"severity\": \"medium\"\n  tag \"rid\": \"SV-34168r1_rule\"\n  tag \"gtitle\": \"SRG-APP-000080\"\n  tag \"cci\": \"CCI-000166\"\n  tag \"check\": \"Moving audit records to a centralized location will assist in\nthe investigation and non-repudiation of audited actions. Verify 'rsyslog' is\nconfigured to send all messages to a log aggregation server.\n\nCheck the configuration of 'rsyslog' with the following command:\n\n# grep @ /etc/rsyslog.conf\n   *.* @@logagg.site.mil\n\nIf there are no lines in the '/etc/rsyslog.conf' file that contain the '@'\nor '@@' symbol(s), and the lines with the correct symbol(s) to send output to\nanother system do not cover all 'rsyslog' output, this is a finding.\"\n  tag \"fix\": \"Modify the '/etc/rsyslog.conf' file to contain a configuration\nline to send all 'rsyslog' output to a log aggregation system:\n\n*.* @@&ltlog aggregation system name&gt\n\n\"\n  begin\n\n    describe service('rsyslog') do\n      it { should be_installed }\n      it { should be_running }\n    end\n    \n    describe \"#{RSYSLOG_CONF} configured with log aggregation server: #{LOG_AGGREGATION_SYSTEM}\" do\n      subject { !file(RSYSLOG_CONF).content.match(/@{1,2}#{LOG_AGGREGATION_SYSTEM}/).nil? }\n      it { should be true }\n    end\n\n  rescue Exception => msg\n    describe \"Exception: #{msg}\" do\n      it { should be_nil}\n    end\n  end\nend\n",
          "source_location": {
            "line": 17,
            "ref": "../elasticsearch-inspec/controls/rsyslog/V-26888.rb"
          },
          "results": [
            {
              "status": "passed",
              "code_desc": "Service rsyslog should be installed",
              "run_time": 0.046325,
              "start_time": "2018-02-11 14:26:25 -0500"
            },
            {
              "status": "passed",
              "code_desc": "Service rsyslog should be running",
              "run_time": 0.000105,
              "start_time": "2018-02-11 14:26:25 -0500"
            },
            {
              "status": "failed",
              "code_desc": "/etc/rsyslog.conf configured with log aggregation server: logagg.site.mil should equal true",
              "run_time": 0.000161,
              "start_time": "2018-02-11 14:26:25 -0500"
            }
          ]
        },
        {
          "id": "V-26891",
          "title": "Applications must validate the binding of the information\nproduce identity to the information.",
          "desc": "Offload and centralize audit records retention to a separate system\nfrom the sources of audit records.",
          "impact": 0.5,
          "refs": [],
          "tags": {
            "nist": [
              "AU-10 (2)",
              "Rev_3"
            ],
            "severity": "medium",
            "rid": "SV-34171r1_rule",
            "gtitle": "SRG-APP-000082",
            "cci": "CCI-001339",
            "check": "Moving audit records to a centralized location will assist in\nthe investigation and non-repudiation of audited actions. Verify 'rsyslog' is\nconfigured to send all messages to a log aggregation server.\n\nCheck the configuration of 'rsyslog' with the following command:\n\n# grep @ /etc/rsyslog.conf\n   *.* @@logagg.site.mil\n\nIf there are no lines in the '/etc/rsyslog.conf' file that contain the '@'\nor '@@' symbol(s), and the lines with the correct symbol(s) to send output to\nanother system do not cover all 'rsyslog' output, this is a finding.",
            "fix": "Modify the '/etc/rsyslog.conf' file to contain a configuration\nline to send all 'rsyslog' output to a log aggregation system:\n\n*.* @@&ltlog aggregation system name&gt\n\n"
          },
          "code": "control \"V-26891\" do\n  title \"Applications must validate the binding of the information\nproduce identity to the information.\"\n  desc  \"Offload and centralize audit records retention to a separate system\nfrom the sources of audit records.\"\n  impact 0.5\n  tag \"nist\": [\"AU-10 (2)\", \"Rev_3\"]\n  tag \"severity\": \"medium\"\n  tag \"rid\": \"SV-34171r1_rule\"\n  tag \"gtitle\": \"SRG-APP-000082\"\n  tag \"cci\": \"CCI-001339\"\n  tag \"check\": \"Moving audit records to a centralized location will assist in\nthe investigation and non-repudiation of audited actions. Verify 'rsyslog' is\nconfigured to send all messages to a log aggregation server.\n\nCheck the configuration of 'rsyslog' with the following command:\n\n# grep @ /etc/rsyslog.conf\n   *.* @@logagg.site.mil\n\nIf there are no lines in the '/etc/rsyslog.conf' file that contain the '@'\nor '@@' symbol(s), and the lines with the correct symbol(s) to send output to\nanother system do not cover all 'rsyslog' output, this is a finding.\"\n  tag \"fix\": \"Modify the '/etc/rsyslog.conf' file to contain a configuration\nline to send all 'rsyslog' output to a log aggregation system:\n\n*.* @@&ltlog aggregation system name&gt\n\n\"\n  begin\n\n    describe service('rsyslog') do\n      it { should be_installed }\n      it { should be_running }\n    end\n    \n    describe \"#{RSYSLOG_CONF} configured with log aggregation server: #{LOG_AGGREGATION_SYSTEM}\" do\n      subject { !file(RSYSLOG_CONF).content.match(/@{1,2}#{LOG_AGGREGATION_SYSTEM}/).nil? }\n      it { should be true }\n    end\n\n  rescue Exception => msg\n    describe \"Exception: #{msg}\" do\n      it { should be_nil}\n    end\n  end\nend\n",
          "source_location": {
            "line": 17,
            "ref": "../elasticsearch-inspec/controls/rsyslog/V-26891.rb"
          },
          "results": [
            {
              "status": "passed",
              "code_desc": "Service rsyslog should be installed",
              "run_time": 0.046375,
              "start_time": "2018-02-11 14:26:25 -0500"
            },
            {
              "status": "passed",
              "code_desc": "Service rsyslog should be running",
              "run_time": 0.000101,
              "start_time": "2018-02-11 14:26:25 -0500"
            },
            {
              "status": "failed",
              "code_desc": "/etc/rsyslog.conf configured with log aggregation server: logagg.site.mil should equal true",
              "run_time": 0.000158,
              "start_time": "2018-02-11 14:26:25 -0500"
            }
          ]
        },
        {
          "id": "V-26890",
          "title": "The application must associate the identity of the information\nproducer with the information.",
          "desc": "Offload and centralize audit records retention to a separate system\nfrom the sources of audit records.",
          "impact": 0.5,
          "refs": [],
          "tags": {
            "nist": [
              "AU-10 (1)",
              "Rev_3"
            ],
            "severity": "medium",
            "rid": "SV-34170r1_rule",
            "gtitle": "SRG-APP-000081",
            "cci": "CCI-001338",
            "check": "Moving audit records to a centralized location will assist in\nthe investigation and non-repudiation of audited actions. Verify 'rsyslog' is\nconfigured to send all messages to a log aggregation server.\n\nCheck the configuration of 'rsyslog' with the following command:\n\n# grep @ /etc/rsyslog.conf\n   *.* @@logagg.site.mil\n\nIf there are no lines in the '/etc/rsyslog.conf' file that contain the '@'\nor '@@' symbol(s), and the lines with the correct symbol(s) to send output to\nanother system do not cover all 'rsyslog' output, this is a finding.",
            "fix": "Modify the '/etc/rsyslog.conf' file to contain a configuration\nline to send all 'rsyslog' output to a log aggregation system:\n\n*.* @@&ltlog aggregation system name&gt\n\n"
          },
          "code": "control \"V-26890\" do\n  title \"The application must associate the identity of the information\nproducer with the information.\"\n  desc  \"Offload and centralize audit records retention to a separate system\nfrom the sources of audit records.\"\n  impact 0.5\n  tag \"nist\": [\"AU-10 (1)\", \"Rev_3\"]\n  tag \"severity\": \"medium\"\n  tag \"rid\": \"SV-34170r1_rule\"\n  tag \"gtitle\": \"SRG-APP-000081\"\n  tag \"cci\": \"CCI-001338\"\n  tag \"check\": \"Moving audit records to a centralized location will assist in\nthe investigation and non-repudiation of audited actions. Verify 'rsyslog' is\nconfigured to send all messages to a log aggregation server.\n\nCheck the configuration of 'rsyslog' with the following command:\n\n# grep @ /etc/rsyslog.conf\n   *.* @@logagg.site.mil\n\nIf there are no lines in the '/etc/rsyslog.conf' file that contain the '@'\nor '@@' symbol(s), and the lines with the correct symbol(s) to send output to\nanother system do not cover all 'rsyslog' output, this is a finding.\"\n  tag \"fix\": \"Modify the '/etc/rsyslog.conf' file to contain a configuration\nline to send all 'rsyslog' output to a log aggregation system:\n\n*.* @@&ltlog aggregation system name&gt\n\n\"\n  begin\n\n    describe service('rsyslog') do\n      it { should be_installed }\n      it { should be_running }\n    end\n    \n    describe \"#{RSYSLOG_CONF} configured with log aggregation server: #{LOG_AGGREGATION_SYSTEM}\" do\n      subject { !file(RSYSLOG_CONF).content.match(/@{1,2}#{LOG_AGGREGATION_SYSTEM}/).nil? }\n      it { should be true }\n    end\n\n  rescue Exception => msg\n    describe \"Exception: #{msg}\" do\n      it { should be_nil}\n    end\n  end\nend\n",
          "source_location": {
            "line": 17,
            "ref": "../elasticsearch-inspec/controls/rsyslog/V-26890.rb"
          },
          "results": [
            {
              "status": "passed",
              "code_desc": "Service rsyslog should be installed",
              "run_time": 0.04711,
              "start_time": "2018-02-11 14:26:25 -0500"
            },
            {
              "status": "passed",
              "code_desc": "Service rsyslog should be running",
              "run_time": 0.000115,
              "start_time": "2018-02-11 14:26:25 -0500"
            },
            {
              "status": "failed",
              "code_desc": "/etc/rsyslog.conf configured with log aggregation server: logagg.site.mil should equal true",
              "run_time": 0.000214,
              "start_time": "2018-02-11 14:26:25 -0500"
            }
          ]
        },
        {
          "id": "V-26976",
          "title": "To support audit review, analysis and reporting the application must\nintegrate audit review, analysis, and reporting processes to support\norganizational processes for investigation and response to suspicious\nactivities.",
          "desc": "Offload and centralize audit records retention to a separate system\nfrom the sources of audit records.",
          "impact": 0.5,
          "refs": [],
          "tags": {
            "nist": [
              "AU-6 (1)",
              "Rev_3"
            ],
            "severity": "medium",
            "rid": "SV-34264r1_rule",
            "gtitle": "SRG-APP-000110",
            "cci": "CCI-000152",
            "check": "Moving audit records to a centralized location will assist in\nthe investigation and response. Verify 'rsyslog' is configured to send all\nmessages to a log aggregation server.\n\nCheck the configuration of 'rsyslog' with the following command:\n\n# grep @ /etc/rsyslog.conf\n   *.* @@logagg.site.mil\n\nIf there are no lines in the '/etc/rsyslog.conf' file that contain the '@'\nor '@@' symbol(s), and the lines with the correct symbol(s) to send output to\nanother system do not cover all 'rsyslog' output, this is a finding.",
            "fix": "Modify the '/etc/rsyslog.conf' file to contain a configuration\nline to send all 'rsyslog' output to a log aggregation system:\n\n*.* @@&ltlog aggregation system name&gt\n\n"
          },
          "code": "control \"V-26976\" do\n  title \"To support audit review, analysis and reporting the application must\nintegrate audit review, analysis, and reporting processes to support\norganizational processes for investigation and response to suspicious\nactivities.\"\n  desc  \"Offload and centralize audit records retention to a separate system\nfrom the sources of audit records.\"\n  impact 0.5\n  tag \"nist\": [\"AU-6 (1)\", \"Rev_3\"]\n  tag \"severity\": \"medium\"\n  tag \"rid\": \"SV-34264r1_rule\"\n  tag \"gtitle\": \"SRG-APP-000110\"\n  tag \"cci\": \"CCI-000152\"\n  tag \"check\": \"Moving audit records to a centralized location will assist in\nthe investigation and response. Verify 'rsyslog' is configured to send all\nmessages to a log aggregation server.\n\nCheck the configuration of 'rsyslog' with the following command:\n\n# grep @ /etc/rsyslog.conf\n   *.* @@logagg.site.mil\n\nIf there are no lines in the '/etc/rsyslog.conf' file that contain the '@'\nor '@@' symbol(s), and the lines with the correct symbol(s) to send output to\nanother system do not cover all 'rsyslog' output, this is a finding.\"\n  tag \"fix\": \"Modify the '/etc/rsyslog.conf' file to contain a configuration\nline to send all 'rsyslog' output to a log aggregation system:\n\n*.* @@&ltlog aggregation system name&gt\n\n\"\n  begin\n\n    describe service('rsyslog') do\n      it { should be_installed }\n      it { should be_running }\n    end\n    \n    describe \"#{RSYSLOG_CONF} configured with log aggregation server: #{LOG_AGGREGATION_SYSTEM}\" do\n      subject { !file(RSYSLOG_CONF).content.match(/@{1,2}#{LOG_AGGREGATION_SYSTEM}/).nil? }\n      it { should be true }\n    end\n\n  rescue Exception => msg\n    describe \"Exception: #{msg}\" do\n      it { should be_nil}\n    end\n  end\nend\n",
          "source_location": {
            "line": 17,
            "ref": "../elasticsearch-inspec/controls/rsyslog/V-26976.rb"
          },
          "results": [
            {
              "status": "passed",
              "code_desc": "Service rsyslog should be installed",
              "run_time": 0.045806,
              "start_time": "2018-02-11 14:26:25 -0500"
            },
            {
              "status": "passed",
              "code_desc": "Service rsyslog should be running",
              "run_time": 0.000138,
              "start_time": "2018-02-11 14:26:25 -0500"
            },
            {
              "status": "failed",
              "code_desc": "/etc/rsyslog.conf configured with log aggregation server: logagg.site.mil should equal true",
              "run_time": 0.000159,
              "start_time": "2018-02-11 14:26:25 -0500"
            }
          ]
        },
        {
          "id": "V-26945",
          "title": "The organizational must employ automated mechanisms to restrict the\nuse of maintenance tools to authorized personnel only.",
          "desc": "Isolate maintenance functions from non-maintenance functions(Cluster\nhealth) with the use of RBAC under the principle of least privilege.\nMaintenance users should not be granted roles and privileges beyond what is\nnecessary to diagnose the system.",
          "impact": 0.5,
          "refs": [],
          "tags": {
            "nist": [
              "MA-3 (4)",
              "Rev_3"
            ],
            "severity": "medium",
            "rid": "SV-34227r1_rule",
            "gtitle": "SRG-APP-NA",
            "cci": "CCI-000872",
            "check": "Design the domains of administrative roles within Elasticsearch\nby the principle of Separation of Duties.\n\nAs the application administrator (shown here as 'elasticsearch'), verify the\npermissions for ES_HOME:\n\n$ ls -la ${ES_HOME?}\n\nIf anything in ES_HOME is not owned by the application administrator, this is a\nfinding.\n\nNext, as the elasticsearch administrator, run the following CURL command:\n\n\n$ curl -XGET  -H 'Content-Type: application/json' -u <TEST_USER> -p\n<TEST_CREDENTIALS> https://<elasticsearch>:9200/_xpack/security/role\n\nReview the role permissions, if any role is listed as superuser but should not\nhave that access, this is a finding.",
            "fix": "Enforce logical access restrictions with changes to application\nconfiguration.\n\nSee the official documentation for the complete  guide on authorization\nconfiguration:\nhttps://www.elastic.co/guide/en/x-pack/current/authorization.html"
          },
          "code": "control \"V-26945\" do\n  title \"The organizational must employ automated mechanisms to restrict the\nuse of maintenance tools to authorized personnel only.\"\n  desc  \"Isolate maintenance functions from non-maintenance functions(Cluster\nhealth) with the use of RBAC under the principle of least privilege.\nMaintenance users should not be granted roles and privileges beyond what is\nnecessary to diagnose the system.\"\n  impact 0.5\n  tag \"nist\": [\"MA-3 (4)\", \"Rev_3\"]\n  tag \"severity\": \"medium\"\n  tag \"rid\": \"SV-34227r1_rule\"\n  tag \"gtitle\": \"SRG-APP-NA\"\n  tag \"cci\": \"CCI-000872\"\n  tag \"check\": \"Design the domains of administrative roles within Elasticsearch\nby the principle of Separation of Duties.\n\nAs the application administrator (shown here as 'elasticsearch'), verify the\npermissions for ES_HOME:\n\n$ ls -la ${ES_HOME?}\n\nIf anything in ES_HOME is not owned by the application administrator, this is a\nfinding.\n\nNext, as the elasticsearch administrator, run the following CURL command:\n\n\n$ curl -XGET  -H 'Content-Type: application/json' -u <TEST_USER> -p\n<TEST_CREDENTIALS> https://<elasticsearch>:9200/_xpack/security/role\n\nReview the role permissions, if any role is listed as superuser but should not\nhave that access, this is a finding.\"\n  tag \"fix\": \"Enforce logical access restrictions with changes to application\nconfiguration.\n\nSee the official documentation for the complete  guide on authorization\nconfiguration:\nhttps://www.elastic.co/guide/en/x-pack/current/authorization.html\"\n\n\n  begin\n\n    es_handle = es_helper(url:\"https://#{ELASTIC_IP}:#{ELASTIC_PORT}\",\n                    username: ES_ADMIN,\n                    password: ES_PASS,\n                    ssl_verify: SSL_VERIFY )\n\n    describe \"No nodes found\" do\n      subject { es_handle.nodes.nil? }\n      it { should_not be_truthy }\n    end if es_handle.nodes.nil?\n\n\n    describe \"ES HOME directory\" do\n      subject { file(ES_HOME) }\n      its('owner') { should eq ES_OWNER }\n      its('group') { should eq ES_GROUP }\n    end\n\n    describe \"ES CONF\" do\n      subject { file(ELASTICSEARCH_CONF) }\n      its('owner') { should eq ES_OWNER }\n      its('group') { should eq ES_GROUP }\n    end\n\n    describe es_handle do\n      its('superusers') { should be_in DOCUMENTED_SUPER_ROLES}\n    end\n\n  rescue Exception => msg\n    describe \"Exception: #{msg}\" do\n      it { should be_nil}\n    end\n  end\nend",
          "source_location": {
            "line": 65,
            "ref": "../elasticsearch-inspec/controls/home+role/V-26945.rb"
          },
          "results": [
            {
              "status": "passed",
              "code_desc": "ES HOME directory owner should eq \"elasticsearch\"",
              "run_time": 0.015072,
              "start_time": "2018-02-11 14:26:25 -0500"
            },
            {
              "status": "passed",
              "code_desc": "ES HOME directory group should eq \"elasticsearch\"",
              "run_time": 0.00012,
              "start_time": "2018-02-11 14:26:25 -0500"
            },
            {
              "status": "passed",
              "code_desc": "ES CONF owner should eq \"elasticsearch\"",
              "run_time": 0.00011,
              "start_time": "2018-02-11 14:26:25 -0500"
            },
            {
              "status": "passed",
              "code_desc": "ES CONF group should eq \"elasticsearch\"",
              "run_time": 0.000072,
              "start_time": "2018-02-11 14:26:25 -0500"
            },
            {
              "status": "passed",
              "code_desc": "Elasticsearch Cluster https://0.0.0.0:9200 superusers should be in \"superuser\"",
              "run_time": 1.280834,
              "start_time": "2018-02-11 14:26:25 -0500"
            }
          ]
        },
        {
          "id": "V-26672",
          "title": "The application must have the ability to retain a session lock\nremaining in effect until the user re-authenticates using established\nidentification and authentication procedures.",
          "desc": "Enforce logical access restrictions with changes to application\nconfiguration.",
          "impact": 0.5,
          "refs": [],
          "tags": {
            "nist": [
              "AC-11 b",
              "Rev_4"
            ],
            "severity": "medium",
            "rid": "SV-33819r1_rule",
            "gtitle": "SRG-APP-000005",
            "cci": "CCI-000056",
            "check": "Design the domains of administrative roles within Elasticsearch\nby the principle of Separation of Duties.\n\nAs the application administrator (shown here as 'elasticsearch'), verify the\npermissions for ES_HOME:\n\n$ ls -la ${ES_HOME?}\n\nIf anything in ES_HOME is not owned by the application administrator, this is a\nfinding.\n\nNext, as the elasticsearch administrator, run the following CURL command:\n\n\n$ curl -XGET  -H 'Content-Type: application/json' -u <TEST_USER> -p\n<TEST_CREDENTIALS> https://<elasticsearch>:9200/_xpack/security/role\n\nReview the role permissions, if any role is listed as superuser but should not\nhave that access, this is a finding.",
            "fix": "Enforce logical access restrictions with changes to application\nconfiguration.\n\nSee the official documentation for the complete  guide on authorization\nconfiguration:\nhttps://www.elastic.co/guide/en/x-pack/current/authorization.html"
          },
          "code": "control \"V-26672\" do\n  title \"The application must have the ability to retain a session lock\nremaining in effect until the user re-authenticates using established\nidentification and authentication procedures.\"\n  desc  \"Enforce logical access restrictions with changes to application\nconfiguration.\"\n  impact 0.5\n  tag \"nist\": [\"AC-11 b\", \"Rev_4\"]\n  tag \"severity\": \"medium\"\n  tag \"rid\": \"SV-33819r1_rule\"\n  tag \"gtitle\": \"SRG-APP-000005\"\n  tag \"cci\": \"CCI-000056\"\n  tag \"check\": \"Design the domains of administrative roles within Elasticsearch\nby the principle of Separation of Duties.\n\nAs the application administrator (shown here as 'elasticsearch'), verify the\npermissions for ES_HOME:\n\n$ ls -la ${ES_HOME?}\n\nIf anything in ES_HOME is not owned by the application administrator, this is a\nfinding.\n\nNext, as the elasticsearch administrator, run the following CURL command:\n\n\n$ curl -XGET  -H 'Content-Type: application/json' -u <TEST_USER> -p\n<TEST_CREDENTIALS> https://<elasticsearch>:9200/_xpack/security/role\n\nReview the role permissions, if any role is listed as superuser but should not\nhave that access, this is a finding.\"\n  tag \"fix\": \"Enforce logical access restrictions with changes to application\nconfiguration.\n\nSee the official documentation for the complete  guide on authorization\nconfiguration:\nhttps://www.elastic.co/guide/en/x-pack/current/authorization.html\"\n\n\n  begin\n\n    es_handle = es_helper(url:\"https://#{ELASTIC_IP}:#{ELASTIC_PORT}\",\n                    username: ES_ADMIN,\n                    password: ES_PASS,\n                    ssl_verify: SSL_VERIFY )\n\n    describe \"No nodes found\" do\n      subject { es_handle.nodes.nil? }\n      it { should_not be_truthy }\n    end if es_handle.nodes.nil?\n\n\n    describe \"ES HOME directory\" do\n      subject { file(ES_HOME) }\n      its('owner') { should eq ES_OWNER }\n      its('group') { should eq ES_GROUP }\n    end\n\n    describe \"ES CONF\" do\n      subject { file(ELASTICSEARCH_CONF) }\n      its('owner') { should eq ES_OWNER }\n      its('group') { should eq ES_GROUP }\n    end\n\n    describe es_handle do\n      its('superusers') { should be_in DOCUMENTED_SUPER_ROLES}\n    end\n\n  rescue Exception => msg\n    describe \"Exception: #{msg}\" do\n      it { should be_nil}\n    end\n  end\nend\n",
          "source_location": {
            "line": 65,
            "ref": "../elasticsearch-inspec/controls/home+role/V-26672.rb"
          },
          "results": [
            {
              "status": "passed",
              "code_desc": "ES HOME directory owner should eq \"elasticsearch\"",
              "run_time": 0.000132,
              "start_time": "2018-02-11 14:26:26 -0500"
            },
            {
              "status": "passed",
              "code_desc": "ES HOME directory group should eq \"elasticsearch\"",
              "run_time": 0.000109,
              "start_time": "2018-02-11 14:26:26 -0500"
            },
            {
              "status": "passed",
              "code_desc": "ES CONF owner should eq \"elasticsearch\"",
              "run_time": 0.000077,
              "start_time": "2018-02-11 14:26:26 -0500"
            },
            {
              "status": "passed",
              "code_desc": "ES CONF group should eq \"elasticsearch\"",
              "run_time": 0.000104,
              "start_time": "2018-02-11 14:26:26 -0500"
            },
            {
              "status": "passed",
              "code_desc": "Elasticsearch Cluster https://0.0.0.0:9200 superusers should be in \"superuser\"",
              "run_time": 1.301925,
              "start_time": "2018-02-11 14:26:26 -0500"
            }
          ]
        },
        {
          "id": "V-26961",
          "title": "Applications must adhere to the principles of least functionality by\nproviding only essential capabilities.",
          "desc": "Separate administrative rights into three groups. User Administrators,\nCluster Administrators, and Index Administrators using X-Pack's RBAC and\nlimiting access to System accounts and configuration files with operating\nsystem controls. Administrators of each type should not be given global\nadministrative controls outside of their job function.",
          "impact": 0.5,
          "refs": [],
          "tags": {
            "nist": [
              "CM-7 a",
              "Rev_4"
            ],
            "severity": "medium",
            "rid": "SV-34246r1_rule",
            "gtitle": "SRG-APP-000141",
            "cci": "CCI-000381",
            "check": "Design the domains of administrative roles within Elasticsearch\nby the principle of Separation of Duties.\n\nAs the application administrator (shown here as 'elasticsearch'), verify the\npermissions for ES_HOME:\n\n$ ls -la ${ES_HOME?}\n\nIf anything in ES_HOME is not owned by the application administrator, this is a\nfinding.\n\nNext, as the elasticsearch administrator, run the following CURL command:\n\n\n$ curl -XGET  -H 'Content-Type: application/json' -u <TEST_USER> -p\n<TEST_CREDENTIALS> https://<elasticsearch>:9200/_xpack/security/role\n\nReview the role permissions, if any role is listed as superuser but should not\nhave that access, this is a finding.",
            "fix": "Enforce logical access restrictions with changes to application\nconfiguration.\n\nSee the official documentation for the complete  guide on authorization\nconfiguration:\nhttps://www.elastic.co/guide/en/x-pack/current/authorization.html"
          },
          "code": "control \"V-26961\" do\n  title \"Applications must adhere to the principles of least functionality by\nproviding only essential capabilities.\"\n  desc  \"Separate administrative rights into three groups. User Administrators,\nCluster Administrators, and Index Administrators using X-Pack's RBAC and\nlimiting access to System accounts and configuration files with operating\nsystem controls. Administrators of each type should not be given global\nadministrative controls outside of their job function.\"\n  impact 0.5\n  tag \"nist\": [\"CM-7 a\", \"Rev_4\"]\n  tag \"severity\": \"medium\"\n  tag \"rid\": \"SV-34246r1_rule\"\n  tag \"gtitle\": \"SRG-APP-000141\"\n  tag \"cci\": \"CCI-000381\"\n  tag \"check\": \"Design the domains of administrative roles within Elasticsearch\nby the principle of Separation of Duties.\n\nAs the application administrator (shown here as 'elasticsearch'), verify the\npermissions for ES_HOME:\n\n$ ls -la ${ES_HOME?}\n\nIf anything in ES_HOME is not owned by the application administrator, this is a\nfinding.\n\nNext, as the elasticsearch administrator, run the following CURL command:\n\n\n$ curl -XGET  -H 'Content-Type: application/json' -u <TEST_USER> -p\n<TEST_CREDENTIALS> https://<elasticsearch>:9200/_xpack/security/role\n\nReview the role permissions, if any role is listed as superuser but should not\nhave that access, this is a finding.\"\n  tag \"fix\": \"Enforce logical access restrictions with changes to application\nconfiguration.\n\nSee the official documentation for the complete  guide on authorization\nconfiguration:\nhttps://www.elastic.co/guide/en/x-pack/current/authorization.html\"\n\n\n  begin\n\n    es_handle = es_helper(url:\"https://#{ELASTIC_IP}:#{ELASTIC_PORT}\",\n                    username: ES_ADMIN,\n                    password: ES_PASS,\n                    ssl_verify: SSL_VERIFY )\n\n    describe \"No nodes found\" do\n      subject { es_handle.nodes.nil? }\n      it { should_not be_truthy }\n    end if es_handle.nodes.nil?\n\n\n    describe \"ES HOME directory\" do\n      subject { file(ES_HOME) }\n      its('owner') { should eq ES_OWNER }\n      its('group') { should eq ES_GROUP }\n    end\n\n    describe \"ES CONF\" do\n      subject { file(ELASTICSEARCH_CONF) }\n      its('owner') { should eq ES_OWNER }\n      its('group') { should eq ES_GROUP }\n    end\n\n    describe es_handle do\n      its('superusers') { should be_in DOCUMENTED_SUPER_ROLES}\n    end\n\n  rescue Exception => msg\n    describe \"Exception: #{msg}\" do\n      it { should be_nil}\n    end\n  end\nend",
          "source_location": {
            "line": 65,
            "ref": "../elasticsearch-inspec/controls/home+role/V-26961.rb"
          },
          "results": [
            {
              "status": "passed",
              "code_desc": "ES HOME directory owner should eq \"elasticsearch\"",
              "run_time": 0.000151,
              "start_time": "2018-02-11 14:26:27 -0500"
            },
            {
              "status": "passed",
              "code_desc": "ES HOME directory group should eq \"elasticsearch\"",
              "run_time": 0.00021,
              "start_time": "2018-02-11 14:26:27 -0500"
            },
            {
              "status": "passed",
              "code_desc": "ES CONF owner should eq \"elasticsearch\"",
              "run_time": 0.000099,
              "start_time": "2018-02-11 14:26:27 -0500"
            },
            {
              "status": "passed",
              "code_desc": "ES CONF group should eq \"elasticsearch\"",
              "run_time": 0.000102,
              "start_time": "2018-02-11 14:26:27 -0500"
            },
            {
              "status": "passed",
              "code_desc": "Elasticsearch Cluster https://0.0.0.0:9200 superusers should be in \"superuser\"",
              "run_time": 1.287151,
              "start_time": "2018-02-11 14:26:27 -0500"
            }
          ]
        },
        {
          "id": "V-26821",
          "title": "Applications must support organizational requirements to implement\nseparation of duties through assigned information access authorizations.",
          "desc": "Grant access to security and administrative functions of Elasticsearch\nonly through Role Based Access Control",
          "impact": 0.5,
          "refs": [],
          "tags": {
            "nist": [
              "AC-5 c",
              "Rev_3"
            ],
            "severity": "medium",
            "rid": "SV-34071r1_rule",
            "gtitle": "SRG-APP-000062",
            "cci": "CCI-000037",
            "check": "Design the domains of administrative roles within Elasticsearch\nby the principle of Separation of Duties.\n\nAs the application administrator (shown here as 'elasticsearch'), verify the\npermissions for ES_HOME:\n\n$ ls -la ${ES_HOME?}\n\nIf anything in ES_HOME is not owned by the application administrator, this is a\nfinding.\n\nNext, as the elasticsearch administrator, run the following CURL command:\n\n\n$ curl -XGET  -H 'Content-Type: application/json' -u <TEST_USER> -p\n<TEST_CREDENTIALS> https://<elasticsearch>:9200/_xpack/security/role\n\nReview the role permissions, if any role is listed as superuser but should not\nhave that access, this is a finding.",
            "fix": "Enforce logical access restrictions with changes to application\nconfiguration.\n\nSee the official documentation for the complete  guide on authorization\nconfiguration:\nhttps://www.elastic.co/guide/en/x-pack/current/authorization.html"
          },
          "code": "control \"V-26821\" do\n  title \"Applications must support organizational requirements to implement\nseparation of duties through assigned information access authorizations.\"\n  desc  \"Grant access to security and administrative functions of Elasticsearch\nonly through Role Based Access Control\"\n  impact 0.5\n  tag \"nist\": [\"AC-5 c\", \"Rev_3\"]\n  tag \"severity\": \"medium\"\n  tag \"rid\": \"SV-34071r1_rule\"\n  tag \"gtitle\": \"SRG-APP-000062\"\n  tag \"cci\": \"CCI-000037\"\n  tag \"check\": \"Design the domains of administrative roles within Elasticsearch\nby the principle of Separation of Duties.\n\nAs the application administrator (shown here as 'elasticsearch'), verify the\npermissions for ES_HOME:\n\n$ ls -la ${ES_HOME?}\n\nIf anything in ES_HOME is not owned by the application administrator, this is a\nfinding.\n\nNext, as the elasticsearch administrator, run the following CURL command:\n\n\n$ curl -XGET  -H 'Content-Type: application/json' -u <TEST_USER> -p\n<TEST_CREDENTIALS> https://<elasticsearch>:9200/_xpack/security/role\n\nReview the role permissions, if any role is listed as superuser but should not\nhave that access, this is a finding.\"\n  tag \"fix\": \"Enforce logical access restrictions with changes to application\nconfiguration.\n\nSee the official documentation for the complete  guide on authorization\nconfiguration:\nhttps://www.elastic.co/guide/en/x-pack/current/authorization.html\"\n\n\n  begin\n\n    es_handle = es_helper(url:\"https://#{ELASTIC_IP}:#{ELASTIC_PORT}\",\n                    username: ES_ADMIN,\n                    password: ES_PASS,\n                    ssl_verify: SSL_VERIFY )\n\n    describe \"No nodes found\" do\n      subject { es_handle.nodes.nil? }\n      it { should_not be_truthy }\n    end if es_handle.nodes.nil?\n\n\n    describe \"ES HOME directory\" do\n      subject { file(ES_HOME) }\n      its('owner') { should eq ES_OWNER }\n      its('group') { should eq ES_GROUP }\n    end\n\n    describe \"ES CONF\" do\n      subject { file(ELASTICSEARCH_CONF) }\n      its('owner') { should eq ES_OWNER }\n      its('group') { should eq ES_GROUP }\n    end\n\n    describe es_handle do\n      its('superusers') { should be_in DOCUMENTED_SUPER_ROLES}\n    end\n\n  rescue Exception => msg\n    describe \"Exception: #{msg}\" do\n      it { should be_nil}\n    end\n  end\nend\n",
          "source_location": {
            "line": 71,
            "ref": "../elasticsearch-inspec/controls/home+role/V-26821.rb"
          },
          "results": [
            {
              "status": "passed",
              "code_desc": "ES HOME directory owner should eq \"elasticsearch\"",
              "run_time": 0.000139,
              "start_time": "2018-02-11 14:26:29 -0500"
            },
            {
              "status": "passed",
              "code_desc": "ES HOME directory group should eq \"elasticsearch\"",
              "run_time": 0.000113,
              "start_time": "2018-02-11 14:26:29 -0500"
            },
            {
              "status": "passed",
              "code_desc": "ES CONF owner should eq \"elasticsearch\"",
              "run_time": 0.000123,
              "start_time": "2018-02-11 14:26:29 -0500"
            },
            {
              "status": "passed",
              "code_desc": "ES CONF group should eq \"elasticsearch\"",
              "run_time": 0.000072,
              "start_time": "2018-02-11 14:26:29 -0500"
            },
            {
              "status": "passed",
              "code_desc": "Elasticsearch Cluster https://0.0.0.0:9200 superusers should be in \"superuser\"",
              "run_time": 1.810268,
              "start_time": "2018-02-11 14:26:29 -0500"
            }
          ]
        },
        {
          "id": "V-26934",
          "title": "The application must support the enforcement of logical access\nrestrictions associated with changes to application configuration.",
          "desc": "Separate administrative rights into three groups. User Administrators,\nCluster Administrators, and Index Administrators using X-Pack's RBAC and\nlimiting access to system user; like elastic, and configuration files with\noperating system controls. Administrators of each type should not be given\nglobal administrative controls outside of their job function.",
          "impact": 0.5,
          "refs": [],
          "tags": {
            "nist": [
              "CM-5",
              "Rev_4"
            ],
            "severity": "medium",
            "rid": "SV-34214r1_rule",
            "gtitle": "SRG-APP-000128",
            "cci": "CCI-000345",
            "check": "Design the domains of administrative roles within Elasticsearch\nby the principle of Separation of Duties.\n\nAs the application administrator (shown here as 'elasticsearch'), verify the\npermissions for ES_HOME:\n\n$ ls -la ${ES_HOME?}\n\nIf anything in ES_HOME is not owned by the application administrator, this is a\nfinding.\n\nNext, as the elasticsearch administrator, run the following CURL command:\n\n\n$ curl -XGET  -H 'Content-Type: application/json' -u <TEST_USER> -p\n<TEST_CREDENTIALS> https://<elasticsearch>:9200/_xpack/security/role\n\nReview the role permissions, if any role is listed as superuser but should not\nhave that access, this is a finding.",
            "fix": "Enforce logical access restrictions with changes to application\nconfiguration.\n\nSee the official documentation for the complete  guide on authorization\nconfiguration:\nhttps://www.elastic.co/guide/en/x-pack/current/authorization.html"
          },
          "code": "control \"V-26934\" do\n  title \"The application must support the enforcement of logical access\nrestrictions associated with changes to application configuration.\"\n  desc  \"Separate administrative rights into three groups. User Administrators,\nCluster Administrators, and Index Administrators using X-Pack's RBAC and\nlimiting access to system user; like elastic, and configuration files with\noperating system controls. Administrators of each type should not be given\nglobal administrative controls outside of their job function.\"\n  impact 0.5\n  tag \"nist\": [\"CM-5\", \"Rev_4\"]\n  tag \"severity\": \"medium\"\n  tag \"rid\": \"SV-34214r1_rule\"\n  tag \"gtitle\": \"SRG-APP-000128\"\n  tag \"cci\": \"CCI-000345\"\n  tag \"check\": \"Design the domains of administrative roles within Elasticsearch\nby the principle of Separation of Duties.\n\nAs the application administrator (shown here as 'elasticsearch'), verify the\npermissions for ES_HOME:\n\n$ ls -la ${ES_HOME?}\n\nIf anything in ES_HOME is not owned by the application administrator, this is a\nfinding.\n\nNext, as the elasticsearch administrator, run the following CURL command:\n\n\n$ curl -XGET  -H 'Content-Type: application/json' -u <TEST_USER> -p\n<TEST_CREDENTIALS> https://<elasticsearch>:9200/_xpack/security/role\n\nReview the role permissions, if any role is listed as superuser but should not\nhave that access, this is a finding.\"\n  tag \"fix\": \"Enforce logical access restrictions with changes to application\nconfiguration.\n\nSee the official documentation for the complete  guide on authorization\nconfiguration:\nhttps://www.elastic.co/guide/en/x-pack/current/authorization.html\"\n\n  begin\n\n    es_handle = es_helper(url:\"https://#{ELASTIC_IP}:#{ELASTIC_PORT}\",\n                    username: ES_ADMIN,\n                    password: ES_PASS,\n                    ssl_verify: SSL_VERIFY )\n\n    describe \"No nodes found\" do\n      subject { es_handle.nodes.nil? }\n      it { should_not be_truthy }\n    end if es_handle.nodes.nil?\n\n\n    describe \"ES HOME directory\" do\n      subject { file(ES_HOME) }\n      its('owner') { should eq ES_OWNER }\n      its('group') { should eq ES_GROUP }\n    end\n\n    describe \"ES CONF\" do\n      subject { file(ELASTICSEARCH_CONF) }\n      its('owner') { should eq ES_OWNER }\n      its('group') { should eq ES_GROUP }\n    end\n\n    describe es_handle do\n      its('superusers') { should be_in DOCUMENTED_SUPER_ROLES}\n    end\n\n  rescue Exception => msg\n    describe \"Exception: #{msg}\" do\n      it { should be_nil}\n    end\n  end\nend",
          "source_location": {
            "line": 65,
            "ref": "../elasticsearch-inspec/controls/home+role/V-26934.rb"
          },
          "results": [
            {
              "status": "passed",
              "code_desc": "ES HOME directory owner should eq \"elasticsearch\"",
              "run_time": 0.000136,
              "start_time": "2018-02-11 14:26:31 -0500"
            },
            {
              "status": "passed",
              "code_desc": "ES HOME directory group should eq \"elasticsearch\"",
              "run_time": 0.0001,
              "start_time": "2018-02-11 14:26:31 -0500"
            },
            {
              "status": "passed",
              "code_desc": "ES CONF owner should eq \"elasticsearch\"",
              "run_time": 0.000106,
              "start_time": "2018-02-11 14:26:31 -0500"
            },
            {
              "status": "passed",
              "code_desc": "ES CONF group should eq \"elasticsearch\"",
              "run_time": 0.000094,
              "start_time": "2018-02-11 14:26:31 -0500"
            },
            {
              "status": "passed",
              "code_desc": "Elasticsearch Cluster https://0.0.0.0:9200 superusers should be in \"superuser\"",
              "run_time": 1.347974,
              "start_time": "2018-02-11 14:26:31 -0500"
            }
          ]
        },
        {
          "id": "V-29189",
          "title": "Applications must isolate security functions enforcing access and\ninformation flow control from both non-security functions and from other\nsecurity functions.",
          "desc": "Isolate security functions from non security functions with the use of\nRBAC under the principle of least privilege. administrative users should not be\ngranted roles and privileges beyond what is necessary to administer the system.",
          "impact": 0.5,
          "refs": [],
          "tags": {
            "nist": [
              "SC-3 (2)",
              "Rev_4"
            ],
            "severity": "medium",
            "rid": "SV-37460r1_rule",
            "gtitle": "SRG-APP-000235",
            "cci": "CCI-001086",
            "check": "Design the domains of administrative roles within Elasticsearch\nby the principle of Separation of Duties.\n\nAs the application administrator (shown here as 'elasticsearch'), verify the\npermissions for ES_HOME:\n\n$ ls -la ${ES_HOME?}\n\nIf anything in ES_HOME is not owned by the application administrator, this is a\nfinding.\n\nNext, as the elasticsearch administrator, run the following CURL command:\n\n\n$ curl -XGET  -H 'Content-Type: application/json' -u <TEST_USER> -p\n<TEST_CREDENTIALS> https://<elasticsearch>:9200/_xpack/security/role\n\nReview the role permissions, if any role is listed as superuser but should not\nhave that access, this is a finding.",
            "fix": "Enforce logical access restrictions with changes to application\nconfiguration.\n\nSee the official documentation for the complete  guide on authorization\nconfiguration:\nhttps://www.elastic.co/guide/en/x-pack/current/authorization.html"
          },
          "code": "control \"V-29189\" do\n  title \"Applications must isolate security functions enforcing access and\ninformation flow control from both non-security functions and from other\nsecurity functions.\"\n  desc  \"Isolate security functions from non security functions with the use of\nRBAC under the principle of least privilege. administrative users should not be\ngranted roles and privileges beyond what is necessary to administer the system.\"\n  impact 0.5\n  tag \"nist\": [\"SC-3 (2)\", \"Rev_4\"]\n  tag \"severity\": \"medium\"\n  tag \"rid\": \"SV-37460r1_rule\"\n  tag \"gtitle\": \"SRG-APP-000235\"\n  tag \"cci\": \"CCI-001086\"\n  tag \"check\": \"Design the domains of administrative roles within Elasticsearch\nby the principle of Separation of Duties.\n\nAs the application administrator (shown here as 'elasticsearch'), verify the\npermissions for ES_HOME:\n\n$ ls -la ${ES_HOME?}\n\nIf anything in ES_HOME is not owned by the application administrator, this is a\nfinding.\n\nNext, as the elasticsearch administrator, run the following CURL command:\n\n\n$ curl -XGET  -H 'Content-Type: application/json' -u <TEST_USER> -p\n<TEST_CREDENTIALS> https://<elasticsearch>:9200/_xpack/security/role\n\nReview the role permissions, if any role is listed as superuser but should not\nhave that access, this is a finding.\"\n  tag \"fix\": \"Enforce logical access restrictions with changes to application\nconfiguration.\n\nSee the official documentation for the complete  guide on authorization\nconfiguration:\nhttps://www.elastic.co/guide/en/x-pack/current/authorization.html\"\n\n  begin\n\n    es_handle = es_helper(url:\"https://#{ELASTIC_IP}:#{ELASTIC_PORT}\",\n                    username: ES_ADMIN,\n                    password: ES_PASS,\n                    ssl_verify: SSL_VERIFY )\n\n    describe \"No nodes found\" do\n      subject { es_handle.nodes.nil? }\n      it { should_not be_truthy }\n    end if es_handle.nodes.nil?\n\n\n    describe \"ES HOME directory\" do\n      subject { file(ES_HOME) }\n      its('owner') { should eq ES_OWNER }\n      its('group') { should eq ES_GROUP }\n    end\n\n    describe \"ES CONF\" do\n      subject { file(ELASTICSEARCH_CONF) }\n      its('owner') { should eq ES_OWNER }\n      its('group') { should eq ES_GROUP }\n    end\n\n    describe es_handle do\n      its('superusers') { should be_in DOCUMENTED_SUPER_ROLES}\n    end\n\n  rescue Exception => msg\n    describe \"Exception: #{msg}\" do\n      it { should be_nil}\n    end\n  end\nend\n",
          "source_location": {
            "line": 65,
            "ref": "../elasticsearch-inspec/controls/home+role/V-29189.rb"
          },
          "results": [
            {
              "status": "passed",
              "code_desc": "ES HOME directory owner should eq \"elasticsearch\"",
              "run_time": 0.000158,
              "start_time": "2018-02-11 14:26:32 -0500"
            },
            {
              "status": "passed",
              "code_desc": "ES HOME directory group should eq \"elasticsearch\"",
              "run_time": 0.000092,
              "start_time": "2018-02-11 14:26:32 -0500"
            },
            {
              "status": "passed",
              "code_desc": "ES CONF owner should eq \"elasticsearch\"",
              "run_time": 0.000083,
              "start_time": "2018-02-11 14:26:32 -0500"
            },
            {
              "status": "passed",
              "code_desc": "ES CONF group should eq \"elasticsearch\"",
              "run_time": 0.000083,
              "start_time": "2018-02-11 14:26:32 -0500"
            },
            {
              "status": "passed",
              "code_desc": "Elasticsearch Cluster https://0.0.0.0:9200 superusers should be in \"superuser\"",
              "run_time": 1.301241,
              "start_time": "2018-02-11 14:26:32 -0500"
            }
          ]
        },
        {
          "id": "V-27159",
          "title": "The application must protect the integrity and availability of\npublicly available information and applications.",
          "desc": "Prevent tampering for publicly available information sets by setting\nread-only access for application or anonymous access, as appropriate.",
          "impact": 0.5,
          "refs": [],
          "tags": {
            "nist": [
              "SC-14",
              "Rev_3"
            ],
            "severity": "medium",
            "rid": "SV-34458r1_rule",
            "gtitle": "SRG-APP-000201",
            "cci": "CCI-001149",
            "check": "Elasticsearch enforces access restrictions based on Role Based\nAccess Control. Other access controls should be handled by the Operating\nSystem.\n\nAs the application administrator (shown here as 'elasticsearch'), verify the\npermissions for ES_HOME:\n\n$ ls -la ${ES_HOME?}\n\nIf anything in ES_HOME is not owned by the application administrator, this is a\nfinding.\n\nAs the elasticsearch administrator, run the following CURL command:\n\n$ curl -XGET  -H 'Content-Type: application/json' -u <TEST_USER> -p\n<TEST_CREDENTIALS> https://<elasticsearch>:9200/_xpack/security/role\n\nReview the role permissions, if any role is incorrect or provides access to\ncluster configuration outside of administrative roles, this is a finding.",
            "fix": "Enforce the protection needs of public information in the same\nmanner as normal access restrictions.\n\nSee the official documentation for the complete  guide on authorization\nconfiguration:\nhttps://www.elastic.co/guide/en/x-pack/current/authorization.html"
          },
          "code": "control \"V-27159\" do\n  title \"The application must protect the integrity and availability of\npublicly available information and applications.\"\n  desc  \"Prevent tampering for publicly available information sets by setting\nread-only access for application or anonymous access, as appropriate.\"\n  impact 0.5\n  tag \"nist\": [\"SC-14\", \"Rev_3\"]\n  tag \"severity\": \"medium\"\n  tag \"rid\": \"SV-34458r1_rule\"\n  tag \"gtitle\": \"SRG-APP-000201\"\n  tag \"cci\": \"CCI-001149\"\n  tag \"check\": \"Elasticsearch enforces access restrictions based on Role Based\nAccess Control. Other access controls should be handled by the Operating\nSystem.\n\nAs the application administrator (shown here as 'elasticsearch'), verify the\npermissions for ES_HOME:\n\n$ ls -la ${ES_HOME?}\n\nIf anything in ES_HOME is not owned by the application administrator, this is a\nfinding.\n\nAs the elasticsearch administrator, run the following CURL command:\n\n$ curl -XGET  -H 'Content-Type: application/json' -u <TEST_USER> -p\n<TEST_CREDENTIALS> https://<elasticsearch>:9200/_xpack/security/role\n\nReview the role permissions, if any role is incorrect or provides access to\ncluster configuration outside of administrative roles, this is a finding.\"\n  tag \"fix\": \"Enforce the protection needs of public information in the same\nmanner as normal access restrictions.\n\nSee the official documentation for the complete  guide on authorization\nconfiguration:\nhttps://www.elastic.co/guide/en/x-pack/current/authorization.html\"\n\n  begin\n\n    es_handle = es_helper(url:\"https://#{ELASTIC_IP}:#{ELASTIC_PORT}\",\n                    username: ES_ADMIN,\n                    password: ES_PASS,\n                    ssl_verify: SSL_VERIFY )\n\n    describe \"No nodes found\" do\n      subject { es_handle.nodes.nil? }\n      it { should_not be_truthy }\n    end if es_handle.nodes.nil?\n\n\n    describe \"ES HOME directory\" do\n      subject { file(ES_HOME) }\n      its('owner') { should eq ES_OWNER }\n      its('group') { should eq ES_GROUP }\n    end\n\n    describe \"ES CONF\" do\n      subject { file(ELASTICSEARCH_CONF) }\n      its('owner') { should eq ES_OWNER }\n      its('group') { should eq ES_GROUP }\n    end\n\n    describe es_handle do\n      its('superusers') { should be_in DOCUMENTED_SUPER_ROLES}\n    end\n\n  rescue Exception => msg\n    describe \"Exception: #{msg}\" do\n      it { should be_nil}\n    end\n  end\nend",
          "source_location": {
            "line": 65,
            "ref": "../elasticsearch-inspec/controls/home+role/V-27159.rb"
          },
          "results": [
            {
              "status": "passed",
              "code_desc": "ES HOME directory owner should eq \"elasticsearch\"",
              "run_time": 0.00022,
              "start_time": "2018-02-11 14:26:33 -0500"
            },
            {
              "status": "passed",
              "code_desc": "ES HOME directory group should eq \"elasticsearch\"",
              "run_time": 0.000118,
              "start_time": "2018-02-11 14:26:33 -0500"
            },
            {
              "status": "passed",
              "code_desc": "ES CONF owner should eq \"elasticsearch\"",
              "run_time": 0.000111,
              "start_time": "2018-02-11 14:26:33 -0500"
            },
            {
              "status": "passed",
              "code_desc": "ES CONF group should eq \"elasticsearch\"",
              "run_time": 0.000095,
              "start_time": "2018-02-11 14:26:33 -0500"
            },
            {
              "status": "passed",
              "code_desc": "Elasticsearch Cluster https://0.0.0.0:9200 superusers should be in \"superuser\"",
              "run_time": 1.366288,
              "start_time": "2018-02-11 14:26:33 -0500"
            }
          ]
        },
        {
          "id": "V-26938",
          "title": "The application must support the organizational requirement to employ\nautomated mechanisms enforcing access restrictions.",
          "desc": "Configure automated alarms to proactively notify when the security or\nstability of the system is threatened",
          "impact": 0.5,
          "refs": [],
          "tags": {
            "nist": [
              "CM-5 (1)",
              "Rev_3"
            ],
            "severity": "medium",
            "rid": "SV-34218r1_rule",
            "gtitle": "SRG-APP-000129",
            "cci": "CCI-000346",
            "check": "Elasticsearch enforces access restrictions based on Role Based\nAccess Control. Other access controls should be handled by the Operating\nSystem.\n\nAs the application administrator (shown here as 'elasticsearch'), verify the\npermissions for ES_HOME:\n\n$ ls -la ${ES_HOME?}\n\nIf anything in ES_HOME is not owned by the application administrator, this is a\nfinding.\n\nAs the elasticsearch administrator, run the following CURL command:\n\n$ curl -XGET  -H 'Content-Type: application/json' -u <TEST_USER> -p\n<TEST_CREDENTIALS> https://<elasticsearch>:9200/_xpack/security/role\n\nReview the role permissions, if any role is incorrect or provides access to\ncluster configuration outside of administrative roles, this is a finding.",
            "fix": "Enforce logical access restrictions with changes to application\nconfiguration.\n\nSee the official documentation for the complete  guide on authorization\nconfiguration:\nhttps://www.elastic.co/guide/en/x-pack/current/authorization.html"
          },
          "code": "control \"V-26938\" do\n  title \"The application must support the organizational requirement to employ\nautomated mechanisms enforcing access restrictions.\"\n  desc  \"Configure automated alarms to proactively notify when the security or\nstability of the system is threatened\"\n  impact 0.5\n  tag \"nist\": [\"CM-5 (1)\", \"Rev_3\"]\n  tag \"severity\": \"medium\"\n  tag \"rid\": \"SV-34218r1_rule\"\n  tag \"gtitle\": \"SRG-APP-000129\"\n  tag \"cci\": \"CCI-000346\"\n  tag \"check\": \"Elasticsearch enforces access restrictions based on Role Based\nAccess Control. Other access controls should be handled by the Operating\nSystem.\n\nAs the application administrator (shown here as 'elasticsearch'), verify the\npermissions for ES_HOME:\n\n$ ls -la ${ES_HOME?}\n\nIf anything in ES_HOME is not owned by the application administrator, this is a\nfinding.\n\nAs the elasticsearch administrator, run the following CURL command:\n\n$ curl -XGET  -H 'Content-Type: application/json' -u <TEST_USER> -p\n<TEST_CREDENTIALS> https://<elasticsearch>:9200/_xpack/security/role\n\nReview the role permissions, if any role is incorrect or provides access to\ncluster configuration outside of administrative roles, this is a finding.\"\n  tag \"fix\": \"Enforce logical access restrictions with changes to application\nconfiguration.\n\nSee the official documentation for the complete  guide on authorization\nconfiguration:\nhttps://www.elastic.co/guide/en/x-pack/current/authorization.html\"\n\n  begin\n\n    es_handle = es_helper(url:\"https://#{ELASTIC_IP}:#{ELASTIC_PORT}\",\n                    username: ES_ADMIN,\n                    password: ES_PASS,\n                    ssl_verify: SSL_VERIFY )\n\n    describe \"No nodes found\" do\n      subject { es_handle.nodes.nil? }\n      it { should_not be_truthy }\n    end if es_handle.nodes.nil?\n\n\n    describe \"ES HOME directory\" do\n      subject { file(ES_HOME) }\n      its('owner') { should eq ES_OWNER }\n      its('group') { should eq ES_GROUP }\n    end\n\n    describe \"ES CONF\" do\n      subject { file(ELASTICSEARCH_CONF) }\n      its('owner') { should eq ES_OWNER }\n      its('group') { should eq ES_GROUP }\n    end\n\n    describe es_handle do\n      its('superusers') { should be_in DOCUMENTED_SUPER_ROLES}\n    end\n\n  rescue Exception => msg\n    describe \"Exception: #{msg}\" do\n      it { should be_nil}\n    end\n  end\nend\n",
          "source_location": {
            "line": 66,
            "ref": "../elasticsearch-inspec/controls/home+role/V-26938.rb"
          },
          "results": [
            {
              "status": "passed",
              "code_desc": "ES HOME directory owner should eq \"elasticsearch\"",
              "run_time": 0.000227,
              "start_time": "2018-02-11 14:26:35 -0500"
            },
            {
              "status": "passed",
              "code_desc": "ES HOME directory group should eq \"elasticsearch\"",
              "run_time": 0.000144,
              "start_time": "2018-02-11 14:26:35 -0500"
            },
            {
              "status": "passed",
              "code_desc": "ES CONF owner should eq \"elasticsearch\"",
              "run_time": 0.000171,
              "start_time": "2018-02-11 14:26:35 -0500"
            },
            {
              "status": "passed",
              "code_desc": "ES CONF group should eq \"elasticsearch\"",
              "run_time": 0.000138,
              "start_time": "2018-02-11 14:26:35 -0500"
            },
            {
              "status": "passed",
              "code_desc": "Elasticsearch Cluster https://0.0.0.0:9200 superusers should be in \"superuser\"",
              "run_time": 1.432268,
              "start_time": "2018-02-11 14:26:35 -0500"
            }
          ]
        },
        {
          "id": "V-26751",
          "title": "The application must prevent access to organizational-defined\nsecurity-relevant information except during secure, non-operable system states.",
          "desc": "Grant access to security and administrative functions of Elasticsearch\nonly through Role Based Access Control",
          "impact": 0.5,
          "refs": [],
          "tags": {
            "nist": [
              "AC-3 (5)",
              "Rev_4"
            ],
            "severity": "medium",
            "rid": "SV-33999r1_rule",
            "gtitle": "SRG-APP-000037",
            "cci": "CCI-000024",
            "check": "Design the domains of administrative roles within Elasticsearch\nby the principle of Separation of Duties.\n\nAs the application administrator (shown here as 'elasticsearch'), verify the\npermissions for ES_HOME:\n\n$ ls -la ${ES_HOME?}\n\nIf anything in ES_HOME is not owned by the application administrator, this is a\nfinding.\n\nNext, as the elasticsearch administrator, run the following CURL command:\n\n\n$ curl -XGET  -H 'Content-Type: application/json' -u <TEST_USER> -p\n<TEST_CREDENTIALS> https://<elasticsearch>:9200/_xpack/security/role\n\nReview the role permissions, if any role is listed as superuser but should not\nhave that access, this is a finding.",
            "fix": "Enforce logical access restrictions with changes to application\nconfiguration.\n\nSee the official documentation for the complete  guide on authorization\nconfiguration:\nhttps://www.elastic.co/guide/en/x-pack/current/authorization.html"
          },
          "code": "control \"V-26751\" do\n  title \"The application must prevent access to organizational-defined\nsecurity-relevant information except during secure, non-operable system states.\"\n  desc  \"Grant access to security and administrative functions of Elasticsearch\nonly through Role Based Access Control\"\n  impact 0.5\n  tag \"nist\": [\"AC-3 (5)\", \"Rev_4\"]\n  tag \"severity\": \"medium\"\n  tag \"rid\": \"SV-33999r1_rule\"\n  tag \"gtitle\": \"SRG-APP-000037\"\n  tag \"cci\": \"CCI-000024\"\n  tag \"check\": \"Design the domains of administrative roles within Elasticsearch\nby the principle of Separation of Duties.\n\nAs the application administrator (shown here as 'elasticsearch'), verify the\npermissions for ES_HOME:\n\n$ ls -la ${ES_HOME?}\n\nIf anything in ES_HOME is not owned by the application administrator, this is a\nfinding.\n\nNext, as the elasticsearch administrator, run the following CURL command:\n\n\n$ curl -XGET  -H 'Content-Type: application/json' -u <TEST_USER> -p\n<TEST_CREDENTIALS> https://<elasticsearch>:9200/_xpack/security/role\n\nReview the role permissions, if any role is listed as superuser but should not\nhave that access, this is a finding.\"\n  tag \"fix\": \"Enforce logical access restrictions with changes to application\nconfiguration.\n\nSee the official documentation for the complete  guide on authorization\nconfiguration:\nhttps://www.elastic.co/guide/en/x-pack/current/authorization.html\"\n\n\n  begin\n\n    es_handle = es_helper(url:\"https://#{ELASTIC_IP}:#{ELASTIC_PORT}\",\n                    username: ES_ADMIN,\n                    password: ES_PASS,\n                    ssl_verify: SSL_VERIFY )\n\n    describe \"No nodes found\" do\n      subject { es_handle.nodes.nil? }\n      it { should_not be_truthy }\n    end if es_handle.nodes.nil?\n\n\n    describe \"ES HOME directory\" do\n      subject { file(ES_HOME) }\n      its('owner') { should eq ES_OWNER }\n      its('group') { should eq ES_GROUP }\n    end\n\n    describe \"ES CONF\" do\n      subject { file(ELASTICSEARCH_CONF) }\n      its('owner') { should eq ES_OWNER }\n      its('group') { should eq ES_GROUP }\n    end\n\n    describe es_handle do\n      its('superusers') { should be_in DOCUMENTED_SUPER_ROLES}\n    end\n\n  rescue Exception => msg\n    describe \"Exception: #{msg}\" do\n      it { should be_nil}\n    end\n  end\nend\n",
          "source_location": {
            "line": 65,
            "ref": "../elasticsearch-inspec/controls/home+role/V-26751.rb"
          },
          "results": [
            {
              "status": "passed",
              "code_desc": "ES HOME directory owner should eq \"elasticsearch\"",
              "run_time": 0.000142,
              "start_time": "2018-02-11 14:26:36 -0500"
            },
            {
              "status": "passed",
              "code_desc": "ES HOME directory group should eq \"elasticsearch\"",
              "run_time": 0.000091,
              "start_time": "2018-02-11 14:26:36 -0500"
            },
            {
              "status": "passed",
              "code_desc": "ES CONF owner should eq \"elasticsearch\"",
              "run_time": 0.000088,
              "start_time": "2018-02-11 14:26:36 -0500"
            },
            {
              "status": "passed",
              "code_desc": "ES CONF group should eq \"elasticsearch\"",
              "run_time": 0.000083,
              "start_time": "2018-02-11 14:26:36 -0500"
            },
            {
              "status": "passed",
              "code_desc": "Elasticsearch Cluster https://0.0.0.0:9200 superusers should be in \"superuser\"",
              "run_time": 1.257063,
              "start_time": "2018-02-11 14:26:36 -0500"
            }
          ]
        },
        {
          "id": "V-27147",
          "title": "The application must synchronize with internal information system\nclocks which in turn, are synchronized on an organizational-defined frequency\nwith an organizational-defined authoritative time source. ",
          "desc": "Synchronize operating system clocks with an organizational\nauthoritative source using NTP.",
          "impact": 0.5,
          "refs": [],
          "tags": {
            "nist": [
              "AU-8 (1)",
              "Rev_3"
            ],
            "severity": "medium",
            "rid": "SV-34446r1_rule",
            "gtitle": "SRG-APP-000117",
            "cci": "CCI-000160",
            "check": "To verify that a remote NTP service is configured for time\nsynchronization, open the following file:\n\n/etc/chrony.conf\n\nin the case the system in question is configured to use the chronyd as the NTP\ndaemon (default setting)\n\n/etc/ntp.conf\n\n in the case the system in question is configured to use the ntpd as the NTP\ndaemon\n\nIn the file, there should be a section similar to the following:\n\nserver ntpserver\n\nIf this is not the case, this is a finding.",
            "fix": "Depending on specific functional requirements of a concrete production\n   environment, the Red Hat Enterprise Linux 7 Server system can be configured to \n   utilize the services of the chronyd NTP daemon (the default), or services of the\n   ntpd NTP daemon. \n   Refer to https://access.redhat.com/documentation/en-US/Red_Hat_Enterprise_Linux/7/html/System_Administrators_Guide/ch-Configuring_NTP_Using_the_chrony_Suite.html for more detailed comparison of the features of both of the choices, and for further guidance how to choose between the two NTP daemons.\n\nTo specify a remote NTP server for time synchronization, perform the following:\n\n* if the system is configured to use the chronyd as the NTP daemon (the default),\n edit the file /etc/chrony.conf as follows,\n\n* if the system is configured to use the ntpd as the NTP daemon, edit the file \n/etc/ntp.conf as documented below.\n\nAdd or correct the following lines, substituting the IP or hostname of a remote \nNTP server for ntpserver:\n\nserver ntpserver\n\nThis instructs the NTP software to contact that remote server to obtain time\ndata."
          },
          "code": "control \"V-27147\" do\n  title \"The application must synchronize with internal information system\nclocks which in turn, are synchronized on an organizational-defined frequency\nwith an organizational-defined authoritative time source. \"\n  desc  \"Synchronize operating system clocks with an organizational\nauthoritative source using NTP.\"\n  impact 0.5\n  tag \"nist\": [\"AU-8 (1)\", \"Rev_3\"]\n  tag \"severity\": \"medium\"\n  tag \"rid\": \"SV-34446r1_rule\"\n  tag \"gtitle\": \"SRG-APP-000117\"\n  tag \"cci\": \"CCI-000160\"\n  tag \"check\": \"To verify that a remote NTP service is configured for time\nsynchronization, open the following file:\n\n/etc/chrony.conf\n\nin the case the system in question is configured to use the chronyd as the NTP\ndaemon (default setting)\n\n/etc/ntp.conf\n\n in the case the system in question is configured to use the ntpd as the NTP\ndaemon\n\nIn the file, there should be a section similar to the following:\n\nserver ntpserver\n\nIf this is not the case, this is a finding.\"\n  tag \"fix\": \"Depending on specific functional requirements of a concrete production\n   environment, the Red Hat Enterprise Linux 7 Server system can be configured to \n   utilize the services of the chronyd NTP daemon (the default), or services of the\n   ntpd NTP daemon. \n   Refer to https://access.redhat.com/documentation/en-US/Red_Hat_Enterprise_Linux/7/html/System_Administrators_Guide/ch-Configuring_NTP_Using_the_chrony_Suite.html for more detailed comparison of the features of both of the choices, and for further guidance how to choose between the two NTP daemons.\n\nTo specify a remote NTP server for time synchronization, perform the following:\n\n* if the system is configured to use the chronyd as the NTP daemon (the default),\n edit the file /etc/chrony.conf as follows,\n\n* if the system is configured to use the ntpd as the NTP daemon, edit the file \n/etc/ntp.conf as documented below.\n\nAdd or correct the following lines, substituting the IP or hostname of a remote \nNTP server for ntpserver:\n\nserver ntpserver\n\nThis instructs the NTP software to contact that remote server to obtain time\ndata.\"\n\n  describe.one do\n    describe service('ntpd') do\n      it { should be_running }\n      it { should be_enabled }\n    end\n\n    describe service('chronyd') do\n      it { should be_running }\n      it { should be_enabled }\n    end\n  end\n\n  begin\n    ntpd_lines = file('/etc/ntp.conf').content.split(\"\\n\")\n  rescue NoMethodError\n    ntpd_lines = []\n  end\n\n  begin\n    chrony_lines = file('/etc/chrony.conf').content.split(\"\\n\")\n  rescue NoMethodError\n    chrony_lines = []\n  end\n\n  describe.one do\n      ntpd_lines.each do |ntpd_line|\n        if ntpd_line !~ /^#/\n          describe ntpd_line do\n            it { should match /^server/ }\n          end\n        end\n      end\n  end if service('ntpd').enabled?\n\n  describe.one do\n      chrony_lines.each do |chrony_line|\n        if chrony_line !~ /^#/\n          describe chrony_line do\n            it { should match /server/ }\n          end\n        end\n      end\n  end if service('chronyd').enabled?\nend",
          "source_location": {
            "line": 5,
            "ref": "../elasticsearch-inspec/controls/single/V-27147.rb"
          },
          "results": [
            {
              "status": "failed",
              "code_desc": "Service ntpd should be running",
              "run_time": 0.000226,
              "start_time": "2018-02-11 14:26:37 -0500"
            },
            {
              "status": "failed",
              "code_desc": "Service ntpd should be enabled",
              "run_time": 0.00024,
              "start_time": "2018-02-11 14:26:37 -0500"
            },
            {
              "status": "failed",
              "code_desc": "Service chronyd should be running",
              "run_time": 0.000164,
              "start_time": "2018-02-11 14:26:37 -0500"
            },
            {
              "status": "failed",
              "code_desc": "Service chronyd should be enabled",
              "run_time": 0.000212,
              "start_time": "2018-02-11 14:26:37 -0500"
            }
          ]
        },
        {
          "id": "V-27066",
          "title": "The application must restrict error messages so only authorized\npersonnel may view them.",
          "desc": "Limit the access of users and administrators to error logs and\nverbatim error log messages whether it be in application provided user\ninterfaces or the actual Elasticsearch error log. Ensure production has an\nappropriate logging information level and is not set to a level left over from\ndevelopment. Secure error logs with OS level protections.",
          "impact": 0.5,
          "refs": [],
          "tags": {
            "nist": [
              "SI-11 b",
              "Rev_4"
            ],
            "severity": "medium",
            "rid": "SV-34361r1_rule",
            "gtitle": "SRG-APP-000267",
            "cci": "CCI-001314",
            "check": "The error logs and audit logs should be restricted to\napplication owner. i.e. /var/log/elasticsearch/audit folder must have mode 0644\nor less permissive for elasticsearch user.\n\nAs the application owner, check the permissions of audit logs; i.e.\n/var/log/elasticsearch/audit, run the command:\n\n $ ls -l /var/log/elasticsearch/audit\n\nIf properly configured, the output should indicate the following permissions:\n-rw------- and the owner should be the application owner. If it does not, this\nis a finding.\n\nAs the application owner, check the permissions of error logs; i.e.\n/var/log/elasticsearch/error, run the command:\n\n $ ls -l /var/log/elasticsearch/error\n\nIf properly configured, the output should indicate the following permissions:\n-rw------- and the owner should be the application owner. If it does not, this\nis a finding.",
            "fix": "To properly set the owner of audit logs, i.e.\n/var/log/elasticsearch/audit, run the command:\n\n $ sudo chown elasticsearch  /var/log/elasticsearch/audit\n\nTo properly set the permissions of audit logs, i.e.\n/var/log/elasticsearch/audit, run the command:\n\n$ sudo chmod 0600 /var/log/elasticsearch/audit\n\nTo properly set the owner of error logs, i.e. /var/log/elasticsearch/error, run\nthe command:\n\n$ sudo chown elasticsearch  /var/log/elasticsearch/error\n\nTo properly set the permissions of error logs, i.e.\n/var/log/elasticsearch/error, run the command:\n\n$ sudo chmod 0600 /var/log/elasticsearch/error  "
          },
          "code": "control \"V-27066\" do\n  title \"The application must restrict error messages so only authorized\npersonnel may view them.\"\n  desc  \"Limit the access of users and administrators to error logs and\nverbatim error log messages whether it be in application provided user\ninterfaces or the actual Elasticsearch error log. Ensure production has an\nappropriate logging information level and is not set to a level left over from\ndevelopment. Secure error logs with OS level protections.\"\n  impact 0.5\n  tag \"nist\": [\"SI-11 b\", \"Rev_4\"]\n  tag \"severity\": \"medium\"\n  tag \"rid\": \"SV-34361r1_rule\"\n  tag \"gtitle\": \"SRG-APP-000267\"\n  tag \"cci\": \"CCI-001314\"\n  tag \"check\": \"The error logs and audit logs should be restricted to\napplication owner. i.e. /var/log/elasticsearch/audit folder must have mode 0644\nor less permissive for elasticsearch user.\n\nAs the application owner, check the permissions of audit logs; i.e.\n/var/log/elasticsearch/audit, run the command:\n\n $ ls -l /var/log/elasticsearch/audit\n\nIf properly configured, the output should indicate the following permissions:\n-rw------- and the owner should be the application owner. If it does not, this\nis a finding.\n\nAs the application owner, check the permissions of error logs; i.e.\n/var/log/elasticsearch/error, run the command:\n\n $ ls -l /var/log/elasticsearch/error\n\nIf properly configured, the output should indicate the following permissions:\n-rw------- and the owner should be the application owner. If it does not, this\nis a finding.\"\n  tag \"fix\": \"To properly set the owner of audit logs, i.e.\n/var/log/elasticsearch/audit, run the command:\n\n $ sudo chown elasticsearch  /var/log/elasticsearch/audit\n\nTo properly set the permissions of audit logs, i.e.\n/var/log/elasticsearch/audit, run the command:\n\n$ sudo chmod 0600 /var/log/elasticsearch/audit\n\nTo properly set the owner of error logs, i.e. /var/log/elasticsearch/error, run\nthe command:\n\n$ sudo chown elasticsearch  /var/log/elasticsearch/error\n\nTo properly set the permissions of error logs, i.e.\n/var/log/elasticsearch/error, run the command:\n\n$ sudo chmod 0600 /var/log/elasticsearch/error  \"\n\n  begin\n\n    describe file('/var/log/elasticsearch/audit') do\n      its('mode') { should eq 0600 }\n    end\n\n    describe file('/var/log/elasticsearch/error') do\n      its('mode') { should eq 0600 }\n    end\n\n  rescue Exception => msg\n    describe \"Exception: #{msg}\" do\n      it { should be_nil}\n    end\n  end\nend\n",
          "source_location": {
            "line": 5,
            "ref": "../elasticsearch-inspec/controls/single/V-27066.rb"
          },
          "results": [
            {
              "status": "failed",
              "code_desc": "File /var/log/elasticsearch/audit mode should eq 384",
              "run_time": 0.02741,
              "start_time": "2018-02-11 14:26:37 -0500"
            },
            {
              "status": "failed",
              "code_desc": "File /var/log/elasticsearch/error mode should eq 384",
              "run_time": 0.02562,
              "start_time": "2018-02-11 14:26:37 -0500"
            }
          ]
        },
        {
          "id": "V-27172",
          "title": "Applications must support organizational requirements to issue public\nkey certificates under an appropriate certificate policy or obtain public key\ncertificates under an appropriate certificate policy from an approved service\nprovider.",
          "desc": "Configure PKI authentication, TLS/SSL, IP filtering; which are key\nfeatures of X-Pack Security. This should ensure that authentication and\ncommunication within Elasticsearch utilizes organizational attained\ncertificates.",
          "impact": 0.5,
          "refs": [],
          "tags": {
            "nist": [
              "SC-17",
              "Rev_4"
            ],
            "severity": "medium",
            "rid": "SV-34471r1_rule",
            "gtitle": "SRG-APP-000205",
            "cci": "CCI-001159",
            "check": "Application must obtain public key certificates from an\napproved service provider.\n\nAs the application administrator (usually elasticsearch), check the xpack.ssl\nsettings are set to approved public key certificates.\n\n$cat elasticsearch.yml | grep xpack.ssl\n\nxpack.ssl.key:                     <server_key>.key\nxpack.ssl.certificate:             <server_certificate>.crt\nxpack.ssl.certificate_authorities: [ <approved_ca>.crt' ]\n\nIf these certificates are not approved certificates, this is a finding.  ",
            "fix": "Revoke trust in any certificates not issued by a DoD-approved\ncertificate authority.\n\nConfigure Elasticsearch to accept only DoD and DoD-approved PKI end-entity\ncertificates. Verify that xpack.ssl.certificate_authorities is pointing to the\ntrusted certificate authority from an approved service provider.\n\nSee the official documentation for the complete  guide on establishing SSL\nconfiguration: https://www.elastic.co/guide/en/x-pack/current/ssl-tls.html"
          },
          "code": "control \"V-27172\" do\n  title \"Applications must support organizational requirements to issue public\nkey certificates under an appropriate certificate policy or obtain public key\ncertificates under an appropriate certificate policy from an approved service\nprovider.\"\n  desc  \"Configure PKI authentication, TLS/SSL, IP filtering; which are key\nfeatures of X-Pack Security. This should ensure that authentication and\ncommunication within Elasticsearch utilizes organizational attained\ncertificates.\"\n  impact 0.5\n  tag \"nist\": [\"SC-17\", \"Rev_4\"]\n  tag \"severity\": \"medium\"\n  tag \"rid\": \"SV-34471r1_rule\"\n  tag \"gtitle\": \"SRG-APP-000205\"\n  tag \"cci\": \"CCI-001159\"\n  tag \"check\": \"Application must obtain public key certificates from an\napproved service provider.\n\nAs the application administrator (usually elasticsearch), check the xpack.ssl\nsettings are set to approved public key certificates.\n\n$cat elasticsearch.yml | grep xpack.ssl\n\nxpack.ssl.key:                     <server_key>.key\nxpack.ssl.certificate:             <server_certificate>.crt\nxpack.ssl.certificate_authorities: [ <approved_ca>.crt' ]\n\nIf these certificates are not approved certificates, this is a finding.  \"\n  tag \"fix\": \"Revoke trust in any certificates not issued by a DoD-approved\ncertificate authority.\n\nConfigure Elasticsearch to accept only DoD and DoD-approved PKI end-entity\ncertificates. Verify that xpack.ssl.certificate_authorities is pointing to the\ntrusted certificate authority from an approved service provider.\n\nSee the official documentation for the complete  guide on establishing SSL\nconfiguration: https://www.elastic.co/guide/en/x-pack/current/ssl-tls.html\"\n\n  begin\n    describe yaml(ELASTICSEARCH_CONF) do\n      its(['xpack.ssl.key']) { should_not be_nil }\n      its(['xpack.ssl.certificate']) { should_not be_nil }\n      its(['xpack.ssl.certificate_authorities']) { should_not be_nil }\n    end\n\n    describe command(\"openssl rsa -in #{yaml(ELASTICSEARCH_CONF)['xpack.ssl.key']} -check -noout\") do\n      its('stdout'){ should match /RSA key ok/ }\n    end\n\n    describe x509_certificate(yaml(ELASTICSEARCH_CONF)['xpack.ssl.certificate']) do\n      it { should be_certificate }\n      it { should be_valid }\n    end\n\n    if yaml(ELASTICSEARCH_CONF)['xpack.ssl.certificate_authorities'].is_a?(Array)\n      yaml(ELASTICSEARCH_CONF)['xpack.ssl.certificate_authorities'].each do |cert|\n        describe x509_certificate(cert) do\n          it { should be_certificate }\n          it { should be_valid }\n        end\n      end\n    else\n      describe x509_certificate(yaml(ELASTICSEARCH_CONF)['xpack.ssl.certificate_authorities']) do\n        it { should be_certificate }\n        it { should be_valid }\n      end\n    end\n\n  rescue Exception => msg\n    describe \"Exception: #{msg}\" do\n      it { should be_nil}\n    end\n  end\nend\n",
          "source_location": {
            "line": 11,
            "ref": "../elasticsearch-inspec/controls/single/V-27172.rb"
          },
          "results": [
            {
              "status": "passed",
              "code_desc": "YAML /etc/elasticsearch/elasticsearch.yml [\"xpack.ssl.key\"] should not be nil",
              "run_time": 0.000151,
              "start_time": "2018-02-11 14:26:37 -0500"
            },
            {
              "status": "passed",
              "code_desc": "YAML /etc/elasticsearch/elasticsearch.yml [\"xpack.ssl.certificate\"] should not be nil",
              "run_time": 0.0001,
              "start_time": "2018-02-11 14:26:37 -0500"
            },
            {
              "status": "passed",
              "code_desc": "YAML /etc/elasticsearch/elasticsearch.yml [\"xpack.ssl.certificate_authorities\"] should not be nil",
              "run_time": 0.0001,
              "start_time": "2018-02-11 14:26:37 -0500"
            },
            {
              "status": "passed",
              "code_desc": "Command openssl rsa -in /etc/elasticsearch/x-pack/elastic/elastic.key -check -noout stdout should match /RSA key ok/",
              "run_time": 0.030283,
              "start_time": "2018-02-11 14:26:37 -0500"
            },
            {
              "status": "passed",
              "code_desc": "x509_certificate /etc/elasticsearch/x-pack/elastic/elastic.crt should be certificate",
              "run_time": 0.000207,
              "start_time": "2018-02-11 14:26:37 -0500"
            },
            {
              "status": "passed",
              "code_desc": "x509_certificate /etc/elasticsearch/x-pack/elastic/elastic.crt should be valid",
              "run_time": 0.000101,
              "start_time": "2018-02-11 14:26:37 -0500"
            },
            {
              "status": "passed",
              "code_desc": "x509_certificate /etc/elasticsearch/x-pack/ca/ca.crt should be certificate",
              "run_time": 0.000102,
              "start_time": "2018-02-11 14:26:37 -0500"
            },
            {
              "status": "passed",
              "code_desc": "x509_certificate /etc/elasticsearch/x-pack/ca/ca.crt should be valid",
              "run_time": 0.000075,
              "start_time": "2018-02-11 14:26:37 -0500"
            }
          ]
        },
        {
          "id": "V-26882",
          "title": "Applications must allocate audit record storage capacity.",
          "desc": "Provision adequate storage for audit records in an automated fashion\nbased upon capacity studies for production systems.",
          "impact": 0.5,
          "refs": [],
          "tags": {
            "nist": [
              "AU-4",
              "Rev_3"
            ],
            "severity": "medium",
            "rid": "SV-34162r1_rule",
            "gtitle": "SRG-APP-000072",
            "cci": "CCI-000137",
            "check": "Run the following command to determine if\n/var/log/elasticsearch/audit is on its own partition or logical volume:\n\n$ mount | grep 'on /var/log/elasticsearch/audit '\n\nIf /var/log/elasticsearch/audit has its own partition or volume group, a line\nwill be returned. If no line is returned, this is a finding.",
            "fix": "Audit logs are stored in the /var/log/elasticsearch/audit\ndirectory. Ensure that it has its own partition or logical volume at\ninstallation time, or migrate it later using LVM. Make absolutely certain that\nit is large enough to store all audit logs that will be created by the auditing\ndaemon."
          },
          "code": "control \"V-26882\" do\n  title \"Applications must allocate audit record storage capacity.\"\n  desc  \"Provision adequate storage for audit records in an automated fashion\nbased upon capacity studies for production systems.\"\n  impact 0.5\n  tag \"nist\": [\"AU-4\", \"Rev_3\"]\n  tag \"severity\": \"medium\"\n  tag \"rid\": \"SV-34162r1_rule\"\n  tag \"gtitle\": \"SRG-APP-000072\"\n  tag \"cci\": \"CCI-000137\"\n  tag \"check\": \"Run the following command to determine if\n/var/log/elasticsearch/audit is on its own partition or logical volume:\n\n$ mount | grep 'on /var/log/elasticsearch/audit '\n\nIf /var/log/elasticsearch/audit has its own partition or volume group, a line\nwill be returned. If no line is returned, this is a finding.\"\n  tag \"fix\": \"Audit logs are stored in the /var/log/elasticsearch/audit\ndirectory. Ensure that it has its own partition or logical volume at\ninstallation time, or migrate it later using LVM. Make absolutely certain that\nit is large enough to store all audit logs that will be created by the auditing\ndaemon.\"\n\n\n  begin\n    describe mount(File.dirname(AUDITD_LOG_FILE)) do\n      it { should be_mounted }\n    end\n\n  rescue Exception => msg\n    describe do\n      skip \"Exception: #{msg}\"\n    end\n  end\nend\n",
          "source_location": {
            "line": 12,
            "ref": "../elasticsearch-inspec/controls/single/V-26882.rb"
          },
          "results": [
            {
              "status": "failed",
              "code_desc": "Mount /var/log/audit should be mounted",
              "run_time": 0.02349,
              "start_time": "2018-02-11 14:26:37 -0500"
            }
          ]
        },
        {
          "id": "V-30590",
          "title": "The application must employ automated mechanisms to alert security\npersonnel of inappropriate or unusual activities with security implications.",
          "desc": "Utilize perimeter, application, centralized authentication, and\nrepository audit controls to audit the use of systems in real time with\nsufficient context.",
          "impact": 0.5,
          "refs": [],
          "tags": {
            "nist": [
              "SI-4 (12)",
              "Rev_4"
            ],
            "severity": "medium",
            "rid": "SV-40335r1_rule",
            "gtitle": "SRG-APP-000237",
            "cci": "CCI-001274",
            "check": "Verify auditd rules are in place to monitor elasticsearch.yml;\nthis file contains security functions settings for elasticsearch.\n\nAs system owner, normally root, run the following command;\n\n$auditctl -l | grep elasticsearch.yml\n\nA watch rule covering all file access ~ -p war for the elasticsearch.yml file\nbe present, if this is not, this is a finding.",
            "fix": "Implment audit rules for elasticsearch configuration settings.\nAll security functions, including the disabling and changing are maintained\nwithin this file.\n\nAs the system owner, usually root, add the following to audit.rules, this file\nis maintained at /etc/audit/rules.d/audit.rules on RHEL 7:\n\n-w <ES_HOME>/config/elasticsearch.yml -p war -k elasticsearch-config"
          },
          "code": "control \"V-30590\" do\n  title \"The application must employ automated mechanisms to alert security\npersonnel of inappropriate or unusual activities with security implications.\"\n  desc  \"Utilize perimeter, application, centralized authentication, and\nrepository audit controls to audit the use of systems in real time with\nsufficient context.\"\n  impact 0.5\n  tag \"nist\": [\"SI-4 (12)\", \"Rev_4\"]\n  tag \"severity\": \"medium\"\n  tag \"rid\": \"SV-40335r1_rule\"\n  tag \"gtitle\": \"SRG-APP-000237\"\n  tag \"cci\": \"CCI-001274\"\n  tag \"check\": \"Verify auditd rules are in place to monitor elasticsearch.yml;\nthis file contains security functions settings for elasticsearch.\n\nAs system owner, normally root, run the following command;\n\n$auditctl -l | grep elasticsearch.yml\n\nA watch rule covering all file access ~ -p war for the elasticsearch.yml file\nbe present, if this is not, this is a finding.\"\n  tag \"fix\": \"Implment audit rules for elasticsearch configuration settings.\nAll security functions, including the disabling and changing are maintained\nwithin this file.\n\nAs the system owner, usually root, add the following to audit.rules, this file\nis maintained at /etc/audit/rules.d/audit.rules on RHEL 7:\n\n-w <ES_HOME>/config/elasticsearch.yml -p war -k elasticsearch-config\"\n\n  describe command('auditctl') do\n    it { should exist } \n  end\n\n  begin\n\n    describe \"Audit Rules for #{ELASTICSEARCH_CONF}\" do\n      subject { auditd.where {file == ELASTICSEARCH_CONF }.entries }\n      it { should_not be_empty }\n    end\n\n    describe \"Audit Rules for #{ELASTICSEARCH_CONF}\" do\n      subject { auditd.where {file == ELASTICSEARCH_CONF } }\n      its('key') { should cmp AUDIT_RULE_ID }\n      its('permissions.flatten') { should include \"r\" }\n      its('permissions.flatten') { should include \"w\" }\n      its('permissions.flatten') { should include \"a\" }\n    end\n\n  rescue Exception => msg\n    describe \"Exception: #{msg}\" do\n      it { should be_nil}\n    end\n  end\nend\n",
          "source_location": {
            "line": 17,
            "ref": "../elasticsearch-inspec/controls/single/V-30590.rb"
          },
          "results": [
            {
              "status": "passed",
              "code_desc": "Command auditctl should exist",
              "run_time": 0.016251,
              "start_time": "2018-02-11 14:26:37 -0500"
            },
            {
              "status": "passed",
              "code_desc": "Audit Rules for /etc/elasticsearch/elasticsearch.yml should not be empty",
              "run_time": 0.018661,
              "start_time": "2018-02-11 14:26:37 -0500"
            },
            {
              "status": "passed",
              "code_desc": "Audit Rules for /etc/elasticsearch/elasticsearch.yml key should cmp == \"elasticsearch-config\"",
              "run_time": 0.013763,
              "start_time": "2018-02-11 14:26:37 -0500"
            },
            {
              "status": "passed",
              "code_desc": "Audit Rules for /etc/elasticsearch/elasticsearch.yml permissions.flatten should include \"r\"",
              "run_time": 0.022256,
              "start_time": "2018-02-11 14:26:37 -0500"
            },
            {
              "status": "passed",
              "code_desc": "Audit Rules for /etc/elasticsearch/elasticsearch.yml permissions.flatten should include \"w\"",
              "run_time": 0.023858,
              "start_time": "2018-02-11 14:26:37 -0500"
            },
            {
              "status": "passed",
              "code_desc": "Audit Rules for /etc/elasticsearch/elasticsearch.yml permissions.flatten should include \"a\"",
              "run_time": 0.018194,
              "start_time": "2018-02-11 14:26:37 -0500"
            }
          ]
        },
        {
          "id": "V-26949",
          "title": "Applications must limit privileges to change the software resident\nwithin software libraries (including privileged programs).",
          "desc": "Install or Upgrade Elasticsearch software with an operating system\naccount restricted to appropriate users and configured to have only the\npermissions necessary to complete the installation or upgrade.",
          "impact": 0.5,
          "refs": [],
          "tags": {
            "nist": [
              "CM-5 (6)",
              "Rev_4"
            ],
            "severity": "medium",
            "rid": "SV-34232r1_rule",
            "gtitle": "SRG-APP-000133",
            "cci": "CCI-001499",
            "check": "Design the domains of administrative roles within Elasticsearch\nby the principle of Separation of Duties.\n\nAs the application administrator (shown here as 'elasticsearch'), verify the\npermissions for ES_HOME:\n\n$ ls -la ${ES_HOME?}\n\nIf any files are not owned by the application owner or have permissions\nallowing others to modify (write) configuration files, this is a finding.",
            "fix": "As the system administrator, change the permissions of ES_HOME."
          },
          "code": "control \"V-26949\" do\n  title \"Applications must limit privileges to change the software resident\nwithin software libraries (including privileged programs).\"\n  desc  \"Install or Upgrade Elasticsearch software with an operating system\naccount restricted to appropriate users and configured to have only the\npermissions necessary to complete the installation or upgrade.\"\n  impact 0.5\n  tag \"nist\": [\"CM-5 (6)\", \"Rev_4\"]\n  tag \"severity\": \"medium\"\n  tag \"rid\": \"SV-34232r1_rule\"\n  tag \"gtitle\": \"SRG-APP-000133\"\n  tag \"cci\": \"CCI-001499\"\n  tag \"check\": \"Design the domains of administrative roles within Elasticsearch\nby the principle of Separation of Duties.\n\nAs the application administrator (shown here as 'elasticsearch'), verify the\npermissions for ES_HOME:\n\n$ ls -la ${ES_HOME?}\n\nIf any files are not owned by the application owner or have permissions\nallowing others to modify (write) configuration files, this is a finding.\"\n  tag \"fix\": \"As the system administrator, change the permissions of ES_HOME.\"\n\n  begin\n\n    es_handle = es_helper(url:\"https://#{ELASTIC_IP}:#{ELASTIC_PORT}\",\n                    username: ES_ADMIN,\n                    password: ES_PASS,\n                    ssl_verify: SSL_VERIFY )\n\n    describe \"No nodes found\" do\n      subject { es_handle.nodes.nil? }\n      it { should_not be_truthy }\n    end if es_handle.nodes.nil?\n\n    describe \"ES HOME directory\" do\n      subject { file(es_handle.settings.first.path.home) }\n      its('owner') { should eq ES_OWNER }\n      its('group') { should eq ES_GROUP }\n    end\n\n  rescue Exception => msg\n    describe \"Exception: #{msg}\" do\n      it { should be_nil}\n    end\n  end\nend\n",
          "source_location": {
            "line": 47,
            "ref": "../elasticsearch-inspec/controls/single/V-26949.rb"
          },
          "results": [
            {
              "status": "passed",
              "code_desc": "ES HOME directory owner should eq \"elasticsearch\"",
              "run_time": 0.000189,
              "start_time": "2018-02-11 14:26:37 -0500"
            },
            {
              "status": "passed",
              "code_desc": "ES HOME directory group should eq \"elasticsearch\"",
              "run_time": 0.000101,
              "start_time": "2018-02-11 14:26:37 -0500"
            }
          ]
        },
        {
          "id": "V-26928",
          "title": "The application, when using PKI-based authentication, must enforce\nauthorized access to the corresponding private key.",
          "desc": "Ensure PKI Private Key is stored with properly ACL on operating\nsystem, and the storage disks are set up with encryption-at-rest.",
          "impact": 0.5,
          "refs": [],
          "tags": {
            "nist": [
              "IA-5 (2) (b)",
              "Rev_4"
            ],
            "severity": "medium",
            "rid": "SV-34208r1_rule",
            "gtitle": "SRG-APP-000176",
            "cci": "CCI-000186",
            "check": "When using PKI-based authentication, it is critical to enforce\nauthorized access.\n\n$ cat config/elasticsearch.yml | grep -A 10 -B 6 'type: \\?pki'\n\n xpack:\n  security:\n    authc:\n      realms:\n        pki1:\n          type: pki\n          username_pattern: 'EMAILADDRESS=(.*?)(?:,|$)'\n          certificate_authorities: <CA_PATH>\n          truststore.path: <TS_PATH>\n\nIf these settings are not correct or missing, this is a finding.\n\nTo check the ownership of <CA_PATH>, run the command:\n\n$ ls -lL <CA_PATH>\n\nIf properly configured, the output should indicate the following owner:\n<APPLICATION_OWNER>. If it does not, this is a finding.\n\nTo check the ownership of <TS_PATH>, run the command:\n\n$ ls -lL <CA_PATH>\n\nIf properly configured, the output should indicate the following owner:\n<APPLICATION_OWNER>. If it does not, this is a finding.\n   ",
            "fix": "Set the owner of <CA_PATH> and <TS_PATH> to the application\nowner.\n\nChange the ownership of <CA_PATH> to <APPLICATION_OWNER>, run the following\ncommand:\n\n$ sudo chown <APPLICATION_OWNER> <CA_PATH>\n\nChange the ownership of <TS_PATH> to <APPLICATION_OWNER>, run the following\ncommand:\n\n$ sudo chown <APPLICATION_OWNER> <TS_PATH> "
          },
          "code": "control \"V-26928\" do\n  title \"The application, when using PKI-based authentication, must enforce\nauthorized access to the corresponding private key.\"\n  desc  \"Ensure PKI Private Key is stored with properly ACL on operating\nsystem, and the storage disks are set up with encryption-at-rest.\"\n  impact 0.5\n  tag \"nist\": [\"IA-5 (2) (b)\", \"Rev_4\"]\n  tag \"severity\": \"medium\"\n  tag \"rid\": \"SV-34208r1_rule\"\n  tag \"gtitle\": \"SRG-APP-000176\"\n  tag \"cci\": \"CCI-000186\"\n  tag \"check\": \"When using PKI-based authentication, it is critical to enforce\nauthorized access.\n\n$ cat config/elasticsearch.yml | grep -A 10 -B 6 'type: \\\\?pki'\n\n xpack:\n  security:\n    authc:\n      realms:\n        pki1:\n          type: pki\n          username_pattern: 'EMAILADDRESS=(.*?)(?:,|$)'\n          certificate_authorities: <CA_PATH>\n          truststore.path: <TS_PATH>\n\nIf these settings are not correct or missing, this is a finding.\n\nTo check the ownership of <CA_PATH>, run the command:\n\n$ ls -lL <CA_PATH>\n\nIf properly configured, the output should indicate the following owner:\n<APPLICATION_OWNER>. If it does not, this is a finding.\n\nTo check the ownership of <TS_PATH>, run the command:\n\n$ ls -lL <CA_PATH>\n\nIf properly configured, the output should indicate the following owner:\n<APPLICATION_OWNER>. If it does not, this is a finding.\n   \"\n  tag \"fix\": \"Set the owner of <CA_PATH> and <TS_PATH> to the application\nowner.\n\nChange the ownership of <CA_PATH> to <APPLICATION_OWNER>, run the following\ncommand:\n\n$ sudo chown <APPLICATION_OWNER> <CA_PATH>\n\nChange the ownership of <TS_PATH> to <APPLICATION_OWNER>, run the following\ncommand:\n\n$ sudo chown <APPLICATION_OWNER> <TS_PATH> \"\n\n  begin\n\n    es_handle = es_helper(url:\"https://#{ELASTIC_IP}:#{ELASTIC_PORT}\",\n                    username: ES_ADMIN,\n                    password: ES_PASS,\n                    ssl_verify: SSL_VERIFY )\n\n    describe \"No nodes found\" do\n      subject { es_handle.nodes.nil? }\n      it { should_not be_truthy }\n    end if es_handle.nodes.nil?\n\n\n    es_handle.nodes.each do |node|\n      describe \"Authentication methods includes PKI for Node: #{node.name}\" do\n        subject { node }\n        its('authc_method') { should include 'pki' }\n      end\n    end unless es_handle.nodes.nil?\n\n    es_handle.nodes.each do |node|\n      describe.one do\n        node.authc_realm.keys.each do |auth_method|\n          describe \"PKI Settings for Node: #{node.name}\" do\n            subject { node.authc_realm[auth_method] }\n            its ('order') { should_not be_nil }\n            its ('username_pattern') { should_not be_nil }\n            its ('certificate_authorities') { should_not be_nil }\n            its ('truststore.path') { should_not be_nil }\n          end if node.authc_realm[auth_method].type.eql?('pki')\n        end\n      end\n    end unless es_handle.nodes.nil?\n\n  rescue Exception => msg\n    describe \"Exception: #{msg}\" do\n      it { should be_nil}\n    end\n  end\nend\n",
          "source_location": {
            "line": 41,
            "ref": "../elasticsearch-inspec/controls/single/V-26928.rb"
          },
          "results": [
            {
              "status": "passed",
              "code_desc": "Authentication methods includes PKI for Node: package-centos-72 authc_method should include \"pki\"",
              "run_time": 0.000097,
              "start_time": "2018-02-11 14:26:37 -0500"
            },
            {
              "status": "passed",
              "code_desc": "PKI Settings for Node: package-centos-72 order should not be nil",
              "run_time": 0.000125,
              "start_time": "2018-02-11 14:26:37 -0500"
            },
            {
              "status": "passed",
              "code_desc": "PKI Settings for Node: package-centos-72 username_pattern should not be nil",
              "run_time": 0.000081,
              "start_time": "2018-02-11 14:26:37 -0500"
            },
            {
              "status": "failed",
              "code_desc": "PKI Settings for Node: package-centos-72 certificate_authorities should not be nil",
              "run_time": 0.000125,
              "start_time": "2018-02-11 14:26:37 -0500"
            },
            {
              "status": "failed",
              "code_desc": "PKI Settings for Node: package-centos-72 truststore.path ",
              "run_time": 0.000095,
              "start_time": "2018-02-11 14:26:37 -0500"
            }
          ]
        },
        {
          "id": "V-27165",
          "title": "The application must protect audit tools from unauthorized deletion.",
          "desc": "Configure operating system protections for audit records such that the\nrecords are not editable or deletable by Elasticsearch administrators and not\naccessible by unauthorized users. Move audit logs off of local machines and\nbackup to a audit log management system.",
          "impact": 0.5,
          "refs": [],
          "tags": {
            "nist": [
              "AU-9",
              "Rev_4"
            ],
            "severity": "medium",
            "rid": "SV-34464r1_rule",
            "gtitle": "SRG-APP-000123",
            "cci": "CCI-001495",
            "check": "The elasticsearch.yml file controls audit function for the\napplication. Protection of this file is critical for system security.\n\nTo check the ownership of elasticsearch.yml, run the command:\n\n $ ls -lL ES_HOME/elasticsearch.yml\n\nIf properly configured, the output should indicate the following owner:\nelasticsearch If it does not, this is a finding.\n\nThe elasticsearch.yml must have mode 0640 or less permissive.\n\nTo check the permissions of elasticsearch.yml, run the command:\n\n $ ls -l ES_HOME/elasticsearch.yml\n\nIf properly configured, the output should indicate the following permissions:\n-rw-r--r-- If it does not, this is a finding.",
            "fix": "To properly set the owner of /etc/shadow, run the command:\n\n$ sudo chown elasticsearch elasticsearch.yml    --           ##   TODO add text\naround adding rule "
          },
          "code": "control \"V-27165\" do\n  title \"The application must protect audit tools from unauthorized deletion.\"\n  desc  \"Configure operating system protections for audit records such that the\nrecords are not editable or deletable by Elasticsearch administrators and not\naccessible by unauthorized users. Move audit logs off of local machines and\nbackup to a audit log management system.\"\n  impact 0.5\n  tag \"nist\": [\"AU-9\", \"Rev_4\"]\n  tag \"severity\": \"medium\"\n  tag \"rid\": \"SV-34464r1_rule\"\n  tag \"gtitle\": \"SRG-APP-000123\"\n  tag \"cci\": \"CCI-001495\"\n  tag \"check\": \"The elasticsearch.yml file controls audit function for the\napplication. Protection of this file is critical for system security.\n\nTo check the ownership of elasticsearch.yml, run the command:\n\n $ ls -lL ES_HOME/elasticsearch.yml\n\nIf properly configured, the output should indicate the following owner:\nelasticsearch If it does not, this is a finding.\n\nThe elasticsearch.yml must have mode 0640 or less permissive.\n\nTo check the permissions of elasticsearch.yml, run the command:\n\n $ ls -l ES_HOME/elasticsearch.yml\n\nIf properly configured, the output should indicate the following permissions:\n-rw-r--r-- If it does not, this is a finding.\"\n  tag \"fix\": \"To properly set the owner of /etc/shadow, run the command:\n\n$ sudo chown elasticsearch elasticsearch.yml    --           ##   TODO add text\naround adding rule \"\n\n  begin\n    describe file(ELASTICSEARCH_CONF) do\n      its('owner') { should eq ES_OWNER }\n      its('group') { should eq ES_GROUP }\n      its('mode') { should cmp <= 0640 }\n    end\n\n  rescue Exception => msg\n    describe \"Exception: #{msg}\" do\n      it { should be_nil}\n    end\n  end\nend\n",
          "source_location": {
            "line": 24,
            "ref": "../elasticsearch-inspec/controls/single/V-27165.rb"
          },
          "results": [
            {
              "status": "passed",
              "code_desc": "File /etc/elasticsearch/elasticsearch.yml owner should eq \"elasticsearch\"",
              "run_time": 0.000119,
              "start_time": "2018-02-11 14:26:37 -0500"
            },
            {
              "status": "passed",
              "code_desc": "File /etc/elasticsearch/elasticsearch.yml group should eq \"elasticsearch\"",
              "run_time": 0.000077,
              "start_time": "2018-02-11 14:26:37 -0500"
            },
            {
              "status": "passed",
              "code_desc": "File /etc/elasticsearch/elasticsearch.yml mode should cmp <= 416",
              "run_time": 0.00014,
              "start_time": "2018-02-11 14:26:37 -0500"
            }
          ]
        },
        {
          "id": "V-27160",
          "title": "The application must protect audit information from unauthorized\ndeletion.",
          "desc": "Configure operating system protections for audit records such that the\nrecords are not editable or deletable by Elasticsearch administrators and not\naccessible by unauthorized users.",
          "impact": 0.5,
          "refs": [],
          "tags": {
            "nist": [
              "AU-9",
              "Rev_4"
            ],
            "severity": "medium",
            "rid": "SV-34459r1_rule",
            "gtitle": "SRG-APP-000120",
            "cci": "CCI-000164",
            "check": "The /var/log/elasticsearch/audit folder must have mode 0644 or\nless permissive.\n\nTo check the permissions of /var/log/elasticsearch/audit, run the command:\n\n $ ls -l /var/log/elasticsearch/audit\n\nIf properly configured, the output should indicate the following permissions:\n-rw-r--r-- If it does not, this is a finding.",
            "fix": "To properly set the permissions of /var/log/elasticsearch/audit,\nrun the command:\n\n$ sudo chmod 0644 /var/log/elasticsearch/audit  "
          },
          "code": "control \"V-27160\" do\n  title \"The application must protect audit information from unauthorized\ndeletion.\"\n  desc  \"Configure operating system protections for audit records such that the\nrecords are not editable or deletable by Elasticsearch administrators and not\naccessible by unauthorized users.\"\n  impact 0.5\n  tag \"nist\": [\"AU-9\", \"Rev_4\"]\n  tag \"severity\": \"medium\"\n  tag \"rid\": \"SV-34459r1_rule\"\n  tag \"gtitle\": \"SRG-APP-000120\"\n  tag \"cci\": \"CCI-000164\"\n  tag \"check\": \"The /var/log/elasticsearch/audit folder must have mode 0644 or\nless permissive.\n\nTo check the permissions of /var/log/elasticsearch/audit, run the command:\n\n $ ls -l /var/log/elasticsearch/audit\n\nIf properly configured, the output should indicate the following permissions:\n-rw-r--r-- If it does not, this is a finding.\"\n  tag \"fix\": \"To properly set the permissions of /var/log/elasticsearch/audit,\nrun the command:\n\n$ sudo chmod 0644 /var/log/elasticsearch/audit  \"\n\n  begin\n\n    describe file(\"#{ES_LOGS_DIR}/audit\") do\n      its('mode') { should cmp <= 0644}\n    end\n\n  rescue Exception => msg\n    describe \"Exception: #{msg}\" do\n      it { should be_nil}\n    end\n  end\nend\n",
          "source_location": {
            "line": 42,
            "ref": "../elasticsearch-inspec/controls/single/V-27160.rb"
          },
          "results": [
            {
              "status": "passed",
              "code_desc": "File /var/log/elasticsearch/audit mode should cmp <= 420",
              "run_time": 0.00012,
              "start_time": "2018-02-11 14:26:37 -0500"
            }
          ]
        },
        {
          "id": "V-26686",
          "title": "The application must monitor for unauthorized remote connections to\nthe information system on an organizational-defined frequency.",
          "desc": "Configure X-Pack Alerting to periodically watch for unauthorized\naccess attempts to the system in X-Pack Security audit logs and notify out to\ncentralized incident systems and personnel.",
          "impact": 0.5,
          "refs": [],
          "tags": {
            "nist": [
              "AC-17 (5)",
              "Rev_3"
            ],
            "severity": "medium",
            "rid": "SV-33909r1_rule",
            "gtitle": "SRG-APP-000018",
            "cci": "CCI-000071",
            "check": "Moving audit information off of the systems creating the audit\nevents into a central location allows for the monitoring of unauthorized remote\nconnections on a organizational-defined frequency. Verify \"rsyslog\" is\nconfigured to send all messages to a log aggregation server.\n\nCheck the configuration of 'rsyslog' with the following command:\n\n# grep @ /etc/rsyslog.conf\n   *.* @@logagg.site.mil\n\nIf there are no lines in the '/etc/rsyslog.conf' file that contain the '@'\nor '@@' symbol(s), and the lines with the correct symbol(s) to send output to\nanother system do not cover all 'rsyslog' output, this is a finding.\n\nAs System owner, verify that elasticsearch audit logs are being monitored by\nrsyslog.  Run the following command\n\n$cat /etc/rsyslog.conf' | grep 'InputFileName\n/var/log/elasticsearch/<clustername>_access.log'",
            "fix": "Modify the '/etc/rsyslog.conf' file to contain a configuration\nline to send all 'rsyslog' output to a log aggregation system:\n\n*.* @@&ltlog aggregation system name&gt\n\nAs System owner, configure rsyslog to monitor elasticsearch audit logs.  Run\nthe following command\n\n$vi /etc/rsyslog.conf' | grep 'InputFileName\n/var/log/elasticsearch/<clustername>_access.log'"
          },
          "code": "control \"V-26686\" do\n  title \"The application must monitor for unauthorized remote connections to\nthe information system on an organizational-defined frequency.\"\n  desc  \"Configure X-Pack Alerting to periodically watch for unauthorized\naccess attempts to the system in X-Pack Security audit logs and notify out to\ncentralized incident systems and personnel.\"\n  impact 0.5\n  tag \"nist\": [\"AC-17 (5)\", \"Rev_3\"]\n  tag \"severity\": \"medium\"\n  tag \"rid\": \"SV-33909r1_rule\"\n  tag \"gtitle\": \"SRG-APP-000018\"\n  tag \"cci\": \"CCI-000071\"\n  tag \"check\": \"Moving audit information off of the systems creating the audit\nevents into a central location allows for the monitoring of unauthorized remote\nconnections on a organizational-defined frequency. Verify \\\"rsyslog\\\" is\nconfigured to send all messages to a log aggregation server.\n\nCheck the configuration of 'rsyslog' with the following command:\n\n# grep @ /etc/rsyslog.conf\n   *.* @@logagg.site.mil\n\nIf there are no lines in the '/etc/rsyslog.conf' file that contain the '@'\nor '@@' symbol(s), and the lines with the correct symbol(s) to send output to\nanother system do not cover all 'rsyslog' output, this is a finding.\n\nAs System owner, verify that elasticsearch audit logs are being monitored by\nrsyslog.  Run the following command\n\n$cat /etc/rsyslog.conf' | grep 'InputFileName\n/var/log/elasticsearch/<clustername>_access.log'\"\n  tag \"fix\": \"Modify the '/etc/rsyslog.conf' file to contain a configuration\nline to send all 'rsyslog' output to a log aggregation system:\n\n*.* @@&ltlog aggregation system name&gt\n\nAs System owner, configure rsyslog to monitor elasticsearch audit logs.  Run\nthe following command\n\n$vi /etc/rsyslog.conf' | grep 'InputFileName\n/var/log/elasticsearch/<clustername>_access.log'\"\n  begin\n\n    es_handle = es_helper(url:\"https://#{ELASTIC_IP}:#{ELASTIC_PORT}\",\n                      username: ES_ADMIN,\n                      password: ES_PASS,\n                      ssl_verify: SSL_VERIFY )\n\n    rsyslog_input_filename_statement = \"InputFileName #{ES_LOGS_DIR}/#{es_handle.cluster_name.first}_access.log\"\n\n\n    describe service('rsyslog') do\n      it { should be_installed }\n      it { should be_running }\n    end\n    \n    describe \"#{RSYSLOG_CONF} configured with log aggregation server: #{LOG_AGGREGATION_SYSTEM}\" do\n      subject { !file(RSYSLOG_CONF).content.match(/@{1,2}#{LOG_AGGREGATION_SYSTEM}/).nil? }\n      it { should be true }\n    end\n\n    describe \"#{RSYSLOG_CONF} contains '#{rsyslog_input_filename_statement}'\" do\n      subject { !file(RSYSLOG_CONF).content.match(rsyslog_input_filename_statement).nil? }\n      it { should be true }\n    end\n\n  rescue Exception => msg\n    describe \"Exception: #{msg}\" do\n      it { should be_nil}\n    end\n  end\nend\n",
          "source_location": {
            "line": 52,
            "ref": "../elasticsearch-inspec/controls/single/V-26686.rb"
          },
          "results": [
            {
              "status": "passed",
              "code_desc": "Service rsyslog should be installed",
              "run_time": 0.055507,
              "start_time": "2018-02-11 14:26:37 -0500"
            },
            {
              "status": "passed",
              "code_desc": "Service rsyslog should be running",
              "run_time": 0.000194,
              "start_time": "2018-02-11 14:26:38 -0500"
            },
            {
              "status": "failed",
              "code_desc": "/etc/rsyslog.conf configured with log aggregation server: logagg.site.mil should equal true",
              "run_time": 0.00021,
              "start_time": "2018-02-11 14:26:38 -0500"
            },
            {
              "status": "failed",
              "code_desc": "/etc/rsyslog.conf contains 'InputFileName /var/log/elasticsearch/elasticsearch_access.log' should equal true",
              "run_time": 0.000128,
              "start_time": "2018-02-11 14:26:38 -0500"
            }
          ]
        },
        {
          "id": "V-27041",
          "title": "Applications must limit the use of resources by priority and not\nimpede the host from servicing processes designated as a higher-priority.",
          "desc": "Elasticsearch is a single process and can be prioritized at the OS\nlevel",
          "impact": 0.5,
          "refs": [],
          "tags": {
            "nist": [
              "SC-6",
              "Rev_3"
            ],
            "severity": "medium",
            "rid": "SV-34335r1_rule",
            "gtitle": "SRG-APP-000248",
            "cci": "CCI-001096",
            "check": "Check elasticsearch service priority level via Operating System\npriority settings. Make sure it is below high-priority processes.\n\nAs the system administrator (usually root, check the NICE setting is set at 0\nor <ORGANIZATIONAL_DETERMINED> level.:\n\n$ ps -efo pid,nice,comm | grep elasticsearch\n\nIf this NICE level is lower than 0 or <ORGANIZATIONAL_DETERMINED> level, this\nis a finding.\n",
            "fix": "Configure elasticsearch service to a lower priority level via\nOperating System priority settings.\n\nSet the default nice value for the application administrator in the\n/etc/security/limits.conf file.\n\n$ sudo su - root\n$ vi /etc/security/limits.conf\n\nSet the hard priority for the application administrator:\n     elasticsearch hard priority 1"
          },
          "code": "control \"V-27041\" do\n  title \"Applications must limit the use of resources by priority and not\nimpede the host from servicing processes designated as a higher-priority.\"\n  desc  \"Elasticsearch is a single process and can be prioritized at the OS\nlevel\"\n  impact 0.5\n  tag \"nist\": [\"SC-6\", \"Rev_3\"]\n  tag \"severity\": \"medium\"\n  tag \"rid\": \"SV-34335r1_rule\"\n  tag \"gtitle\": \"SRG-APP-000248\"\n  tag \"cci\": \"CCI-001096\"\n  tag \"check\": \"Check elasticsearch service priority level via Operating System\npriority settings. Make sure it is below high-priority processes.\n\nAs the system administrator (usually root, check the NICE setting is set at 0\nor <ORGANIZATIONAL_DETERMINED> level.:\n\n$ ps -efo pid,nice,comm | grep elasticsearch\n\nIf this NICE level is lower than 0 or <ORGANIZATIONAL_DETERMINED> level, this\nis a finding.\n\"\n  tag \"fix\": \"Configure elasticsearch service to a lower priority level via\nOperating System priority settings.\n\nSet the default nice value for the application administrator in the\n/etc/security/limits.conf file.\n\n$ sudo su - root\n$ vi /etc/security/limits.conf\n\nSet the hard priority for the application administrator:\n     elasticsearch hard priority 1\"\n\n  begin\n    \n    describe \"/etc/security/limits.conf contains 'elasticsearch hard priority #{NICE_LEVEL}'\" do\n      subject { !file('/etc/security/limits.conf').content.match(/elasticsearch hard priority #{NICE_LEVEL}/).nil? }\n      it { should be true }\n    end\n\n  rescue Exception => msg\n    describe \"Exception: #{msg}\" do\n      it { should be_nil}\n    end\n  end\nend",
          "source_location": {
            "line": 11,
            "ref": "../elasticsearch-inspec/controls/single/V-27041.rb"
          },
          "results": [
            {
              "status": "failed",
              "code_desc": "/etc/security/limits.conf contains 'elasticsearch hard priority 1' should equal true",
              "run_time": 0.014373,
              "start_time": "2018-02-11 14:26:38 -0500"
            }
          ]
        },
        {
          "id": "V-26952",
          "title": "Applications must automatically implement organizational-defined\nsafeguards and countermeasures if security functions (or mechanisms) are\nchanged inappropriately.",
          "desc": "Monitor the elasticsearch configuration on the system running\nElasticsearch software and notify operators when activity occurs.",
          "impact": 0.5,
          "refs": [],
          "tags": {
            "nist": [
              "CM-5 (7)",
              "Rev_3"
            ],
            "severity": "medium",
            "rid": "SV-34235r1_rule",
            "gtitle": "SRG-APP-000134",
            "cci": "CCI-001500",
            "check": "Verify auditd rules are in place to monitor elasticsearch.yml;\nthis file contains security functions settings for elasticsearch.\n\nAs system owner, normally root, run the following command;\n\n$auditctl -l | grep elasticsearch.yml\n\nA watch rule covering all file access ~ -p war for the elasticsearch.yml file\nbe present, if this is not, this is a finding.\n",
            "fix": "Implment audit rules for elasticsearch configuration settings.\nAll security functions, including the disabling and changing are maintained\nwithin this file.\n\nAs the system owner, usually root, add the following to audit.rules, this file\nis maintained at /etc/audit/rules.d/audit.rules on RHEL 7:\n\n-w <ES_HOME>/config/elasticsearch.yml -p war -k elasticsearch-config"
          },
          "code": "control \"V-26952\" do\n  title \"Applications must automatically implement organizational-defined\nsafeguards and countermeasures if security functions (or mechanisms) are\nchanged inappropriately.\"\n  desc  \"Monitor the elasticsearch configuration on the system running\nElasticsearch software and notify operators when activity occurs. \"\n  impact 0.5\n  tag \"nist\": [\"CM-5 (7)\", \"Rev_3\"]\n  tag \"severity\": \"medium\"\n  tag \"rid\": \"SV-34235r1_rule\"\n  tag \"gtitle\": \"SRG-APP-000134\"\n  tag \"cci\": \"CCI-001500\"\n  tag \"check\": \"Verify auditd rules are in place to monitor elasticsearch.yml;\nthis file contains security functions settings for elasticsearch.\n\nAs system owner, normally root, run the following command;\n\n$auditctl -l | grep elasticsearch.yml\n\nA watch rule covering all file access ~ -p war for the elasticsearch.yml file\nbe present, if this is not, this is a finding.\n\"\n  tag \"fix\": \"Implment audit rules for elasticsearch configuration settings.\nAll security functions, including the disabling and changing are maintained\nwithin this file.\n\nAs the system owner, usually root, add the following to audit.rules, this file\nis maintained at /etc/audit/rules.d/audit.rules on RHEL 7:\n\n-w <ES_HOME>/config/elasticsearch.yml -p war -k elasticsearch-config\"\n\n  begin\n    \n    describe \"Audit Rules for #{ELASTICSEARCH_CONF}\" do\n      subject { auditd.where {file == ELASTICSEARCH_CONF }.entries }\n      it { should_not be_empty }\n    end\n\n    describe \"Audit Rules for #{ELASTICSEARCH_CONF}\" do\n      subject { auditd.where {file == ELASTICSEARCH_CONF } }\n      its('key') { should cmp AUDIT_RULE_ID }\n      its('permissions.flatten') { should include \"r\" }\n      its('permissions.flatten') { should include \"w\" }\n      its('permissions.flatten') { should include \"a\" }\n    end\n\n  rescue Exception => msg\n    describe \"Exception: #{msg}\" do\n      it { should be_nil}\n    end\n  end\nend\n",
          "source_location": {
            "line": 17,
            "ref": "../elasticsearch-inspec/controls/single/V-26952.rb"
          },
          "results": [
            {
              "status": "passed",
              "code_desc": "Audit Rules for /etc/elasticsearch/elasticsearch.yml should not be empty",
              "run_time": 0.014628,
              "start_time": "2018-02-11 14:26:38 -0500"
            },
            {
              "status": "passed",
              "code_desc": "Audit Rules for /etc/elasticsearch/elasticsearch.yml key should cmp == \"elasticsearch-config\"",
              "run_time": 0.01601,
              "start_time": "2018-02-11 14:26:38 -0500"
            },
            {
              "status": "passed",
              "code_desc": "Audit Rules for /etc/elasticsearch/elasticsearch.yml permissions.flatten should include \"r\"",
              "run_time": 0.017073,
              "start_time": "2018-02-11 14:26:38 -0500"
            },
            {
              "status": "passed",
              "code_desc": "Audit Rules for /etc/elasticsearch/elasticsearch.yml permissions.flatten should include \"w\"",
              "run_time": 0.014699,
              "start_time": "2018-02-11 14:26:38 -0500"
            },
            {
              "status": "passed",
              "code_desc": "Audit Rules for /etc/elasticsearch/elasticsearch.yml permissions.flatten should include \"a\"",
              "run_time": 0.013991,
              "start_time": "2018-02-11 14:26:38 -0500"
            }
          ]
        },
        {
          "id": "V-26706",
          "title": "Applications must support the requirement to automatically audit\naccount modification.",
          "desc": "Utilize perimeter, application, centralized authentication, and\nrepository audit controls to audit the use of systems in real time with\nsufficient context.  X-Pack Security audit controls should be enabled to audit\nthe defaults of all HTTP/S based access to Elasticsearch.  All applications\nshould use HTTP/S  rather than Elasticsearch transport protocol.",
          "impact": 0.5,
          "refs": [],
          "tags": {
            "nist": [
              "AC-2 (4)",
              "Rev_4"
            ],
            "severity": "medium",
            "rid": "SV-33949r1_rule",
            "gtitle": "SRG-APP-000027",
            "cci": "CCI-001403",
            "check": "Account termination and notification must be handled by an one\nof the supported external authentication mechanism; LDAP, Active Directory, or\nPKI and verify auditing is setup.\n\nIf the external authentication is Active Directory; verify the following\nsettings.\n\n$ cat config/elasticsearch.yml | grep -A 6 -B 6 'type: \\?active_directory'\n\n\n xpack:\n  security:\n    authc:\n      realms:\n        active_directory:\n          type: active_directory\n          order: 0\n          domain_name: ad.example.com\n          url: ldaps://ad.example.com:636\n          unmapped_groups_as_roles: true | false\n\nIf these settings are not correct or missing, this is a finding.\n\nIf the external authentication is LDAP; verify the following settings.\n\n$ cat config/elasticsearch.yml | grep -A 16 -B 6 'type: \\?ldap'\n\nxpack:\n  security:\n    authc:\n      realms:\n        ldap1:\n          type: ldap\n          order: 0\n          url: 'ldaps://ldap.example.com:636'\n          bind_dn: 'cn=ldapuser, ou=users, o=services, dc=example, dc=com'\n          bind_password: changeme\n          user_search:\n            base_dn: 'dc=example,dc=com'\n            attribute: cn\n          group_search:\n            base_dn: 'dc=example,dc=com'\n          files:\n            role_mapping: 'CONFIG_DIR/x-pack/role_mapping.yml\n\nIf these settings are not correct or missing, this is a finding.\n\nIf the external authentication is PKI; verify the following settings.\n\n$ cat config/elasticsearch.yml | grep -A 6 -B 6 'type: \\?pki'\n\n xpack:\n  security:\n    authc:\n      realms:\n        pki1:\n          type: pki\n          username_pattern: 'EMAILADDRESS=(.*?)(?:,|$)'\n\nIf these settings are not correct or missing, this is a finding.  As the\napplication administrator (usually elasticsearch, check the\nxpack.security.audit.outputs setting contains logfile by running the following:\n\n\n$ cat config/elasticsearch.yml | grep xpack.security.audit.outputs\n\nIf this configuration setting is not present, this is a finding.\n\nIf this configuration setting does not contain logfile, this is a finding.     ",
            "fix": "Configure elasticsearch realms settings to point to\norganizational supported authentication mechanism to handle account\nmodification auditing.\n\nSee the official documentation for the instructions on realm configuration:\nhttps://www.elastic.co/guide/en/x-pack/current/_how_authentication_works.html\n\n\nConfigure elasticsearch audit settings to contain sufficient information to\nmonitor for unauthorized access.\n\nSee the official documentation for the instructions on audit configuration:\nhttps://www.elastic.co/guide/en/x-pack/current/auditing.html"
          },
          "code": "control \"V-26706\" do\n  title \"Applications must support the requirement to automatically audit\naccount modification.\"\n  desc  \"Utilize perimeter, application, centralized authentication, and\nrepository audit controls to audit the use of systems in real time with\nsufficient context.  X-Pack Security audit controls should be enabled to audit\nthe defaults of all HTTP/S based access to Elasticsearch.  All applications\nshould use HTTP/S  rather than Elasticsearch transport protocol.\"\n  impact 0.5\n  tag \"nist\": [\"AC-2 (4)\", \"Rev_4\"]\n  tag \"severity\": \"medium\"\n  tag \"rid\": \"SV-33949r1_rule\"\n  tag \"gtitle\": \"SRG-APP-000027\"\n  tag \"cci\": \"CCI-001403\"\n  tag \"check\": \"Account termination and notification must be handled by an one\nof the supported external authentication mechanism; LDAP, Active Directory, or\nPKI and verify auditing is setup.\n\nIf the external authentication is Active Directory; verify the following\nsettings.\n\n$ cat config/elasticsearch.yml | grep -A 6 -B 6 'type: \\\\?active_directory'\n\n\n xpack:\n  security:\n    authc:\n      realms:\n        active_directory:\n          type: active_directory\n          order: 0\n          domain_name: ad.example.com\n          url: ldaps://ad.example.com:636\n          unmapped_groups_as_roles: true | false\n\nIf these settings are not correct or missing, this is a finding.\n\nIf the external authentication is LDAP; verify the following settings.\n\n$ cat config/elasticsearch.yml | grep -A 16 -B 6 'type: \\\\?ldap'\n\nxpack:\n  security:\n    authc:\n      realms:\n        ldap1:\n          type: ldap\n          order: 0\n          url: 'ldaps://ldap.example.com:636'\n          bind_dn: 'cn=ldapuser, ou=users, o=services, dc=example, dc=com'\n          bind_password: changeme\n          user_search:\n            base_dn: 'dc=example,dc=com'\n            attribute: cn\n          group_search:\n            base_dn: 'dc=example,dc=com'\n          files:\n            role_mapping: 'CONFIG_DIR/x-pack/role_mapping.yml\n\nIf these settings are not correct or missing, this is a finding.\n\nIf the external authentication is PKI; verify the following settings.\n\n$ cat config/elasticsearch.yml | grep -A 6 -B 6 'type: \\\\?pki'\n\n xpack:\n  security:\n    authc:\n      realms:\n        pki1:\n          type: pki\n          username_pattern: 'EMAILADDRESS=(.*?)(?:,|$)'\n\nIf these settings are not correct or missing, this is a finding.  As the\napplication administrator (usually elasticsearch, check the\nxpack.security.audit.outputs setting contains logfile by running the following:\n\n\n$ cat config/elasticsearch.yml | grep xpack.security.audit.outputs\n\nIf this configuration setting is not present, this is a finding.\n\nIf this configuration setting does not contain logfile, this is a finding.     \"\n  tag \"fix\": \"Configure elasticsearch realms settings to point to\norganizational supported authentication mechanism to handle account\nmodification auditing.\n\nSee the official documentation for the instructions on realm configuration:\nhttps://www.elastic.co/guide/en/x-pack/current/_how_authentication_works.html\n\n\nConfigure elasticsearch audit settings to contain sufficient information to\nmonitor for unauthorized access.\n\nSee the official documentation for the instructions on audit configuration:\nhttps://www.elastic.co/guide/en/x-pack/current/auditing.html\"\n\n  begin\n    \n    es_handle = es_helper(url:\"https://#{ELASTIC_IP}:#{ELASTIC_PORT}\",\n                    username: ES_ADMIN,\n                    password: ES_PASS,\n                    ssl_verify: SSL_VERIFY )\n\n    describe \"No nodes found\" do\n      subject { es_handle.nodes.nil? }\n      it { should_not be_truthy }\n    end if es_handle.nodes.nil?\n\n    es_handle.nodes.each do |node|\n      describe \"Authentication methods includes AD, LDAP or PKI for Node: #{node.name}\" do\n        subject { node.authc_method.any? { |x| ['pki','active_directory','ldap'].include?(x) } }\n        it{ should be true }\n      end\n    end unless es_handle.nodes.nil?\n\n    es_handle.nodes.each do |node|\n      describe.one do\n        node.authc_realm.keys.each do |auth_method|\n          describe \"Active Directory Settings for Node: #{node.name}\" do\n            subject { es_handle.settings.first.xpack.security.authc.realms[auth_method] }\n            its ('order') { should_not be_nil }\n            its ('domain_name') { should_not be_nil }\n            its ('url') { should_not be_nil }\n            its ('unmapped_groups_as_roles') { should_not be_nil }\n          end if node.authc_realm[auth_method].type.eql?('active_directory')\n\n          describe \"LDAP Settings for Node: #{node.name}\" do\n            subject { es_handle.settings.first.xpack.security.authc.realms[auth_method] }\n            its ('order') { should_not be_nil }\n            its ('url') { should_not be_nil }\n            its ('bind_dn') { should_not be_nil }\n            its ('bind_password') { should_not be_nil }\n            its ('user_search.base_dn') { should_not be_nil }\n            its ('user_search.attribute') { should_not be_nil }\n            its ('group_search.base_dn') { should_not be_nil }\n            its ('files.role_mapping') { should_not be_nil }\n          end if node.authc_realm[auth_method].type.eql?('ldap')\n\n          describe \"PKI Settings for Node: #{node.name}\" do\n            subject { node.authc_realm[auth_method] }\n            its ('order') { should_not be_nil }\n            its ('username_pattern') { should_not be_nil }\n          end if node.authc_realm[auth_method].type.eql?('pki')\n        end\n      end\n    end unless es_handle.nodes.nil?\n\n\n    es_handle.nodes.each do |node|\n      describe \"Audit Settings for Node: #{node.name}\" do\n        subject { node.audit }\n        its('enabled') { should eq 'true' }\n        its('outputs') { should include 'logfile' }\n      end\n    end unless es_handle.nodes.nil?\n\n    describe \"Audit Settings from ES_CONF_YML\" do\n      subject { yaml(ELASTICSEARCH_CONF) }\n      its(['xpack.security.audit.enabled']) { should eq true }\n      its(['xpack.security.audit.outputs']) { should include 'logfile' }\n    end\n\n  rescue Exception => msg\n    describe \"Exception: #{msg}\" do\n      it { should be_nil}\n    end\n  end\nend\n",
          "source_location": {
            "line": 41,
            "ref": "../elasticsearch-inspec/controls/audit+ad+ldap+pki/V-26706.rb"
          },
          "results": [
            {
              "status": "passed",
              "code_desc": "Authentication methods includes AD, LDAP or PKI for Node: package-centos-72 should equal true",
              "run_time": 0.000102,
              "start_time": "2018-02-11 14:26:38 -0500"
            },
            {
              "status": "passed",
              "code_desc": "PKI Settings for Node: package-centos-72 order should not be nil",
              "run_time": 0.000079,
              "start_time": "2018-02-11 14:26:38 -0500"
            },
            {
              "status": "passed",
              "code_desc": "PKI Settings for Node: package-centos-72 username_pattern should not be nil",
              "run_time": 0.000055,
              "start_time": "2018-02-11 14:26:38 -0500"
            },
            {
              "status": "passed",
              "code_desc": "Audit Settings for Node: package-centos-72 enabled should eq \"true\"",
              "run_time": 0.000075,
              "start_time": "2018-02-11 14:26:38 -0500"
            },
            {
              "status": "passed",
              "code_desc": "Audit Settings for Node: package-centos-72 outputs should include \"logfile\"",
              "run_time": 0.00008,
              "start_time": "2018-02-11 14:26:38 -0500"
            },
            {
              "status": "passed",
              "code_desc": "Audit Settings from ES_CONF_YML [\"xpack.security.audit.enabled\"] should eq true",
              "run_time": 0.000576,
              "start_time": "2018-02-11 14:26:38 -0500"
            },
            {
              "status": "passed",
              "code_desc": "Audit Settings from ES_CONF_YML [\"xpack.security.audit.outputs\"] should include \"logfile\"",
              "run_time": 0.000477,
              "start_time": "2018-02-11 14:26:38 -0500"
            }
          ]
        },
        {
          "id": "V-26703",
          "title": "The application must be capable of automatically disabling accounts\nafter a 35 day period of account inactivity.",
          "desc": "Configure the X-Pack Security to use a centralized authentication and\nauthorization service such as Active Directory or LDAP in order to comply with\norganizational defined management policies.",
          "impact": 0.5,
          "refs": [],
          "tags": {
            "nist": [
              "AC-2 (3)",
              "Rev_4"
            ],
            "severity": "medium",
            "rid": "SV-33946r1_rule",
            "gtitle": "SRG-APP-000025",
            "cci": "CCI-000017",
            "check": "Account disabling must be handled by an one of the supported\nexternal authentication mechanism; LDAP, Active Directory, or PKI.\n\nIf the external authentication is Active Directory; verify the following\nsettings.\n\n$ cat config/elasticsearch.yml | grep -A 6 -B 6 'type: \\?active_directory'\n\n\n xpack:\n  security:\n    authc:\n      realms:\n        active_directory:\n          type: active_directory\n          order: 0\n          domain_name: ad.example.com\n          url: ldaps://ad.example.com:636\n          unmapped_groups_as_roles: true | false\n\nIf these settings are not correct or missing, this is a finding.\n\nIf the external authentication is LDAP; verify the following settings.\n\n$ cat config/elasticsearch.yml | grep -A 16 -B 6 'type: \\?ldap'\n\nxpack:\n  security:\n    authc:\n      realms:\n        ldap1:\n          type: ldap\n          order: 0\n          url: 'ldaps://ldap.example.com:636'\n          bind_dn: 'cn=ldapuser, ou=users, o=services, dc=example, dc=com'\n          bind_password: changeme\n          user_search:\n            base_dn: 'dc=example,dc=com'\n            attribute: cn\n          group_search:\n            base_dn: 'dc=example,dc=com'\n          files:\n            role_mapping: 'CONFIG_DIR/x-pack/role_mapping.yml\n\nIf these settings are not correct or missing, this is a finding.\n\nIf the external authentication is PKI; verify the following settings.\n\n$ cat config/elasticsearch.yml | grep -A 6 -B 6 'type: \\?pki'\n\n xpack:\n  security:\n    authc:\n      realms:\n        pki1:\n          type: pki\n          username_pattern: 'EMAILADDRESS=(.*?)(?:,|$)'\n\nIf these settings are not correct or missing, this is a finding.  As the\napplication administrator (usually elasticsearch, check the\nxpack.security.audit.outputs setting contains logfile by running the following:\n\n\n$ cat config/elasticsearch.yml | grep xpack.security.audit.outputs\n\nIf this configuration setting is not present, this is a finding.\n\nIf this configuration setting does not contain logfile, this is a finding.     ",
            "fix": "Configure elasticsearch realms settings to point to\norganizational supported authentication mechanism to handle account disabling.\n\nSee the official documentation for the instructions on realm configuration:\nhttps://www.elastic.co/guide/en/x-pack/current/_how_authentication_works.html "
          },
          "code": "control \"V-26703\" do\n  title \"The application must be capable of automatically disabling accounts\nafter a 35 day period of account inactivity.\"\n  desc  \"Configure the X-Pack Security to use a centralized authentication and\nauthorization service such as Active Directory or LDAP in order to comply with\norganizational defined management policies.\"\n  impact 0.5\n  tag \"nist\": [\"AC-2 (3)\", \"Rev_4\"]\n  tag \"severity\": \"medium\"\n  tag \"rid\": \"SV-33946r1_rule\"\n  tag \"gtitle\": \"SRG-APP-000025\"\n  tag \"cci\": \"CCI-000017\"\n  tag \"check\": \"Account disabling must be handled by an one of the supported\nexternal authentication mechanism; LDAP, Active Directory, or PKI.\n\nIf the external authentication is Active Directory; verify the following\nsettings.\n\n$ cat config/elasticsearch.yml | grep -A 6 -B 6 'type: \\\\?active_directory'\n\n\n xpack:\n  security:\n    authc:\n      realms:\n        active_directory:\n          type: active_directory\n          order: 0\n          domain_name: ad.example.com\n          url: ldaps://ad.example.com:636\n          unmapped_groups_as_roles: true | false\n\nIf these settings are not correct or missing, this is a finding.\n\nIf the external authentication is LDAP; verify the following settings.\n\n$ cat config/elasticsearch.yml | grep -A 16 -B 6 'type: \\\\?ldap'\n\nxpack:\n  security:\n    authc:\n      realms:\n        ldap1:\n          type: ldap\n          order: 0\n          url: 'ldaps://ldap.example.com:636'\n          bind_dn: 'cn=ldapuser, ou=users, o=services, dc=example, dc=com'\n          bind_password: changeme\n          user_search:\n            base_dn: 'dc=example,dc=com'\n            attribute: cn\n          group_search:\n            base_dn: 'dc=example,dc=com'\n          files:\n            role_mapping: 'CONFIG_DIR/x-pack/role_mapping.yml\n\nIf these settings are not correct or missing, this is a finding.\n\nIf the external authentication is PKI; verify the following settings.\n\n$ cat config/elasticsearch.yml | grep -A 6 -B 6 'type: \\\\?pki'\n\n xpack:\n  security:\n    authc:\n      realms:\n        pki1:\n          type: pki\n          username_pattern: 'EMAILADDRESS=(.*?)(?:,|$)'\n\nIf these settings are not correct or missing, this is a finding.  As the\napplication administrator (usually elasticsearch, check the\nxpack.security.audit.outputs setting contains logfile by running the following:\n\n\n$ cat config/elasticsearch.yml | grep xpack.security.audit.outputs\n\nIf this configuration setting is not present, this is a finding.\n\nIf this configuration setting does not contain logfile, this is a finding.     \"\n  tag \"fix\": \"Configure elasticsearch realms settings to point to\norganizational supported authentication mechanism to handle account disabling.\n\nSee the official documentation for the instructions on realm configuration:\nhttps://www.elastic.co/guide/en/x-pack/current/_how_authentication_works.html \"\n\n  begin\n    \n    es_handle = es_helper(url:\"https://#{ELASTIC_IP}:#{ELASTIC_PORT}\",\n                    username: ES_ADMIN,\n                    password: ES_PASS,\n                    ssl_verify: SSL_VERIFY )\n\n    describe \"No nodes found\" do\n      subject { es_handle.nodes.nil? }\n      it { should_not be_truthy }\n    end if es_handle.nodes.nil?\n\n    es_handle.nodes.each do |node|\n      describe \"Authentication methods includes AD, LDAP or PKI for Node: #{node.name}\" do\n        subject { node.authc_method.any? { |x| ['pki','active_directory','ldap'].include?(x) } }\n        it{ should be true }\n      end\n    end unless es_handle.nodes.nil?\n\n    es_handle.nodes.each do |node|\n      describe.one do\n        node.authc_realm.keys.each do |auth_method|\n          describe \"Active Directory Settings for Node: #{node.name}\" do\n            subject { es_handle.settings.first.xpack.security.authc.realms[auth_method] }\n            its ('order') { should_not be_nil }\n            its ('domain_name') { should_not be_nil }\n            its ('url') { should_not be_nil }\n            its ('unmapped_groups_as_roles') { should_not be_nil }\n          end if node.authc_realm[auth_method].type.eql?('active_directory')\n\n          describe \"LDAP Settings for Node: #{node.name}\" do\n            subject { es_handle.settings.first.xpack.security.authc.realms[auth_method] }\n            its ('order') { should_not be_nil }\n            its ('url') { should_not be_nil }\n            its ('bind_dn') { should_not be_nil }\n            its ('bind_password') { should_not be_nil }\n            its ('user_search.base_dn') { should_not be_nil }\n            its ('user_search.attribute') { should_not be_nil }\n            its ('group_search.base_dn') { should_not be_nil }\n            its ('files.role_mapping') { should_not be_nil }\n          end if node.authc_realm[auth_method].type.eql?('ldap')\n\n          describe \"PKI Settings for Node: #{node.name}\" do\n            subject { node.authc_realm[auth_method] }\n            its ('order') { should_not be_nil }\n            its ('username_pattern') { should_not be_nil }\n          end if node.authc_realm[auth_method].type.eql?('pki')\n        end\n      end\n    end unless es_handle.nodes.nil?\n\n\n    es_handle.nodes.each do |node|\n      describe \"Audit Settings for Node: #{node.name}\" do\n        subject { node.audit }\n        its('enabled') { should eq 'true' }\n        its('outputs') { should include 'logfile' }\n      end\n    end unless es_handle.nodes.nil?\n\n    describe \"Audit Settings from ES_CONF_YML\" do\n      subject { yaml(ELASTICSEARCH_CONF) }\n      its(['xpack.security.audit.enabled']) { should eq true }\n      its(['xpack.security.audit.outputs']) { should include 'logfile' }\n    end\n\n  rescue Exception => msg\n    describe \"Exception: #{msg}\" do\n      it { should be_nil}\n    end\n  end\nend\n",
          "source_location": {
            "line": 41,
            "ref": "../elasticsearch-inspec/controls/audit+ad+ldap+pki/V-26703.rb"
          },
          "results": [
            {
              "status": "passed",
              "code_desc": "Authentication methods includes AD, LDAP or PKI for Node: package-centos-72 should equal true",
              "run_time": 0.000105,
              "start_time": "2018-02-11 14:26:38 -0500"
            },
            {
              "status": "passed",
              "code_desc": "PKI Settings for Node: package-centos-72 order should not be nil",
              "run_time": 0.000078,
              "start_time": "2018-02-11 14:26:38 -0500"
            },
            {
              "status": "passed",
              "code_desc": "PKI Settings for Node: package-centos-72 username_pattern should not be nil",
              "run_time": 0.000073,
              "start_time": "2018-02-11 14:26:38 -0500"
            },
            {
              "status": "passed",
              "code_desc": "Audit Settings for Node: package-centos-72 enabled should eq \"true\"",
              "run_time": 0.000093,
              "start_time": "2018-02-11 14:26:38 -0500"
            },
            {
              "status": "passed",
              "code_desc": "Audit Settings for Node: package-centos-72 outputs should include \"logfile\"",
              "run_time": 0.00008,
              "start_time": "2018-02-11 14:26:38 -0500"
            },
            {
              "status": "passed",
              "code_desc": "Audit Settings from ES_CONF_YML [\"xpack.security.audit.enabled\"] should eq true",
              "run_time": 0.000523,
              "start_time": "2018-02-11 14:26:38 -0500"
            },
            {
              "status": "passed",
              "code_desc": "Audit Settings from ES_CONF_YML [\"xpack.security.audit.outputs\"] should include \"logfile\"",
              "run_time": 0.000572,
              "start_time": "2018-02-11 14:26:38 -0500"
            }
          ]
        },
        {
          "id": "V-30570",
          "title": "The application must enforce requirements for remote connections to\nthe information system.",
          "desc": "Limit access inbound and outbound access to Elasticsearch over\nnetworks using software and hardware firewall rules. Disable zen multicast\ndiscovery, and enable unicast only to known elasticsearch cluster nodes.",
          "impact": 0.5,
          "refs": [],
          "tags": {
            "nist": [
              "AC-17 e",
              "Rev_3"
            ],
            "severity": "medium",
            "rid": "SV-40299r1_rule",
            "gtitle": "SRG-APP-000140",
            "cci": "CCI-000066",
            "check": "Verify that external authentication mechanism is in place,\nLDAP, Active Directory, or PKI and verify auditing is setup.\n\nIf the external authentication is Active Directory; verify the following\nsettings.\n\n$ cat config/elasticsearch.yml | grep -A 6 -B 6 'type: \\?active_directory'\n\n\n xpack:\n  security:\n    authc:\n      realms:\n        active_directory:\n          type: active_directory\n          order: 0\n          domain_name: ad.example.com\n          url: ldaps://ad.example.com:636\n          unmapped_groups_as_roles: true | false\n\nIf these settings are not correct or missing, this is a finding.\n\nIf the external authentication is LDAP; verify the following settings.\n\n$ cat config/elasticsearch.yml | grep -A 16 -B 6 'type: \\?ldap'\n\nxpack:\n  security:\n    authc:\n      realms:\n        ldap1:\n          type: ldap\n          order: 0\n          url: 'ldaps://ldap.example.com:636'\n          bind_dn: 'cn=ldapuser, ou=users, o=services, dc=example, dc=com'\n          bind_password: changeme\n          user_search:\n            base_dn: 'dc=example,dc=com'\n            attribute: cn\n          group_search:\n            base_dn: 'dc=example,dc=com'\n          files:\n            role_mapping: 'CONFIG_DIR/x-pack/role_mapping.yml\n\nIf these settings are not correct or missing, this is a finding.\n\nIf the external authentication is PKI; verify the following settings.\n\n$ cat config/elasticsearch.yml | grep -A 6 -B 6 'type: \\?pki'\n\n xpack:\n  security:\n    authc:\n      realms:\n        pki1:\n          type: pki\n          username_pattern: 'EMAILADDRESS=(.*?)(?:,|$)'\n\nIf these settings are not correct or missing, this is a finding.  As the\napplication administrator (usually elasticsearch, check the\nxpack.security.audit.outputs setting contains logfile by running the following:\n\n\n$ cat config/elasticsearch.yml | grep xpack.security.audit.outputs\n\nIf this configuration setting is not present, this is a finding.\n\nIf this configuration setting does not contain logfile, this is a finding.     ",
            "fix": "Configure elasticsearch realms settings to point to\norganizational supported authentication mechanism\n\nSee the official documentation for the instructions on realm configuration:\nhttps://www.elastic.co/guide/en/x-pack/current/_how_authentication_works.html\n\n\nConfigure elasticsearch audit settings to contain sufficient information to\nmonitor for unauthorized access.\n\nSee the official documentation for the instructions on audit configuration:\nhttps://www.elastic.co/guide/en/x-pack/current/auditing.html"
          },
          "code": "control \"V-30570\" do\n  title \"The application must enforce requirements for remote connections to\nthe information system.\"\n  desc  \"Limit access inbound and outbound access to Elasticsearch over\nnetworks using software and hardware firewall rules. Disable zen multicast\ndiscovery, and enable unicast only to known elasticsearch cluster nodes.\"\n  impact 0.5\n  tag \"nist\": [\"AC-17 e\", \"Rev_3\"]\n  tag \"severity\": \"medium\"\n  tag \"rid\": \"SV-40299r1_rule\"\n  tag \"gtitle\": \"SRG-APP-000140\"\n  tag \"cci\": \"CCI-000066\"\n  tag \"check\": \"Verify that external authentication mechanism is in place,\nLDAP, Active Directory, or PKI and verify auditing is setup.\n\nIf the external authentication is Active Directory; verify the following\nsettings.\n\n$ cat config/elasticsearch.yml | grep -A 6 -B 6 'type: \\\\?active_directory'\n\n\n xpack:\n  security:\n    authc:\n      realms:\n        active_directory:\n          type: active_directory\n          order: 0\n          domain_name: ad.example.com\n          url: ldaps://ad.example.com:636\n          unmapped_groups_as_roles: true | false\n\nIf these settings are not correct or missing, this is a finding.\n\nIf the external authentication is LDAP; verify the following settings.\n\n$ cat config/elasticsearch.yml | grep -A 16 -B 6 'type: \\\\?ldap'\n\nxpack:\n  security:\n    authc:\n      realms:\n        ldap1:\n          type: ldap\n          order: 0\n          url: 'ldaps://ldap.example.com:636'\n          bind_dn: 'cn=ldapuser, ou=users, o=services, dc=example, dc=com'\n          bind_password: changeme\n          user_search:\n            base_dn: 'dc=example,dc=com'\n            attribute: cn\n          group_search:\n            base_dn: 'dc=example,dc=com'\n          files:\n            role_mapping: 'CONFIG_DIR/x-pack/role_mapping.yml\n\nIf these settings are not correct or missing, this is a finding.\n\nIf the external authentication is PKI; verify the following settings.\n\n$ cat config/elasticsearch.yml | grep -A 6 -B 6 'type: \\\\?pki'\n\n xpack:\n  security:\n    authc:\n      realms:\n        pki1:\n          type: pki\n          username_pattern: 'EMAILADDRESS=(.*?)(?:,|$)'\n\nIf these settings are not correct or missing, this is a finding.  As the\napplication administrator (usually elasticsearch, check the\nxpack.security.audit.outputs setting contains logfile by running the following:\n\n\n$ cat config/elasticsearch.yml | grep xpack.security.audit.outputs\n\nIf this configuration setting is not present, this is a finding.\n\nIf this configuration setting does not contain logfile, this is a finding.     \"\n  tag \"fix\": \"Configure elasticsearch realms settings to point to\norganizational supported authentication mechanism\n\nSee the official documentation for the instructions on realm configuration:\nhttps://www.elastic.co/guide/en/x-pack/current/_how_authentication_works.html\n\n\nConfigure elasticsearch audit settings to contain sufficient information to\nmonitor for unauthorized access.\n\nSee the official documentation for the instructions on audit configuration:\nhttps://www.elastic.co/guide/en/x-pack/current/auditing.html\"\n\n  begin\n    \n    es_handle = es_helper(url:\"https://#{ELASTIC_IP}:#{ELASTIC_PORT}\",\n                    username: ES_ADMIN,\n                    password: ES_PASS,\n                    ssl_verify: SSL_VERIFY )\n\n    describe \"No nodes found\" do\n      subject { es_handle.nodes.nil? }\n      it { should_not be_truthy }\n    end if es_handle.nodes.nil?\n\n    es_handle.nodes.each do |node|\n      describe \"Authentication methods includes AD, LDAP or PKI for Node: #{node.name}\" do\n        subject { node.authc_method.any? { |x| ['pki','active_directory','ldap'].include?(x) } }\n        it{ should be true }\n      end\n    end unless es_handle.nodes.nil?\n\n    es_handle.nodes.each do |node|\n      describe.one do\n        node.authc_realm.keys.each do |auth_method|\n          describe \"Active Directory Settings for Node: #{node.name}\" do\n            subject { es_handle.settings.first.xpack.security.authc.realms[auth_method] }\n            its ('order') { should_not be_nil }\n            its ('domain_name') { should_not be_nil }\n            its ('url') { should_not be_nil }\n            its ('unmapped_groups_as_roles') { should_not be_nil }\n          end if node.authc_realm[auth_method].type.eql?('active_directory')\n\n          describe \"LDAP Settings for Node: #{node.name}\" do\n            subject { es_handle.settings.first.xpack.security.authc.realms[auth_method] }\n            its ('order') { should_not be_nil }\n            its ('url') { should_not be_nil }\n            its ('bind_dn') { should_not be_nil }\n            its ('bind_password') { should_not be_nil }\n            its ('user_search.base_dn') { should_not be_nil }\n            its ('user_search.attribute') { should_not be_nil }\n            its ('group_search.base_dn') { should_not be_nil }\n            its ('files.role_mapping') { should_not be_nil }\n          end if node.authc_realm[auth_method].type.eql?('ldap')\n\n          describe \"PKI Settings for Node: #{node.name}\" do\n            subject { node.authc_realm[auth_method] }\n            its ('order') { should_not be_nil }\n            its ('username_pattern') { should_not be_nil }\n          end if node.authc_realm[auth_method].type.eql?('pki')\n        end\n      end\n    end unless es_handle.nodes.nil?\n\n\n    es_handle.nodes.each do |node|\n      describe \"Audit Settings for Node: #{node.name}\" do\n        subject { node.audit }\n        its('enabled') { should eq 'true' }\n        its('outputs') { should include 'logfile' }\n      end\n    end unless es_handle.nodes.nil?\n\n    describe \"Audit Settings from ES_CONF_YML\" do\n      subject { yaml(ELASTICSEARCH_CONF) }\n      its(['xpack.security.audit.enabled']) { should eq true }\n      its(['xpack.security.audit.outputs']) { should include 'logfile' }\n    end\n\n  rescue Exception => msg\n    describe \"Exception: #{msg}\" do\n      it { should be_nil}\n    end\n  end\nend\n",
          "source_location": {
            "line": 41,
            "ref": "../elasticsearch-inspec/controls/audit+ad+ldap+pki/V-30570.rb"
          },
          "results": [
            {
              "status": "passed",
              "code_desc": "Authentication methods includes AD, LDAP or PKI for Node: package-centos-72 should equal true",
              "run_time": 0.000085,
              "start_time": "2018-02-11 14:26:38 -0500"
            },
            {
              "status": "passed",
              "code_desc": "PKI Settings for Node: package-centos-72 order should not be nil",
              "run_time": 0.000071,
              "start_time": "2018-02-11 14:26:38 -0500"
            },
            {
              "status": "passed",
              "code_desc": "PKI Settings for Node: package-centos-72 username_pattern should not be nil",
              "run_time": 0.000065,
              "start_time": "2018-02-11 14:26:38 -0500"
            },
            {
              "status": "passed",
              "code_desc": "Audit Settings for Node: package-centos-72 enabled should eq \"true\"",
              "run_time": 0.000097,
              "start_time": "2018-02-11 14:26:38 -0500"
            },
            {
              "status": "passed",
              "code_desc": "Audit Settings for Node: package-centos-72 outputs should include \"logfile\"",
              "run_time": 0.000107,
              "start_time": "2018-02-11 14:26:38 -0500"
            },
            {
              "status": "passed",
              "code_desc": "Audit Settings from ES_CONF_YML [\"xpack.security.audit.enabled\"] should eq true",
              "run_time": 0.000489,
              "start_time": "2018-02-11 14:26:38 -0500"
            },
            {
              "status": "passed",
              "code_desc": "Audit Settings from ES_CONF_YML [\"xpack.security.audit.outputs\"] should include \"logfile\"",
              "run_time": 0.000476,
              "start_time": "2018-02-11 14:26:38 -0500"
            }
          ]
        },
        {
          "id": "V-26731",
          "title": "The application must automatically audit account termination and\nnotify appropriate individuals.",
          "desc": "Utilize perimeter, application, centralized authentication, and\nrepository audit controls to audit the use of systems in real time with\nsufficient context.  X-Pack Security audit controls should be enabled to audit\nthe defaults of all HTTP/S based access to Elasticsearch.  All applications\nshould use HTTP/S  rather than Elasticsearch transport protocol.",
          "impact": 0.5,
          "refs": [],
          "tags": {
            "nist": [
              "AC-2 (4)",
              "Rev_4"
            ],
            "severity": "medium",
            "rid": "SV-33979r1_rule",
            "gtitle": "SRG-APP-000029",
            "cci": "CCI-001405",
            "check": "Account termination and notification must be handled by an one\nof the supported external authentication mechanism; LDAP, Active Directory, or\nPKI and verify auditing is setup.\n\nIf the external authentication is Active Directory; verify the following\nsettings.\n\n$ cat config/elasticsearch.yml | grep -A 6 -B 6 'type: \\?active_directory'\n\n\n xpack:\n  security:\n    authc:\n      realms:\n        active_directory:\n          type: active_directory\n          order: 0\n          domain_name: ad.example.com\n          url: ldaps://ad.example.com:636\n          unmapped_groups_as_roles: true | false\n\nIf these settings are not correct or missing, this is a finding.\n\nIf the external authentication is LDAP; verify the following settings.\n\n$ cat config/elasticsearch.yml | grep -A 16 -B 6 'type: \\?ldap'\n\nxpack:\n  security:\n    authc:\n      realms:\n        ldap1:\n          type: ldap\n          order: 0\n          url: 'ldaps://ldap.example.com:636'\n          bind_dn: 'cn=ldapuser, ou=users, o=services, dc=example, dc=com'\n          bind_password: changeme\n          user_search:\n            base_dn: 'dc=example,dc=com'\n            attribute: cn\n          group_search:\n            base_dn: 'dc=example,dc=com'\n          files:\n            role_mapping: 'CONFIG_DIR/x-pack/role_mapping.yml\n\nIf these settings are not correct or missing, this is a finding.\n\nIf the external authentication is PKI; verify the following settings.\n\n$ cat config/elasticsearch.yml | grep -A 6 -B 6 'type: \\?pki'\n\n xpack:\n  security:\n    authc:\n      realms:\n        pki1:\n          type: pki\n          username_pattern: 'EMAILADDRESS=(.*?)(?:,|$)'\n\nIf these settings are not correct or missing, this is a finding.  As the\napplication administrator (usually elasticsearch, check the\nxpack.security.audit.outputs setting contains logfile by running the following:\n\n\n$ cat config/elasticsearch.yml | grep xpack.security.audit.outputs\n\nIf this configuration setting is not present, this is a finding.\n\nIf this configuration setting does not contain logfile, this is a finding.     ",
            "fix": "Configure elasticsearch realms settings to point to\norganizational supported authentication mechanism to handle account termination\nand notification.\n\nSee the official documentation for the instructions on realm configuration:\nhttps://www.elastic.co/guide/en/x-pack/current/_how_authentication_works.html\n\n\nConfigure elasticsearch audit settings to contain sufficient information to\nmonitor for unauthorized access.\n\nSee the official documentation for the instructions on audit configuration:\nhttps://www.elastic.co/guide/en/x-pack/current/auditing.html"
          },
          "code": "control \"V-26731\" do\n  title \"The application must automatically audit account termination and\nnotify appropriate individuals.\"\n  desc  \"Utilize perimeter, application, centralized authentication, and\nrepository audit controls to audit the use of systems in real time with\nsufficient context.  X-Pack Security audit controls should be enabled to audit\nthe defaults of all HTTP/S based access to Elasticsearch.  All applications\nshould use HTTP/S  rather than Elasticsearch transport protocol.\"\n  impact 0.5\n  tag \"nist\": [\"AC-2 (4)\", \"Rev_4\"]\n  tag \"severity\": \"medium\"\n  tag \"rid\": \"SV-33979r1_rule\"\n  tag \"gtitle\": \"SRG-APP-000029\"\n  tag \"cci\": \"CCI-001405\"\n  tag \"check\": \"Account termination and notification must be handled by an one\nof the supported external authentication mechanism; LDAP, Active Directory, or\nPKI and verify auditing is setup.\n\nIf the external authentication is Active Directory; verify the following\nsettings.\n\n$ cat config/elasticsearch.yml | grep -A 6 -B 6 'type: \\\\?active_directory'\n\n\n xpack:\n  security:\n    authc:\n      realms:\n        active_directory:\n          type: active_directory\n          order: 0\n          domain_name: ad.example.com\n          url: ldaps://ad.example.com:636\n          unmapped_groups_as_roles: true | false\n\nIf these settings are not correct or missing, this is a finding.\n\nIf the external authentication is LDAP; verify the following settings.\n\n$ cat config/elasticsearch.yml | grep -A 16 -B 6 'type: \\\\?ldap'\n\nxpack:\n  security:\n    authc:\n      realms:\n        ldap1:\n          type: ldap\n          order: 0\n          url: 'ldaps://ldap.example.com:636'\n          bind_dn: 'cn=ldapuser, ou=users, o=services, dc=example, dc=com'\n          bind_password: changeme\n          user_search:\n            base_dn: 'dc=example,dc=com'\n            attribute: cn\n          group_search:\n            base_dn: 'dc=example,dc=com'\n          files:\n            role_mapping: 'CONFIG_DIR/x-pack/role_mapping.yml\n\nIf these settings are not correct or missing, this is a finding.\n\nIf the external authentication is PKI; verify the following settings.\n\n$ cat config/elasticsearch.yml | grep -A 6 -B 6 'type: \\\\?pki'\n\n xpack:\n  security:\n    authc:\n      realms:\n        pki1:\n          type: pki\n          username_pattern: 'EMAILADDRESS=(.*?)(?:,|$)'\n\nIf these settings are not correct or missing, this is a finding.  As the\napplication administrator (usually elasticsearch, check the\nxpack.security.audit.outputs setting contains logfile by running the following:\n\n\n$ cat config/elasticsearch.yml | grep xpack.security.audit.outputs\n\nIf this configuration setting is not present, this is a finding.\n\nIf this configuration setting does not contain logfile, this is a finding.     \"\n  tag \"fix\": \"Configure elasticsearch realms settings to point to\norganizational supported authentication mechanism to handle account termination\nand notification.\n\nSee the official documentation for the instructions on realm configuration:\nhttps://www.elastic.co/guide/en/x-pack/current/_how_authentication_works.html\n\n\nConfigure elasticsearch audit settings to contain sufficient information to\nmonitor for unauthorized access.\n\nSee the official documentation for the instructions on audit configuration:\nhttps://www.elastic.co/guide/en/x-pack/current/auditing.html\"\n\n  begin\n    \n    es_handle = es_helper(url:\"https://#{ELASTIC_IP}:#{ELASTIC_PORT}\",\n                    username: ES_ADMIN,\n                    password: ES_PASS,\n                    ssl_verify: SSL_VERIFY )\n\n    describe \"No nodes found\" do\n      subject { es_handle.nodes.nil? }\n      it { should_not be_truthy }\n    end if es_handle.nodes.nil?\n\n    es_handle.nodes.each do |node|\n      describe \"Authentication methods includes AD, LDAP or PKI for Node: #{node.name}\" do\n        subject { node.authc_method.any? { |x| ['pki','active_directory','ldap'].include?(x) } }\n        it{ should be true }\n      end\n    end unless es_handle.nodes.nil?\n\n    es_handle.nodes.each do |node|\n      describe.one do\n        node.authc_realm.keys.each do |auth_method|\n          describe \"Active Directory Settings for Node: #{node.name}\" do\n            subject { es_handle.settings.first.xpack.security.authc.realms[auth_method] }\n            its ('order') { should_not be_nil }\n            its ('domain_name') { should_not be_nil }\n            its ('url') { should_not be_nil }\n            its ('unmapped_groups_as_roles') { should_not be_nil }\n          end if node.authc_realm[auth_method].type.eql?('active_directory')\n\n          describe \"LDAP Settings for Node: #{node.name}\" do\n            subject { es_handle.settings.first.xpack.security.authc.realms[auth_method] }\n            its ('order') { should_not be_nil }\n            its ('url') { should_not be_nil }\n            its ('bind_dn') { should_not be_nil }\n            its ('bind_password') { should_not be_nil }\n            its ('user_search.base_dn') { should_not be_nil }\n            its ('user_search.attribute') { should_not be_nil }\n            its ('group_search.base_dn') { should_not be_nil }\n            its ('files.role_mapping') { should_not be_nil }\n          end if node.authc_realm[auth_method].type.eql?('ldap')\n\n          describe \"PKI Settings for Node: #{node.name}\" do\n            subject { node.authc_realm[auth_method] }\n            its ('order') { should_not be_nil }\n            its ('username_pattern') { should_not be_nil }\n          end if node.authc_realm[auth_method].type.eql?('pki')\n        end\n      end\n    end unless es_handle.nodes.nil?\n\n\n    es_handle.nodes.each do |node|\n      describe \"Audit Settings for Node: #{node.name}\" do\n        subject { node.audit }\n        its('enabled') { should eq 'true' }\n        its('outputs') { should include 'logfile' }\n      end\n    end unless es_handle.nodes.nil?\n\n    describe \"Audit Settings from ES_CONF_YML\" do\n      subject { yaml(ELASTICSEARCH_CONF) }\n      its(['xpack.security.audit.enabled']) { should eq true }\n      its(['xpack.security.audit.outputs']) { should include 'logfile' }\n    end\n\n  rescue Exception => msg\n    describe \"Exception: #{msg}\" do\n      it { should be_nil}\n    end\n  end\nend\n",
          "source_location": {
            "line": 41,
            "ref": "../elasticsearch-inspec/controls/audit+ad+ldap+pki/V-26731.rb"
          },
          "results": [
            {
              "status": "passed",
              "code_desc": "Authentication methods includes AD, LDAP or PKI for Node: package-centos-72 should equal true",
              "run_time": 0.000107,
              "start_time": "2018-02-11 14:26:38 -0500"
            },
            {
              "status": "passed",
              "code_desc": "PKI Settings for Node: package-centos-72 order should not be nil",
              "run_time": 0.000069,
              "start_time": "2018-02-11 14:26:38 -0500"
            },
            {
              "status": "passed",
              "code_desc": "PKI Settings for Node: package-centos-72 username_pattern should not be nil",
              "run_time": 0.000062,
              "start_time": "2018-02-11 14:26:38 -0500"
            },
            {
              "status": "passed",
              "code_desc": "Audit Settings for Node: package-centos-72 enabled should eq \"true\"",
              "run_time": 0.00008,
              "start_time": "2018-02-11 14:26:38 -0500"
            },
            {
              "status": "passed",
              "code_desc": "Audit Settings for Node: package-centos-72 outputs should include \"logfile\"",
              "run_time": 0.000108,
              "start_time": "2018-02-11 14:26:38 -0500"
            },
            {
              "status": "passed",
              "code_desc": "Audit Settings from ES_CONF_YML [\"xpack.security.audit.enabled\"] should eq true",
              "run_time": 0.00053,
              "start_time": "2018-02-11 14:26:38 -0500"
            },
            {
              "status": "passed",
              "code_desc": "Audit Settings from ES_CONF_YML [\"xpack.security.audit.outputs\"] should include \"logfile\"",
              "run_time": 0.000535,
              "start_time": "2018-02-11 14:26:38 -0500"
            }
          ]
        },
        {
          "id": "V-26676",
          "title": "The application must dynamically reconfigure security attributes in\naccordance with an identified security policy as information is created and\ncombined.",
          "desc": "Applicable - does not meet - not configurable, and does not meet the\nrequirement.",
          "impact": 0.5,
          "refs": [],
          "tags": {
            "nist": [
              "AC-16 (1)",
              "Rev_4"
            ],
            "severity": "medium",
            "rid": "SV-33847r1_rule",
            "gtitle": "SRG-APP-000009",
            "cci": "CCI-001424",
            "check": "Elasticsearch cannot support this requirement without \n  assistance from an external application, policy, or service.",
            "fix": "As appropriate, grant Role Based Access Control for \n  organizational users, non-organizational users, and anonymous users."
          },
          "code": "control \"V-26676\" do\n  title \"The application must dynamically reconfigure security attributes in\naccordance with an identified security policy as information is created and\ncombined.\"\n  desc  \"Applicable - does not meet - not configurable, and does not meet the\nrequirement.\"\n  impact 0.5\n  tag \"nist\": [\"AC-16 (1)\", \"Rev_4\"]\n  tag \"severity\": \"medium\"\n  tag \"rid\": \"SV-33847r1_rule\"\n  tag \"gtitle\": \"SRG-APP-000009\"\n  tag \"cci\": \"CCI-001424\"\n  tag \"check\": \"Elasticsearch cannot support this requirement without \n  assistance from an external application, policy, or service.\"\n  tag \"fix\": \"As appropriate, grant Role Based Access Control for \n  organizational users, non-organizational users, and anonymous users.\"\n\n  only_if do\n    false\n  end\nend\n",
          "source_location": {
            "line": 5,
            "ref": "../elasticsearch-inspec/controls/not configurable/V-26676.rb"
          },
          "results": [
            {
              "status": "skipped",
              "code_desc": "Operating System Detection",
              "run_time": 0.000006,
              "start_time": "2018-02-11 14:26:38 -0500",
              "resource": "Operating System Detection",
              "skip_message": "Skipped control due to only_if condition."
            }
          ]
        },
        {
          "id": "V-26737",
          "title": "The application must enforce dual authorization, based on\norganizational policies and procedures for organizational-defined privileged\ncommands.",
          "desc": "Applicable - does not meet - not configurable, and does not meet the\nrequirement.",
          "impact": 0.5,
          "refs": [],
          "tags": {
            "nist": [
              "AC-3 (2)",
              "Rev_4"
            ],
            "severity": "medium",
            "rid": "SV-33985r1_rule",
            "gtitle": "SRG-APP-000034",
            "cci": "CCI-000021",
            "check": "Elasticsearch cannot support this requirement without\nassistance from an external application, policy, or service.",
            "fix": "Implement a Custom Realm within X-Pack security.\n\nSee the official documentation for the instructions on custom realms:\nhttps://www.elastic.co/guide/en/x-pack/current/custom-realms.html#implementing-custom-realm"
          },
          "code": "control \"V-26737\" do\n  title \"The application must enforce dual authorization, based on\norganizational policies and procedures for organizational-defined privileged\ncommands.\"\n  desc  \"Applicable - does not meet - not configurable, and does not meet the\nrequirement.\"\n  impact 0.5\n  tag \"nist\": [\"AC-3 (2)\", \"Rev_4\"]\n  tag \"severity\": \"medium\"\n  tag \"rid\": \"SV-33985r1_rule\"\n  tag \"gtitle\": \"SRG-APP-000034\"\n  tag \"cci\": \"CCI-000021\"\n  tag \"check\": \"Elasticsearch cannot support this requirement without\nassistance from an external application, policy, or service.\"\n  tag \"fix\": \"Implement a Custom Realm within X-Pack security.\n\nSee the official documentation for the instructions on custom realms:\nhttps://www.elastic.co/guide/en/x-pack/current/custom-realms.html#implementing-custom-realm\"\n\n  only_if do\n    false\n  end\nend\n",
          "source_location": {
            "line": 5,
            "ref": "../elasticsearch-inspec/controls/not configurable/V-26737.rb"
          },
          "results": [
            {
              "status": "skipped",
              "code_desc": "Operating System Detection",
              "run_time": 0.000004,
              "start_time": "2018-02-11 14:26:38 -0500",
              "resource": "Operating System Detection",
              "skip_message": "Skipped control due to only_if condition."
            }
          ]
        },
        {
          "id": "V-27137",
          "title": "Applications utilized for integrity verification must detect\nunauthorized changes to software and information.",
          "desc": "Applicable - does not meet - not configurable, and does not meet the\nrequirement.",
          "impact": 0.5,
          "refs": [],
          "tags": {
            "nist": [
              "SI-7",
              "Rev_3"
            ],
            "severity": "medium",
            "rid": "SV-34436r1_rule",
            "gtitle": "SRG-APP-000262",
            "cci": "CCI-001297",
            "check": "Elasticsearch cannot support this requirement without\nassistance from an external application, policy, or service.",
            "fix": "Install the AIDE package with the command:\n\n$ sudo yum install aide"
          },
          "code": "control \"V-27137\" do\n  title \"Applications utilized for integrity verification must detect\nunauthorized changes to software and information.\"\n  desc  \"Applicable - does not meet - not configurable, and does not meet the\nrequirement.\"\n  impact 0.5\n  tag \"nist\": [\"SI-7\", \"Rev_3\"]\n  tag \"severity\": \"medium\"\n  tag \"rid\": \"SV-34436r1_rule\"\n  tag \"gtitle\": \"SRG-APP-000262\"\n  tag \"cci\": \"CCI-001297\"\n  tag \"check\": \"Elasticsearch cannot support this requirement without\nassistance from an external application, policy, or service.\"\n  tag \"fix\": \"The AIDE package can be installed to be available for integrity\nchecking.\n\nRun the following command to determine if the aide package is installed:\n\n$ rpm -q aide\n\nIf the package is not installed, this is a finding.\"\n  tag \"fix\": \"Install the AIDE package with the command:\n\n$ sudo yum install aide\"\n\n  begin\n    describe command('aide') do\n      it { should exist}\n    end\n\n  rescue Exception => msg\n    describe \"Exception: #{msg}\" do\n      it { should be_nil}\n    end\n  end\n\nend\n",
          "source_location": {
            "line": 5,
            "ref": "../elasticsearch-inspec/controls/not configurable/V-27137.rb"
          },
          "results": [
            {
              "status": "failed",
              "code_desc": "Command aide should exist",
              "run_time": 0.016484,
              "start_time": "2018-02-11 14:26:38 -0500"
            }
          ]
        },
        {
          "id": "V-27166",
          "title": "The application must have the capability to produce audit records on\nhardware-enforced, write-once media.",
          "desc": "Applicable - does not meet - not configurable, and does not meet the\nrequirement.",
          "impact": 0.5,
          "refs": [],
          "tags": {
            "nist": [
              "AU-9 (1)",
              "Rev_4"
            ],
            "severity": "medium",
            "rid": "SV-34465r1_rule",
            "gtitle": "SRG-APP-000124",
            "cci": "CCI-000165",
            "check": "Elasticsearch cannot support this requirement without\nassistance from an external application, policy, or service.",
            "fix": "Do not expose Elasticsearch directly to users, instead have an\napplication make requests on behalf of users."
          },
          "code": "control \"V-27166\" do\n  title \"The application must have the capability to produce audit records on\nhardware-enforced, write-once media.\"\n  desc  \"Applicable - does not meet - not configurable, and does not meet the\nrequirement.\"\n  impact 0.5\n  tag \"nist\": [\"AU-9 (1)\", \"Rev_4\"]\n  tag \"severity\": \"medium\"\n  tag \"rid\": \"SV-34465r1_rule\"\n  tag \"gtitle\": \"SRG-APP-000124\"\n  tag \"cci\": \"CCI-000165\"\n  tag \"check\": \"Elasticsearch cannot support this requirement without\nassistance from an external application, policy, or service.\"\n  tag \"fix\": \"Do not expose Elasticsearch directly to users, instead have an\napplication make requests on behalf of users.\"\n\n  only_if do\n    false\n  end\nend",
          "source_location": {
            "line": 5,
            "ref": "../elasticsearch-inspec/controls/not configurable/V-27166.rb"
          },
          "results": [
            {
              "status": "skipped",
              "code_desc": "Operating System Detection",
              "run_time": 0.000005,
              "start_time": "2018-02-11 14:26:38 -0500",
              "resource": "Operating System Detection",
              "skip_message": "Skipped control due to only_if condition."
            }
          ]
        },
        {
          "id": "V-27179",
          "title": "The application must prevent the presentation of information system\nmanagement-related functionality at an interface utilized by general (i.e.,\nnon-privileged) users.",
          "desc": "Applicable - does not meet - not configurable, and does not meet the\nrequirement.",
          "impact": 0.5,
          "refs": [],
          "tags": {
            "nist": [
              "SC-2 (1)",
              "Rev_4"
            ],
            "severity": "medium",
            "rid": "SV-34478r1_rule",
            "gtitle": "SRG-APP-000212",
            "cci": "CCI-001083",
            "check": "Elasticsearch cannot support this requirement without\nassistance from an external application, policy, or service.",
            "fix": "Do not expose Elasticsearch directly to users, instead have an\napplication make requests on behalf of users. If this is not possible, have an\napplication to sanitize requests and responses from and to users.\n\nSeparate the access point and accounts used to administer Elasticsearch by\nconfiguring different user interfaces and issuing separate administrative\naccounts for the use of administrators taking administrative actions. Prevent\nAdministrative interfaces and accounts should not be used for\nnon-administrative actions by using X-Pack's RBAC to enforce separation of\nduties. Audit and alert on the actions of administrator accounts to assure they\nare not being used for non-administrative action."
          },
          "code": "control \"V-27179\" do\n  title \"The application must prevent the presentation of information system\nmanagement-related functionality at an interface utilized by general (i.e.,\nnon-privileged) users.\"\n  desc  \"Applicable - does not meet - not configurable, and does not meet the\nrequirement.\"\n  impact 0.5\n  tag \"nist\": [\"SC-2 (1)\", \"Rev_4\"]\n  tag \"severity\": \"medium\"\n  tag \"rid\": \"SV-34478r1_rule\"\n  tag \"gtitle\": \"SRG-APP-000212\"\n  tag \"cci\": \"CCI-001083\"\n  tag \"check\": \"Elasticsearch cannot support this requirement without\nassistance from an external application, policy, or service.\"\n  tag \"fix\": \"Do not expose Elasticsearch directly to users, instead have an\napplication make requests on behalf of users. If this is not possible, have an\napplication to sanitize requests and responses from and to users.\n\nSeparate the access point and accounts used to administer Elasticsearch by\nconfiguring different user interfaces and issuing separate administrative\naccounts for the use of administrators taking administrative actions. Prevent\nAdministrative interfaces and accounts should not be used for\nnon-administrative actions by using X-Pack's RBAC to enforce separation of\nduties. Audit and alert on the actions of administrator accounts to assure they\nare not being used for non-administrative action.\"\n\n  only_if do\n    false\n  end\nend\n",
          "source_location": {
            "line": 5,
            "ref": "../elasticsearch-inspec/controls/not configurable/V-27179.rb"
          },
          "results": [
            {
              "status": "skipped",
              "code_desc": "Operating System Detection",
              "run_time": 0.000004,
              "start_time": "2018-02-11 14:26:38 -0500",
              "resource": "Operating System Detection",
              "skip_message": "Skipped control due to only_if condition."
            }
          ]
        },
        {
          "id": "V-27178",
          "title": "The application must separate user functionality (including user\ninterface services) from information system management functionality.",
          "desc": "Applicable - does not meet - not configurable, and does not meet the\nrequirement.",
          "impact": 0.5,
          "refs": [],
          "tags": {
            "nist": [
              "SC-2",
              "Rev_4"
            ],
            "severity": "medium",
            "rid": "SV-34477r1_rule",
            "gtitle": "SRG-APP-000211",
            "cci": "CCI-001082",
            "check": "Elasticsearch cannot support this requirement without\nassistance from an external application, policy, or service.",
            "fix": "Integrating a Proxy or API gateway in front of elasticsearch REST\nAPI will allow you to separate user functions from system management functions.\n\n\nThis is different than Access to the system management functions, as the access\ncan be controlled by X-Pack Role based Access Controls."
          },
          "code": "control \"V-27178\" do\n  title \"The application must separate user functionality (including user\ninterface services) from information system management functionality.\"\n  desc  \"Applicable - does not meet - not configurable, and does not meet the\nrequirement.\"\n  impact 0.5\n  tag \"nist\": [\"SC-2\", \"Rev_4\"]\n  tag \"severity\": \"medium\"\n  tag \"rid\": \"SV-34477r1_rule\"\n  tag \"gtitle\": \"SRG-APP-000211\"\n  tag \"cci\": \"CCI-001082\"\n  tag \"check\": \"Elasticsearch cannot support this requirement without\nassistance from an external application, policy, or service.\"\n  tag \"fix\": \"Integrating a Proxy or API gateway in front of elasticsearch REST\nAPI will allow you to separate user functions from system management functions.\n\n\nThis is different than Access to the system management functions, as the access\ncan be controlled by X-Pack Role based Access Controls.\"\n\n  only_if do\n    false\n  end\nend\n",
          "source_location": {
            "line": 5,
            "ref": "../elasticsearch-inspec/controls/not configurable/V-27178.rb"
          },
          "results": [
            {
              "status": "skipped",
              "code_desc": "Operating System Detection",
              "run_time": 0.000003,
              "start_time": "2018-02-11 14:26:38 -0500",
              "resource": "Operating System Detection",
              "skip_message": "Skipped control due to only_if condition."
            }
          ]
        },
        {
          "id": "V-26929",
          "title": "The application must protect audit data records and integrity by using\ncryptographic mechanisms.",
          "desc": "Applicable - does not meet - not configurable, and does not meet the\nrequirement.",
          "impact": 0.5,
          "refs": [],
          "tags": {
            "nist": [
              "AU-9 (3)",
              "Rev_4"
            ],
            "severity": "medium",
            "rid": "SV-34209r1_rule",
            "gtitle": "SRG-APP-000126",
            "cci": "CCI-001350",
            "check": "Elasticsearch cannot support this requirement without\nassistance from an external application, policy, or service.",
            "fix": "Perform computation and application of a cryptographic-signed\nhash using asymmetric cryptography on audit records. "
          },
          "code": "control \"V-26929\" do\n  title \"The application must protect audit data records and integrity by using\ncryptographic mechanisms.\"\n  desc  \"Applicable - does not meet - not configurable, and does not meet the\nrequirement.\"\n  impact 0.5\n  tag \"nist\": [\"AU-9 (3)\", \"Rev_4\"]\n  tag \"severity\": \"medium\"\n  tag \"rid\": \"SV-34209r1_rule\"\n  tag \"gtitle\": \"SRG-APP-000126\"\n  tag \"cci\": \"CCI-001350\"\n  tag \"check\": \"Elasticsearch cannot support this requirement without\nassistance from an external application, policy, or service.\"\n  tag \"fix\": \"Perform computation and application of a cryptographic-signed\nhash using asymmetric cryptography on audit records. \"\n\n  only_if do\n    false\n  end\nend\n",
          "source_location": {
            "line": 5,
            "ref": "../elasticsearch-inspec/controls/not configurable/V-26929.rb"
          },
          "results": [
            {
              "status": "skipped",
              "code_desc": "Operating System Detection",
              "run_time": 0.000004,
              "start_time": "2018-02-11 14:26:38 -0500",
              "resource": "Operating System Detection",
              "skip_message": "Skipped control due to only_if condition."
            }
          ]
        },
        {
          "id": "V-26943",
          "title": "Applications must prevent the installation of organizational-defined\ncritical software programs not signed with a certificate that has been\nrecognized and approved by the organizational.",
          "desc": "Elastic components should be installed from approved and controlled\ncopies of the software only.  The binary hashes of the approved software (down\nto the patch level) should be routinely check according to the policies of the\norganizational.",
          "impact": 0.5,
          "refs": [],
          "tags": {
            "nist": [
              "CM-5 (3)",
              "Rev_3"
            ],
            "severity": "medium",
            "rid": "SV-34224r1_rule",
            "gtitle": "SRG-APP-000131",
            "cci": "CCI-000352",
            "check": "Elasticsearch, Inc. signs all of packages with the\nElasticsearch Signing Key (PGP key D88E42B4, available from\nhttps://pgp.mit.edu) with fingerprint:\n\n4609 5ACC 8548 582C 1A26 99A9 D27D 666C D88E 42B4\n\nAs the system owner, download and install the public signing key and verify the\npackage:\n\nrpm --import https://artifacts.elastic.co/GPG-KEY-elasticsearch\nrpm -K elasticsearch\n\nReview the response, if it does not respond with md5 gpg OK, this is a finding.",
            "fix": "Elastic components should be installed from approved and\ncontrolled copies of the software only.\n\nSee the official documentation for RPM installation at:\nhttps://www.elastic.co/guide/en/elasticsearch/reference/current/rpm.html"
          },
          "code": "control \"V-26943\" do\n  title \"Applications must prevent the installation of organizational-defined\ncritical software programs not signed with a certificate that has been\nrecognized and approved by the organizational.\"\n  desc  \"Elastic components should be installed from approved and controlled\ncopies of the software only.  The binary hashes of the approved software (down\nto the patch level) should be routinely check according to the policies of the\norganizational.\"\n  impact 0.5\n  tag \"nist\": [\"CM-5 (3)\", \"Rev_3\"]\n  tag \"severity\": \"medium\"\n  tag \"rid\": \"SV-34224r1_rule\"\n  tag \"gtitle\": \"SRG-APP-000131\"\n  tag \"cci\": \"CCI-000352\"\n  tag \"check\": \"Elasticsearch, Inc. signs all of packages with the\nElasticsearch Signing Key (PGP key D88E42B4, available from\nhttps://pgp.mit.edu) with fingerprint:\n\n4609 5ACC 8548 582C 1A26 99A9 D27D 666C D88E 42B4\n\nAs the system owner, download and install the public signing key and verify the\npackage:\n\nrpm --import https://artifacts.elastic.co/GPG-KEY-elasticsearch\nrpm -K elasticsearch\n\nReview the response, if it does not respond with md5 gpg OK, this is a finding.\"\n  tag \"fix\": \"Elastic components should be installed from approved and\ncontrolled copies of the software only.\n\nSee the official documentation for RPM installation at:\nhttps://www.elastic.co/guide/en/elasticsearch/reference/current/rpm.html\"\nend\n",
          "source_location": {
            "line": 1,
            "ref": "../elasticsearch-inspec/controls/not configurable/V-26943.rb"
          },
          "results": []
        },
        {
          "id": "V-26664",
          "title": "The application must be able to define the maximum number of\nconcurrent sessions for an application account globally, by account type, by\naccount, or a combination thereof. ",
          "desc": "Applicable - does not meet - not configurable, and does not meet the\nrequirement.",
          "impact": 0.5,
          "refs": [],
          "tags": {
            "nist": [
              "AC-10",
              "Rev_4"
            ],
            "severity": "medium",
            "rid": "SV-33786r1_rule",
            "gtitle": "SRG-APP-000001",
            "cci": "CCI-000054",
            "check": "Elasticsearch cannot support this requirement without\nassistance from an external application, policy, or service.",
            "fix": "Do not expose Elasticsearch directly to users, instead have an\napplication make requests on behalf of users.\n\nLimit the number of connections from clients (connection pool size) in the\nclient's initialization settings to limit the impact of Denial of Service\nattacks. Connection pools are shared amongst API calls from different users as\nthere is no session concept within Elasticsearch."
          },
          "code": "control \"V-26664\" do\n  title \"The application must be able to define the maximum number of\nconcurrent sessions for an application account globally, by account type, by\naccount, or a combination thereof. \"\n  desc  \"Applicable - does not meet - not configurable, and does not meet the\nrequirement.\"\n  impact 0.5\n  tag \"nist\": [\"AC-10\", \"Rev_4\"]\n  tag \"severity\": \"medium\"\n  tag \"rid\": \"SV-33786r1_rule\"\n  tag \"gtitle\": \"SRG-APP-000001\"\n  tag \"cci\": \"CCI-000054\"\n  tag \"check\": \"Elasticsearch cannot support this requirement without\nassistance from an external application, policy, or service.\"\n  tag \"fix\": \"Do not expose Elasticsearch directly to users, instead have an\napplication make requests on behalf of users.\n\nLimit the number of connections from clients (connection pool size) in the\nclient's initialization settings to limit the impact of Denial of Service\nattacks. Connection pools are shared amongst API calls from different users as\nthere is no session concept within Elasticsearch.\"\n\n  only_if do\n    false\n  end\nend\n",
          "source_location": {
            "line": 5,
            "ref": "../elasticsearch-inspec/controls/not configurable/V-26664.rb"
          },
          "results": [
            {
              "status": "skipped",
              "code_desc": "Operating System Detection",
              "run_time": 0.000003,
              "start_time": "2018-02-11 14:26:38 -0500",
              "resource": "Operating System Detection",
              "skip_message": "Skipped control due to only_if condition."
            }
          ]
        },
        {
          "id": "V-30589",
          "title": "The application must use cryptographic mechanisms to protect the\nintegrity of audit tools.",
          "desc": "Applicable - does not meet - not configurable, and does not meet the\nrequirement.",
          "impact": 0.5,
          "refs": [],
          "tags": {
            "nist": [
              "AU-9 (3)",
              "Rev_4"
            ],
            "severity": "medium",
            "rid": "SV-40333r1_rule",
            "gtitle": "SRG-APP-000290",
            "cci": "CCI-001496",
            "check": "Elasticsearch cannot support this requirement without\nassistance from an external application, policy, or service.",
            "fix": "Although the application cannot fulfill a crypytological\nmechanism for protection, there are a number of protects that can be put in\nplace. Utilize Elasticsearch Signing Key (PGP key D88E42B4, available from\nhttps://pgp.mit.edu) and create rules for auditd on elasticsearch.yml file."
          },
          "code": "control \"V-30589\" do\n  title \"The application must use cryptographic mechanisms to protect the\nintegrity of audit tools.\"\n  desc  \"Applicable - does not meet - not configurable, and does not meet the\nrequirement.\"\n  impact 0.5\n  tag \"nist\": [\"AU-9 (3)\", \"Rev_4\"]\n  tag \"severity\": \"medium\"\n  tag \"rid\": \"SV-40333r1_rule\"\n  tag \"gtitle\": \"SRG-APP-000290\"\n  tag \"cci\": \"CCI-001496\"\n  tag \"check\": \"Elasticsearch cannot support this requirement without\nassistance from an external application, policy, or service.\"\n  tag \"fix\": \"Although the application cannot fulfill a crypytological\nmechanism for protection, there are a number of protects that can be put in\nplace. Utilize Elasticsearch Signing Key (PGP key D88E42B4, available from\nhttps://pgp.mit.edu) and create rules for auditd on elasticsearch.yml file.\"\n\n  only_if do\n    false\n  end\nend\n",
          "source_location": {
            "line": 5,
            "ref": "../elasticsearch-inspec/controls/not configurable/V-30589.rb"
          },
          "results": [
            {
              "status": "skipped",
              "code_desc": "Operating System Detection",
              "run_time": 0.000003,
              "start_time": "2018-02-11 14:26:38 -0500",
              "resource": "Operating System Detection",
              "skip_message": "Skipped control due to only_if condition."
            }
          ]
        },
        {
          "id": "V-26932",
          "title": "The application must obscure feedback of authentication information\nduring the authentication process to protect the information from possible\nexploitation/use by unauthorized individuals.",
          "desc": "Applicable - does not meet - not configurable, and does not meet the\nrequirement.",
          "impact": 0.5,
          "refs": [],
          "tags": {
            "nist": [
              "IA-6",
              "Rev_4"
            ],
            "severity": "medium",
            "rid": "SV-34212r1_rule",
            "gtitle": "SRG-APP-000178",
            "cci": "CCI-000206",
            "check": "Elasticsearch cannot support this requirement without\nassistance from an external application, policy, or service.",
            "fix": "Do not expose Elasticsearch directly to users, instead have an\napplication make requests on behalf of users. If this is not possible, have an\napplication to sanitize requests and responses from and to users."
          },
          "code": "control \"V-26932\" do\n  title \"The application must obscure feedback of authentication information\nduring the authentication process to protect the information from possible\nexploitation/use by unauthorized individuals.\"\n  desc  \"Applicable - does not meet - not configurable, and does not meet the\nrequirement.\"\n  impact 0.5\n  tag \"nist\": [\"IA-6\", \"Rev_4\"]\n  tag \"severity\": \"medium\"\n  tag \"rid\": \"SV-34212r1_rule\"\n  tag \"gtitle\": \"SRG-APP-000178\"\n  tag \"cci\": \"CCI-000206\"\n  tag \"check\": \"Elasticsearch cannot support this requirement without\nassistance from an external application, policy, or service.\"\n  tag \"fix\": \"Do not expose Elasticsearch directly to users, instead have an\napplication make requests on behalf of users. If this is not possible, have an\napplication to sanitize requests and responses from and to users.\"\n\n  only_if do\n    false\n  end\nend\n",
          "source_location": {
            "line": 5,
            "ref": "../elasticsearch-inspec/controls/not configurable/V-26932.rb"
          },
          "results": [
            {
              "status": "skipped",
              "code_desc": "Operating System Detection",
              "run_time": 0.000003,
              "start_time": "2018-02-11 14:26:38 -0500",
              "resource": "Operating System Detection",
              "skip_message": "Skipped control due to only_if condition."
            }
          ]
        },
        {
          "id": "V-26917",
          "title": "The application must enforce configurable traffic volume thresholds\nrepresenting auditing capacity for network traffic.",
          "desc": "Applicable - does not meet - not configurable, and does not meet the\nrequirement.",
          "impact": 0.5,
          "refs": [],
          "tags": {
            "nist": [
              "AU-5 (3)",
              "Rev_4"
            ],
            "severity": "medium",
            "rid": "SV-34197r1_rule",
            "gtitle": "SRG-APP-000105",
            "cci": "CCI-000145",
            "check": "Elasticsearch cannot support this requirement without\nassistance from an external application, policy, or service.",
            "fix": "Integrate network traffic control solutions outside of\nelasticsearch.  Monitor the health and resources (such as remaining storage) of\nsystems running Elasticsearch software and notify operators when safety\nthresholds have been exceeded. "
          },
          "code": "control \"V-26917\" do\n  title \"The application must enforce configurable traffic volume thresholds\nrepresenting auditing capacity for network traffic.\"\n  desc  \"Applicable - does not meet - not configurable, and does not meet the\nrequirement.\"\n  impact 0.5\n  tag \"nist\": [\"AU-5 (3)\", \"Rev_4\"]\n  tag \"severity\": \"medium\"\n  tag \"rid\": \"SV-34197r1_rule\"\n  tag \"gtitle\": \"SRG-APP-000105\"\n  tag \"cci\": \"CCI-000145\"\n  tag \"check\": \"Elasticsearch cannot support this requirement without\nassistance from an external application, policy, or service.\"\n  tag \"fix\": \"Integrate network traffic control solutions outside of\nelasticsearch.  Monitor the health and resources (such as remaining storage) of\nsystems running Elasticsearch software and notify operators when safety\nthresholds have been exceeded. \"\n\n  only_if do\n    false\n  end\nend\n",
          "source_location": {
            "line": 5,
            "ref": "../elasticsearch-inspec/controls/not configurable/V-26917.rb"
          },
          "results": [
            {
              "status": "skipped",
              "code_desc": "Operating System Detection",
              "run_time": 0.000003,
              "start_time": "2018-02-11 14:26:38 -0500",
              "resource": "Operating System Detection",
              "skip_message": "Skipped control due to only_if condition."
            }
          ]
        },
        {
          "id": "V-27105",
          "title": "The application must support taking organizational-defined list of\nleast-disruptive actions to terminate suspicious events.",
          "desc": "Applicable - does not meet - not configurable, and does not meet the\nrequirement.",
          "impact": 0.5,
          "refs": [],
          "tags": {
            "nist": [
              "SI-4 (7)",
              "Rev_4"
            ],
            "severity": "medium",
            "rid": "SV-34400r1_rule",
            "gtitle": "SRG-APP-000287",
            "cci": "CCI-001670",
            "check": "Elasticsearch cannot support this requirement without\nassistance from an external application, policy, or service.",
            "fix": "Do not expose Elasticsearch directly to users, instead have an\napplication make requests on behalf of users."
          },
          "code": "control \"V-27105\" do\n  title \"The application must support taking organizational-defined list of\nleast-disruptive actions to terminate suspicious events.\"\n  desc  \"Applicable - does not meet - not configurable, and does not meet the\nrequirement.\"\n  impact 0.5\n  tag \"nist\": [\"SI-4 (7)\", \"Rev_4\"]\n  tag \"severity\": \"medium\"\n  tag \"rid\": \"SV-34400r1_rule\"\n  tag \"gtitle\": \"SRG-APP-000287\"\n  tag \"cci\": \"CCI-001670\"\n  tag \"check\": \"Elasticsearch cannot support this requirement without\nassistance from an external application, policy, or service.\"\n  tag \"fix\": \"Do not expose Elasticsearch directly to users, instead have an\napplication make requests on behalf of users.\"\n\n  only_if do\n    false\n  end\nend\n",
          "source_location": {
            "line": 5,
            "ref": "../elasticsearch-inspec/controls/not configurable/V-27105.rb"
          },
          "results": [
            {
              "status": "skipped",
              "code_desc": "Operating System Detection",
              "run_time": 0.000003,
              "start_time": "2018-02-11 14:26:38 -0500",
              "resource": "Operating System Detection",
              "skip_message": "Skipped control due to only_if condition."
            }
          ]
        },
        {
          "id": "V-27065",
          "title": "The application must only generate error messages that provide\ninformation necessary for corrective actions without revealing\norganizational-defined sensitive or potentially harmful information in error\nlogs and administrative messages that could be exploited.",
          "desc": "Applicable - does not meet - not configurable, and does not meet the\nrequirement.",
          "impact": 0.5,
          "refs": [],
          "tags": {
            "nist": [
              "SI-11 a",
              "Rev_4"
            ],
            "severity": "medium",
            "rid": "SV-34360r1_rule",
            "gtitle": "SRG-APP-000266",
            "cci": "CCI-001312",
            "check": "Elasticsearch cannot support this requirement without\nassistance from an external application, policy, or service.",
            "fix": "Do not expose Elasticsearch directly to users, instead have an\napplication make requests on behalf of users. If this is not possible, have an\napplication to sanitize requests and responses from and to users.  Limit the\naccess of users and administrators to error logs and verbatim error log\nmessages whether it be in application provided user interfaces or the actual\nElasticsearch error log. Ensure production has an appropriate logging\ninformation level and is not set to a level left over from development. Secure\nerror logs with OS level protections."
          },
          "code": "control \"V-27065\" do\n  title \"The application must only generate error messages that provide\ninformation necessary for corrective actions without revealing\norganizational-defined sensitive or potentially harmful information in error\nlogs and administrative messages that could be exploited.\"\n  desc  \"Applicable - does not meet - not configurable, and does not meet the\nrequirement.\"\n  impact 0.5\n  tag \"nist\": [\"SI-11 a\", \"Rev_4\"]\n  tag \"severity\": \"medium\"\n  tag \"rid\": \"SV-34360r1_rule\"\n  tag \"gtitle\": \"SRG-APP-000266\"\n  tag \"cci\": \"CCI-001312\"\n  tag \"check\": \"Elasticsearch cannot support this requirement without\nassistance from an external application, policy, or service.\"\n  tag \"fix\": \"Do not expose Elasticsearch directly to users, instead have an\napplication make requests on behalf of users. If this is not possible, have an\napplication to sanitize requests and responses from and to users.  Limit the\naccess of users and administrators to error logs and verbatim error log\nmessages whether it be in application provided user interfaces or the actual\nElasticsearch error log. Ensure production has an appropriate logging\ninformation level and is not set to a level left over from development. Secure\nerror logs with OS level protections.\"\n\n  only_if do\n    false\n  end\nend\n",
          "source_location": {
            "line": 5,
            "ref": "../elasticsearch-inspec/controls/not configurable/V-27065.rb"
          },
          "results": [
            {
              "status": "skipped",
              "code_desc": "Operating System Detection",
              "run_time": 0.000003,
              "start_time": "2018-02-11 14:26:38 -0500",
              "resource": "Operating System Detection",
              "skip_message": "Skipped control due to only_if condition."
            }
          ]
        },
        {
          "id": "V-27153",
          "title": "Applications must employ NSA-approved cryptography to protect\nclassified information.",
          "desc": "Configure X-Pack Security to use an organizational approved FIPS 140-2\njava cryptography provider.",
          "impact": 0.5,
          "refs": [],
          "tags": {
            "nist": [
              "SC-13 (2)",
              "Rev_3"
            ],
            "severity": "medium",
            "rid": "SV-34452r1_rule",
            "gtitle": "SRG-APP-000198",
            "cci": "CCI-001146",
            "check": "Application must utilize approved cryptography to protect\nclassified information.\n\nAs the application administrator (usually elasticsearch), check the xpack.ssl\nsettings are set to the correct values.\n\n$cat elasticsearch.yml | grep xpack.ssl\n\nxpack.ssl.key:                     <server_key>.key\nxpack.ssl.certificate:             <server_certificate>.crt\nxpack.ssl.certificate_authorities: [ <approved_ca>.crt' ]\n\nIf these setting are not set or the underlying certificate and keys are not\ncorrect, this is a finding.\n\n$cat elasticsearch.yml | grep xpack.ssl.cipher_suites:\n\nIf this setting is not present, or not set to FIPS-validated or NSA-approved\ncryptography, this is a finding.\n\nAs a elasticsearch user, check that non-secure http traffic does not response\nwith 200 status:\n\n$curl -H 'Content-Type: application/json' -u <TEST_USER> -p <TEST_CREDENTIALS>\nhttp://<elasticsearchIP:9200>/\n\nIf a 200 response comes back, this is a finding.",
            "fix": "Employ approved cryptography to protect classified information.\n\n\nSee the official documentation for the complete  guide on establishing SSL\nconfiguration: https://www.elastic.co/guide/en/x-pack/current/ssl-tls.html"
          },
          "code": "control \"V-27153\" do\n  title \"Applications must employ NSA-approved cryptography to protect\nclassified information.\"\n  desc  \"Configure X-Pack Security to use an organizational approved FIPS 140-2\njava cryptography provider.\"\n  impact 0.5\n  tag \"nist\": [\"SC-13 (2)\", \"Rev_3\"]\n  tag \"severity\": \"medium\"\n  tag \"rid\": \"SV-34452r1_rule\"\n  tag \"gtitle\": \"SRG-APP-000198\"\n  tag \"cci\": \"CCI-001146\"\n  tag \"check\": \"Application must utilize approved cryptography to protect\nclassified information.\n\nAs the application administrator (usually elasticsearch), check the xpack.ssl\nsettings are set to the correct values.\n\n$cat elasticsearch.yml | grep xpack.ssl\n\nxpack.ssl.key:                     <server_key>.key\nxpack.ssl.certificate:             <server_certificate>.crt\nxpack.ssl.certificate_authorities: [ <approved_ca>.crt' ]\n\nIf these setting are not set or the underlying certificate and keys are not\ncorrect, this is a finding.\n\n$cat elasticsearch.yml | grep xpack.ssl.cipher_suites:\n\nIf this setting is not present, or not set to FIPS-validated or NSA-approved\ncryptography, this is a finding.\n\nAs a elasticsearch user, check that non-secure http traffic does not response\nwith 200 status:\n\n$curl -H 'Content-Type: application/json' -u <TEST_USER> -p <TEST_CREDENTIALS>\nhttp://<elasticsearchIP:9200>/\n\nIf a 200 response comes back, this is a finding.\"\n  tag \"fix\": \"Employ approved cryptography to protect classified information.\n\n\nSee the official documentation for the complete  guide on establishing SSL\nconfiguration: https://www.elastic.co/guide/en/x-pack/current/ssl-tls.html\"\n\n\n  begin\n    es_conf = yaml(ELASTICSEARCH_CONF)\n\n    describe es_conf do\n      its(['xpack.ssl.key']) { should_not be_nil }\n      its(['xpack.ssl.certificate']) { should_not be_nil }\n      its(['xpack.ssl.certificate_authorities']) { should_not be_nil }\n      its(['xpack.ssl.cipher_suites']) { should match_array APPROVED_CIPHER_SUITES }\n    end\n\n    es_handle = es_helper(url:\"https://#{ELASTIC_IP}:#{ELASTIC_PORT}\",\n                    username: ES_ADMIN,\n                    password: ES_PASS,\n                    ssl_verify: SSL_VERIFY )\n\n    describe \"No nodes found\" do\n      subject { es_handle.nodes.nil? }\n      it { should_not be_truthy }\n    end if es_handle.nodes.nil?\n\n    es_handle.nodes.each do |node|\n      describe \"CIPHER_SUITES useed for Node: #{node.name}\" do\n        subject { node.cipher_suite }\n        it { should match_array APPROVED_CIPHER_SUITES }\n      end\n    end unless es_handle.nodes.nil?\n    \n    describe command(\"openssl rsa -in #{es_conf['xpack.ssl.key']} -check -noout\") do\n      its('stdout'){ should match /RSA key ok/ }\n    end\n\n    describe x509_certificate(es_conf['xpack.ssl.certificate']) do\n      it { should be_certificate }\n      it { should be_valid }\n    end\n\n    if es_conf['xpack.ssl.certificate_authorities'].is_a?(Array)\n      es_conf['xpack.ssl.certificate_authorities'].each do |cert|\n        describe x509_certificate(cert) do\n          it { should be_certificate }\n          it { should be_valid }\n        end\n      end\n    else\n      describe x509_certificate(es_conf['xpack.ssl.certificate_authorities']) do\n        it { should be_certificate }\n        it { should be_valid }\n      end\n    end\n\n    describe es_handle do \n      it { should_not have_http_access }\n    end\n\n  rescue Exception => msg\n    describe \"Exception: #{msg}\" do\n      it { should be_nil}\n    end\n  end\nend\n",
          "source_location": {
            "line": 55,
            "ref": "../elasticsearch-inspec/controls/certs+cipher_suites+http/V-27153.rb"
          },
          "results": [
            {
              "status": "passed",
              "code_desc": "YAML /etc/elasticsearch/elasticsearch.yml [\"xpack.ssl.key\"] should not be nil",
              "run_time": 0.000099,
              "start_time": "2018-02-11 14:26:38 -0500"
            },
            {
              "status": "passed",
              "code_desc": "YAML /etc/elasticsearch/elasticsearch.yml [\"xpack.ssl.certificate\"] should not be nil",
              "run_time": 0.000103,
              "start_time": "2018-02-11 14:26:38 -0500"
            },
            {
              "status": "passed",
              "code_desc": "YAML /etc/elasticsearch/elasticsearch.yml [\"xpack.ssl.certificate_authorities\"] should not be nil",
              "run_time": 0.000064,
              "start_time": "2018-02-11 14:26:38 -0500"
            },
            {
              "status": "passed",
              "code_desc": "YAML /etc/elasticsearch/elasticsearch.yml [\"xpack.ssl.cipher_suites\"] should contain exactly \"TLS_ECDHE_RSA_WITH_AES_128_CBC_SHA256\", \"TLS_ECDHE_ECDSA_WITH_AES_128_CBC_SHA256\", \"TLS_ECDHE_ECDSA_WITH_AES_128_CBC_SHA\", \"TLS_ECDHE_RSA_WITH_AES_128_CBC_SHA\", \"TLS_RSA_WITH_AES_128_CBC_SHA256\", and \"TLS_RSA_WITH_AES_128_CBC_SHA\"",
              "run_time": 0.003062,
              "start_time": "2018-02-11 14:26:38 -0500"
            },
            {
              "status": "passed",
              "code_desc": "CIPHER_SUITES useed for Node: package-centos-72 should contain exactly \"TLS_ECDHE_RSA_WITH_AES_128_CBC_SHA256\", \"TLS_ECDHE_ECDSA_WITH_AES_128_CBC_SHA256\", \"TLS_ECDHE_ECDSA_WITH_AES_128_CBC_SHA\", \"TLS_ECDHE_RSA_WITH_AES_128_CBC_SHA\", \"TLS_RSA_WITH_AES_128_CBC_SHA256\", and \"TLS_RSA_WITH_AES_128_CBC_SHA\"",
              "run_time": 0.000203,
              "start_time": "2018-02-11 14:26:38 -0500"
            },
            {
              "status": "passed",
              "code_desc": "Command openssl rsa -in /etc/elasticsearch/x-pack/elastic/elastic.key -check -noout stdout should match /RSA key ok/",
              "run_time": 0.020691,
              "start_time": "2018-02-11 14:26:38 -0500"
            },
            {
              "status": "passed",
              "code_desc": "x509_certificate /etc/elasticsearch/x-pack/elastic/elastic.crt should be certificate",
              "run_time": 0.000129,
              "start_time": "2018-02-11 14:26:38 -0500"
            },
            {
              "status": "passed",
              "code_desc": "x509_certificate /etc/elasticsearch/x-pack/elastic/elastic.crt should be valid",
              "run_time": 0.00008,
              "start_time": "2018-02-11 14:26:38 -0500"
            },
            {
              "status": "passed",
              "code_desc": "x509_certificate /etc/elasticsearch/x-pack/ca/ca.crt should be certificate",
              "run_time": 0.000062,
              "start_time": "2018-02-11 14:26:38 -0500"
            },
            {
              "status": "passed",
              "code_desc": "x509_certificate /etc/elasticsearch/x-pack/ca/ca.crt should be valid",
              "run_time": 0.000061,
              "start_time": "2018-02-11 14:26:38 -0500"
            },
            {
              "status": "passed",
              "code_desc": "Elasticsearch Cluster https://0.0.0.0:9200 should not have http access",
              "run_time": 0.021399,
              "start_time": "2018-02-11 14:26:38 -0500"
            }
          ]
        },
        {
          "id": "V-26935",
          "title": "The application must use mechanisms for authentication to a\ncryptographic module that meet the requirements of applicable federal laws,\nExecutive Orders, directives, policies, regulations, standards, and guidance\nfor such authentication.",
          "desc": "Configure X-Pack to use an organizational approved FIPS 140-2 java\ncryptography provider.",
          "impact": 0.5,
          "refs": [],
          "tags": {
            "nist": [
              "IA-7",
              "Rev_4"
            ],
            "severity": "medium",
            "rid": "SV-34215r1_rule",
            "gtitle": "SRG-APP-000179",
            "cci": "CCI-000803",
            "check": "Application must utilize approved cryptography that complying\nwith applicable federal laws, Executive Orders, directives, policies,\nregulations, standards, and guidance.\n\nAs the application administrator (usually elasticsearch), check the xpack.ssl\nsettings are set to the correct values.\n\n$cat elasticsearch.yml | grep xpack.ssl\n\nxpack.ssl.key:                     <server_key>.key\nxpack.ssl.certificate:             <server_certificate>.crt\nxpack.ssl.certificate_authorities: [ <approved_ca>.crt' ]\n\nIf these setting are not set or the underlying certificate and keys are not\ncorrect, this is a finding.\n\n$cat elasticsearch.yml | grep xpack.ssl.cipher_suites:\n\nIf this setting is not present, or not set to FIPS-validated or NSA-approved\ncryptography, this is a finding.\n\nAs a elasticsearch user, check that non-secure http traffic does not response\nwith 200 status:\n\n$curl -H 'Content-Type: application/json' -u <TEST_USER> -p <TEST_CREDENTIALS>\nhttp://<elasticsearchIP:9200>/\n\nIf a 200 response comes back, this is a finding.",
            "fix": "Employ approved cryptography that complying with applicable\nfederal laws, Executive Orders, directives, policies, regulations, standards,\nand guidance.\n\nSee the official documentation for the complete  guide on establishing SSL\nconfiguration: https://www.elastic.co/guide/en/x-pack/current/ssl-tls.html"
          },
          "code": "control \"V-26935\" do\n  title \"The application must use mechanisms for authentication to a\ncryptographic module that meet the requirements of applicable federal laws,\nExecutive Orders, directives, policies, regulations, standards, and guidance\nfor such authentication.\"\n  desc  \"Configure X-Pack to use an organizational approved FIPS 140-2 java\ncryptography provider.\"\n  impact 0.5\n  tag \"nist\": [\"IA-7\", \"Rev_4\"]\n  tag \"severity\": \"medium\"\n  tag \"rid\": \"SV-34215r1_rule\"\n  tag \"gtitle\": \"SRG-APP-000179\"\n  tag \"cci\": \"CCI-000803\"\n  tag \"check\": \"Application must utilize approved cryptography that complying\nwith applicable federal laws, Executive Orders, directives, policies,\nregulations, standards, and guidance.\n\nAs the application administrator (usually elasticsearch), check the xpack.ssl\nsettings are set to the correct values.\n\n$cat elasticsearch.yml | grep xpack.ssl\n\nxpack.ssl.key:                     <server_key>.key\nxpack.ssl.certificate:             <server_certificate>.crt\nxpack.ssl.certificate_authorities: [ <approved_ca>.crt' ]\n\nIf these setting are not set or the underlying certificate and keys are not\ncorrect, this is a finding.\n\n$cat elasticsearch.yml | grep xpack.ssl.cipher_suites:\n\nIf this setting is not present, or not set to FIPS-validated or NSA-approved\ncryptography, this is a finding.\n\nAs a elasticsearch user, check that non-secure http traffic does not response\nwith 200 status:\n\n$curl -H 'Content-Type: application/json' -u <TEST_USER> -p <TEST_CREDENTIALS>\nhttp://<elasticsearchIP:9200>/\n\nIf a 200 response comes back, this is a finding.\"\n  tag \"fix\": \"Employ approved cryptography that complying with applicable\nfederal laws, Executive Orders, directives, policies, regulations, standards,\nand guidance.\n\nSee the official documentation for the complete  guide on establishing SSL\nconfiguration: https://www.elastic.co/guide/en/x-pack/current/ssl-tls.html\"\n\n  begin\n    es_conf = yaml(ELASTICSEARCH_CONF)\n\n    describe es_conf do\n      its(['xpack.ssl.key']) { should_not be_nil }\n      its(['xpack.ssl.certificate']) { should_not be_nil }\n      its(['xpack.ssl.certificate_authorities']) { should_not be_nil }\n      its(['xpack.ssl.cipher_suites']) { should match_array APPROVED_CIPHER_SUITES }\n    end\n\n    es_handle = es_helper(url:\"https://#{ELASTIC_IP}:#{ELASTIC_PORT}\",\n                    username: ES_ADMIN,\n                    password: ES_PASS,\n                    ssl_verify: SSL_VERIFY )\n\n    describe \"No nodes found\" do\n      subject { es_handle.nodes.nil? }\n      it { should_not be_truthy }\n    end if es_handle.nodes.nil?\n\n    es_handle.nodes.each do |node|\n      describe \"CIPHER_SUITES useed for Node: #{node.name}\" do\n        subject { node.cipher_suite }\n        it { should match_array APPROVED_CIPHER_SUITES }\n      end\n    end unless es_handle.nodes.nil?\n\n    describe command(\"openssl rsa -in #{es_conf['xpack.ssl.key']} -check -noout\") do\n      its('stdout'){ should match /RSA key ok/ }\n    end\n\n    describe x509_certificate(es_conf['xpack.ssl.certificate']) do\n      it { should be_certificate }\n      it { should be_valid }\n    end\n\n    if es_conf['xpack.ssl.certificate_authorities'].is_a?(Array)\n      es_conf['xpack.ssl.certificate_authorities'].each do |cert|\n        describe x509_certificate(cert) do\n          it { should be_certificate }\n          it { should be_valid }\n        end\n      end\n    else\n      describe x509_certificate(es_conf['xpack.ssl.certificate_authorities']) do\n        it { should be_certificate }\n        it { should be_valid }\n      end\n    end\n\n    describe es_handle do \n      it { should_not have_http_access }\n    end\n\n  rescue Exception => msg\n    describe \"Exception: #{msg}\" do\n      it { should be_nil}\n    end\n  end\nend\n",
          "source_location": {
            "line": 54,
            "ref": "../elasticsearch-inspec/controls/certs+cipher_suites+http/V-26935.rb"
          },
          "results": [
            {
              "status": "passed",
              "code_desc": "YAML /etc/elasticsearch/elasticsearch.yml [\"xpack.ssl.key\"] should not be nil",
              "run_time": 0.00016,
              "start_time": "2018-02-11 14:26:38 -0500"
            },
            {
              "status": "passed",
              "code_desc": "YAML /etc/elasticsearch/elasticsearch.yml [\"xpack.ssl.certificate\"] should not be nil",
              "run_time": 0.000113,
              "start_time": "2018-02-11 14:26:38 -0500"
            },
            {
              "status": "passed",
              "code_desc": "YAML /etc/elasticsearch/elasticsearch.yml [\"xpack.ssl.certificate_authorities\"] should not be nil",
              "run_time": 0.000084,
              "start_time": "2018-02-11 14:26:38 -0500"
            },
            {
              "status": "passed",
              "code_desc": "YAML /etc/elasticsearch/elasticsearch.yml [\"xpack.ssl.cipher_suites\"] should contain exactly \"TLS_ECDHE_RSA_WITH_AES_128_CBC_SHA256\", \"TLS_ECDHE_ECDSA_WITH_AES_128_CBC_SHA256\", \"TLS_ECDHE_ECDSA_WITH_AES_128_CBC_SHA\", \"TLS_ECDHE_RSA_WITH_AES_128_CBC_SHA\", \"TLS_RSA_WITH_AES_128_CBC_SHA256\", and \"TLS_RSA_WITH_AES_128_CBC_SHA\"",
              "run_time": 0.000204,
              "start_time": "2018-02-11 14:26:38 -0500"
            },
            {
              "status": "passed",
              "code_desc": "CIPHER_SUITES useed for Node: package-centos-72 should contain exactly \"TLS_ECDHE_RSA_WITH_AES_128_CBC_SHA256\", \"TLS_ECDHE_ECDSA_WITH_AES_128_CBC_SHA256\", \"TLS_ECDHE_ECDSA_WITH_AES_128_CBC_SHA\", \"TLS_ECDHE_RSA_WITH_AES_128_CBC_SHA\", \"TLS_RSA_WITH_AES_128_CBC_SHA256\", and \"TLS_RSA_WITH_AES_128_CBC_SHA\"",
              "run_time": 0.000153,
              "start_time": "2018-02-11 14:26:38 -0500"
            },
            {
              "status": "passed",
              "code_desc": "Command openssl rsa -in /etc/elasticsearch/x-pack/elastic/elastic.key -check -noout stdout should match /RSA key ok/",
              "run_time": 0.019796,
              "start_time": "2018-02-11 14:26:38 -0500"
            },
            {
              "status": "passed",
              "code_desc": "x509_certificate /etc/elasticsearch/x-pack/elastic/elastic.crt should be certificate",
              "run_time": 0.000121,
              "start_time": "2018-02-11 14:26:38 -0500"
            },
            {
              "status": "passed",
              "code_desc": "x509_certificate /etc/elasticsearch/x-pack/elastic/elastic.crt should be valid",
              "run_time": 0.000083,
              "start_time": "2018-02-11 14:26:38 -0500"
            },
            {
              "status": "passed",
              "code_desc": "x509_certificate /etc/elasticsearch/x-pack/ca/ca.crt should be certificate",
              "run_time": 0.000063,
              "start_time": "2018-02-11 14:26:38 -0500"
            },
            {
              "status": "passed",
              "code_desc": "x509_certificate /etc/elasticsearch/x-pack/ca/ca.crt should be valid",
              "run_time": 0.000083,
              "start_time": "2018-02-11 14:26:38 -0500"
            },
            {
              "status": "passed",
              "code_desc": "Elasticsearch Cluster https://0.0.0.0:9200 should not have http access",
              "run_time": 0.018111,
              "start_time": "2018-02-11 14:26:38 -0500"
            }
          ]
        },
        {
          "id": "V-27155",
          "title": "Applications must employ FIPS-validated or NSA-approved cryptography\nto implement digital signatures.",
          "desc": "Configure X-Pack Security to use an organizational approved FIPS 140-2\njava cryptography provider.",
          "impact": 0.5,
          "refs": [],
          "tags": {
            "nist": [
              "SC-13 (4)",
              "Rev_3"
            ],
            "severity": "medium",
            "rid": "SV-34454r1_rule",
            "gtitle": "SRG-APP-NA",
            "cci": "CCI-001148",
            "check": "Application must utilize approved cryptography to establish\nimplement digital signatures.\n\nAs the application administrator (usually elasticsearch), check the xpack.ssl\nsettings are set to the correct values.\n\n$cat elasticsearch.yml | grep xpack.ssl\n\nxpack.ssl.key:                     <server_key>.key\nxpack.ssl.certificate:             <server_certificate>.crt\nxpack.ssl.certificate_authorities: [ <approved_ca>.crt' ]\n\nIf these setting are not set or the underlying certificate and keys are not\ncorrect, this is a finding.\n\n$cat elasticsearch.yml | grep xpack.ssl.cipher_suites:\n\nIf this setting is not present, or not set to FIPS-validated or NSA-approved\ncryptography, this is a finding.\n\nAs a elasticsearch user, check that non-secure http traffic does not response\nwith 200 status:\n\n$curl -H 'Content-Type: application/json' -u <TEST_USER> -p <TEST_CREDENTIALS>\nhttp://<elasticsearchIP:9200>/\n\nIf a 200 response comes back, this is a finding.",
            "fix": "Employ approved cryptography to implement digital signatures.\n\n\nSee the official documentation for the complete  guide on establishing SSL\nconfiguration: https://www.elastic.co/guide/en/x-pack/current/ssl-tls.html"
          },
          "code": "control \"V-27155\" do\n  title \"Applications must employ FIPS-validated or NSA-approved cryptography\nto implement digital signatures.\"\n  desc  \"Configure X-Pack Security to use an organizational approved FIPS 140-2\njava cryptography provider.\"\n  impact 0.5\n  tag \"nist\": [\"SC-13 (4)\", \"Rev_3\"]\n  tag \"severity\": \"medium\"\n  tag \"rid\": \"SV-34454r1_rule\"\n  tag \"gtitle\": \"SRG-APP-NA\"\n  tag \"cci\": \"CCI-001148\"\n  tag \"check\": \"Application must utilize approved cryptography to establish\nimplement digital signatures.\n\nAs the application administrator (usually elasticsearch), check the xpack.ssl\nsettings are set to the correct values.\n\n$cat elasticsearch.yml | grep xpack.ssl\n\nxpack.ssl.key:                     <server_key>.key\nxpack.ssl.certificate:             <server_certificate>.crt\nxpack.ssl.certificate_authorities: [ <approved_ca>.crt' ]\n\nIf these setting are not set or the underlying certificate and keys are not\ncorrect, this is a finding.\n\n$cat elasticsearch.yml | grep xpack.ssl.cipher_suites:\n\nIf this setting is not present, or not set to FIPS-validated or NSA-approved\ncryptography, this is a finding.\n\nAs a elasticsearch user, check that non-secure http traffic does not response\nwith 200 status:\n\n$curl -H 'Content-Type: application/json' -u <TEST_USER> -p <TEST_CREDENTIALS>\nhttp://<elasticsearchIP:9200>/\n\nIf a 200 response comes back, this is a finding.\"\n  tag \"fix\": \"Employ approved cryptography to implement digital signatures.\n\n\nSee the official documentation for the complete  guide on establishing SSL\nconfiguration: https://www.elastic.co/guide/en/x-pack/current/ssl-tls.html\"\n\n  begin\n    es_conf = yaml(ELASTICSEARCH_CONF)\n\n    describe es_conf do\n      its(['xpack.ssl.key']) { should_not be_nil }\n      its(['xpack.ssl.certificate']) { should_not be_nil }\n      its(['xpack.ssl.certificate_authorities']) { should_not be_nil }\n      its(['xpack.ssl.cipher_suites']) { should match_array APPROVED_CIPHER_SUITES }\n    end\n\n    es_handle = es_helper(url:\"https://#{ELASTIC_IP}:#{ELASTIC_PORT}\",\n                    username: ES_ADMIN,\n                    password: ES_PASS,\n                    ssl_verify: SSL_VERIFY )\n\n    describe \"No nodes found\" do\n      subject { es_handle.nodes.nil? }\n      it { should_not be_truthy }\n    end if es_handle.nodes.nil?\n\n    es_handle.nodes.each do |node|\n      describe \"CIPHER_SUITES useed for Node: #{node.name}\" do\n        subject { node.cipher_suite }\n        it { should match_array APPROVED_CIPHER_SUITES }\n      end\n    end unless es_handle.nodes.nil?\n    \n    describe command(\"openssl rsa -in #{es_conf['xpack.ssl.key']} -check -noout\") do\n      its('stdout'){ should match /RSA key ok/ }\n    end\n\n    describe x509_certificate(es_conf['xpack.ssl.certificate']) do\n      it { should be_certificate }\n      it { should be_valid }\n    end\n\n    if es_conf['xpack.ssl.certificate_authorities'].is_a?(Array)\n      es_conf['xpack.ssl.certificate_authorities'].each do |cert|\n        describe x509_certificate(cert) do\n          it { should be_certificate }\n          it { should be_valid }\n        end\n      end\n    else\n      describe x509_certificate(es_conf['xpack.ssl.certificate_authorities']) do\n        it { should be_certificate }\n        it { should be_valid }\n      end\n    end\n\n    describe es_handle do \n      it { should_not have_http_access }\n    end\n\n  rescue Exception => msg\n    describe \"Exception: #{msg}\" do\n      it { should be_nil}\n    end\n  end\nend\n",
          "source_location": {
            "line": 54,
            "ref": "../elasticsearch-inspec/controls/certs+cipher_suites+http/V-27155.rb"
          },
          "results": [
            {
              "status": "passed",
              "code_desc": "YAML /etc/elasticsearch/elasticsearch.yml [\"xpack.ssl.key\"] should not be nil",
              "run_time": 0.000125,
              "start_time": "2018-02-11 14:26:38 -0500"
            },
            {
              "status": "passed",
              "code_desc": "YAML /etc/elasticsearch/elasticsearch.yml [\"xpack.ssl.certificate\"] should not be nil",
              "run_time": 0.000065,
              "start_time": "2018-02-11 14:26:38 -0500"
            },
            {
              "status": "passed",
              "code_desc": "YAML /etc/elasticsearch/elasticsearch.yml [\"xpack.ssl.certificate_authorities\"] should not be nil",
              "run_time": 0.000106,
              "start_time": "2018-02-11 14:26:38 -0500"
            },
            {
              "status": "passed",
              "code_desc": "YAML /etc/elasticsearch/elasticsearch.yml [\"xpack.ssl.cipher_suites\"] should contain exactly \"TLS_ECDHE_RSA_WITH_AES_128_CBC_SHA256\", \"TLS_ECDHE_ECDSA_WITH_AES_128_CBC_SHA256\", \"TLS_ECDHE_ECDSA_WITH_AES_128_CBC_SHA\", \"TLS_ECDHE_RSA_WITH_AES_128_CBC_SHA\", \"TLS_RSA_WITH_AES_128_CBC_SHA256\", and \"TLS_RSA_WITH_AES_128_CBC_SHA\"",
              "run_time": 0.000187,
              "start_time": "2018-02-11 14:26:38 -0500"
            },
            {
              "status": "passed",
              "code_desc": "CIPHER_SUITES useed for Node: package-centos-72 should contain exactly \"TLS_ECDHE_RSA_WITH_AES_128_CBC_SHA256\", \"TLS_ECDHE_ECDSA_WITH_AES_128_CBC_SHA256\", \"TLS_ECDHE_ECDSA_WITH_AES_128_CBC_SHA\", \"TLS_ECDHE_RSA_WITH_AES_128_CBC_SHA\", \"TLS_RSA_WITH_AES_128_CBC_SHA256\", and \"TLS_RSA_WITH_AES_128_CBC_SHA\"",
              "run_time": 0.000112,
              "start_time": "2018-02-11 14:26:38 -0500"
            },
            {
              "status": "passed",
              "code_desc": "Command openssl rsa -in /etc/elasticsearch/x-pack/elastic/elastic.key -check -noout stdout should match /RSA key ok/",
              "run_time": 0.021571,
              "start_time": "2018-02-11 14:26:38 -0500"
            },
            {
              "status": "passed",
              "code_desc": "x509_certificate /etc/elasticsearch/x-pack/elastic/elastic.crt should be certificate",
              "run_time": 0.000106,
              "start_time": "2018-02-11 14:26:38 -0500"
            },
            {
              "status": "passed",
              "code_desc": "x509_certificate /etc/elasticsearch/x-pack/elastic/elastic.crt should be valid",
              "run_time": 0.000117,
              "start_time": "2018-02-11 14:26:38 -0500"
            },
            {
              "status": "passed",
              "code_desc": "x509_certificate /etc/elasticsearch/x-pack/ca/ca.crt should be certificate",
              "run_time": 0.000071,
              "start_time": "2018-02-11 14:26:38 -0500"
            },
            {
              "status": "passed",
              "code_desc": "x509_certificate /etc/elasticsearch/x-pack/ca/ca.crt should be valid",
              "run_time": 0.000093,
              "start_time": "2018-02-11 14:26:38 -0500"
            },
            {
              "status": "passed",
              "code_desc": "Elasticsearch Cluster https://0.0.0.0:9200 should not have http access",
              "run_time": 0.051797,
              "start_time": "2018-02-11 14:26:38 -0500"
            }
          ]
        },
        {
          "id": "V-27154",
          "title": "Applications must employ FIPS-validated cryptography to protect\nunclassified information when such information must be separated from\nindividuals who have the necessary clearances yet lack the necessary access\napprovals.",
          "desc": "Configure X-Pack Security to use an organizational approved FIPS 140-2\njava cryptography provider.",
          "impact": 0.5,
          "refs": [],
          "tags": {
            "nist": [
              "SC-13 (3)",
              "Rev_3"
            ],
            "severity": "medium",
            "rid": "SV-34453r1_rule",
            "gtitle": "SRG-APP-000199",
            "cci": "CCI-001147",
            "check": "Application must utilize approved cryptography for data\nseparation.\n\nAs the application administrator (usually elasticsearch), check the xpack.ssl\nsettings are set to the correct values.\n\n$cat elasticsearch.yml | grep xpack.ssl\n\nxpack.ssl.key:                     <server_key>.key\nxpack.ssl.certificate:             <server_certificate>.crt\nxpack.ssl.certificate_authorities: [ <approved_ca>.crt' ]\n\nIf these setting are not set or the underlying certificate and keys are not\ncorrect, this is a finding.\n\n$cat elasticsearch.yml | grep xpack.ssl.cipher_suites:\n\nIf this setting is not present, or not set to FIPS-validated or NSA-approved\ncryptography, this is a finding.\n\nAs a elasticsearch user, check that non-secure http traffic does not response\nwith 200 status:\n\n$curl -H 'Content-Type: application/json' -u <TEST_USER> -p <TEST_CREDENTIALS>\nhttp://<elasticsearchIP:9200>/\n\nIf a 200 response comes back, this is a finding.",
            "fix": "Employ approved cryptography for data separations.\n\nSee the official documentation for the complete  guide on establishing SSL\nconfiguration: https://www.elastic.co/guide/en/x-pack/current/ssl-tls.html"
          },
          "code": "control \"V-27154\" do\n  title \"Applications must employ FIPS-validated cryptography to protect\nunclassified information when such information must be separated from\nindividuals who have the necessary clearances yet lack the necessary access\napprovals.\"\n  desc  \"Configure X-Pack Security to use an organizational approved FIPS 140-2\njava cryptography provider.\"\n  impact 0.5\n  tag \"nist\": [\"SC-13 (3)\", \"Rev_3\"]\n  tag \"severity\": \"medium\"\n  tag \"rid\": \"SV-34453r1_rule\"\n  tag \"gtitle\": \"SRG-APP-000199\"\n  tag \"cci\": \"CCI-001147\"\n  tag \"check\": \"Application must utilize approved cryptography for data\nseparation.\n\nAs the application administrator (usually elasticsearch), check the xpack.ssl\nsettings are set to the correct values.\n\n$cat elasticsearch.yml | grep xpack.ssl\n\nxpack.ssl.key:                     <server_key>.key\nxpack.ssl.certificate:             <server_certificate>.crt\nxpack.ssl.certificate_authorities: [ <approved_ca>.crt' ]\n\nIf these setting are not set or the underlying certificate and keys are not\ncorrect, this is a finding.\n\n$cat elasticsearch.yml | grep xpack.ssl.cipher_suites:\n\nIf this setting is not present, or not set to FIPS-validated or NSA-approved\ncryptography, this is a finding.\n\nAs a elasticsearch user, check that non-secure http traffic does not response\nwith 200 status:\n\n$curl -H 'Content-Type: application/json' -u <TEST_USER> -p <TEST_CREDENTIALS>\nhttp://<elasticsearchIP:9200>/\n\nIf a 200 response comes back, this is a finding.\"\n  tag \"fix\": \"Employ approved cryptography for data separations.\n\nSee the official documentation for the complete  guide on establishing SSL\nconfiguration: https://www.elastic.co/guide/en/x-pack/current/ssl-tls.html\"\n\n  begin\n    es_conf = yaml(ELASTICSEARCH_CONF)\n\n    describe es_conf do\n      its(['xpack.ssl.key']) { should_not be_nil }\n      its(['xpack.ssl.certificate']) { should_not be_nil }\n      its(['xpack.ssl.certificate_authorities']) { should_not be_nil }\n      its(['xpack.ssl.cipher_suites']) { should match_array APPROVED_CIPHER_SUITES }\n    end\n\n    es_handle = es_helper(url:\"https://#{ELASTIC_IP}:#{ELASTIC_PORT}\",\n                    username: ES_ADMIN,\n                    password: ES_PASS,\n                    ssl_verify: SSL_VERIFY )\n\n    describe \"No nodes found\" do\n      subject { es_handle.nodes.nil? }\n      it { should_not be_truthy }\n    end if es_handle.nodes.nil?\n\n    es_handle.nodes.each do |node|\n      describe \"CIPHER_SUITES useed for Node: #{node.name}\" do\n        subject { node.cipher_suite }\n        it { should match_array APPROVED_CIPHER_SUITES }\n      end\n    end unless es_handle.nodes.nil?\n    \n    describe command(\"openssl rsa -in #{es_conf['xpack.ssl.key']} -check -noout\") do\n      its('stdout'){ should match /RSA key ok/ }\n    end\n\n    describe x509_certificate(es_conf['xpack.ssl.certificate']) do\n      it { should be_certificate }\n      it { should be_valid }\n    end\n\n    if es_conf['xpack.ssl.certificate_authorities'].is_a?(Array)\n      es_conf['xpack.ssl.certificate_authorities'].each do |cert|\n        describe x509_certificate(cert) do\n          it { should be_certificate }\n          it { should be_valid }\n        end\n      end\n    else\n      describe x509_certificate(es_conf['xpack.ssl.certificate_authorities']) do\n        it { should be_certificate }\n        it { should be_valid }\n      end\n    end\n\n    describe es_handle do \n      it { should_not have_http_access }\n    end\n\n  rescue Exception => msg\n    describe \"Exception: #{msg}\" do\n      it { should be_nil}\n    end\n  end\nend",
          "source_location": {
            "line": 54,
            "ref": "../elasticsearch-inspec/controls/certs+cipher_suites+http/V-27154.rb"
          },
          "results": [
            {
              "status": "passed",
              "code_desc": "YAML /etc/elasticsearch/elasticsearch.yml [\"xpack.ssl.key\"] should not be nil",
              "run_time": 0.000103,
              "start_time": "2018-02-11 14:26:38 -0500"
            },
            {
              "status": "passed",
              "code_desc": "YAML /etc/elasticsearch/elasticsearch.yml [\"xpack.ssl.certificate\"] should not be nil",
              "run_time": 0.000063,
              "start_time": "2018-02-11 14:26:38 -0500"
            },
            {
              "status": "passed",
              "code_desc": "YAML /etc/elasticsearch/elasticsearch.yml [\"xpack.ssl.certificate_authorities\"] should not be nil",
              "run_time": 0.000057,
              "start_time": "2018-02-11 14:26:38 -0500"
            },
            {
              "status": "passed",
              "code_desc": "YAML /etc/elasticsearch/elasticsearch.yml [\"xpack.ssl.cipher_suites\"] should contain exactly \"TLS_ECDHE_RSA_WITH_AES_128_CBC_SHA256\", \"TLS_ECDHE_ECDSA_WITH_AES_128_CBC_SHA256\", \"TLS_ECDHE_ECDSA_WITH_AES_128_CBC_SHA\", \"TLS_ECDHE_RSA_WITH_AES_128_CBC_SHA\", \"TLS_RSA_WITH_AES_128_CBC_SHA256\", and \"TLS_RSA_WITH_AES_128_CBC_SHA\"",
              "run_time": 0.000145,
              "start_time": "2018-02-11 14:26:38 -0500"
            },
            {
              "status": "passed",
              "code_desc": "CIPHER_SUITES useed for Node: package-centos-72 should contain exactly \"TLS_ECDHE_RSA_WITH_AES_128_CBC_SHA256\", \"TLS_ECDHE_ECDSA_WITH_AES_128_CBC_SHA256\", \"TLS_ECDHE_ECDSA_WITH_AES_128_CBC_SHA\", \"TLS_ECDHE_RSA_WITH_AES_128_CBC_SHA\", \"TLS_RSA_WITH_AES_128_CBC_SHA256\", and \"TLS_RSA_WITH_AES_128_CBC_SHA\"",
              "run_time": 0.000113,
              "start_time": "2018-02-11 14:26:38 -0500"
            },
            {
              "status": "passed",
              "code_desc": "Command openssl rsa -in /etc/elasticsearch/x-pack/elastic/elastic.key -check -noout stdout should match /RSA key ok/",
              "run_time": 0.019118,
              "start_time": "2018-02-11 14:26:38 -0500"
            },
            {
              "status": "passed",
              "code_desc": "x509_certificate /etc/elasticsearch/x-pack/elastic/elastic.crt should be certificate",
              "run_time": 0.000162,
              "start_time": "2018-02-11 14:26:38 -0500"
            },
            {
              "status": "passed",
              "code_desc": "x509_certificate /etc/elasticsearch/x-pack/elastic/elastic.crt should be valid",
              "run_time": 0.000092,
              "start_time": "2018-02-11 14:26:38 -0500"
            },
            {
              "status": "passed",
              "code_desc": "x509_certificate /etc/elasticsearch/x-pack/ca/ca.crt should be certificate",
              "run_time": 0.000071,
              "start_time": "2018-02-11 14:26:38 -0500"
            },
            {
              "status": "passed",
              "code_desc": "x509_certificate /etc/elasticsearch/x-pack/ca/ca.crt should be valid",
              "run_time": 0.000071,
              "start_time": "2018-02-11 14:26:38 -0500"
            },
            {
              "status": "passed",
              "code_desc": "Elasticsearch Cluster https://0.0.0.0:9200 should not have http access",
              "run_time": 0.020825,
              "start_time": "2018-02-11 14:26:38 -0500"
            }
          ]
        },
        {
          "id": "V-27150",
          "title": "Applications must employ FIPS-validated cryptography to protect\nunclassified information.",
          "desc": "Configure X-Pack Security to use an organizational approved FIPS 140-2\njava cryptography provider.",
          "impact": 0.5,
          "refs": [],
          "tags": {
            "nist": [
              "SC-13 (1)",
              "Rev_3"
            ],
            "severity": "medium",
            "rid": "SV-34449r1_rule",
            "gtitle": "SRG-APP-000197",
            "cci": "CCI-001145",
            "check": "Application must utilize approved cryptography to protect\nunclassified information.\n\nAs the application administrator (usually elasticsearch), check the xpack.ssl\nsettings are set to the correct values.\n\n$cat elasticsearch.yml | grep xpack.ssl\n\nxpack.ssl.key:                     <server_key>.key\nxpack.ssl.certificate:             <server_certificate>.crt\nxpack.ssl.certificate_authorities: [ <approved_ca>.crt' ]\n\nIf these setting are not set or the underlying certificate and keys are not\ncorrect, this is a finding.\n\n$cat elasticsearch.yml | grep xpack.ssl.cipher_suites:\n\nIf this setting is not present, or not set to FIPS-validated or NSA-approved\ncryptography, this is a finding.\n\nAs a elasticsearch user, check that non-secure http traffic does not response\nwith 200 status:\n\n$curl -H 'Content-Type: application/json' -u <TEST_USER> -p <TEST_CREDENTIALS>\nhttp://<elasticsearchIP:9200>/\n\nIf a 200 response comes back, this is a finding.",
            "fix": "Employ approved cryptography to protect unclassified information.\n\n\nSee the official documentation for the complete  guide on establishing SSL\nconfiguration: https://www.elastic.co/guide/en/x-pack/current/ssl-tls.html"
          },
          "code": "control \"V-27150\" do\n  title \"Applications must employ FIPS-validated cryptography to protect\nunclassified information.\"\n  desc  \"Configure X-Pack Security to use an organizational approved FIPS 140-2\njava cryptography provider.\"\n  impact 0.5\n  tag \"nist\": [\"SC-13 (1)\", \"Rev_3\"]\n  tag \"severity\": \"medium\"\n  tag \"rid\": \"SV-34449r1_rule\"\n  tag \"gtitle\": \"SRG-APP-000197\"\n  tag \"cci\": \"CCI-001145\"\n  tag \"check\": \"Application must utilize approved cryptography to protect\nunclassified information.\n\nAs the application administrator (usually elasticsearch), check the xpack.ssl\nsettings are set to the correct values.\n\n$cat elasticsearch.yml | grep xpack.ssl\n\nxpack.ssl.key:                     <server_key>.key\nxpack.ssl.certificate:             <server_certificate>.crt\nxpack.ssl.certificate_authorities: [ <approved_ca>.crt' ]\n\nIf these setting are not set or the underlying certificate and keys are not\ncorrect, this is a finding.\n\n$cat elasticsearch.yml | grep xpack.ssl.cipher_suites:\n\nIf this setting is not present, or not set to FIPS-validated or NSA-approved\ncryptography, this is a finding.\n\nAs a elasticsearch user, check that non-secure http traffic does not response\nwith 200 status:\n\n$curl -H 'Content-Type: application/json' -u <TEST_USER> -p <TEST_CREDENTIALS>\nhttp://<elasticsearchIP:9200>/\n\nIf a 200 response comes back, this is a finding.\"\n  tag \"fix\": \"Employ approved cryptography to protect unclassified information.\n\n\nSee the official documentation for the complete  guide on establishing SSL\nconfiguration: https://www.elastic.co/guide/en/x-pack/current/ssl-tls.html\"\n\n  begin\n    es_conf = yaml(ELASTICSEARCH_CONF)\n\n    describe es_conf do\n      its(['xpack.ssl.key']) { should_not be_nil }\n      its(['xpack.ssl.certificate']) { should_not be_nil }\n      its(['xpack.ssl.certificate_authorities']) { should_not be_nil }\n      its(['xpack.ssl.cipher_suites']) { should match_array APPROVED_CIPHER_SUITES }\n    end\n\n    es_handle = es_helper(url:\"https://#{ELASTIC_IP}:#{ELASTIC_PORT}\",\n                    username: ES_ADMIN,\n                    password: ES_PASS,\n                    ssl_verify: SSL_VERIFY )\n\n    describe \"No nodes found\" do\n      subject { es_handle.nodes.nil? }\n      it { should_not be_truthy }\n    end if es_handle.nodes.nil?\n\n    es_handle.nodes.each do |node|\n      describe \"CIPHER_SUITES useed for Node: #{node.name}\" do\n        subject { node.cipher_suite }\n        it { should match_array APPROVED_CIPHER_SUITES }\n      end\n    end unless es_handle.nodes.nil?\n    \n    describe command(\"openssl rsa -in #{es_conf['xpack.ssl.key']} -check -noout\") do\n      its('stdout'){ should match /RSA key ok/ }\n    end\n\n    describe x509_certificate(es_conf['xpack.ssl.certificate']) do\n      it { should be_certificate }\n      it { should be_valid }\n    end\n\n    if es_conf['xpack.ssl.certificate_authorities'].is_a?(Array)\n      es_conf['xpack.ssl.certificate_authorities'].each do |cert|\n        describe x509_certificate(cert) do\n          it { should be_certificate }\n          it { should be_valid }\n        end\n      end\n    else\n      describe x509_certificate(es_conf['xpack.ssl.certificate_authorities']) do\n        it { should be_certificate }\n        it { should be_valid }\n      end\n    end\n\n    describe es_handle do \n      it { should_not have_http_access }\n    end\n\n  rescue Exception => msg\n    describe \"Exception: #{msg}\" do\n      it { should be_nil}\n    end\n  end\nend\n",
          "source_location": {
            "line": 54,
            "ref": "../elasticsearch-inspec/controls/certs+cipher_suites+http/V-27150.rb"
          },
          "results": [
            {
              "status": "passed",
              "code_desc": "YAML /etc/elasticsearch/elasticsearch.yml [\"xpack.ssl.key\"] should not be nil",
              "run_time": 0.000103,
              "start_time": "2018-02-11 14:26:38 -0500"
            },
            {
              "status": "passed",
              "code_desc": "YAML /etc/elasticsearch/elasticsearch.yml [\"xpack.ssl.certificate\"] should not be nil",
              "run_time": 0.000069,
              "start_time": "2018-02-11 14:26:38 -0500"
            },
            {
              "status": "passed",
              "code_desc": "YAML /etc/elasticsearch/elasticsearch.yml [\"xpack.ssl.certificate_authorities\"] should not be nil",
              "run_time": 0.000088,
              "start_time": "2018-02-11 14:26:38 -0500"
            },
            {
              "status": "passed",
              "code_desc": "YAML /etc/elasticsearch/elasticsearch.yml [\"xpack.ssl.cipher_suites\"] should contain exactly \"TLS_ECDHE_RSA_WITH_AES_128_CBC_SHA256\", \"TLS_ECDHE_ECDSA_WITH_AES_128_CBC_SHA256\", \"TLS_ECDHE_ECDSA_WITH_AES_128_CBC_SHA\", \"TLS_ECDHE_RSA_WITH_AES_128_CBC_SHA\", \"TLS_RSA_WITH_AES_128_CBC_SHA256\", and \"TLS_RSA_WITH_AES_128_CBC_SHA\"",
              "run_time": 0.000177,
              "start_time": "2018-02-11 14:26:38 -0500"
            },
            {
              "status": "passed",
              "code_desc": "CIPHER_SUITES useed for Node: package-centos-72 should contain exactly \"TLS_ECDHE_RSA_WITH_AES_128_CBC_SHA256\", \"TLS_ECDHE_ECDSA_WITH_AES_128_CBC_SHA256\", \"TLS_ECDHE_ECDSA_WITH_AES_128_CBC_SHA\", \"TLS_ECDHE_RSA_WITH_AES_128_CBC_SHA\", \"TLS_RSA_WITH_AES_128_CBC_SHA256\", and \"TLS_RSA_WITH_AES_128_CBC_SHA\"",
              "run_time": 0.000145,
              "start_time": "2018-02-11 14:26:38 -0500"
            },
            {
              "status": "passed",
              "code_desc": "Command openssl rsa -in /etc/elasticsearch/x-pack/elastic/elastic.key -check -noout stdout should match /RSA key ok/",
              "run_time": 0.019492,
              "start_time": "2018-02-11 14:26:38 -0500"
            },
            {
              "status": "passed",
              "code_desc": "x509_certificate /etc/elasticsearch/x-pack/elastic/elastic.crt should be certificate",
              "run_time": 0.000165,
              "start_time": "2018-02-11 14:26:38 -0500"
            },
            {
              "status": "passed",
              "code_desc": "x509_certificate /etc/elasticsearch/x-pack/elastic/elastic.crt should be valid",
              "run_time": 0.000089,
              "start_time": "2018-02-11 14:26:38 -0500"
            },
            {
              "status": "passed",
              "code_desc": "x509_certificate /etc/elasticsearch/x-pack/ca/ca.crt should be certificate",
              "run_time": 0.000062,
              "start_time": "2018-02-11 14:26:38 -0500"
            },
            {
              "status": "passed",
              "code_desc": "x509_certificate /etc/elasticsearch/x-pack/ca/ca.crt should be valid",
              "run_time": 0.000078,
              "start_time": "2018-02-11 14:26:38 -0500"
            },
            {
              "status": "passed",
              "code_desc": "Elasticsearch Cluster https://0.0.0.0:9200 should not have http access",
              "run_time": 0.024196,
              "start_time": "2018-02-11 14:26:38 -0500"
            }
          ]
        },
        {
          "id": "V-27140",
          "title": "The application must implement required cryptographic protections\nusing cryptographic modules complying with applicable federal laws, Executive\nOrders, directives, policies, regulations, standards, and guidance.",
          "desc": "Configure X-Pack Security to use an organizational approved FIPS 140-2\njava cryptography provider.",
          "impact": 0.5,
          "refs": [],
          "tags": {
            "nist": [
              "SC-13",
              "Rev_3"
            ],
            "severity": "medium",
            "rid": "SV-34439r1_rule",
            "gtitle": "SRG-APP-000196",
            "cci": "CCI-001144",
            "check": "Application must utilize approved cryptography that complying\nwith applicable federal laws, Executive Orders, directives, policies,\nregulations, standards, and guidance.\n\nAs the application administrator (usually elasticsearch), check the xpack.ssl\nsettings are set to the correct values.\n\n$cat elasticsearch.yml | grep xpack.ssl\n\nxpack.ssl.key:                     <server_key>.key\nxpack.ssl.certificate:             <server_certificate>.crt\nxpack.ssl.certificate_authorities: [ <approved_ca>.crt' ]\n\nIf these setting are not set or the underlying certificate and keys are not\ncorrect, this is a finding.\n\n$cat elasticsearch.yml | grep xpack.ssl.cipher_suites:\n\nIf this setting is not present, or not set to FIPS-validated or NSA-approved\ncryptography, this is a finding.\n\nAs a elasticsearch user, check that non-secure http traffic does not response\nwith 200 status:\n\n$curl -H 'Content-Type: application/json' -u <TEST_USER> -p <TEST_CREDENTIALS>\nhttp://<elasticsearchIP:9200>/\n\nIf a 200 response comes back, this is a finding.",
            "fix": "Employ approved cryptography that complying with applicable\nfederal laws, Executive Orders, directives, policies, regulations, standards,\nand guidance.\n\nSee the official documentation for the complete  guide on establishing SSL\nconfiguration: https://www.elastic.co/guide/en/x-pack/current/ssl-tls.html"
          },
          "code": "control \"V-27140\" do\n  title \"The application must implement required cryptographic protections\nusing cryptographic modules complying with applicable federal laws, Executive\nOrders, directives, policies, regulations, standards, and guidance.\"\n  desc  \"Configure X-Pack Security to use an organizational approved FIPS 140-2\njava cryptography provider.\"\n  impact 0.5\n  tag \"nist\": [\"SC-13\", \"Rev_3\"]\n  tag \"severity\": \"medium\"\n  tag \"rid\": \"SV-34439r1_rule\"\n  tag \"gtitle\": \"SRG-APP-000196\"\n  tag \"cci\": \"CCI-001144\"\n  tag \"check\": \"Application must utilize approved cryptography that complying\nwith applicable federal laws, Executive Orders, directives, policies,\nregulations, standards, and guidance.\n\nAs the application administrator (usually elasticsearch), check the xpack.ssl\nsettings are set to the correct values.\n\n$cat elasticsearch.yml | grep xpack.ssl\n\nxpack.ssl.key:                     <server_key>.key\nxpack.ssl.certificate:             <server_certificate>.crt\nxpack.ssl.certificate_authorities: [ <approved_ca>.crt' ]\n\nIf these setting are not set or the underlying certificate and keys are not\ncorrect, this is a finding.\n\n$cat elasticsearch.yml | grep xpack.ssl.cipher_suites:\n\nIf this setting is not present, or not set to FIPS-validated or NSA-approved\ncryptography, this is a finding.\n\nAs a elasticsearch user, check that non-secure http traffic does not response\nwith 200 status:\n\n$curl -H 'Content-Type: application/json' -u <TEST_USER> -p <TEST_CREDENTIALS>\nhttp://<elasticsearchIP:9200>/\n\nIf a 200 response comes back, this is a finding.\"\n  tag \"fix\": \"Employ approved cryptography that complying with applicable\nfederal laws, Executive Orders, directives, policies, regulations, standards,\nand guidance.\n\nSee the official documentation for the complete  guide on establishing SSL\nconfiguration: https://www.elastic.co/guide/en/x-pack/current/ssl-tls.html\"\n\n  begin\n    es_conf = yaml(ELASTICSEARCH_CONF)\n\n    describe es_conf do\n      its(['xpack.ssl.key']) { should_not be_nil }\n      its(['xpack.ssl.certificate']) { should_not be_nil }\n      its(['xpack.ssl.certificate_authorities']) { should_not be_nil }\n      its(['xpack.ssl.cipher_suites']) { should match_array APPROVED_CIPHER_SUITES }\n    end\n\n    es_handle = es_helper(url:\"https://#{ELASTIC_IP}:#{ELASTIC_PORT}\",\n                    username: ES_ADMIN,\n                    password: ES_PASS,\n                    ssl_verify: SSL_VERIFY )\n\n    describe \"No nodes found\" do\n      subject { es_handle.nodes.nil? }\n      it { should_not be_truthy }\n    end if es_handle.nodes.nil?\n\n    es_handle.nodes.each do |node|\n      describe \"CIPHER_SUITES useed for Node: #{node.name}\" do\n        subject { node.cipher_suite }\n        it { should match_array APPROVED_CIPHER_SUITES }\n      end\n    end unless es_handle.nodes.nil?\n    \n    describe command(\"openssl rsa -in #{es_conf['xpack.ssl.key']} -check -noout\") do\n      its('stdout'){ should match /RSA key ok/ }\n    end\n\n    describe x509_certificate(es_conf['xpack.ssl.certificate']) do\n      it { should be_certificate }\n      it { should be_valid }\n    end\n\n    if es_conf['xpack.ssl.certificate_authorities'].is_a?(Array)\n      es_conf['xpack.ssl.certificate_authorities'].each do |cert|\n        describe x509_certificate(cert) do\n          it { should be_certificate }\n          it { should be_valid }\n        end\n      end\n    else\n      describe x509_certificate(es_conf['xpack.ssl.certificate_authorities']) do\n        it { should be_certificate }\n        it { should be_valid }\n      end\n    end\n\n    describe es_handle do \n      it { should_not have_http_access }\n    end\n\n  rescue Exception => msg\n    describe \"Exception: #{msg}\" do\n      it { should be_nil}\n    end\n  end\nend\n",
          "source_location": {
            "line": 54,
            "ref": "../elasticsearch-inspec/controls/certs+cipher_suites+http/V-27140.rb"
          },
          "results": [
            {
              "status": "passed",
              "code_desc": "YAML /etc/elasticsearch/elasticsearch.yml [\"xpack.ssl.key\"] should not be nil",
              "run_time": 0.000102,
              "start_time": "2018-02-11 14:26:38 -0500"
            },
            {
              "status": "passed",
              "code_desc": "YAML /etc/elasticsearch/elasticsearch.yml [\"xpack.ssl.certificate\"] should not be nil",
              "run_time": 0.000063,
              "start_time": "2018-02-11 14:26:38 -0500"
            },
            {
              "status": "passed",
              "code_desc": "YAML /etc/elasticsearch/elasticsearch.yml [\"xpack.ssl.certificate_authorities\"] should not be nil",
              "run_time": 0.000059,
              "start_time": "2018-02-11 14:26:38 -0500"
            },
            {
              "status": "passed",
              "code_desc": "YAML /etc/elasticsearch/elasticsearch.yml [\"xpack.ssl.cipher_suites\"] should contain exactly \"TLS_ECDHE_RSA_WITH_AES_128_CBC_SHA256\", \"TLS_ECDHE_ECDSA_WITH_AES_128_CBC_SHA256\", \"TLS_ECDHE_ECDSA_WITH_AES_128_CBC_SHA\", \"TLS_ECDHE_RSA_WITH_AES_128_CBC_SHA\", \"TLS_RSA_WITH_AES_128_CBC_SHA256\", and \"TLS_RSA_WITH_AES_128_CBC_SHA\"",
              "run_time": 0.000161,
              "start_time": "2018-02-11 14:26:38 -0500"
            },
            {
              "status": "passed",
              "code_desc": "CIPHER_SUITES useed for Node: package-centos-72 should contain exactly \"TLS_ECDHE_RSA_WITH_AES_128_CBC_SHA256\", \"TLS_ECDHE_ECDSA_WITH_AES_128_CBC_SHA256\", \"TLS_ECDHE_ECDSA_WITH_AES_128_CBC_SHA\", \"TLS_ECDHE_RSA_WITH_AES_128_CBC_SHA\", \"TLS_RSA_WITH_AES_128_CBC_SHA256\", and \"TLS_RSA_WITH_AES_128_CBC_SHA\"",
              "run_time": 0.000125,
              "start_time": "2018-02-11 14:26:38 -0500"
            },
            {
              "status": "passed",
              "code_desc": "Command openssl rsa -in /etc/elasticsearch/x-pack/elastic/elastic.key -check -noout stdout should match /RSA key ok/",
              "run_time": 0.020708,
              "start_time": "2018-02-11 14:26:38 -0500"
            },
            {
              "status": "passed",
              "code_desc": "x509_certificate /etc/elasticsearch/x-pack/elastic/elastic.crt should be certificate",
              "run_time": 0.000137,
              "start_time": "2018-02-11 14:26:38 -0500"
            },
            {
              "status": "passed",
              "code_desc": "x509_certificate /etc/elasticsearch/x-pack/elastic/elastic.crt should be valid",
              "run_time": 0.0001,
              "start_time": "2018-02-11 14:26:38 -0500"
            },
            {
              "status": "passed",
              "code_desc": "x509_certificate /etc/elasticsearch/x-pack/ca/ca.crt should be certificate",
              "run_time": 0.00008,
              "start_time": "2018-02-11 14:26:38 -0500"
            },
            {
              "status": "passed",
              "code_desc": "x509_certificate /etc/elasticsearch/x-pack/ca/ca.crt should be valid",
              "run_time": 0.000063,
              "start_time": "2018-02-11 14:26:38 -0500"
            },
            {
              "status": "passed",
              "code_desc": "Elasticsearch Cluster https://0.0.0.0:9200 should not have http access",
              "run_time": 0.019331,
              "start_time": "2018-02-11 14:26:38 -0500"
            }
          ]
        },
        {
          "id": "V-26678",
          "title": "The application must maintain the binding of security attributes to\ninformation with sufficient assurance that the information/attribute\nassociation can be used as the basis for automated policy actions.",
          "desc": "The JSON data models used by a system must maintain denormalized or\nlinked security labels and markings for information such that the information\ncan be used for automated policy actions by applications and Elasticsearch\nsecurity infrastructure. Utilize X-Pack Security's Field and Document Level\nSecurity features to restrict access based on information within the document.",
          "impact": 0.5,
          "refs": [],
          "tags": {
            "nist": [
              "AC-16 (3)",
              "Rev_3"
            ],
            "severity": "medium",
            "rid": "SV-33877r1_rule",
            "gtitle": "SRG-APP-000011",
            "cci": "CCI-001426",
            "check": "The JSON data models used by a system must maintain\ndenormalized or linked security labels and markings for information such that\nthe information can be used for automated policy actions by applications and\nElasticsearch security infrastructure. Data in transit is protected via TLS.\nUtilize X-Pack Security's Field and Document Level Security features to\nrestrict access based on information within the document.",
            "fix": "As a data owner, build a data model that is denormalized or\nlinked security labels and markings for information such that the information\ncan be used for automated policy actions by applications and Elasticsearch\nsecurity infrastructure."
          },
          "code": "control \"V-26678\" do\n  title \"The application must maintain the binding of security attributes to\ninformation with sufficient assurance that the information/attribute\nassociation can be used as the basis for automated policy actions.\"\n  desc  \"The JSON data models used by a system must maintain denormalized or\nlinked security labels and markings for information such that the information\ncan be used for automated policy actions by applications and Elasticsearch\nsecurity infrastructure. Utilize X-Pack Security's Field and Document Level\nSecurity features to restrict access based on information within the document.\"\n  impact 0.5\n  tag \"nist\": [\"AC-16 (3)\", \"Rev_3\"]\n  tag \"severity\": \"medium\"\n  tag \"rid\": \"SV-33877r1_rule\"\n  tag \"gtitle\": \"SRG-APP-000011\"\n  tag \"cci\": \"CCI-001426\"\n  tag \"check\": \"The JSON data models used by a system must maintain\ndenormalized or linked security labels and markings for information such that\nthe information can be used for automated policy actions by applications and\nElasticsearch security infrastructure. Data in transit is protected via TLS.\nUtilize X-Pack Security's Field and Document Level Security features to\nrestrict access based on information within the document.\"\n  tag \"fix\": \"As a data owner, build a data model that is denormalized or\nlinked security labels and markings for information such that the information\ncan be used for automated policy actions by applications and Elasticsearch\nsecurity infrastructure.\"\n\n  begin\n    es_handle = es_helper(url:\"https://#{ELASTIC_IP}:#{ELASTIC_PORT}\",\n                    username: ES_ADMIN,\n                    password: ES_PASS,\n                    ssl_verify: SSL_VERIFY )\n\n    describe \"No nodes found\" do\n      subject { es_handle.nodes.nil? }\n      it { should_not be_truthy }\n    end if es_handle.nodes.nil?\n\n    es_handle.nodes.each do |node|\n      describe \"SSL Settings for Node: #{node.name}\" do\n        subject { node }\n        its(\"http_ssl.enabled\") { should eq 'true' }\n        its(\"transport_ssl.enabled\") { should eq 'true' }\n      end\n    end unless es_handle.nodes.nil?\n\n    describe yaml(ELASTICSEARCH_CONF) do\n      its(['xpack.ssl.key']) { should_not be_nil }\n      its(['xpack.ssl.certificate']) { should_not be_nil }\n      its(['xpack.ssl.certificate_authorities']) { should_not be_nil }\n      its(['xpack.security.http.ssl.enabled']) { should eq true }\n      its(['xpack.security.transport.ssl.enabled']) { should eq true }\n    end\n\n  rescue Exception => msg\n    describe \"Exception: #{msg}\" do\n      it { should be_nil}\n    end\n  end\nend",
          "source_location": {
            "line": 41,
            "ref": "../elasticsearch-inspec/controls/tls/V-26678.rb"
          },
          "results": [
            {
              "status": "passed",
              "code_desc": "SSL Settings for Node: package-centos-72 http_ssl.enabled should eq \"true\"",
              "run_time": 0.000165,
              "start_time": "2018-02-11 14:26:38 -0500"
            },
            {
              "status": "passed",
              "code_desc": "SSL Settings for Node: package-centos-72 transport_ssl.enabled should eq \"true\"",
              "run_time": 0.000087,
              "start_time": "2018-02-11 14:26:38 -0500"
            },
            {
              "status": "passed",
              "code_desc": "YAML /etc/elasticsearch/elasticsearch.yml [\"xpack.ssl.key\"] should not be nil",
              "run_time": 0.00009,
              "start_time": "2018-02-11 14:26:38 -0500"
            },
            {
              "status": "passed",
              "code_desc": "YAML /etc/elasticsearch/elasticsearch.yml [\"xpack.ssl.certificate\"] should not be nil",
              "run_time": 0.000056,
              "start_time": "2018-02-11 14:26:38 -0500"
            },
            {
              "status": "passed",
              "code_desc": "YAML /etc/elasticsearch/elasticsearch.yml [\"xpack.ssl.certificate_authorities\"] should not be nil",
              "run_time": 0.000057,
              "start_time": "2018-02-11 14:26:38 -0500"
            },
            {
              "status": "passed",
              "code_desc": "YAML /etc/elasticsearch/elasticsearch.yml [\"xpack.security.http.ssl.enabled\"] should eq true",
              "run_time": 0.000084,
              "start_time": "2018-02-11 14:26:38 -0500"
            },
            {
              "status": "passed",
              "code_desc": "YAML /etc/elasticsearch/elasticsearch.yml [\"xpack.security.transport.ssl.enabled\"] should eq true",
              "run_time": 0.000061,
              "start_time": "2018-02-11 14:26:38 -0500"
            }
          ]
        },
        {
          "id": "V-27170",
          "title": "The application must associate security attributes with information\nexchanged between information systems.",
          "desc": "The JSON data models used by a system must maintain denormalized or\nlinked security labels and markings for information such that the information\ncan be used for automated policy actions by applications and Elasticsearch\nsecurity infrastructure. Utilize X-Pack Security's Field and Document Level\nSecurity features to restrict access based on information within the document.",
          "impact": 0.5,
          "refs": [],
          "tags": {
            "nist": [
              "SC-16",
              "Rev_4"
            ],
            "severity": "medium",
            "rid": "SV-34469r1_rule",
            "gtitle": "SRG-APP-000203",
            "cci": "CCI-001157",
            "check": "The JSON data models used by a system must maintain\ndenormalized or linked security labels and markings for information such that\nthe information can be used for automated policy actions by applications and\nElasticsearch security infrastructure. Data in transit is protected via TLS.\nUtilize X-Pack Security's Field and Document Level Security features to\nrestrict access based on information within the document.",
            "fix": "As a data owner, build a data model that is denormalized or\nlinked security labels and markings for information such that the information\ncan be used for automated policy actions by applications and Elasticsearch\nsecurity infrastructure."
          },
          "code": "control \"V-27170\" do\n  title \"The application must associate security attributes with information\nexchanged between information systems.\"\n  desc  \"The JSON data models used by a system must maintain denormalized or\nlinked security labels and markings for information such that the information\ncan be used for automated policy actions by applications and Elasticsearch\nsecurity infrastructure. Utilize X-Pack Security's Field and Document Level\nSecurity features to restrict access based on information within the document.\"\n  impact 0.5\n  tag \"nist\": [\"SC-16\", \"Rev_4\"]\n  tag \"severity\": \"medium\"\n  tag \"rid\": \"SV-34469r1_rule\"\n  tag \"gtitle\": \"SRG-APP-000203\"\n  tag \"cci\": \"CCI-001157\"\n  tag \"check\": \"The JSON data models used by a system must maintain\ndenormalized or linked security labels and markings for information such that\nthe information can be used for automated policy actions by applications and\nElasticsearch security infrastructure. Data in transit is protected via TLS.\nUtilize X-Pack Security's Field and Document Level Security features to\nrestrict access based on information within the document.\"\n  tag \"fix\": \"As a data owner, build a data model that is denormalized or\nlinked security labels and markings for information such that the information\ncan be used for automated policy actions by applications and Elasticsearch\nsecurity infrastructure.\"\n\n  begin\n    es_handle = es_helper(url:\"https://#{ELASTIC_IP}:#{ELASTIC_PORT}\",\n                    username: ES_ADMIN,\n                    password: ES_PASS,\n                    ssl_verify: SSL_VERIFY )\n\n    describe \"No nodes found\" do\n      subject { es_handle.nodes.nil? }\n      it { should_not be_truthy }\n    end if es_handle.nodes.nil?\n\n    es_handle.nodes.each do |node|\n      describe \"SSL Settings for Node: #{node.name}\" do\n        subject { node }\n        its(\"http_ssl.enabled\") { should eq 'true' }\n        its(\"transport_ssl.enabled\") { should eq 'true' }\n      end\n    end unless es_handle.nodes.nil?\n\n    describe yaml(ELASTICSEARCH_CONF) do\n      its(['xpack.ssl.key']) { should_not be_nil }\n      its(['xpack.ssl.certificate']) { should_not be_nil }\n      its(['xpack.ssl.certificate_authorities']) { should_not be_nil }\n      its(['xpack.security.http.ssl.enabled']) { should eq true }\n      its(['xpack.security.transport.ssl.enabled']) { should eq true }\n    end\n\n\n  rescue Exception => msg\n    describe \"Exception: #{msg}\" do\n      it { should be_nil}\n    end\n  end\nend\n",
          "source_location": {
            "line": 41,
            "ref": "../elasticsearch-inspec/controls/tls/V-27170.rb"
          },
          "results": [
            {
              "status": "passed",
              "code_desc": "SSL Settings for Node: package-centos-72 http_ssl.enabled should eq \"true\"",
              "run_time": 0.000069,
              "start_time": "2018-02-11 14:26:38 -0500"
            },
            {
              "status": "passed",
              "code_desc": "SSL Settings for Node: package-centos-72 transport_ssl.enabled should eq \"true\"",
              "run_time": 0.000063,
              "start_time": "2018-02-11 14:26:38 -0500"
            },
            {
              "status": "passed",
              "code_desc": "YAML /etc/elasticsearch/elasticsearch.yml [\"xpack.ssl.key\"] should not be nil",
              "run_time": 0.000058,
              "start_time": "2018-02-11 14:26:38 -0500"
            },
            {
              "status": "passed",
              "code_desc": "YAML /etc/elasticsearch/elasticsearch.yml [\"xpack.ssl.certificate\"] should not be nil",
              "run_time": 0.000065,
              "start_time": "2018-02-11 14:26:38 -0500"
            },
            {
              "status": "passed",
              "code_desc": "YAML /etc/elasticsearch/elasticsearch.yml [\"xpack.ssl.certificate_authorities\"] should not be nil",
              "run_time": 0.000053,
              "start_time": "2018-02-11 14:26:38 -0500"
            },
            {
              "status": "passed",
              "code_desc": "YAML /etc/elasticsearch/elasticsearch.yml [\"xpack.security.http.ssl.enabled\"] should eq true",
              "run_time": 0.000063,
              "start_time": "2018-02-11 14:26:38 -0500"
            },
            {
              "status": "passed",
              "code_desc": "YAML /etc/elasticsearch/elasticsearch.yml [\"xpack.security.transport.ssl.enabled\"] should eq true",
              "run_time": 0.000079,
              "start_time": "2018-02-11 14:26:38 -0500"
            }
          ]
        },
        {
          "id": "V-26675",
          "title": "The application must maintain and support the use of organizational\ndefined security attributes to information in transmission.",
          "desc": "The JSON data models used by a system must maintain denormalized or\nlinked security labels and markings for information such that the information\ncan be used for automated policy actions by applications and Elasticsearch\nsecurity infrastructure. Data in transit is protected via TLS. Utilize X-Pack\nSecurity's Field and Document Level Security features to restrict access based\non information within the document.",
          "impact": 0.5,
          "refs": [],
          "tags": {
            "nist": [
              "AC-16",
              "Rev_3"
            ],
            "severity": "medium",
            "rid": "SV-33823r1_rule",
            "gtitle": "SRG-APP-000008",
            "cci": "CCI-001401",
            "check": "The JSON data models used by a system must maintain\ndenormalized or linked security labels and markings for information such that\nthe information can be used for automated policy actions by applications and\nElasticsearch security infrastructure. Data in transit is protected via TLS.\nUtilize X-Pack Security's Field and Document Level Security features to\nrestrict access based on information within the document.",
            "fix": "As a data owner, build a data model that is denormalized or\nlinked security labels and markings for information such that the information\ncan be used for automated policy actions by applications and Elasticsearch\nsecurity infrastructure."
          },
          "code": "control \"V-26675\" do\n  title \"The application must maintain and support the use of organizational\ndefined security attributes to information in transmission.\"\n  desc  \"The JSON data models used by a system must maintain denormalized or\nlinked security labels and markings for information such that the information\ncan be used for automated policy actions by applications and Elasticsearch\nsecurity infrastructure. Data in transit is protected via TLS. Utilize X-Pack\nSecurity's Field and Document Level Security features to restrict access based\non information within the document.\"\n  impact 0.5\n  tag \"nist\": [\"AC-16\", \"Rev_3\"]\n  tag \"severity\": \"medium\"\n  tag \"rid\": \"SV-33823r1_rule\"\n  tag \"gtitle\": \"SRG-APP-000008\"\n  tag \"cci\": \"CCI-001401\"\n  tag \"check\": \"The JSON data models used by a system must maintain\ndenormalized or linked security labels and markings for information such that\nthe information can be used for automated policy actions by applications and\nElasticsearch security infrastructure. Data in transit is protected via TLS.\nUtilize X-Pack Security's Field and Document Level Security features to\nrestrict access based on information within the document.\"\n  tag \"fix\": \"As a data owner, build a data model that is denormalized or\nlinked security labels and markings for information such that the information\ncan be used for automated policy actions by applications and Elasticsearch\nsecurity infrastructure.\"\n\n  begin\n    es_handle = es_helper(url:\"https://#{ELASTIC_IP}:#{ELASTIC_PORT}\",\n                    username: ES_ADMIN,\n                    password: ES_PASS,\n                    ssl_verify: SSL_VERIFY )\n\n    describe \"No nodes found\" do\n      subject { es_handle.nodes.nil? }\n      it { should_not be_truthy }\n    end if es_handle.nodes.nil?\n\n    es_handle.nodes.each do |node|\n      describe \"SSL Settings for Node: #{node.name}\" do\n        subject { node }\n        its(\"http_ssl.enabled\") { should eq 'true' }\n        its(\"transport_ssl.enabled\") { should eq 'true' }\n      end\n    end unless es_handle.nodes.nil?\n\n    describe yaml(ELASTICSEARCH_CONF) do\n      its(['xpack.ssl.key']) { should_not be_nil }\n      its(['xpack.ssl.certificate']) { should_not be_nil }\n      its(['xpack.ssl.certificate_authorities']) { should_not be_nil }\n      its(['xpack.security.http.ssl.enabled']) { should eq true }\n      its(['xpack.security.transport.ssl.enabled']) { should eq true }\n    end\n\n  rescue Exception => msg\n    describe \"Exception: #{msg}\" do\n      it { should be_nil}\n    end\n  end\nend\n",
          "source_location": {
            "line": 41,
            "ref": "../elasticsearch-inspec/controls/tls/V-26675.rb"
          },
          "results": [
            {
              "status": "passed",
              "code_desc": "SSL Settings for Node: package-centos-72 http_ssl.enabled should eq \"true\"",
              "run_time": 0.000086,
              "start_time": "2018-02-11 14:26:38 -0500"
            },
            {
              "status": "passed",
              "code_desc": "SSL Settings for Node: package-centos-72 transport_ssl.enabled should eq \"true\"",
              "run_time": 0.000064,
              "start_time": "2018-02-11 14:26:38 -0500"
            },
            {
              "status": "passed",
              "code_desc": "YAML /etc/elasticsearch/elasticsearch.yml [\"xpack.ssl.key\"] should not be nil",
              "run_time": 0.000059,
              "start_time": "2018-02-11 14:26:38 -0500"
            },
            {
              "status": "passed",
              "code_desc": "YAML /etc/elasticsearch/elasticsearch.yml [\"xpack.ssl.certificate\"] should not be nil",
              "run_time": 0.000056,
              "start_time": "2018-02-11 14:26:38 -0500"
            },
            {
              "status": "passed",
              "code_desc": "YAML /etc/elasticsearch/elasticsearch.yml [\"xpack.ssl.certificate_authorities\"] should not be nil",
              "run_time": 0.00007,
              "start_time": "2018-02-11 14:26:38 -0500"
            },
            {
              "status": "passed",
              "code_desc": "YAML /etc/elasticsearch/elasticsearch.yml [\"xpack.security.http.ssl.enabled\"] should eq true",
              "run_time": 0.000063,
              "start_time": "2018-02-11 14:26:38 -0500"
            },
            {
              "status": "passed",
              "code_desc": "YAML /etc/elasticsearch/elasticsearch.yml [\"xpack.security.transport.ssl.enabled\"] should eq true",
              "run_time": 0.00006,
              "start_time": "2018-02-11 14:26:38 -0500"
            }
          ]
        },
        {
          "id": "V-26733",
          "title": "Service Oriented Architecture (SOA) based applications must\ndynamically manage user privileges and associated access authorizations.",
          "desc": "Populate user metadata dynamically upon login and Implement templated\nRBAC policies with X-Pack Security to reflect the dynamic attributes of users.\n(https://www.elastic.co/guide/en/x-pack/current/field-and-document-access-control.html#templating-role-query)",
          "impact": 0.5,
          "refs": [],
          "tags": {
            "nist": [
              "AC-2 (6)",
              "Rev_3"
            ],
            "severity": "medium",
            "rid": "SV-33981r1_rule",
            "gtitle": "SRG-APP-000031",
            "cci": "CCI-000020",
            "check": "To establish dynamic privilege controls, elasticsearch relies\non external authentication mechanism (LDAP, AD, PKI), time to live (cache.ttl),\nand document/field level security.\n\nIf the external authentication is Active Directory; verify the following\nsettings.\n\n$ cat config/elasticsearch.yml | grep -A 6 -B 6 'type: \\?active_directory'\n\n\n xpack:\n  security:\n    authc:\n      realms:\n        active_directory:\n          type: active_directory\n          order: 0\n          domain_name: ad.example.com\n          url: ldaps://ad.example.com:636\n          unmapped_groups_as_roles: true | false\n\nIf these settings are not correct or missing, this is a finding.\n\nIf the external authentication is LDAP; verify the following settings.\n\n$ cat config/elasticsearch.yml | grep -A 16 -B 6 'type: \\?ldap'\n\nxpack:\n  security:\n    authc:\n      realms:\n        ldap1:\n          type: ldap\n          order: 0\n          url: 'ldaps://ldap.example.com:636'\n          bind_dn: 'cn=ldapuser, ou=users, o=services, dc=example, dc=com'\n          bind_password: changeme\n          user_search:\n            base_dn: 'dc=example,dc=com'\n            attribute: cn\n          group_search:\n            base_dn: 'dc=example,dc=com'\n          files:\n            role_mapping: 'CONFIG_DIR/x-pack/role_mapping.yml\n\nIf these settings are not correct or missing, this is a finding.\n\nIf the external authentication is PKI; verify the following settings.\n\n$ cat config/elasticsearch.yml | grep -A 6 -B 6 'type: \\?pki'\n\n xpack:\n  security:\n    authc:\n      realms:\n        pki1:\n          type: pki\n          username_pattern: 'EMAILADDRESS=(.*?)(?:,|$)'\n\nIf these settings are not correct or missing, this is a finding.\n\nThe default cache.ttl is 20m.\n\nAs a data owner, you can verify that your data model holds fields that can be\nused to assist in privilege management.\n\nAs the elasticsearch administrator, you can verify that roles exists that are\nspecific to data access, run the following CURL command:\n\n$ curl -XGET  -H 'Content-Type: application/json' -u <TEST_USER> -p\n<TEST_CREDENTIALS> https://localhost:9200/_xpack/security/role\n\nReview the role permissions, if any role is incorrect or provides general\naccess to all data, this is a finding.\n\n",
            "fix": "Configure elasticsearch realms settings to point to\norganizational supported authentication mechanism to handle account termination\nand notification.\n\nSee the official documentation for the instructions on realm configuration:\nhttps://www.elastic.co/guide/en/x-pack/current/_how_authentication_works.html\n\n\nAs a data owner, update your data model to contain fields that can be used to\ncontrol user privileges.\n\nSee the officieal documentation for the instructions on document and field\nlevel security:\nhttps://www.elastic.co/guide/en/x-pack/current/field-and-document-access-control.html"
          },
          "code": "control \"V-26733\" do\n  title \"Service Oriented Architecture (SOA) based applications must\ndynamically manage user privileges and associated access authorizations.\"\n  desc  \"Populate user metadata dynamically upon login and Implement templated\nRBAC policies with X-Pack Security to reflect the dynamic attributes of users.\n(https://www.elastic.co/guide/en/x-pack/current/field-and-document-access-control.html#templating-role-query)\"\n  impact 0.5\n  tag \"nist\": [\"AC-2 (6)\", \"Rev_3\"]\n  tag \"severity\": \"medium\"\n  tag \"rid\": \"SV-33981r1_rule\"\n  tag \"gtitle\": \"SRG-APP-000031\"\n  tag \"cci\": \"CCI-000020\"\n  tag \"check\": \"To establish dynamic privilege controls, elasticsearch relies\non external authentication mechanism (LDAP, AD, PKI), time to live (cache.ttl),\nand document/field level security.\n\nIf the external authentication is Active Directory; verify the following\nsettings.\n\n$ cat config/elasticsearch.yml | grep -A 6 -B 6 'type: \\\\?active_directory'\n\n\n xpack:\n  security:\n    authc:\n      realms:\n        active_directory:\n          type: active_directory\n          order: 0\n          domain_name: ad.example.com\n          url: ldaps://ad.example.com:636\n          unmapped_groups_as_roles: true | false\n\nIf these settings are not correct or missing, this is a finding.\n\nIf the external authentication is LDAP; verify the following settings.\n\n$ cat config/elasticsearch.yml | grep -A 16 -B 6 'type: \\\\?ldap'\n\nxpack:\n  security:\n    authc:\n      realms:\n        ldap1:\n          type: ldap\n          order: 0\n          url: 'ldaps://ldap.example.com:636'\n          bind_dn: 'cn=ldapuser, ou=users, o=services, dc=example, dc=com'\n          bind_password: changeme\n          user_search:\n            base_dn: 'dc=example,dc=com'\n            attribute: cn\n          group_search:\n            base_dn: 'dc=example,dc=com'\n          files:\n            role_mapping: 'CONFIG_DIR/x-pack/role_mapping.yml\n\nIf these settings are not correct or missing, this is a finding.\n\nIf the external authentication is PKI; verify the following settings.\n\n$ cat config/elasticsearch.yml | grep -A 6 -B 6 'type: \\\\?pki'\n\n xpack:\n  security:\n    authc:\n      realms:\n        pki1:\n          type: pki\n          username_pattern: 'EMAILADDRESS=(.*?)(?:,|$)'\n\nIf these settings are not correct or missing, this is a finding.\n\nThe default cache.ttl is 20m.\n\nAs a data owner, you can verify that your data model holds fields that can be\nused to assist in privilege management.\n\nAs the elasticsearch administrator, you can verify that roles exists that are\nspecific to data access, run the following CURL command:\n\n$ curl -XGET  -H 'Content-Type: application/json' -u <TEST_USER> -p\n<TEST_CREDENTIALS> https://localhost:9200/_xpack/security/role\n\nReview the role permissions, if any role is incorrect or provides general\naccess to all data, this is a finding.\n\n\"\n  tag \"fix\": \"Configure elasticsearch realms settings to point to\norganizational supported authentication mechanism to handle account termination\nand notification.\n\nSee the official documentation for the instructions on realm configuration:\nhttps://www.elastic.co/guide/en/x-pack/current/_how_authentication_works.html\n\n\nAs a data owner, update your data model to contain fields that can be used to\ncontrol user privileges.\n\nSee the officieal documentation for the instructions on document and field\nlevel security:\nhttps://www.elastic.co/guide/en/x-pack/current/field-and-document-access-control.html\"\n\n  begin\n\n    es_handle = es_helper(url:\"https://#{ELASTIC_IP}:#{ELASTIC_PORT}\",\n                    username: ES_ADMIN,\n                    password: ES_PASS,\n                    ssl_verify: SSL_VERIFY )\n\n    describe \"No nodes found\" do\n      subject { es_handle.nodes.nil? }\n      it { should_not be_truthy }\n    end if es_handle.nodes.nil?\n\n\n    es_handle.nodes.each do |node|\n      describe \"Authentication methods includes AD, LDAP or PKI for Node: #{node.name}\" do\n        subject { node.authc_method.any? { |x| ['pki','active_directory','ldap'].include?(x) } }\n        it{ should be true }\n      end\n    end unless es_handle.nodes.nil?\n\n    es_handle.nodes.each do |node|\n      describe.one do\n        node.authc_realm.keys.each do |auth_method|\n          describe \"Active Directory Settings for Node: #{node.name}\" do\n            subject { es_handle.settings.first.xpack.security.authc.realms[auth_method] }\n            its ('order') { should_not be_nil }\n            its ('domain_name') { should_not be_nil }\n            its ('url') { should_not be_nil }\n            its ('unmapped_groups_as_roles') { should_not be_nil }\n          end if node.authc_realm[auth_method].type.eql?('active_directory')\n\n          describe \"LDAP Settings for Node: #{node.name}\" do\n            subject { es_handle.settings.first.xpack.security.authc.realms[auth_method] }\n            its ('order') { should_not be_nil }\n            its ('url') { should_not be_nil }\n            its ('bind_dn') { should_not be_nil }\n            its ('bind_password') { should_not be_nil }\n            its ('user_search.base_dn') { should_not be_nil }\n            its ('user_search.attribute') { should_not be_nil }\n            its ('group_search.base_dn') { should_not be_nil }\n            its ('files.role_mapping') { should_not be_nil }\n          end if node.authc_realm[auth_method].type.eql?('ldap')\n\n          describe \"PKI Settings for Node: #{node.name}\" do\n            subject { node.authc_realm[auth_method] }\n            its ('order') { should_not be_nil }\n            its ('username_pattern') { should_not be_nil }\n          end if node.authc_realm[auth_method].type.eql?('pki')\n        end\n      end\n    end unless es_handle.nodes.nil?\n\n    describe es_handle do\n      its('superusers') { should be_in DOCUMENTED_SUPER_ROLES}\n    end\n\n  rescue Exception => msg\n    describe \"Exception: #{msg}\" do\n      it { should be_nil}\n    end\n  end\nend\n",
          "source_location": {
            "line": 54,
            "ref": "../elasticsearch-inspec/controls/ad+ldap+pki+role/V-26733.rb"
          },
          "results": [
            {
              "status": "passed",
              "code_desc": "Authentication methods includes AD, LDAP or PKI for Node: package-centos-72 should equal true",
              "run_time": 0.000087,
              "start_time": "2018-02-11 14:26:38 -0500"
            },
            {
              "status": "passed",
              "code_desc": "PKI Settings for Node: package-centos-72 order should not be nil",
              "run_time": 0.000078,
              "start_time": "2018-02-11 14:26:38 -0500"
            },
            {
              "status": "passed",
              "code_desc": "PKI Settings for Node: package-centos-72 username_pattern should not be nil",
              "run_time": 0.000052,
              "start_time": "2018-02-11 14:26:38 -0500"
            },
            {
              "status": "passed",
              "code_desc": "Elasticsearch Cluster https://0.0.0.0:9200 superusers should be in \"superuser\"",
              "run_time": 1.271186,
              "start_time": "2018-02-11 14:26:38 -0500"
            }
          ]
        },
        {
          "id": "V-30593",
          "title": "Applications that utilize Discretionary Access Control (DAC) must\nenforce a policy that Includes or excludes access to the granularity of a\nsingle user.",
          "desc": "Utilize an enterprise Authentication realm, create a data model that\nsupports security tags, and verify roles exists that restrict access based on\nDiscretionary Access Controls.",
          "impact": 0.5,
          "refs": [],
          "tags": {
            "nist": [
              "AC-3 (4)",
              "Rev_3"
            ],
            "severity": "medium",
            "rid": "SV-40340r1_rule",
            "gtitle": "SRG-APP-000087",
            "cci": "CCI-001694",
            "check": "To establish dynamic privilege controls, elasticsearch relies\non external authentication mechanism (LDAP, AD, PKI), time to live (cache.ttl),\nand document/field level security.\n\nIf the external authentication is Active Directory; verify the following\nsettings.\n\n$ cat config/elasticsearch.yml | grep -A 6 -B 6 'type: \\?active_directory'\n\n\n xpack:\n  security:\n    authc:\n      realms:\n        active_directory:\n          type: active_directory\n          order: 0\n          domain_name: ad.example.com\n          url: ldaps://ad.example.com:636\n          unmapped_groups_as_roles: true | false\n\nIf these settings are not correct or missing, this is a finding.\n\nIf the external authentication is LDAP; verify the following settings.\n\n$ cat config/elasticsearch.yml | grep -A 16 -B 6 'type: \\?ldap'\n\nxpack:\n  security:\n    authc:\n      realms:\n        ldap1:\n          type: ldap\n          order: 0\n          url: \"ldaps://ldap.example.com:636\"\n          bind_dn: \"cn=ldapuser, ou=users, o=services, dc=example, dc=com\"\n          bind_password: changeme\n          user_search:\n            base_dn: \"dc=example,dc=com\"\n            attribute: cn\n          group_search:\n            base_dn: \"dc=example,dc=com\"\n          files:\n            role_mapping: \"CONFIG_DIR/x-pack/role_mapping.yml\n\nIf these settings are not correct or missing, this is a finding.\n\nIf the external authentication is PKI; verify the following settings.\n\n$ cat config/elasticsearch.yml | grep -A 6 -B 6 'type: \\?pki'\n\n xpack:\n  security:\n    authc:\n      realms:\n        pki1:\n          type: pki\n          username_pattern: \"EMAILADDRESS=(.*?)(?:,|$)\"\n\nIf these settings are not correct or missing, this is a finding.\n\nThe default cache.ttl is 20m.\n\nAs a data owner, you can verify that your data model holds fields that can be\nused to assist in privilege management.\n\nAs the elasticsearch administrator, you can verify that roles exists that are\nspecific to data access, run the following CURL command:\n\n$ curl -XGET  -H 'Content-Type: application/json' -u <TEST_USER> -p\n<TEST_CREDENTIALS> https://localhost:9200/_xpack/security/role\n\nReview the role permissions, if any role is incorrect or provides general\naccess to all data, this is a finding.\n\n",
            "fix": "Configure elasticsearch realms settings to point to\norganizational supported authentication mechanism to handle account termination\nand notification.\n\nSee the official documentation for the instructions on realm configuration:\nhttps://www.elastic.co/guide/en/x-pack/current/_how_authentication_works.html\n\n\nAs a data owner, update your data model to contain fields that can be used to\ncontrol user privileges.\n\nSee the officieal documentation for the instructions on document and field\nlevel security:\nhttps://www.elastic.co/guide/en/x-pack/current/field-and-document-access-control.html"
          },
          "code": "control \"V-30593\" do\n  title \"Applications that utilize Discretionary Access Control (DAC) must\nenforce a policy that Includes or excludes access to the granularity of a\nsingle user.\"\n  desc  \"Utilize an enterprise Authentication realm, create a data model that\nsupports security tags, and verify roles exists that restrict access based on\nDiscretionary Access Controls.\"\n  impact 0.5\n  tag \"nist\": [\"AC-3 (4)\", \"Rev_3\"]\n  tag \"severity\": \"medium\"\n  tag \"rid\": \"SV-40340r1_rule\"\n  tag \"gtitle\": \"SRG-APP-000087\"\n  tag \"cci\": \"CCI-001694\"\n  tag \"check\": \"To establish dynamic privilege controls, elasticsearch relies\non external authentication mechanism (LDAP, AD, PKI), time to live (cache.ttl),\nand document/field level security.\n\nIf the external authentication is Active Directory; verify the following\nsettings.\n\n$ cat config/elasticsearch.yml | grep -A 6 -B 6 'type: \\\\?active_directory'\n\n\n xpack:\n  security:\n    authc:\n      realms:\n        active_directory:\n          type: active_directory\n          order: 0\n          domain_name: ad.example.com\n          url: ldaps://ad.example.com:636\n          unmapped_groups_as_roles: true | false\n\nIf these settings are not correct or missing, this is a finding.\n\nIf the external authentication is LDAP; verify the following settings.\n\n$ cat config/elasticsearch.yml | grep -A 16 -B 6 'type: \\\\?ldap'\n\nxpack:\n  security:\n    authc:\n      realms:\n        ldap1:\n          type: ldap\n          order: 0\n          url: \\\"ldaps://ldap.example.com:636\\\"\n          bind_dn: \\\"cn=ldapuser, ou=users, o=services, dc=example, dc=com\\\"\n          bind_password: changeme\n          user_search:\n            base_dn: \\\"dc=example,dc=com\\\"\n            attribute: cn\n          group_search:\n            base_dn: \\\"dc=example,dc=com\\\"\n          files:\n            role_mapping: \\\"CONFIG_DIR/x-pack/role_mapping.yml\n\nIf these settings are not correct or missing, this is a finding.\n\nIf the external authentication is PKI; verify the following settings.\n\n$ cat config/elasticsearch.yml | grep -A 6 -B 6 'type: \\\\?pki'\n\n xpack:\n  security:\n    authc:\n      realms:\n        pki1:\n          type: pki\n          username_pattern: \\\"EMAILADDRESS=(.*?)(?:,|$)\\\"\n\nIf these settings are not correct or missing, this is a finding.\n\nThe default cache.ttl is 20m.\n\nAs a data owner, you can verify that your data model holds fields that can be\nused to assist in privilege management.\n\nAs the elasticsearch administrator, you can verify that roles exists that are\nspecific to data access, run the following CURL command:\n\n$ curl -XGET  -H 'Content-Type: application/json' -u <TEST_USER> -p\n<TEST_CREDENTIALS> https://localhost:9200/_xpack/security/role\n\nReview the role permissions, if any role is incorrect or provides general\naccess to all data, this is a finding.\n\n\"\n  tag \"fix\": \"Configure elasticsearch realms settings to point to\norganizational supported authentication mechanism to handle account termination\nand notification.\n\nSee the official documentation for the instructions on realm configuration:\nhttps://www.elastic.co/guide/en/x-pack/current/_how_authentication_works.html\n\n\nAs a data owner, update your data model to contain fields that can be used to\ncontrol user privileges.\n\nSee the officieal documentation for the instructions on document and field\nlevel security:\nhttps://www.elastic.co/guide/en/x-pack/current/field-and-document-access-control.html\"\n\n  begin\n\n    es_handle = es_helper(url:\"https://#{ELASTIC_IP}:#{ELASTIC_PORT}\",\n                    username: ES_ADMIN,\n                    password: ES_PASS,\n                    ssl_verify: SSL_VERIFY )\n\n    describe \"No nodes found\" do\n      subject { es_handle.nodes.nil? }\n      it { should_not be_truthy }\n    end if es_handle.nodes.nil?\n\n\n    es_handle.nodes.each do |node|\n      describe \"Authentication methods includes AD, LDAP or PKI for Node: #{node.name}\" do\n        subject { node.authc_method.any? { |x| ['pki','active_directory','ldap'].include?(x) } }\n        it{ should be true }\n      end\n    end unless es_handle.nodes.nil?\n\n    es_handle.nodes.each do |node|\n      describe.one do\n        node.authc_realm.keys.each do |auth_method|\n          describe \"Active Directory Settings for Node: #{node.name}\" do\n            subject { es_handle.settings.first.xpack.security.authc.realms[auth_method] }\n            its ('order') { should_not be_nil }\n            its ('domain_name') { should_not be_nil }\n            its ('url') { should_not be_nil }\n            its ('unmapped_groups_as_roles') { should_not be_nil }\n          end if node.authc_realm[auth_method].type.eql?('active_directory')\n\n          describe \"LDAP Settings for Node: #{node.name}\" do\n            subject { es_handle.settings.first.xpack.security.authc.realms[auth_method] }\n            its ('order') { should_not be_nil }\n            its ('url') { should_not be_nil }\n            its ('bind_dn') { should_not be_nil }\n            its ('bind_password') { should_not be_nil }\n            its ('user_search.base_dn') { should_not be_nil }\n            its ('user_search.attribute') { should_not be_nil }\n            its ('group_search.base_dn') { should_not be_nil }\n            its ('files.role_mapping') { should_not be_nil }\n          end if node.authc_realm[auth_method].type.eql?('ldap')\n\n          describe \"PKI Settings for Node: #{node.name}\" do\n            subject { node.authc_realm[auth_method] }\n            its ('order') { should_not be_nil }\n            its ('username_pattern') { should_not be_nil }\n          end if node.authc_realm[auth_method].type.eql?('pki')\n        end\n      end\n    end unless es_handle.nodes.nil?\n\n    describe es_handle do\n      its('superusers') { should be_in DOCUMENTED_SUPER_ROLES}\n    end\n\n  rescue Exception => msg\n    describe \"Exception: #{msg}\" do\n      it { should be_nil}\n    end\n  end\nend\n",
          "source_location": {
            "line": 47,
            "ref": "../elasticsearch-inspec/controls/ad+ldap+pki+role/V-30593.rb"
          },
          "results": [
            {
              "status": "passed",
              "code_desc": "Authentication methods includes AD, LDAP or PKI for Node: package-centos-72 should equal true",
              "run_time": 0.000124,
              "start_time": "2018-02-11 14:26:39 -0500"
            },
            {
              "status": "passed",
              "code_desc": "PKI Settings for Node: package-centos-72 order should not be nil",
              "run_time": 0.000074,
              "start_time": "2018-02-11 14:26:39 -0500"
            },
            {
              "status": "passed",
              "code_desc": "PKI Settings for Node: package-centos-72 username_pattern should not be nil",
              "run_time": 0.000055,
              "start_time": "2018-02-11 14:26:39 -0500"
            },
            {
              "status": "passed",
              "code_desc": "Elasticsearch Cluster https://0.0.0.0:9200 superusers should be in \"superuser\"",
              "run_time": 1.343133,
              "start_time": "2018-02-11 14:26:39 -0500"
            }
          ]
        },
        {
          "id": "V-30592",
          "title": "Applications utilizing Discretionary Access Control (DAC) must enforce\na policy that limits propagation of access rights.",
          "desc": "All access to information and actions within Elasticsearch need to be\ngoverned by X-Pack Security's Role Based Access Control to limit access to\nsensitive information. To implement fine grained access control and\ndiscretionary access control, extend policy making decisions to trusted\napplication tiers able to instruct Elasticsearch to add dynamic document and\nfield-level security primitives to Elasticsearch queries and aggregations\nthrough alias filters and query dynamic query construction.",
          "impact": 0.5,
          "refs": [],
          "tags": {
            "nist": [
              "AC-3 (4)",
              "Rev_3"
            ],
            "severity": "medium",
            "rid": "SV-40339r1_rule",
            "gtitle": "SRG-APP-000085",
            "cci": "CCI-001693",
            "check": "To establish dynamic privilege controls, elasticsearch relies\non external authentication mechanism (LDAP, AD, PKI), time to live (cache.ttl),\nand document/field level security.\n\nIf the external authentication is Active Directory; verify the following\nsettings.\n\n$ cat config/elasticsearch.yml | grep -A 6 -B 6 'type: \\?active_directory'\n\n\n xpack:\n  security:\n    authc:\n      realms:\n        active_directory:\n          type: active_directory\n          order: 0\n          domain_name: ad.example.com\n          url: ldaps://ad.example.com:636\n          unmapped_groups_as_roles: true | false\n\nIf these settings are not correct or missing, this is a finding.\n\nIf the external authentication is LDAP; verify the following settings.\n\n$ cat config/elasticsearch.yml | grep -A 16 -B 6 'type: \\?ldap'\n\nxpack:\n  security:\n    authc:\n      realms:\n        ldap1:\n          type: ldap\n          order: 0\n          url: \"ldaps://ldap.example.com:636\"\n          bind_dn: \"cn=ldapuser, ou=users, o=services, dc=example, dc=com\"\n          bind_password: changeme\n          user_search:\n            base_dn: \"dc=example,dc=com\"\n            attribute: cn\n          group_search:\n            base_dn: \"dc=example,dc=com\"\n          files:\n            role_mapping: \"CONFIG_DIR/x-pack/role_mapping.yml\n\nIf these settings are not correct or missing, this is a finding.\n\nIf the external authentication is PKI; verify the following settings.\n\n$ cat config/elasticsearch.yml | grep -A 6 -B 6 'type: \\?pki'\n\n xpack:\n  security:\n    authc:\n      realms:\n        pki1:\n          type: pki\n          username_pattern: \"EMAILADDRESS=(.*?)(?:,|$)\"\n\nIf these settings are not correct or missing, this is a finding.\n\nThe default cache.ttl is 20m.\n\nAs a data owner, you can verify that your data model holds fields that can be\nused to assist in privilege management.\n\nAs the elasticsearch administrator, you can verify that roles exists that are\nspecific to data access, run the following CURL command:\n\n$ curl -XGET  -H 'Content-Type: application/json' -u <TEST_USER> -p\n<TEST_CREDENTIALS> https://localhost:9200/_xpack/security/role\n\nReview the role permissions, if any role is incorrect or provides general\naccess to all data, this is a finding.\n\n",
            "fix": "Configure elasticsearch realms settings to point to\norganizational supported authentication mechanism to handle account termination\nand notification.\n\nSee the official documentation for the instructions on realm configuration:\nhttps://www.elastic.co/guide/en/x-pack/current/_how_authentication_works.html\n\n\nAs a data owner, update your data model to contain fields that can be used to\ncontrol user privileges.\n\nSee the officieal documentation for the instructions on document and field\nlevel security:\nhttps://www.elastic.co/guide/en/x-pack/current/field-and-document-access-control.html"
          },
          "code": "control \"V-30592\" do\n  title \"Applications utilizing Discretionary Access Control (DAC) must enforce\na policy that limits propagation of access rights.\"\n  desc  \"All access to information and actions within Elasticsearch need to be\ngoverned by X-Pack Security's Role Based Access Control to limit access to\nsensitive information. To implement fine grained access control and\ndiscretionary access control, extend policy making decisions to trusted\napplication tiers able to instruct Elasticsearch to add dynamic document and\nfield-level security primitives to Elasticsearch queries and aggregations\nthrough alias filters and query dynamic query construction.\"\n  impact 0.5\n  tag \"nist\": [\"AC-3 (4)\", \"Rev_3\"]\n  tag \"severity\": \"medium\"\n  tag \"rid\": \"SV-40339r1_rule\"\n  tag \"gtitle\": \"SRG-APP-000085\"\n  tag \"cci\": \"CCI-001693\"\n  tag \"check\": \"To establish dynamic privilege controls, elasticsearch relies\non external authentication mechanism (LDAP, AD, PKI), time to live (cache.ttl),\nand document/field level security.\n\nIf the external authentication is Active Directory; verify the following\nsettings.\n\n$ cat config/elasticsearch.yml | grep -A 6 -B 6 'type: \\\\?active_directory'\n\n\n xpack:\n  security:\n    authc:\n      realms:\n        active_directory:\n          type: active_directory\n          order: 0\n          domain_name: ad.example.com\n          url: ldaps://ad.example.com:636\n          unmapped_groups_as_roles: true | false\n\nIf these settings are not correct or missing, this is a finding.\n\nIf the external authentication is LDAP; verify the following settings.\n\n$ cat config/elasticsearch.yml | grep -A 16 -B 6 'type: \\\\?ldap'\n\nxpack:\n  security:\n    authc:\n      realms:\n        ldap1:\n          type: ldap\n          order: 0\n          url: \\\"ldaps://ldap.example.com:636\\\"\n          bind_dn: \\\"cn=ldapuser, ou=users, o=services, dc=example, dc=com\\\"\n          bind_password: changeme\n          user_search:\n            base_dn: \\\"dc=example,dc=com\\\"\n            attribute: cn\n          group_search:\n            base_dn: \\\"dc=example,dc=com\\\"\n          files:\n            role_mapping: \\\"CONFIG_DIR/x-pack/role_mapping.yml\n\nIf these settings are not correct or missing, this is a finding.\n\nIf the external authentication is PKI; verify the following settings.\n\n$ cat config/elasticsearch.yml | grep -A 6 -B 6 'type: \\\\?pki'\n\n xpack:\n  security:\n    authc:\n      realms:\n        pki1:\n          type: pki\n          username_pattern: \\\"EMAILADDRESS=(.*?)(?:,|$)\\\"\n\nIf these settings are not correct or missing, this is a finding.\n\nThe default cache.ttl is 20m.\n\nAs a data owner, you can verify that your data model holds fields that can be\nused to assist in privilege management.\n\nAs the elasticsearch administrator, you can verify that roles exists that are\nspecific to data access, run the following CURL command:\n\n$ curl -XGET  -H 'Content-Type: application/json' -u <TEST_USER> -p\n<TEST_CREDENTIALS> https://localhost:9200/_xpack/security/role\n\nReview the role permissions, if any role is incorrect or provides general\naccess to all data, this is a finding.\n\n\"\n  tag \"fix\": \"Configure elasticsearch realms settings to point to\norganizational supported authentication mechanism to handle account termination\nand notification.\n\nSee the official documentation for the instructions on realm configuration:\nhttps://www.elastic.co/guide/en/x-pack/current/_how_authentication_works.html\n\n\nAs a data owner, update your data model to contain fields that can be used to\ncontrol user privileges.\n\nSee the officieal documentation for the instructions on document and field\nlevel security:\nhttps://www.elastic.co/guide/en/x-pack/current/field-and-document-access-control.html\"\n\n  begin\n\n    es_handle = es_helper(url:\"https://#{ELASTIC_IP}:#{ELASTIC_PORT}\",\n                    username: ES_ADMIN,\n                    password: ES_PASS,\n                    ssl_verify: SSL_VERIFY )\n\n    describe \"No nodes found\" do\n      subject { es_handle.nodes.nil? }\n      it { should_not be_truthy }\n    end if es_handle.nodes.nil?\n\n\n    es_handle.nodes.each do |node|\n      describe \"Authentication methods includes AD, LDAP or PKI for Node: #{node.name}\" do\n        subject { node.authc_method.any? { |x| ['pki','active_directory','ldap'].include?(x) } }\n        it{ should be true }\n      end\n    end unless es_handle.nodes.nil?\n\n    es_handle.nodes.each do |node|\n      describe.one do\n        node.authc_realm.keys.each do |auth_method|\n          describe \"Active Directory Settings for Node: #{node.name}\" do\n            subject { es_handle.settings.first.xpack.security.authc.realms[auth_method] }\n            its ('order') { should_not be_nil }\n            its ('domain_name') { should_not be_nil }\n            its ('url') { should_not be_nil }\n            its ('unmapped_groups_as_roles') { should_not be_nil }\n          end if node.authc_realm[auth_method].type.eql?('active_directory')\n\n          describe \"LDAP Settings for Node: #{node.name}\" do\n            subject { es_handle.settings.first.xpack.security.authc.realms[auth_method] }\n            its ('order') { should_not be_nil }\n            its ('url') { should_not be_nil }\n            its ('bind_dn') { should_not be_nil }\n            its ('bind_password') { should_not be_nil }\n            its ('user_search.base_dn') { should_not be_nil }\n            its ('user_search.attribute') { should_not be_nil }\n            its ('group_search.base_dn') { should_not be_nil }\n            its ('files.role_mapping') { should_not be_nil }\n          end if node.authc_realm[auth_method].type.eql?('ldap')\n\n          describe \"PKI Settings for Node: #{node.name}\" do\n            subject { node.authc_realm[auth_method] }\n            its ('order') { should_not be_nil }\n            its ('username_pattern') { should_not be_nil }\n          end if node.authc_realm[auth_method].type.eql?('pki')\n        end\n      end\n    end unless es_handle.nodes.nil?\n\n    describe es_handle do\n      its('superusers') { should be_in DOCUMENTED_SUPER_ROLES}\n    end\n\n  rescue Exception => msg\n    describe \"Exception: #{msg}\" do\n      it { should be_nil}\n    end\n  end\nend\n",
          "source_location": {
            "line": 47,
            "ref": "../elasticsearch-inspec/controls/ad+ldap+pki+role/V-30592.rb"
          },
          "results": [
            {
              "status": "passed",
              "code_desc": "Authentication methods includes AD, LDAP or PKI for Node: package-centos-72 should equal true",
              "run_time": 0.000114,
              "start_time": "2018-02-11 14:26:41 -0500"
            },
            {
              "status": "passed",
              "code_desc": "PKI Settings for Node: package-centos-72 order should not be nil",
              "run_time": 0.000074,
              "start_time": "2018-02-11 14:26:41 -0500"
            },
            {
              "status": "passed",
              "code_desc": "PKI Settings for Node: package-centos-72 username_pattern should not be nil",
              "run_time": 0.000062,
              "start_time": "2018-02-11 14:26:41 -0500"
            },
            {
              "status": "passed",
              "code_desc": "Elasticsearch Cluster https://0.0.0.0:9200 superusers should be in \"superuser\"",
              "run_time": 1.344556,
              "start_time": "2018-02-11 14:26:41 -0500"
            }
          ]
        },
        {
          "id": "V-26750",
          "title": "The application must enforce Discretionary Access Control (DAC) policy\nallowing users to specify and control sharing by named individuals, groups of\nindividuals, or by both, limiting propagation of access rights and includes or\nexcludes access to the granularity of a single user.",
          "desc": "Plan for the capability to implement Discretionary Access Control\n(DAC) with includes or excludes access to the single user. Utilize X-Pack\nSecurity's Field and Document Level Security features to restrict access based\non information within the document.",
          "impact": 0.5,
          "refs": [],
          "tags": {
            "nist": [
              "AC-3 (4)",
              "Rev_3"
            ],
            "severity": "medium",
            "rid": "SV-33998r1_rule",
            "gtitle": "SRG-APP-000036",
            "cci": "CCI-001362",
            "check": "To establish dynamic privilege controls, elasticsearch relies\non external authentication mechanism (LDAP, AD, PKI), time to live (cache.ttl),\nand document/field level security.\n\nIf the external authentication is Active Directory; verify the following\nsettings.\n\n$ cat config/elasticsearch.yml | grep -A 6 -B 6 'type: \\?active_directory'\n\n\n xpack:\n  security:\n    authc:\n      realms:\n        active_directory:\n          type: active_directory\n          order: 0\n          domain_name: ad.example.com\n          url: ldaps://ad.example.com:636\n          unmapped_groups_as_roles: true | false\n\nIf these settings are not correct or missing, this is a finding.\n\nIf the external authentication is LDAP; verify the following settings.\n\n$ cat config/elasticsearch.yml | grep -A 16 -B 6 'type: \\?ldap'\n\nxpack:\n  security:\n    authc:\n      realms:\n        ldap1:\n          type: ldap\n          order: 0\n          url: \"ldaps://ldap.example.com:636\"\n          bind_dn: \"cn=ldapuser, ou=users, o=services, dc=example, dc=com\"\n          bind_password: changeme\n          user_search:\n            base_dn: \"dc=example,dc=com\"\n            attribute: cn\n          group_search:\n            base_dn: \"dc=example,dc=com\"\n          files:\n            role_mapping: \"CONFIG_DIR/x-pack/role_mapping.yml\n\nIf these settings are not correct or missing, this is a finding.\n\nIf the external authentication is PKI; verify the following settings.\n\n$ cat config/elasticsearch.yml | grep -A 6 -B 6 'type: \\?pki'\n\n xpack:\n  security:\n    authc:\n      realms:\n        pki1:\n          type: pki\n          username_pattern: \"EMAILADDRESS=(.*?)(?:,|$)\"\n\nIf these settings are not correct or missing, this is a finding.\n\nThe default cache.ttl is 20m.\n\nAs a data owner, you can verify that your data model holds fields that can be\nused to assist in privilege management.\n\nAs the elasticsearch administrator, you can verify that roles exists that are\nspecific to data access, run the following CURL command:\n\n$ curl -XGET  -H 'Content-Type: application/json' -u <TEST_USER> -p\n<TEST_CREDENTIALS> https://localhost:9200/_xpack/security/role\n\nReview the role permissions, if any role is incorrect or provides general\naccess to all data, this is a finding.\n\n",
            "fix": "Configure elasticsearch realms settings to point to\norganizational supported authentication mechanism to handle account termination\nand notification.\n\nSee the official documentation for the instructions on realm configuration:\nhttps://www.elastic.co/guide/en/x-pack/current/_how_authentication_works.html\n\n\nAs a data owner, update your data model to contain fields that can be used to\ncontrol user privileges.\n\nSee the officieal documentation for the instructions on document and field\nlevel security:\nhttps://www.elastic.co/guide/en/x-pack/current/field-and-document-access-control.html"
          },
          "code": "control \"V-26750\" do\n  title \"The application must enforce Discretionary Access Control (DAC) policy\nallowing users to specify and control sharing by named individuals, groups of\nindividuals, or by both, limiting propagation of access rights and includes or\nexcludes access to the granularity of a single user.\"\n  desc  \"Plan for the capability to implement Discretionary Access Control\n(DAC) with includes or excludes access to the single user. Utilize X-Pack\nSecurity's Field and Document Level Security features to restrict access based\non information within the document.\"\n  impact 0.5\n  tag \"nist\": [\"AC-3 (4)\", \"Rev_3\"]\n  tag \"severity\": \"medium\"\n  tag \"rid\": \"SV-33998r1_rule\"\n  tag \"gtitle\": \"SRG-APP-000036\"\n  tag \"cci\": \"CCI-001362\"\n  tag \"check\": \"To establish dynamic privilege controls, elasticsearch relies\non external authentication mechanism (LDAP, AD, PKI), time to live (cache.ttl),\nand document/field level security.\n\nIf the external authentication is Active Directory; verify the following\nsettings.\n\n$ cat config/elasticsearch.yml | grep -A 6 -B 6 'type: \\\\?active_directory'\n\n\n xpack:\n  security:\n    authc:\n      realms:\n        active_directory:\n          type: active_directory\n          order: 0\n          domain_name: ad.example.com\n          url: ldaps://ad.example.com:636\n          unmapped_groups_as_roles: true | false\n\nIf these settings are not correct or missing, this is a finding.\n\nIf the external authentication is LDAP; verify the following settings.\n\n$ cat config/elasticsearch.yml | grep -A 16 -B 6 'type: \\\\?ldap'\n\nxpack:\n  security:\n    authc:\n      realms:\n        ldap1:\n          type: ldap\n          order: 0\n          url: \\\"ldaps://ldap.example.com:636\\\"\n          bind_dn: \\\"cn=ldapuser, ou=users, o=services, dc=example, dc=com\\\"\n          bind_password: changeme\n          user_search:\n            base_dn: \\\"dc=example,dc=com\\\"\n            attribute: cn\n          group_search:\n            base_dn: \\\"dc=example,dc=com\\\"\n          files:\n            role_mapping: \\\"CONFIG_DIR/x-pack/role_mapping.yml\n\nIf these settings are not correct or missing, this is a finding.\n\nIf the external authentication is PKI; verify the following settings.\n\n$ cat config/elasticsearch.yml | grep -A 6 -B 6 'type: \\\\?pki'\n\n xpack:\n  security:\n    authc:\n      realms:\n        pki1:\n          type: pki\n          username_pattern: \\\"EMAILADDRESS=(.*?)(?:,|$)\\\"\n\nIf these settings are not correct or missing, this is a finding.\n\nThe default cache.ttl is 20m.\n\nAs a data owner, you can verify that your data model holds fields that can be\nused to assist in privilege management.\n\nAs the elasticsearch administrator, you can verify that roles exists that are\nspecific to data access, run the following CURL command:\n\n$ curl -XGET  -H 'Content-Type: application/json' -u <TEST_USER> -p\n<TEST_CREDENTIALS> https://localhost:9200/_xpack/security/role\n\nReview the role permissions, if any role is incorrect or provides general\naccess to all data, this is a finding.\n\n\"\n  tag \"fix\": \"Configure elasticsearch realms settings to point to\norganizational supported authentication mechanism to handle account termination\nand notification.\n\nSee the official documentation for the instructions on realm configuration:\nhttps://www.elastic.co/guide/en/x-pack/current/_how_authentication_works.html\n\n\nAs a data owner, update your data model to contain fields that can be used to\ncontrol user privileges.\n\nSee the officieal documentation for the instructions on document and field\nlevel security:\nhttps://www.elastic.co/guide/en/x-pack/current/field-and-document-access-control.html\"\n\n  begin\n\n    es_handle = es_helper(url:\"https://#{ELASTIC_IP}:#{ELASTIC_PORT}\",\n                    username: ES_ADMIN,\n                    password: ES_PASS,\n                    ssl_verify: SSL_VERIFY )\n\n    describe \"No nodes found\" do\n      subject { es_handle.nodes.nil? }\n      it { should_not be_truthy }\n    end if es_handle.nodes.nil?\n\n\n    es_handle.nodes.each do |node|\n      describe \"Authentication methods includes AD, LDAP or PKI for Node: #{node.name}\" do\n        subject { node.authc_method.any? { |x| ['pki','active_directory','ldap'].include?(x) } }\n        it{ should be true }\n      end\n    end unless es_handle.nodes.nil?\n\n    es_handle.nodes.each do |node|\n      describe.one do\n        node.authc_realm.keys.each do |auth_method|\n          describe \"Active Directory Settings for Node: #{node.name}\" do\n            subject { es_handle.settings.first.xpack.security.authc.realms[auth_method] }\n            its ('order') { should_not be_nil }\n            its ('domain_name') { should_not be_nil }\n            its ('url') { should_not be_nil }\n            its ('unmapped_groups_as_roles') { should_not be_nil }\n          end if node.authc_realm[auth_method].type.eql?('active_directory')\n\n          describe \"LDAP Settings for Node: #{node.name}\" do\n            subject { es_handle.settings.first.xpack.security.authc.realms[auth_method] }\n            its ('order') { should_not be_nil }\n            its ('url') { should_not be_nil }\n            its ('bind_dn') { should_not be_nil }\n            its ('bind_password') { should_not be_nil }\n            its ('user_search.base_dn') { should_not be_nil }\n            its ('user_search.attribute') { should_not be_nil }\n            its ('group_search.base_dn') { should_not be_nil }\n            its ('files.role_mapping') { should_not be_nil }\n          end if node.authc_realm[auth_method].type.eql?('ldap')\n\n          describe \"PKI Settings for Node: #{node.name}\" do\n            subject { node.authc_realm[auth_method] }\n            its ('order') { should_not be_nil }\n            its ('username_pattern') { should_not be_nil }\n          end if node.authc_realm[auth_method].type.eql?('pki')\n        end\n      end\n    end unless es_handle.nodes.nil?\n\n    describe es_handle do\n      its('superusers') { should be_in DOCUMENTED_SUPER_ROLES}\n    end\n\n  rescue Exception => msg\n    describe \"Exception: #{msg}\" do\n      it { should be_nil}\n    end\n  end\nend\n",
          "source_location": {
            "line": 54,
            "ref": "../elasticsearch-inspec/controls/ad+ldap+pki+role/V-26750.rb"
          },
          "results": [
            {
              "status": "passed",
              "code_desc": "Authentication methods includes AD, LDAP or PKI for Node: package-centos-72 should equal true",
              "run_time": 0.000139,
              "start_time": "2018-02-11 14:26:42 -0500"
            },
            {
              "status": "passed",
              "code_desc": "PKI Settings for Node: package-centos-72 order should not be nil",
              "run_time": 0.00009,
              "start_time": "2018-02-11 14:26:42 -0500"
            },
            {
              "status": "passed",
              "code_desc": "PKI Settings for Node: package-centos-72 username_pattern should not be nil",
              "run_time": 0.000115,
              "start_time": "2018-02-11 14:26:42 -0500"
            },
            {
              "status": "passed",
              "code_desc": "Elasticsearch Cluster https://0.0.0.0:9200 superusers should be in \"superuser\"",
              "run_time": 1.339609,
              "start_time": "2018-02-11 14:26:42 -0500"
            }
          ]
        },
        {
          "id": "V-26860",
          "title": "The application must produce audit records that contain sufficient\ninformation to establish the outcome (success or failure) of the events.",
          "desc": "Utilize perimeter, application, centralized authentication, and\nrepository audit controls to audit the use of systems in real time with\nsufficient context.  X-Pack Security audit controls should be enabled to audit\nthe defaults of all HTTP/S based access to Elasticsearch.  All applications\nshould use HTTP/S  rather than Elasticsearch transport protocol.",
          "impact": 0.5,
          "refs": [],
          "tags": {
            "nist": [
              "AU-3",
              "Rev_4"
            ],
            "severity": "medium",
            "rid": "SV-34140r1_rule",
            "gtitle": "SRG-APP-000099",
            "cci": "CCI-000134",
            "check": "Check Elasticsearch.yml settings and existing audit records to\nverify information specific to the necessary content of the event is being\ncaptured and stored with audit records.\n\nAs the application administrator (usually elasticsearch, check the\nxpack.security.audit.outputs setting contains logfile by running the following:\n\n\n$ cat config/elasticsearch.yml | grep xpack.security.audit.outputs\n\nIf this configuration setting is not present, this is a finding.  If this\nconfiguration setting does not contain logfile, this is a finding.\n\nFor a complete list of extra information that can be added to log_line_prefix,\nsee the official documentation:\nhttps://www.elastic.co/guide/en/x-pack/current/auditing.html\n\n If the current settings do not provide enough information regarding the\ncontent of the event, this is a finding.",
            "fix": "Configure elasticsearch audit settings to contain sufficient\ninformation to establish the outcome of an event occurred.\n\nSee the official documentation for the instructions on audit configuration:\nhttps://www.elastic.co/guide/en/x-pack/current/auditing.html"
          },
          "code": "control \"V-26860\" do\n  title \"The application must produce audit records that contain sufficient\ninformation to establish the outcome (success or failure) of the events.\"\n  desc  \"Utilize perimeter, application, centralized authentication, and\nrepository audit controls to audit the use of systems in real time with\nsufficient context.  X-Pack Security audit controls should be enabled to audit\nthe defaults of all HTTP/S based access to Elasticsearch.  All applications\nshould use HTTP/S  rather than Elasticsearch transport protocol.\"\n  impact 0.5\n  tag \"nist\": [\"AU-3\", \"Rev_4\"]\n  tag \"severity\": \"medium\"\n  tag \"rid\": \"SV-34140r1_rule\"\n  tag \"gtitle\": \"SRG-APP-000099\"\n  tag \"cci\": \"CCI-000134\"\n  tag \"check\": \"Check Elasticsearch.yml settings and existing audit records to\nverify information specific to the necessary content of the event is being\ncaptured and stored with audit records.\n\nAs the application administrator (usually elasticsearch, check the\nxpack.security.audit.outputs setting contains logfile by running the following:\n\n\n$ cat config/elasticsearch.yml | grep xpack.security.audit.outputs\n\nIf this configuration setting is not present, this is a finding.  If this\nconfiguration setting does not contain logfile, this is a finding.\n\nFor a complete list of extra information that can be added to log_line_prefix,\nsee the official documentation:\nhttps://www.elastic.co/guide/en/x-pack/current/auditing.html\n\n If the current settings do not provide enough information regarding the\ncontent of the event, this is a finding.\"\n  tag \"fix\": \"Configure elasticsearch audit settings to contain sufficient\ninformation to establish the outcome of an event occurred.\n\nSee the official documentation for the instructions on audit configuration:\nhttps://www.elastic.co/guide/en/x-pack/current/auditing.html\"\n\n  begin\n    es_handle = es_helper(url:\"https://#{ELASTIC_IP}:#{ELASTIC_PORT}\",\n                    username: ES_ADMIN,\n                    password: ES_PASS,\n                    ssl_verify: SSL_VERIFY )\n\n    describe \"No nodes found\" do\n      subject { es_handle.nodes.nil? }\n      it { should_not be_truthy }\n    end if es_handle.nodes.nil?\n\n    es_handle.nodes.each do |node|\n      describe \"Audit Settings for Node: #{node.name}\" do\n        subject { node.audit }\n        its('enabled') { should eq 'true' }\n        its('outputs') { should include 'logfile' }\n        its('logfile.events.include') { should match_array ES_INCLUDED_LOGEVENTS }\n        its('logfile.events.exclude') { should match_array ES_EXCLUDED_LOGEVENTS }\n      end\n    end unless es_handle.nodes.nil?\n\n    describe \"Audit Settings from ES_CONF_YML\" do\n      subject { yaml(ELASTICSEARCH_CONF) }\n      its(['xpack.security.audit.enabled']) { should eq true }\n      its(['xpack.security.audit.outputs']) { should include 'logfile' }\n      its(['xpack.security.audit.logfile.events.include']) { should match_array ES_INCLUDED_LOGEVENTS }\n      its(['xpack.security.audit.logfile.events.exclude']) { should match_array ES_EXCLUDED_LOGEVENTS }\n    end\n\n  rescue Exception => msg\n    describe \"Exception: #{msg}\" do\n      it { should be_nil}\n    end\n  end\nend\n",
          "source_location": {
            "line": 54,
            "ref": "../elasticsearch-inspec/controls/audit/V-26860.rb"
          },
          "results": [
            {
              "status": "passed",
              "code_desc": "Audit Settings for Node: package-centos-72 enabled should eq \"true\"",
              "run_time": 0.000107,
              "start_time": "2018-02-11 14:26:43 -0500"
            },
            {
              "status": "passed",
              "code_desc": "Audit Settings for Node: package-centos-72 outputs should include \"logfile\"",
              "run_time": 0.000093,
              "start_time": "2018-02-11 14:26:43 -0500"
            },
            {
              "status": "passed",
              "code_desc": "Audit Settings for Node: package-centos-72 logfile.events.include should contain exactly \"access_denied\", \"anonymous_access_denied\", \"authentication_failed\", \"connection_denied\", \"tampered_request\", \"run_as_denied\", and \"run_as_granted\"",
              "run_time": 0.000155,
              "start_time": "2018-02-11 14:26:43 -0500"
            },
            {
              "status": "passed",
              "code_desc": "Audit Settings for Node: package-centos-72 logfile.events.exclude should contain exactly \"access_granted\"",
              "run_time": 0.000076,
              "start_time": "2018-02-11 14:26:43 -0500"
            },
            {
              "status": "passed",
              "code_desc": "Audit Settings from ES_CONF_YML [\"xpack.security.audit.enabled\"] should eq true",
              "run_time": 0.00055,
              "start_time": "2018-02-11 14:26:43 -0500"
            },
            {
              "status": "passed",
              "code_desc": "Audit Settings from ES_CONF_YML [\"xpack.security.audit.outputs\"] should include \"logfile\"",
              "run_time": 0.000501,
              "start_time": "2018-02-11 14:26:43 -0500"
            },
            {
              "status": "passed",
              "code_desc": "Audit Settings from ES_CONF_YML [\"xpack.security.audit.logfile.events.include\"] should contain exactly \"access_denied\", \"anonymous_access_denied\", \"authentication_failed\", \"connection_denied\", \"tampered_request\", \"run_as_denied\", and \"run_as_granted\"",
              "run_time": 0.000504,
              "start_time": "2018-02-11 14:26:43 -0500"
            },
            {
              "status": "passed",
              "code_desc": "Audit Settings from ES_CONF_YML [\"xpack.security.audit.logfile.events.exclude\"] should contain exactly \"access_granted\"",
              "run_time": 0.000499,
              "start_time": "2018-02-11 14:26:43 -0500"
            }
          ]
        },
        {
          "id": "V-26904",
          "title": "The application must initiate session auditing upon start up.",
          "desc": "Utilize perimeter, application, centralized authentication, and\nrepository audit controls to audit the use of systems in real time with\nsufficient context.  X-Pack Security audit controls should be enabled to audit\nthe defaults of all HTTP/S based access to Elasticsearch.  All applications\nshould use HTTP/S  rather than Elasticsearch transport protocol.",
          "impact": 0.5,
          "refs": [],
          "tags": {
            "nist": [
              "AU-14 (1)",
              "Rev_4"
            ],
            "severity": "medium",
            "rid": "SV-34184r1_rule",
            "gtitle": "SRG-APP-000092",
            "cci": "CCI-001464",
            "check": "Check Elasticsearch.yml settings and existing audit records to\nverify information specific to the necessary content of the event is being\ncaptured and stored with audit records.\n\nAs the application administrator (usually elasticsearch, check the\nxpack.security.audit.outputs setting contains logfile by running the following:\n\n\n$ cat config/elasticsearch.yml | grep xpack.security.audit.outputs\n\nIf this configuration setting is not present, this is a finding.  If this\nconfiguration setting does not contain logfile, this is a finding.\n\nFor a complete list of extra information that can be added to log_line_prefix,\nsee the official documentation:\nhttps://www.elastic.co/guide/en/x-pack/current/auditing.html\n\n If the current settings do not provide enough information regarding the\ncontent of the event, this is a finding.",
            "fix": "Configure elasticsearch audit settings to contain sufficient\ninformation to establish where an event occurred.\n\nSee the official documentation for the instructions on audit configuration:\nhttps://www.elastic.co/guide/en/x-pack/current/auditing.html"
          },
          "code": "control \"V-26904\" do\n  title \"The application must initiate session auditing upon start up.\"\n  desc  \"Utilize perimeter, application, centralized authentication, and\nrepository audit controls to audit the use of systems in real time with\nsufficient context.  X-Pack Security audit controls should be enabled to audit\nthe defaults of all HTTP/S based access to Elasticsearch.  All applications\nshould use HTTP/S  rather than Elasticsearch transport protocol.\"\n  impact 0.5\n  tag \"nist\": [\"AU-14 (1)\", \"Rev_4\"]\n  tag \"severity\": \"medium\"\n  tag \"rid\": \"SV-34184r1_rule\"\n  tag \"gtitle\": \"SRG-APP-000092\"\n  tag \"cci\": \"CCI-001464\"\n  tag \"check\": \"Check Elasticsearch.yml settings and existing audit records to\nverify information specific to the necessary content of the event is being\ncaptured and stored with audit records.\n\nAs the application administrator (usually elasticsearch, check the\nxpack.security.audit.outputs setting contains logfile by running the following:\n\n\n$ cat config/elasticsearch.yml | grep xpack.security.audit.outputs\n\nIf this configuration setting is not present, this is a finding.  If this\nconfiguration setting does not contain logfile, this is a finding.\n\nFor a complete list of extra information that can be added to log_line_prefix,\nsee the official documentation:\nhttps://www.elastic.co/guide/en/x-pack/current/auditing.html\n\n If the current settings do not provide enough information regarding the\ncontent of the event, this is a finding.\"\n  tag \"fix\": \"Configure elasticsearch audit settings to contain sufficient\ninformation to establish where an event occurred.\n\nSee the official documentation for the instructions on audit configuration:\nhttps://www.elastic.co/guide/en/x-pack/current/auditing.html\"\n\n  begin\n    es_handle = es_helper(url:\"https://#{ELASTIC_IP}:#{ELASTIC_PORT}\",\n                    username: ES_ADMIN,\n                    password: ES_PASS,\n                    ssl_verify: SSL_VERIFY )\n\n    describe \"No nodes found\" do\n      subject { es_handle.nodes.nil? }\n      it { should_not be_truthy }\n    end if es_handle.nodes.nil?\n\n    es_handle.nodes.each do |node|\n      describe \"Audit Settings for Node: #{node.name}\" do\n        subject { node.audit }\n        its('enabled') { should eq 'true' }\n        its('outputs') { should include 'logfile' }\n        its('logfile.events.include') { should match_array ES_INCLUDED_LOGEVENTS }\n        its('logfile.events.exclude') { should match_array ES_EXCLUDED_LOGEVENTS }\n      end\n    end unless es_handle.nodes.nil?\n\n    describe \"Audit Settings from ES_CONF_YML\" do\n      subject { yaml(ELASTICSEARCH_CONF) }\n      its(['xpack.security.audit.enabled']) { should eq true }\n      its(['xpack.security.audit.outputs']) { should include 'logfile' }\n      its(['xpack.security.audit.logfile.events.include']) { should match_array ES_INCLUDED_LOGEVENTS }\n      its(['xpack.security.audit.logfile.events.exclude']) { should match_array ES_EXCLUDED_LOGEVENTS }\n    end\n\n  rescue Exception => msg\n    describe \"Exception: #{msg}\" do\n      it { should be_nil}\n    end\n  end\nend\n",
          "source_location": {
            "line": 53,
            "ref": "../elasticsearch-inspec/controls/audit/V-26904.rb"
          },
          "results": [
            {
              "status": "passed",
              "code_desc": "Audit Settings for Node: package-centos-72 enabled should eq \"true\"",
              "run_time": 0.000073,
              "start_time": "2018-02-11 14:26:43 -0500"
            },
            {
              "status": "passed",
              "code_desc": "Audit Settings for Node: package-centos-72 outputs should include \"logfile\"",
              "run_time": 0.000076,
              "start_time": "2018-02-11 14:26:43 -0500"
            },
            {
              "status": "passed",
              "code_desc": "Audit Settings for Node: package-centos-72 logfile.events.include should contain exactly \"access_denied\", \"anonymous_access_denied\", \"authentication_failed\", \"connection_denied\", \"tampered_request\", \"run_as_denied\", and \"run_as_granted\"",
              "run_time": 0.000139,
              "start_time": "2018-02-11 14:26:43 -0500"
            },
            {
              "status": "passed",
              "code_desc": "Audit Settings for Node: package-centos-72 logfile.events.exclude should contain exactly \"access_granted\"",
              "run_time": 0.000074,
              "start_time": "2018-02-11 14:26:43 -0500"
            },
            {
              "status": "passed",
              "code_desc": "Audit Settings from ES_CONF_YML [\"xpack.security.audit.enabled\"] should eq true",
              "run_time": 0.000493,
              "start_time": "2018-02-11 14:26:43 -0500"
            },
            {
              "status": "passed",
              "code_desc": "Audit Settings from ES_CONF_YML [\"xpack.security.audit.outputs\"] should include \"logfile\"",
              "run_time": 0.000468,
              "start_time": "2018-02-11 14:26:43 -0500"
            },
            {
              "status": "passed",
              "code_desc": "Audit Settings from ES_CONF_YML [\"xpack.security.audit.logfile.events.include\"] should contain exactly \"access_denied\", \"anonymous_access_denied\", \"authentication_failed\", \"connection_denied\", \"tampered_request\", \"run_as_denied\", and \"run_as_granted\"",
              "run_time": 0.00052,
              "start_time": "2018-02-11 14:26:43 -0500"
            },
            {
              "status": "passed",
              "code_desc": "Audit Settings from ES_CONF_YML [\"xpack.security.audit.logfile.events.exclude\"] should contain exactly \"access_granted\"",
              "run_time": 0.000458,
              "start_time": "2018-02-11 14:26:43 -0500"
            }
          ]
        },
        {
          "id": "V-26864",
          "title": "The application must produce audit records containing sufficient\ninformation to establish the identity of any user/subject or process associated\nwith the event.",
          "desc": "Utilize perimeter, application, centralized authentication, and\nrepository audit controls to audit the use of systems in real time with\nsufficient context.  X-Pack Security audit controls should be enabled to audit\nthe defaults of all HTTP/S based access to Elasticsearch.  All applications\nshould use HTTP/S  rather than Elasticsearch transport protocol.",
          "impact": 0.5,
          "refs": [],
          "tags": {
            "nist": [
              "AU-3",
              "Rev_4"
            ],
            "severity": "medium",
            "rid": "SV-34144r1_rule",
            "gtitle": "SRG-APP-000100",
            "cci": "CCI-001487",
            "check": "Check Elasticsearch.yml settings and existing audit records to\nverify information specific to the necessary content of the event is being\ncaptured and stored with audit records.\n\nAs the application administrator (usually elasticsearch, check the\nxpack.security.audit.outputs setting contains logfile by running the following:\n\n\n$ cat config/elasticsearch.yml | grep xpack.security.audit.outputs\n\nIf this configuration setting is not present, this is a finding.  If this\nconfiguration setting does not contain logfile, this is a finding.\n\nFor a complete list of extra information that can be added to log_line_prefix,\nsee the official documentation:\nhttps://www.elastic.co/guide/en/x-pack/current/auditing.html\n\n If the current settings do not provide enough information regarding the\ncontent of the event, this is a finding.",
            "fix": "Configure elasticsearch audit settings to contain sufficient\ninformation to establish the user/subject associated with an event.\n\nSee the official documentation for the instructions on audit configuration:\nhttps://www.elastic.co/guide/en/x-pack/current/auditing.html"
          },
          "code": "control \"V-26864\" do\n  title \"The application must produce audit records containing sufficient\ninformation to establish the identity of any user/subject or process associated\nwith the event.\"\n  desc  \"Utilize perimeter, application, centralized authentication, and\nrepository audit controls to audit the use of systems in real time with\nsufficient context.  X-Pack Security audit controls should be enabled to audit\nthe defaults of all HTTP/S based access to Elasticsearch.  All applications\nshould use HTTP/S  rather than Elasticsearch transport protocol.\"\n  impact 0.5\n  tag \"nist\": [\"AU-3\", \"Rev_4\"]\n  tag \"severity\": \"medium\"\n  tag \"rid\": \"SV-34144r1_rule\"\n  tag \"gtitle\": \"SRG-APP-000100\"\n  tag \"cci\": \"CCI-001487\"\n  tag \"check\": \"Check Elasticsearch.yml settings and existing audit records to\nverify information specific to the necessary content of the event is being\ncaptured and stored with audit records.\n\nAs the application administrator (usually elasticsearch, check the\nxpack.security.audit.outputs setting contains logfile by running the following:\n\n\n$ cat config/elasticsearch.yml | grep xpack.security.audit.outputs\n\nIf this configuration setting is not present, this is a finding.  If this\nconfiguration setting does not contain logfile, this is a finding.\n\nFor a complete list of extra information that can be added to log_line_prefix,\nsee the official documentation:\nhttps://www.elastic.co/guide/en/x-pack/current/auditing.html\n\n If the current settings do not provide enough information regarding the\ncontent of the event, this is a finding.\"\n  tag \"fix\": \"Configure elasticsearch audit settings to contain sufficient\ninformation to establish the user/subject associated with an event.\n\nSee the official documentation for the instructions on audit configuration:\nhttps://www.elastic.co/guide/en/x-pack/current/auditing.html\"\n\n  begin\n    es_handle = es_helper(url:\"https://#{ELASTIC_IP}:#{ELASTIC_PORT}\",\n                    username: ES_ADMIN,\n                    password: ES_PASS,\n                    ssl_verify: SSL_VERIFY )\n\n    describe \"No nodes found\" do\n      subject { es_handle.nodes.nil? }\n      it { should_not be_truthy }\n    end if es_handle.nodes.nil?\n\n    es_handle.nodes.each do |node|\n      describe \"Audit Settings for Node: #{node.name}\" do\n        subject { node.audit }\n        its('enabled') { should eq 'true' }\n        its('outputs') { should include 'logfile' }\n        its('logfile.events.include') { should match_array ES_INCLUDED_LOGEVENTS }\n        its('logfile.events.exclude') { should match_array ES_EXCLUDED_LOGEVENTS }\n      end\n    end unless es_handle.nodes.nil?\n\n    describe \"Audit Settings from ES_CONF_YML\" do\n      subject { yaml(ELASTICSEARCH_CONF) }\n      its(['xpack.security.audit.enabled']) { should eq true }\n      its(['xpack.security.audit.outputs']) { should include 'logfile' }\n      its(['xpack.security.audit.logfile.events.include']) { should match_array ES_INCLUDED_LOGEVENTS }\n      its(['xpack.security.audit.logfile.events.exclude']) { should match_array ES_EXCLUDED_LOGEVENTS }\n    end\n\n  rescue Exception => msg\n    describe \"Exception: #{msg}\" do\n      it { should be_nil}\n    end\n  end\nend\n",
          "source_location": {
            "line": 53,
            "ref": "../elasticsearch-inspec/controls/audit/V-26864.rb"
          },
          "results": [
            {
              "status": "passed",
              "code_desc": "Audit Settings for Node: package-centos-72 enabled should eq \"true\"",
              "run_time": 0.000074,
              "start_time": "2018-02-11 14:26:43 -0500"
            },
            {
              "status": "passed",
              "code_desc": "Audit Settings for Node: package-centos-72 outputs should include \"logfile\"",
              "run_time": 0.000073,
              "start_time": "2018-02-11 14:26:43 -0500"
            },
            {
              "status": "passed",
              "code_desc": "Audit Settings for Node: package-centos-72 logfile.events.include should contain exactly \"access_denied\", \"anonymous_access_denied\", \"authentication_failed\", \"connection_denied\", \"tampered_request\", \"run_as_denied\", and \"run_as_granted\"",
              "run_time": 0.000115,
              "start_time": "2018-02-11 14:26:43 -0500"
            },
            {
              "status": "passed",
              "code_desc": "Audit Settings for Node: package-centos-72 logfile.events.exclude should contain exactly \"access_granted\"",
              "run_time": 0.000074,
              "start_time": "2018-02-11 14:26:43 -0500"
            },
            {
              "status": "passed",
              "code_desc": "Audit Settings from ES_CONF_YML [\"xpack.security.audit.enabled\"] should eq true",
              "run_time": 0.000467,
              "start_time": "2018-02-11 14:26:43 -0500"
            },
            {
              "status": "passed",
              "code_desc": "Audit Settings from ES_CONF_YML [\"xpack.security.audit.outputs\"] should include \"logfile\"",
              "run_time": 0.000516,
              "start_time": "2018-02-11 14:26:43 -0500"
            },
            {
              "status": "passed",
              "code_desc": "Audit Settings from ES_CONF_YML [\"xpack.security.audit.logfile.events.include\"] should contain exactly \"access_denied\", \"anonymous_access_denied\", \"authentication_failed\", \"connection_denied\", \"tampered_request\", \"run_as_denied\", and \"run_as_granted\"",
              "run_time": 0.000493,
              "start_time": "2018-02-11 14:26:43 -0500"
            },
            {
              "status": "passed",
              "code_desc": "Audit Settings from ES_CONF_YML [\"xpack.security.audit.logfile.events.exclude\"] should contain exactly \"access_granted\"",
              "run_time": 0.000461,
              "start_time": "2018-02-11 14:26:43 -0500"
            }
          ]
        },
        {
          "id": "V-27085",
          "title": "The application must provide an audit reduction capability.",
          "desc": "Automate the creation of reports, dashboards, and interactive\nexploration of audit records.",
          "impact": 0.5,
          "refs": [],
          "tags": {
            "nist": [
              "AU-7",
              "Rev_3"
            ],
            "severity": "medium",
            "rid": "SV-34380r1_rule",
            "gtitle": "SRG-APP-000113",
            "cci": "CCI-000156",
            "check": "Check Elasticsearch.yml settings and existing audit records to\nverify information specific to the necessary content of the event is being\ncaptured and stored with audit records.\n\nAs the application administrator (usually elasticsearch, check the\nxpack.security.audit.outputs setting contains logfile by running the following:\n\n\n$ cat config/elasticsearch.yml | grep xpack.security.audit.outputs\n\nIf this configuration setting is not present, this is a finding.  If this\nconfiguration setting does not contain logfile, this is a finding.\n\nFor a complete list of extra information that can be added to log_line_prefix,\nsee the official documentation:\nhttps://www.elastic.co/guide/en/x-pack/current/auditing.html\n\n If the current settings do not provide enough information regarding the\ncontent of the event, this is a finding.",
            "fix": "Configure elasticsearch audit settings to contain sufficient\ninformation to establish where an event occurred.\n\nSee the official documentation for the instructions on audit configuration:\nhttps://www.elastic.co/guide/en/x-pack/current/auditing.html"
          },
          "code": "control \"V-27085\" do\n  title \"The application must provide an audit reduction capability.\"\n  desc  \"Automate the creation of reports, dashboards, and interactive\nexploration of audit records.\"\n  impact 0.5\n  tag \"nist\": [\"AU-7\", \"Rev_3\"]\n  tag \"severity\": \"medium\"\n  tag \"rid\": \"SV-34380r1_rule\"\n  tag \"gtitle\": \"SRG-APP-000113\"\n  tag \"cci\": \"CCI-000156\"\n  tag \"check\": \"Check Elasticsearch.yml settings and existing audit records to\nverify information specific to the necessary content of the event is being\ncaptured and stored with audit records.\n\nAs the application administrator (usually elasticsearch, check the\nxpack.security.audit.outputs setting contains logfile by running the following:\n\n\n$ cat config/elasticsearch.yml | grep xpack.security.audit.outputs\n\nIf this configuration setting is not present, this is a finding.  If this\nconfiguration setting does not contain logfile, this is a finding.\n\nFor a complete list of extra information that can be added to log_line_prefix,\nsee the official documentation:\nhttps://www.elastic.co/guide/en/x-pack/current/auditing.html\n\n If the current settings do not provide enough information regarding the\ncontent of the event, this is a finding.\"\n  tag \"fix\": \"Configure elasticsearch audit settings to contain sufficient\ninformation to establish where an event occurred.\n\nSee the official documentation for the instructions on audit configuration:\nhttps://www.elastic.co/guide/en/x-pack/current/auditing.html\"\n\n  begin\n    es_handle = es_helper(url:\"https://#{ELASTIC_IP}:#{ELASTIC_PORT}\",\n                    username: ES_ADMIN,\n                    password: ES_PASS,\n                    ssl_verify: SSL_VERIFY )\n\n    describe \"No nodes found\" do\n      subject { es_handle.nodes.nil? }\n      it { should_not be_truthy }\n    end if es_handle.nodes.nil?\n\n    es_handle.nodes.each do |node|\n      describe \"Audit Settings for Node: #{node.name}\" do\n        subject { node.audit }\n        its('enabled') { should eq 'true' }\n        its('outputs') { should include 'logfile' }\n        its('logfile.events.include') { should match_array ES_INCLUDED_LOGEVENTS }\n        its('logfile.events.exclude') { should match_array ES_EXCLUDED_LOGEVENTS }\n      end\n    end unless es_handle.nodes.nil?\n\n    describe \"Audit Settings from ES_CONF_YML\" do\n      subject { yaml(ELASTICSEARCH_CONF) }\n      its(['xpack.security.audit.enabled']) { should eq true }\n      its(['xpack.security.audit.outputs']) { should include 'logfile' }\n      its(['xpack.security.audit.logfile.events.include']) { should match_array ES_INCLUDED_LOGEVENTS }\n      its(['xpack.security.audit.logfile.events.exclude']) { should match_array ES_EXCLUDED_LOGEVENTS }\n    end\n\n  rescue Exception => msg\n    describe \"Exception: #{msg}\" do\n      it { should be_nil}\n    end\n  end\nend\n",
          "source_location": {
            "line": 54,
            "ref": "../elasticsearch-inspec/controls/audit/V-27085.rb"
          },
          "results": [
            {
              "status": "passed",
              "code_desc": "Audit Settings for Node: package-centos-72 enabled should eq \"true\"",
              "run_time": 0.000072,
              "start_time": "2018-02-11 14:26:43 -0500"
            },
            {
              "status": "passed",
              "code_desc": "Audit Settings for Node: package-centos-72 outputs should include \"logfile\"",
              "run_time": 0.000075,
              "start_time": "2018-02-11 14:26:43 -0500"
            },
            {
              "status": "passed",
              "code_desc": "Audit Settings for Node: package-centos-72 logfile.events.include should contain exactly \"access_denied\", \"anonymous_access_denied\", \"authentication_failed\", \"connection_denied\", \"tampered_request\", \"run_as_denied\", and \"run_as_granted\"",
              "run_time": 0.000129,
              "start_time": "2018-02-11 14:26:43 -0500"
            },
            {
              "status": "passed",
              "code_desc": "Audit Settings for Node: package-centos-72 logfile.events.exclude should contain exactly \"access_granted\"",
              "run_time": 0.000077,
              "start_time": "2018-02-11 14:26:43 -0500"
            },
            {
              "status": "passed",
              "code_desc": "Audit Settings from ES_CONF_YML [\"xpack.security.audit.enabled\"] should eq true",
              "run_time": 0.000492,
              "start_time": "2018-02-11 14:26:43 -0500"
            },
            {
              "status": "passed",
              "code_desc": "Audit Settings from ES_CONF_YML [\"xpack.security.audit.outputs\"] should include \"logfile\"",
              "run_time": 0.000459,
              "start_time": "2018-02-11 14:26:43 -0500"
            },
            {
              "status": "passed",
              "code_desc": "Audit Settings from ES_CONF_YML [\"xpack.security.audit.logfile.events.include\"] should contain exactly \"access_denied\", \"anonymous_access_denied\", \"authentication_failed\", \"connection_denied\", \"tampered_request\", \"run_as_denied\", and \"run_as_granted\"",
              "run_time": 0.000522,
              "start_time": "2018-02-11 14:26:43 -0500"
            },
            {
              "status": "passed",
              "code_desc": "Audit Settings from ES_CONF_YML [\"xpack.security.audit.logfile.events.exclude\"] should contain exactly \"access_granted\"",
              "run_time": 0.000477,
              "start_time": "2018-02-11 14:26:43 -0500"
            }
          ]
        },
        {
          "id": "V-26900",
          "title": "The application must produce a system-wide (logical or physical) audit\ntrail composed of audit records in a standardized format.",
          "desc": "Utilize perimeter, application, centralized authentication, and\nrepository audit controls to audit the use of systems in real time with\nsufficient context.  X-Pack Security audit controls should be enabled to audit\nthe defaults of all HTTP/S based access to Elasticsearch.  All applications\nshould use HTTP/S  rather than Elasticsearch transport protocol.",
          "impact": 0.5,
          "refs": [],
          "tags": {
            "nist": [
              "AU-12 (2)",
              "Rev_4"
            ],
            "severity": "medium",
            "rid": "SV-34180r1_rule",
            "gtitle": "SRG-APP-000088",
            "cci": "CCI-001353",
            "check": "Check Elasticsearch.yml settings and existing audit records to\nverify information specific to the necessary content of the event is being\ncaptured and stored with audit records.\n\nAs the application administrator (usually elasticsearch, check the\nxpack.security.audit.outputs setting contains logfile by running the following:\n\n\n$ cat config/elasticsearch.yml | grep xpack.security.audit.outputs\n\nIf this configuration setting is not present, this is a finding.  If this\nconfiguration setting does not contain logfile, this is a finding.\n\nFor a complete list of extra information that can be added to log_line_prefix,\nsee the official documentation:\nhttps://www.elastic.co/guide/en/x-pack/current/auditing.html\n\n If the current settings do not provide enough information regarding the\ncontent of the event, this is a finding.",
            "fix": "Configure elasticsearch audit settings to contain sufficient\ninformation to establish where an event occurred.\n\nSee the official documentation for the instructions on audit configuration:\nhttps://www.elastic.co/guide/en/x-pack/current/auditing.html"
          },
          "code": "control \"V-26900\" do\n  title \"The application must produce a system-wide (logical or physical) audit\ntrail composed of audit records in a standardized format.\"\n  desc  \"Utilize perimeter, application, centralized authentication, and\nrepository audit controls to audit the use of systems in real time with\nsufficient context.  X-Pack Security audit controls should be enabled to audit\nthe defaults of all HTTP/S based access to Elasticsearch.  All applications\nshould use HTTP/S  rather than Elasticsearch transport protocol.\"\n  impact 0.5\n  tag \"nist\": [\"AU-12 (2)\", \"Rev_4\"]\n  tag \"severity\": \"medium\"\n  tag \"rid\": \"SV-34180r1_rule\"\n  tag \"gtitle\": \"SRG-APP-000088\"\n  tag \"cci\": \"CCI-001353\"\n  tag \"check\": \"Check Elasticsearch.yml settings and existing audit records to\nverify information specific to the necessary content of the event is being\ncaptured and stored with audit records.\n\nAs the application administrator (usually elasticsearch, check the\nxpack.security.audit.outputs setting contains logfile by running the following:\n\n\n$ cat config/elasticsearch.yml | grep xpack.security.audit.outputs\n\nIf this configuration setting is not present, this is a finding.  If this\nconfiguration setting does not contain logfile, this is a finding.\n\nFor a complete list of extra information that can be added to log_line_prefix,\nsee the official documentation:\nhttps://www.elastic.co/guide/en/x-pack/current/auditing.html\n\n If the current settings do not provide enough information regarding the\ncontent of the event, this is a finding.\"\n  tag \"fix\": \"Configure elasticsearch audit settings to contain sufficient\ninformation to establish where an event occurred.\n\nSee the official documentation for the instructions on audit configuration:\nhttps://www.elastic.co/guide/en/x-pack/current/auditing.html\"\n\n  begin\n    es_handle = es_helper(url:\"https://#{ELASTIC_IP}:#{ELASTIC_PORT}\",\n                    username: ES_ADMIN,\n                    password: ES_PASS,\n                    ssl_verify: SSL_VERIFY )\n\n    describe \"No nodes found\" do\n      subject { es_handle.nodes.nil? }\n      it { should_not be_truthy }\n    end if es_handle.nodes.nil?\n\n    es_handle.nodes.each do |node|\n      describe \"Audit Settings for Node: #{node.name}\" do\n        subject { node.audit }\n        its('enabled') { should eq 'true' }\n        its('outputs') { should include 'logfile' }\n        its('logfile.events.include') { should match_array ES_INCLUDED_LOGEVENTS }\n        its('logfile.events.exclude') { should match_array ES_EXCLUDED_LOGEVENTS }\n      end\n    end unless es_handle.nodes.nil?\n\n    describe \"Audit Settings from ES_CONF_YML\" do\n      subject { yaml(ELASTICSEARCH_CONF) }\n      its(['xpack.security.audit.enabled']) { should eq true }\n      its(['xpack.security.audit.outputs']) { should include 'logfile' }\n      its(['xpack.security.audit.logfile.events.include']) { should match_array ES_INCLUDED_LOGEVENTS }\n      its(['xpack.security.audit.logfile.events.exclude']) { should match_array ES_EXCLUDED_LOGEVENTS }\n    end\n\n  rescue Exception => msg\n    describe \"Exception: #{msg}\" do\n      it { should be_nil}\n    end\n  end\nend\n",
          "source_location": {
            "line": 54,
            "ref": "../elasticsearch-inspec/controls/audit/V-26900.rb"
          },
          "results": [
            {
              "status": "passed",
              "code_desc": "Audit Settings for Node: package-centos-72 enabled should eq \"true\"",
              "run_time": 0.000074,
              "start_time": "2018-02-11 14:26:43 -0500"
            },
            {
              "status": "passed",
              "code_desc": "Audit Settings for Node: package-centos-72 outputs should include \"logfile\"",
              "run_time": 0.000073,
              "start_time": "2018-02-11 14:26:43 -0500"
            },
            {
              "status": "passed",
              "code_desc": "Audit Settings for Node: package-centos-72 logfile.events.include should contain exactly \"access_denied\", \"anonymous_access_denied\", \"authentication_failed\", \"connection_denied\", \"tampered_request\", \"run_as_denied\", and \"run_as_granted\"",
              "run_time": 0.000114,
              "start_time": "2018-02-11 14:26:43 -0500"
            },
            {
              "status": "passed",
              "code_desc": "Audit Settings for Node: package-centos-72 logfile.events.exclude should contain exactly \"access_granted\"",
              "run_time": 0.000073,
              "start_time": "2018-02-11 14:26:43 -0500"
            },
            {
              "status": "passed",
              "code_desc": "Audit Settings from ES_CONF_YML [\"xpack.security.audit.enabled\"] should eq true",
              "run_time": 0.000473,
              "start_time": "2018-02-11 14:26:43 -0500"
            },
            {
              "status": "passed",
              "code_desc": "Audit Settings from ES_CONF_YML [\"xpack.security.audit.outputs\"] should include \"logfile\"",
              "run_time": 0.00049,
              "start_time": "2018-02-11 14:26:43 -0500"
            },
            {
              "status": "passed",
              "code_desc": "Audit Settings from ES_CONF_YML [\"xpack.security.audit.logfile.events.include\"] should contain exactly \"access_denied\", \"anonymous_access_denied\", \"authentication_failed\", \"connection_denied\", \"tampered_request\", \"run_as_denied\", and \"run_as_granted\"",
              "run_time": 0.000491,
              "start_time": "2018-02-11 14:26:43 -0500"
            },
            {
              "status": "passed",
              "code_desc": "Audit Settings from ES_CONF_YML [\"xpack.security.audit.logfile.events.exclude\"] should contain exactly \"access_granted\"",
              "run_time": 0.000489,
              "start_time": "2018-02-11 14:26:43 -0500"
            }
          ]
        },
        {
          "id": "V-26887",
          "title": "Applications must configure their auditing to reduce the likelihood of\nstorage capacity being exceeded.",
          "desc": "Offload and centralize audit records retention to a separate system\nfrom the sources of audit records.",
          "impact": 0.5,
          "refs": [],
          "tags": {
            "nist": [
              "AU-4",
              "Rev_3"
            ],
            "severity": "medium",
            "rid": "SV-34167r1_rule",
            "gtitle": "SRG-APP-000071",
            "cci": "CCI-000138",
            "check": "Check Elasticsearch.yml settings and existing audit records to\nverify information specific to the necessary content of the event is being\ncaptured and stored with audit records.\n\nAs the application administrator (usually elasticsearch, check the\nxpack.security.audit.outputs setting contains logfile by running the following:\n\n\n$ cat config/elasticsearch.yml | grep xpack.security.audit\n\nThis setting allows for the customization of audits to reduce likelihood of\nexceeding storage capacity.\n\nFor a complete list of extra information that can be added to log_line_prefix,\nsee the official documentation:\nhttps://www.elastic.co/guide/en/x-pack/current/auditing.html      ",
            "fix": "Configure elasticsearch audit settings to contain sufficient\ninformation to establish where an event occurred.\n\nSee the official documentation for the instructions on audit configuration:\nhttps://www.elastic.co/guide/en/x-pack/current/auditing.html\n\nIf javascript or python plugins are installed on the machine; run uninstall\ncommand as follows:"
          },
          "code": "control \"V-26887\" do\n  title \"Applications must configure their auditing to reduce the likelihood of\nstorage capacity being exceeded.\"\n  desc  \"Offload and centralize audit records retention to a separate system\nfrom the sources of audit records.\"\n  impact 0.5\n  tag \"nist\": [\"AU-4\", \"Rev_3\"]\n  tag \"severity\": \"medium\"\n  tag \"rid\": \"SV-34167r1_rule\"\n  tag \"gtitle\": \"SRG-APP-000071\"\n  tag \"cci\": \"CCI-000138\"\n  tag \"check\": \"Check Elasticsearch.yml settings and existing audit records to\nverify information specific to the necessary content of the event is being\ncaptured and stored with audit records.\n\nAs the application administrator (usually elasticsearch, check the\nxpack.security.audit.outputs setting contains logfile by running the following:\n\n\n$ cat config/elasticsearch.yml | grep xpack.security.audit\n\nThis setting allows for the customization of audits to reduce likelihood of\nexceeding storage capacity.\n\nFor a complete list of extra information that can be added to log_line_prefix,\nsee the official documentation:\nhttps://www.elastic.co/guide/en/x-pack/current/auditing.html      \"\n  tag \"fix\": \"Configure elasticsearch audit settings to contain sufficient\ninformation to establish where an event occurred.\n\nSee the official documentation for the instructions on audit configuration:\nhttps://www.elastic.co/guide/en/x-pack/current/auditing.html\n\nIf javascript or python plugins are installed on the machine; run uninstall\ncommand as follows:\"\n\n  begin\n    es_handle = es_helper(url:\"https://#{ELASTIC_IP}:#{ELASTIC_PORT}\",\n                    username: ES_ADMIN,\n                    password: ES_PASS,\n                    ssl_verify: SSL_VERIFY )\n\n    describe \"No nodes found\" do\n      subject { es_handle.nodes.nil? }\n      it { should_not be_truthy }\n    end if es_handle.nodes.nil?\n\n    es_handle.nodes.each do |node|\n      describe \"Audit Settings for Node: #{node.name}\" do\n        subject { node.audit }\n        its('enabled') { should eq 'true' }\n        its('outputs') { should include 'logfile' }\n        its('logfile.events.include') { should match_array ES_INCLUDED_LOGEVENTS }\n        its('logfile.events.exclude') { should match_array ES_EXCLUDED_LOGEVENTS }\n      end\n    end unless es_handle.nodes.nil?\n\n    describe \"Audit Settings from ES_CONF_YML\" do\n      subject { yaml(ELASTICSEARCH_CONF) }\n      its(['xpack.security.audit.enabled']) { should eq true }\n      its(['xpack.security.audit.outputs']) { should include 'logfile' }\n      its(['xpack.security.audit.logfile.events.include']) { should match_array ES_INCLUDED_LOGEVENTS }\n      its(['xpack.security.audit.logfile.events.exclude']) { should match_array ES_EXCLUDED_LOGEVENTS }\n    end\n\n  rescue Exception => msg\n    describe \"Exception: #{msg}\" do\n      it { should be_nil}\n    end\n  end\nend\n",
          "source_location": {
            "line": 54,
            "ref": "../elasticsearch-inspec/controls/audit/V-26887.rb"
          },
          "results": [
            {
              "status": "passed",
              "code_desc": "Audit Settings for Node: package-centos-72 enabled should eq \"true\"",
              "run_time": 0.000074,
              "start_time": "2018-02-11 14:26:43 -0500"
            },
            {
              "status": "passed",
              "code_desc": "Audit Settings for Node: package-centos-72 outputs should include \"logfile\"",
              "run_time": 0.000075,
              "start_time": "2018-02-11 14:26:43 -0500"
            },
            {
              "status": "passed",
              "code_desc": "Audit Settings for Node: package-centos-72 logfile.events.include should contain exactly \"access_denied\", \"anonymous_access_denied\", \"authentication_failed\", \"connection_denied\", \"tampered_request\", \"run_as_denied\", and \"run_as_granted\"",
              "run_time": 0.000116,
              "start_time": "2018-02-11 14:26:43 -0500"
            },
            {
              "status": "passed",
              "code_desc": "Audit Settings for Node: package-centos-72 logfile.events.exclude should contain exactly \"access_granted\"",
              "run_time": 0.000075,
              "start_time": "2018-02-11 14:26:43 -0500"
            },
            {
              "status": "passed",
              "code_desc": "Audit Settings from ES_CONF_YML [\"xpack.security.audit.enabled\"] should eq true",
              "run_time": 0.000455,
              "start_time": "2018-02-11 14:26:43 -0500"
            },
            {
              "status": "passed",
              "code_desc": "Audit Settings from ES_CONF_YML [\"xpack.security.audit.outputs\"] should include \"logfile\"",
              "run_time": 0.000459,
              "start_time": "2018-02-11 14:26:43 -0500"
            },
            {
              "status": "passed",
              "code_desc": "Audit Settings from ES_CONF_YML [\"xpack.security.audit.logfile.events.include\"] should contain exactly \"access_denied\", \"anonymous_access_denied\", \"authentication_failed\", \"connection_denied\", \"tampered_request\", \"run_as_denied\", and \"run_as_granted\"",
              "run_time": 0.000529,
              "start_time": "2018-02-11 14:26:43 -0500"
            },
            {
              "status": "passed",
              "code_desc": "Audit Settings from ES_CONF_YML [\"xpack.security.audit.logfile.events.exclude\"] should contain exactly \"access_granted\"",
              "run_time": 0.000476,
              "start_time": "2018-02-11 14:26:43 -0500"
            }
          ]
        },
        {
          "id": "V-26896",
          "title": "The application must provide the capability to compile audit records\nfrom multiple components within the system into a system-wide (logical or\nphysical) audit trail that is time-correlated to within organizational-defined\nlevel of tolerance.",
          "desc": "Utilize perimeter, application, centralized authentication, and\nrepository audit controls to audit the use of systems in real time with\nsufficient context.  X-Pack Security audit controls should be enabled to audit\nthe defaults of all HTTP/S based access to Elasticsearch.  All applications\nshould use HTTP/S  rather than Elasticsearch transport protocol.",
          "impact": 0.5,
          "refs": [],
          "tags": {
            "nist": [
              "AU-12 (1)",
              "Rev_4"
            ],
            "severity": "medium",
            "rid": "SV-34176r1_rule",
            "gtitle": "SRG-APP-000086",
            "cci": "CCI-000174",
            "check": "Check Elasticsearch.yml settings and existing audit records to\nverify information specific to the necessary content of the event is being\ncaptured and stored with audit records.\n\nAs the application administrator (usually elasticsearch, check the\nxpack.security.audit.outputs setting contains logfile by running the following:\n\n\n$ cat config/elasticsearch.yml | grep xpack.security.audit.outputs\n\nIf this configuration setting is not present, this is a finding.  If this\nconfiguration setting does not contain logfile, this is a finding.\n\nFor a complete list of extra information that can be added to log_line_prefix,\nsee the official documentation:\nhttps://www.elastic.co/guide/en/x-pack/current/auditing.html\n\n If the current settings do not provide enough information regarding the\ncontent of the event, this is a finding.",
            "fix": "Configure elasticsearch audit settings to contain sufficient\ninformation to establish where an event occurred.\n\nSee the official documentation for the instructions on audit configuration:\nhttps://www.elastic.co/guide/en/x-pack/current/auditing.html"
          },
          "code": "control \"V-26896\" do\n  title \"The application must provide the capability to compile audit records\nfrom multiple components within the system into a system-wide (logical or\nphysical) audit trail that is time-correlated to within organizational-defined\nlevel of tolerance.\"\n  desc  \"Utilize perimeter, application, centralized authentication, and\nrepository audit controls to audit the use of systems in real time with\nsufficient context.  X-Pack Security audit controls should be enabled to audit\nthe defaults of all HTTP/S based access to Elasticsearch.  All applications\nshould use HTTP/S  rather than Elasticsearch transport protocol.\"\n  impact 0.5\n  tag \"nist\": [\"AU-12 (1)\", \"Rev_4\"]\n  tag \"severity\": \"medium\"\n  tag \"rid\": \"SV-34176r1_rule\"\n  tag \"gtitle\": \"SRG-APP-000086\"\n  tag \"cci\": \"CCI-000174\"\n  tag \"check\": \"Check Elasticsearch.yml settings and existing audit records to\nverify information specific to the necessary content of the event is being\ncaptured and stored with audit records.\n\nAs the application administrator (usually elasticsearch, check the\nxpack.security.audit.outputs setting contains logfile by running the following:\n\n\n$ cat config/elasticsearch.yml | grep xpack.security.audit.outputs\n\nIf this configuration setting is not present, this is a finding.  If this\nconfiguration setting does not contain logfile, this is a finding.\n\nFor a complete list of extra information that can be added to log_line_prefix,\nsee the official documentation:\nhttps://www.elastic.co/guide/en/x-pack/current/auditing.html\n\n If the current settings do not provide enough information regarding the\ncontent of the event, this is a finding.\"\n  tag \"fix\": \"Configure elasticsearch audit settings to contain sufficient\ninformation to establish where an event occurred.\n\nSee the official documentation for the instructions on audit configuration:\nhttps://www.elastic.co/guide/en/x-pack/current/auditing.html\"\n\n  begin\n    es_handle = es_helper(url:\"https://#{ELASTIC_IP}:#{ELASTIC_PORT}\",\n                    username: ES_ADMIN,\n                    password: ES_PASS,\n                    ssl_verify: SSL_VERIFY )\n\n    describe \"No nodes found\" do\n      subject { es_handle.nodes.nil? }\n      it { should_not be_truthy }\n    end if es_handle.nodes.nil?\n\n    es_handle.nodes.each do |node|\n      describe \"Audit Settings for Node: #{node.name}\" do\n        subject { node.audit }\n        its('enabled') { should eq 'true' }\n        its('outputs') { should include 'logfile' }\n        its('logfile.events.include') { should match_array ES_INCLUDED_LOGEVENTS }\n        its('logfile.events.exclude') { should match_array ES_EXCLUDED_LOGEVENTS }\n      end\n    end unless es_handle.nodes.nil?\n\n    describe \"Audit Settings from ES_CONF_YML\" do\n      subject { yaml(ELASTICSEARCH_CONF) }\n      its(['xpack.security.audit.enabled']) { should eq true }\n      its(['xpack.security.audit.outputs']) { should include 'logfile' }\n      its(['xpack.security.audit.logfile.events.include']) { should match_array ES_INCLUDED_LOGEVENTS }\n      its(['xpack.security.audit.logfile.events.exclude']) { should match_array ES_EXCLUDED_LOGEVENTS }\n    end\n\n  rescue Exception => msg\n    describe \"Exception: #{msg}\" do\n      it { should be_nil}\n    end\n  end\nend\n",
          "source_location": {
            "line": 54,
            "ref": "../elasticsearch-inspec/controls/audit/V-26896.rb"
          },
          "results": [
            {
              "status": "passed",
              "code_desc": "Audit Settings for Node: package-centos-72 enabled should eq \"true\"",
              "run_time": 0.000099,
              "start_time": "2018-02-11 14:26:43 -0500"
            },
            {
              "status": "passed",
              "code_desc": "Audit Settings for Node: package-centos-72 outputs should include \"logfile\"",
              "run_time": 0.000076,
              "start_time": "2018-02-11 14:26:43 -0500"
            },
            {
              "status": "passed",
              "code_desc": "Audit Settings for Node: package-centos-72 logfile.events.include should contain exactly \"access_denied\", \"anonymous_access_denied\", \"authentication_failed\", \"connection_denied\", \"tampered_request\", \"run_as_denied\", and \"run_as_granted\"",
              "run_time": 0.000142,
              "start_time": "2018-02-11 14:26:43 -0500"
            },
            {
              "status": "passed",
              "code_desc": "Audit Settings for Node: package-centos-72 logfile.events.exclude should contain exactly \"access_granted\"",
              "run_time": 0.000076,
              "start_time": "2018-02-11 14:26:43 -0500"
            },
            {
              "status": "passed",
              "code_desc": "Audit Settings from ES_CONF_YML [\"xpack.security.audit.enabled\"] should eq true",
              "run_time": 0.000481,
              "start_time": "2018-02-11 14:26:43 -0500"
            },
            {
              "status": "passed",
              "code_desc": "Audit Settings from ES_CONF_YML [\"xpack.security.audit.outputs\"] should include \"logfile\"",
              "run_time": 0.000466,
              "start_time": "2018-02-11 14:26:43 -0500"
            },
            {
              "status": "passed",
              "code_desc": "Audit Settings from ES_CONF_YML [\"xpack.security.audit.logfile.events.include\"] should contain exactly \"access_denied\", \"anonymous_access_denied\", \"authentication_failed\", \"connection_denied\", \"tampered_request\", \"run_as_denied\", and \"run_as_granted\"",
              "run_time": 0.0005,
              "start_time": "2018-02-11 14:26:43 -0500"
            },
            {
              "status": "passed",
              "code_desc": "Audit Settings from ES_CONF_YML [\"xpack.security.audit.logfile.events.exclude\"] should contain exactly \"access_granted\"",
              "run_time": 0.000476,
              "start_time": "2018-02-11 14:26:43 -0500"
            }
          ]
        },
        {
          "id": "V-26851",
          "title": "The application must produce audit records containing sufficient\ninformation to establish the sources of the events.",
          "desc": "Utilize perimeter, application, centralized authentication, and\nrepository audit controls to audit the use of systems in real time with\nsufficient context.  X-Pack Security audit controls should be enabled to audit\nthe defaults of all HTTP/S based access to Elasticsearch.  All applications\nshould use HTTP/S  rather than Elasticsearch transport protocol.",
          "impact": 0.5,
          "refs": [],
          "tags": {
            "nist": [
              "AU-3",
              "Rev_4"
            ],
            "severity": "medium",
            "rid": "SV-34131r1_rule",
            "gtitle": "SRG-APP-000098",
            "cci": "CCI-000133",
            "check": "Check Elasticsearch.yml settings and existing audit records to\nverify information specific to the necessary content of the event is being\ncaptured and stored with audit records.\n\nAs the application administrator (usually elasticsearch, check the\nxpack.security.audit.outputs setting contains logfile by running the following:\n\n\n$ cat config/elasticsearch.yml | grep xpack.security.audit.outputs\n\nIf this configuration setting is not present, this is a finding.  If this\nconfiguration setting does not contain logfile, this is a finding.\n\nFor a complete list of extra information that can be added to log_line_prefix,\nsee the official documentation:\nhttps://www.elastic.co/guide/en/x-pack/current/auditing.html\n\n If the current settings do not provide enough information regarding the\ncontent of the event, this is a finding.",
            "fix": "Configure elasticsearch audit settings to contain sufficient\ninformation to establish where an event occurred.\n\nSee the official documentation for the instructions on audit configuration:\nhttps://www.elastic.co/guide/en/x-pack/current/auditing.html"
          },
          "code": "control \"V-26851\" do\n  title \"The application must produce audit records containing sufficient\ninformation to establish the sources of the events.\"\n  desc  \"Utilize perimeter, application, centralized authentication, and\nrepository audit controls to audit the use of systems in real time with\nsufficient context.  X-Pack Security audit controls should be enabled to audit\nthe defaults of all HTTP/S based access to Elasticsearch.  All applications\nshould use HTTP/S  rather than Elasticsearch transport protocol.\"\n  impact 0.5\n  tag \"nist\": [\"AU-3\", \"Rev_4\"]\n  tag \"severity\": \"medium\"\n  tag \"rid\": \"SV-34131r1_rule\"\n  tag \"gtitle\": \"SRG-APP-000098\"\n  tag \"cci\": \"CCI-000133\"\n  tag \"check\": \"Check Elasticsearch.yml settings and existing audit records to\nverify information specific to the necessary content of the event is being\ncaptured and stored with audit records.\n\nAs the application administrator (usually elasticsearch, check the\nxpack.security.audit.outputs setting contains logfile by running the following:\n\n\n$ cat config/elasticsearch.yml | grep xpack.security.audit.outputs\n\nIf this configuration setting is not present, this is a finding.  If this\nconfiguration setting does not contain logfile, this is a finding.\n\nFor a complete list of extra information that can be added to log_line_prefix,\nsee the official documentation:\nhttps://www.elastic.co/guide/en/x-pack/current/auditing.html\n\n If the current settings do not provide enough information regarding the\ncontent of the event, this is a finding.\"\n  tag \"fix\": \"Configure elasticsearch audit settings to contain sufficient\ninformation to establish where an event occurred.\n\nSee the official documentation for the instructions on audit configuration:\nhttps://www.elastic.co/guide/en/x-pack/current/auditing.html\"\n\n  begin\n    es_handle = es_helper(url:\"https://#{ELASTIC_IP}:#{ELASTIC_PORT}\",\n                    username: ES_ADMIN,\n                    password: ES_PASS,\n                    ssl_verify: SSL_VERIFY )\n\n    describe \"No nodes found\" do\n      subject { es_handle.nodes.nil? }\n      it { should_not be_truthy }\n    end if es_handle.nodes.nil?\n\n    es_handle.nodes.each do |node|\n      describe \"Audit Settings for Node: #{node.name}\" do\n        subject { node.audit }\n        its('enabled') { should eq 'true' }\n        its('outputs') { should include 'logfile' }\n        its('logfile.events.include') { should match_array ES_INCLUDED_LOGEVENTS }\n        its('logfile.events.exclude') { should match_array ES_EXCLUDED_LOGEVENTS }\n      end\n    end unless es_handle.nodes.nil?\n\n    describe \"Audit Settings from ES_CONF_YML\" do\n      subject { yaml(ELASTICSEARCH_CONF) }\n      its(['xpack.security.audit.enabled']) { should eq true }\n      its(['xpack.security.audit.outputs']) { should include 'logfile' }\n      its(['xpack.security.audit.logfile.events.include']) { should match_array ES_INCLUDED_LOGEVENTS }\n      its(['xpack.security.audit.logfile.events.exclude']) { should match_array ES_EXCLUDED_LOGEVENTS }\n    end\n\n  rescue Exception => msg\n    describe \"Exception: #{msg}\" do\n      it { should be_nil}\n    end\n  end\nend\n",
          "source_location": {
            "line": 54,
            "ref": "../elasticsearch-inspec/controls/audit/V-26851.rb"
          },
          "results": [
            {
              "status": "passed",
              "code_desc": "Audit Settings for Node: package-centos-72 enabled should eq \"true\"",
              "run_time": 0.000076,
              "start_time": "2018-02-11 14:26:43 -0500"
            },
            {
              "status": "passed",
              "code_desc": "Audit Settings for Node: package-centos-72 outputs should include \"logfile\"",
              "run_time": 0.000073,
              "start_time": "2018-02-11 14:26:43 -0500"
            },
            {
              "status": "passed",
              "code_desc": "Audit Settings for Node: package-centos-72 logfile.events.include should contain exactly \"access_denied\", \"anonymous_access_denied\", \"authentication_failed\", \"connection_denied\", \"tampered_request\", \"run_as_denied\", and \"run_as_granted\"",
              "run_time": 0.000113,
              "start_time": "2018-02-11 14:26:43 -0500"
            },
            {
              "status": "passed",
              "code_desc": "Audit Settings for Node: package-centos-72 logfile.events.exclude should contain exactly \"access_granted\"",
              "run_time": 0.000096,
              "start_time": "2018-02-11 14:26:43 -0500"
            },
            {
              "status": "passed",
              "code_desc": "Audit Settings from ES_CONF_YML [\"xpack.security.audit.enabled\"] should eq true",
              "run_time": 0.000476,
              "start_time": "2018-02-11 14:26:43 -0500"
            },
            {
              "status": "passed",
              "code_desc": "Audit Settings from ES_CONF_YML [\"xpack.security.audit.outputs\"] should include \"logfile\"",
              "run_time": 0.000494,
              "start_time": "2018-02-11 14:26:43 -0500"
            },
            {
              "status": "passed",
              "code_desc": "Audit Settings from ES_CONF_YML [\"xpack.security.audit.logfile.events.include\"] should contain exactly \"access_denied\", \"anonymous_access_denied\", \"authentication_failed\", \"connection_denied\", \"tampered_request\", \"run_as_denied\", and \"run_as_granted\"",
              "run_time": 0.000507,
              "start_time": "2018-02-11 14:26:43 -0500"
            },
            {
              "status": "passed",
              "code_desc": "Audit Settings from ES_CONF_YML [\"xpack.security.audit.logfile.events.exclude\"] should contain exactly \"access_granted\"",
              "run_time": 0.000509,
              "start_time": "2018-02-11 14:26:43 -0500"
            }
          ]
        },
        {
          "id": "V-26901",
          "title": "The application must provide audit record generation capability for\ndefined auditable events within defined application components.",
          "desc": "Utilize perimeter, application, centralized authentication, and\nrepository audit controls to audit the use of systems in real time with\nsufficient context.  X-Pack Security audit controls should be enabled to audit\nthe defaults of all HTTP/S based access to Elasticsearch.  All applications\nshould use HTTP/S  rather than Elasticsearch transport protocol.",
          "impact": 0.5,
          "refs": [],
          "tags": {
            "nist": [
              "AU-12 a",
              "Rev_4"
            ],
            "severity": "medium",
            "rid": "SV-34181r1_rule",
            "gtitle": "SRG-APP-000089",
            "cci": "CCI-000169",
            "check": "Check Elasticsearch.yml settings and existing audit records to\nverify information specific to the necessary content of the event is being\ncaptured and stored with audit records.\n\nAs the application administrator (usually elasticsearch, check the\nxpack.security.audit.outputs setting contains logfile by running the following:\n\n\n$ cat config/elasticsearch.yml | grep xpack.security.audit.outputs\n\nIf this configuration setting is not present, this is a finding.  If this\nconfiguration setting does not contain logfile, this is a finding.\n\nFor a complete list of extra information that can be added to log_line_prefix,\nsee the official documentation:\nhttps://www.elastic.co/guide/en/x-pack/current/auditing.html\n\n If the current settings do not provide enough information regarding the\ncontent of the event, this is a finding.",
            "fix": "Configure elasticsearch audit settings to contain sufficient\ninformation to establish where an event occurred.\n\nSee the official documentation for the instructions on audit configuration:\nhttps://www.elastic.co/guide/en/x-pack/current/auditing.html"
          },
          "code": "control \"V-26901\" do\n  title \"The application must provide audit record generation capability for\ndefined auditable events within defined application components.\"\n  desc  \"Utilize perimeter, application, centralized authentication, and\nrepository audit controls to audit the use of systems in real time with\nsufficient context.  X-Pack Security audit controls should be enabled to audit\nthe defaults of all HTTP/S based access to Elasticsearch.  All applications\nshould use HTTP/S  rather than Elasticsearch transport protocol.\"\n  impact 0.5\n  tag \"nist\": [\"AU-12 a\", \"Rev_4\"]\n  tag \"severity\": \"medium\"\n  tag \"rid\": \"SV-34181r1_rule\"\n  tag \"gtitle\": \"SRG-APP-000089\"\n  tag \"cci\": \"CCI-000169\"\n  tag \"check\": \"Check Elasticsearch.yml settings and existing audit records to\nverify information specific to the necessary content of the event is being\ncaptured and stored with audit records.\n\nAs the application administrator (usually elasticsearch, check the\nxpack.security.audit.outputs setting contains logfile by running the following:\n\n\n$ cat config/elasticsearch.yml | grep xpack.security.audit.outputs\n\nIf this configuration setting is not present, this is a finding.  If this\nconfiguration setting does not contain logfile, this is a finding.\n\nFor a complete list of extra information that can be added to log_line_prefix,\nsee the official documentation:\nhttps://www.elastic.co/guide/en/x-pack/current/auditing.html\n\n If the current settings do not provide enough information regarding the\ncontent of the event, this is a finding.\"\n  tag \"fix\": \"Configure elasticsearch audit settings to contain sufficient\ninformation to establish where an event occurred.\n\nSee the official documentation for the instructions on audit configuration:\nhttps://www.elastic.co/guide/en/x-pack/current/auditing.html\"\n\n  begin\n    es_handle = es_helper(url:\"https://#{ELASTIC_IP}:#{ELASTIC_PORT}\",\n                    username: ES_ADMIN,\n                    password: ES_PASS,\n                    ssl_verify: SSL_VERIFY )\n\n    describe \"No nodes found\" do\n      subject { es_handle.nodes.nil? }\n      it { should_not be_truthy }\n    end if es_handle.nodes.nil?\n\n    es_handle.nodes.each do |node|\n      describe \"Audit Settings for Node: #{node.name}\" do\n        subject { node.audit }\n        its('enabled') { should eq 'true' }\n        its('outputs') { should include 'logfile' }\n        its('logfile.events.include') { should match_array ES_INCLUDED_LOGEVENTS }\n        its('logfile.events.exclude') { should match_array ES_EXCLUDED_LOGEVENTS }\n      end\n    end unless es_handle.nodes.nil?\n\n    describe \"Audit Settings from ES_CONF_YML\" do\n      subject { yaml(ELASTICSEARCH_CONF) }\n      its(['xpack.security.audit.enabled']) { should eq true }\n      its(['xpack.security.audit.outputs']) { should include 'logfile' }\n      its(['xpack.security.audit.logfile.events.include']) { should match_array ES_INCLUDED_LOGEVENTS }\n      its(['xpack.security.audit.logfile.events.exclude']) { should match_array ES_EXCLUDED_LOGEVENTS }\n    end\n\n  rescue Exception => msg\n    describe \"Exception: #{msg}\" do\n      it { should be_nil}\n    end\n  end\nend",
          "source_location": {
            "line": 54,
            "ref": "../elasticsearch-inspec/controls/audit/V-26901.rb"
          },
          "results": [
            {
              "status": "passed",
              "code_desc": "Audit Settings for Node: package-centos-72 enabled should eq \"true\"",
              "run_time": 0.000073,
              "start_time": "2018-02-11 14:26:43 -0500"
            },
            {
              "status": "passed",
              "code_desc": "Audit Settings for Node: package-centos-72 outputs should include \"logfile\"",
              "run_time": 0.000099,
              "start_time": "2018-02-11 14:26:43 -0500"
            },
            {
              "status": "passed",
              "code_desc": "Audit Settings for Node: package-centos-72 logfile.events.include should contain exactly \"access_denied\", \"anonymous_access_denied\", \"authentication_failed\", \"connection_denied\", \"tampered_request\", \"run_as_denied\", and \"run_as_granted\"",
              "run_time": 0.000115,
              "start_time": "2018-02-11 14:26:43 -0500"
            },
            {
              "status": "passed",
              "code_desc": "Audit Settings for Node: package-centos-72 logfile.events.exclude should contain exactly \"access_granted\"",
              "run_time": 0.000075,
              "start_time": "2018-02-11 14:26:43 -0500"
            },
            {
              "status": "passed",
              "code_desc": "Audit Settings from ES_CONF_YML [\"xpack.security.audit.enabled\"] should eq true",
              "run_time": 0.000509,
              "start_time": "2018-02-11 14:26:43 -0500"
            },
            {
              "status": "passed",
              "code_desc": "Audit Settings from ES_CONF_YML [\"xpack.security.audit.outputs\"] should include \"logfile\"",
              "run_time": 0.000583,
              "start_time": "2018-02-11 14:26:43 -0500"
            },
            {
              "status": "passed",
              "code_desc": "Audit Settings from ES_CONF_YML [\"xpack.security.audit.logfile.events.include\"] should contain exactly \"access_denied\", \"anonymous_access_denied\", \"authentication_failed\", \"connection_denied\", \"tampered_request\", \"run_as_denied\", and \"run_as_granted\"",
              "run_time": 0.000534,
              "start_time": "2018-02-11 14:26:43 -0500"
            },
            {
              "status": "passed",
              "code_desc": "Audit Settings from ES_CONF_YML [\"xpack.security.audit.logfile.events.exclude\"] should contain exactly \"access_granted\"",
              "run_time": 0.000475,
              "start_time": "2018-02-11 14:26:43 -0500"
            }
          ]
        },
        {
          "id": "V-26845",
          "title": "The application must produce audit records containing sufficient\ninformation to establish what type of events occurred.",
          "desc": "Utilize perimeter, application, centralized authentication, and\nrepository audit controls to audit the use of systems in real time with\nsufficient context.  X-Pack Security audit controls should be enabled to audit\nthe defaults of all HTTP/S based access to Elasticsearch.  All applications\nshould use HTTP/S  rather than Elasticsearch transport protocol.",
          "impact": 0.5,
          "refs": [],
          "tags": {
            "nist": [
              "AU-3",
              "Rev_4"
            ],
            "severity": "medium",
            "rid": "SV-34125r1_rule",
            "gtitle": "SRG-APP-000095",
            "cci": "CCI-000130",
            "check": "Check Elasticsearch.yml settings and existing audit records to\nverify information specific to the necessary content of the event is being\ncaptured and stored with audit records.\n\nAs the application administrator (usually elasticsearch, check the\nxpack.security.audit.outputs setting contains logfile by running the following:\n\n\n$ cat config/elasticsearch.yml | grep xpack.security.audit.outputs\n\nIf this configuration setting is not present, this is a finding.  If this\nconfiguration setting does not contain logfile, this is a finding.\n\nFor a complete list of extra information that can be added to log_line_prefix,\nsee the official documentation:\nhttps://www.elastic.co/guide/en/x-pack/current/auditing.html\n\n If the current settings do not provide enough information regarding the\ncontent of the event, this is a finding.",
            "fix": "Configure elasticsearch audit settings to contain sufficient\ninformation to establish where an event occurred.\n\nSee the official documentation for the instructions on audit configuration:\nhttps://www.elastic.co/guide/en/x-pack/current/auditing.html"
          },
          "code": "control \"V-26845\" do\n  title \"The application must produce audit records containing sufficient\ninformation to establish what type of events occurred.\"\n  desc  \"Utilize perimeter, application, centralized authentication, and\nrepository audit controls to audit the use of systems in real time with\nsufficient context.  X-Pack Security audit controls should be enabled to audit\nthe defaults of all HTTP/S based access to Elasticsearch.  All applications\nshould use HTTP/S  rather than Elasticsearch transport protocol.\"\n  impact 0.5\n  tag \"nist\": [\"AU-3\", \"Rev_4\"]\n  tag \"severity\": \"medium\"\n  tag \"rid\": \"SV-34125r1_rule\"\n  tag \"gtitle\": \"SRG-APP-000095\"\n  tag \"cci\": \"CCI-000130\"\n  tag \"check\": \"Check Elasticsearch.yml settings and existing audit records to\nverify information specific to the necessary content of the event is being\ncaptured and stored with audit records.\n\nAs the application administrator (usually elasticsearch, check the\nxpack.security.audit.outputs setting contains logfile by running the following:\n\n\n$ cat config/elasticsearch.yml | grep xpack.security.audit.outputs\n\nIf this configuration setting is not present, this is a finding.  If this\nconfiguration setting does not contain logfile, this is a finding.\n\nFor a complete list of extra information that can be added to log_line_prefix,\nsee the official documentation:\nhttps://www.elastic.co/guide/en/x-pack/current/auditing.html\n\n If the current settings do not provide enough information regarding the\ncontent of the event, this is a finding.\"\n  tag \"fix\": \"Configure elasticsearch audit settings to contain sufficient\ninformation to establish where an event occurred.\n\nSee the official documentation for the instructions on audit configuration:\nhttps://www.elastic.co/guide/en/x-pack/current/auditing.html\"\n\n  begin\n    es_handle = es_helper(url:\"https://#{ELASTIC_IP}:#{ELASTIC_PORT}\",\n                    username: ES_ADMIN,\n                    password: ES_PASS,\n                    ssl_verify: SSL_VERIFY )\n\n    describe \"No nodes found\" do\n      subject { es_handle.nodes.nil? }\n      it { should_not be_truthy }\n    end if es_handle.nodes.nil?\n\n    es_handle.nodes.each do |node|\n      describe \"Audit Settings for Node: #{node.name}\" do\n        subject { node.audit }\n        its('enabled') { should eq 'true' }\n        its('outputs') { should include 'logfile' }\n        its('logfile.events.include') { should match_array ES_INCLUDED_LOGEVENTS }\n        its('logfile.events.exclude') { should match_array ES_EXCLUDED_LOGEVENTS }\n      end\n    end unless es_handle.nodes.nil?\n\n    describe \"Audit Settings from ES_CONF_YML\" do\n      subject { yaml(ELASTICSEARCH_CONF) }\n      its(['xpack.security.audit.enabled']) { should eq true }\n      its(['xpack.security.audit.outputs']) { should include 'logfile' }\n      its(['xpack.security.audit.logfile.events.include']) { should match_array ES_INCLUDED_LOGEVENTS }\n      its(['xpack.security.audit.logfile.events.exclude']) { should match_array ES_EXCLUDED_LOGEVENTS }\n    end\n\n  rescue Exception => msg\n    describe \"Exception: #{msg}\" do\n      it { should be_nil}\n    end\n  end\nend\n",
          "source_location": {
            "line": 54,
            "ref": "../elasticsearch-inspec/controls/audit/V-26845.rb"
          },
          "results": [
            {
              "status": "passed",
              "code_desc": "Audit Settings for Node: package-centos-72 enabled should eq \"true\"",
              "run_time": 0.000099,
              "start_time": "2018-02-11 14:26:43 -0500"
            },
            {
              "status": "passed",
              "code_desc": "Audit Settings for Node: package-centos-72 outputs should include \"logfile\"",
              "run_time": 0.000077,
              "start_time": "2018-02-11 14:26:43 -0500"
            },
            {
              "status": "passed",
              "code_desc": "Audit Settings for Node: package-centos-72 logfile.events.include should contain exactly \"access_denied\", \"anonymous_access_denied\", \"authentication_failed\", \"connection_denied\", \"tampered_request\", \"run_as_denied\", and \"run_as_granted\"",
              "run_time": 0.000136,
              "start_time": "2018-02-11 14:26:43 -0500"
            },
            {
              "status": "passed",
              "code_desc": "Audit Settings for Node: package-centos-72 logfile.events.exclude should contain exactly \"access_granted\"",
              "run_time": 0.000074,
              "start_time": "2018-02-11 14:26:43 -0500"
            },
            {
              "status": "passed",
              "code_desc": "Audit Settings from ES_CONF_YML [\"xpack.security.audit.enabled\"] should eq true",
              "run_time": 0.000463,
              "start_time": "2018-02-11 14:26:43 -0500"
            },
            {
              "status": "passed",
              "code_desc": "Audit Settings from ES_CONF_YML [\"xpack.security.audit.outputs\"] should include \"logfile\"",
              "run_time": 0.000473,
              "start_time": "2018-02-11 14:26:43 -0500"
            },
            {
              "status": "passed",
              "code_desc": "Audit Settings from ES_CONF_YML [\"xpack.security.audit.logfile.events.include\"] should contain exactly \"access_denied\", \"anonymous_access_denied\", \"authentication_failed\", \"connection_denied\", \"tampered_request\", \"run_as_denied\", and \"run_as_granted\"",
              "run_time": 0.000512,
              "start_time": "2018-02-11 14:26:43 -0500"
            },
            {
              "status": "passed",
              "code_desc": "Audit Settings from ES_CONF_YML [\"xpack.security.audit.logfile.events.exclude\"] should contain exactly \"access_granted\"",
              "run_time": 0.000486,
              "start_time": "2018-02-11 14:26:43 -0500"
            }
          ]
        },
        {
          "id": "V-26905",
          "title": "The application must provide the capability to capture, record, and\nlog all content related to a user session.",
          "desc": "Utilize perimeter, application, centralized authentication, and\nrepository audit controls to audit the use of systems in real time with\nsufficient context.  X-Pack Security audit controls should be enabled to audit\nthe defaults of all HTTP/S based access to Elasticsearch.  All applications\nshould use HTTP/S  rather than Elasticsearch transport protocol.",
          "impact": 0.5,
          "refs": [],
          "tags": {
            "nist": [
              "AU-14 (2)",
              "Rev_4"
            ],
            "severity": "medium",
            "rid": "SV-34185r1_rule",
            "gtitle": "SRG-APP-000093",
            "cci": "CCI-001462",
            "check": "Check Elasticsearch.yml settings and existing audit records to\nverify information specific to the necessary content of the event is being\ncaptured and stored with audit records.\n\nAs the application administrator (usually elasticsearch, check the\nxpack.security.audit.outputs setting contains logfile by running the following:\n\n\n$ cat config/elasticsearch.yml | grep xpack.security.audit.outputs\n\nIf this configuration setting is not present, this is a finding.  If this\nconfiguration setting does not contain logfile, this is a finding.\n\nFor a complete list of extra information that can be added to log_line_prefix,\nsee the official documentation:\nhttps://www.elastic.co/guide/en/x-pack/current/auditing.html\n\n If the current settings do not provide enough information regarding the\ncontent of the event, this is a finding.",
            "fix": "Configure elasticsearch audit settings to contain sufficient\ninformation to establish the outcome of an event occurred.\n\nSee the official documentation for the instructions on audit configuration:\nhttps://www.elastic.co/guide/en/x-pack/current/auditing.html"
          },
          "code": "control \"V-26905\" do\n  title \"The application must provide the capability to capture, record, and\nlog all content related to a user session.\"\n  desc  \"Utilize perimeter, application, centralized authentication, and\nrepository audit controls to audit the use of systems in real time with\nsufficient context.  X-Pack Security audit controls should be enabled to audit\nthe defaults of all HTTP/S based access to Elasticsearch.  All applications\nshould use HTTP/S  rather than Elasticsearch transport protocol.\"\n  impact 0.5\n  tag \"nist\": [\"AU-14 (2)\", \"Rev_4\"]\n  tag \"severity\": \"medium\"\n  tag \"rid\": \"SV-34185r1_rule\"\n  tag \"gtitle\": \"SRG-APP-000093\"\n  tag \"cci\": \"CCI-001462\"\n  tag \"check\": \"Check Elasticsearch.yml settings and existing audit records to\nverify information specific to the necessary content of the event is being\ncaptured and stored with audit records.\n\nAs the application administrator (usually elasticsearch, check the\nxpack.security.audit.outputs setting contains logfile by running the following:\n\n\n$ cat config/elasticsearch.yml | grep xpack.security.audit.outputs\n\nIf this configuration setting is not present, this is a finding.  If this\nconfiguration setting does not contain logfile, this is a finding.\n\nFor a complete list of extra information that can be added to log_line_prefix,\nsee the official documentation:\nhttps://www.elastic.co/guide/en/x-pack/current/auditing.html\n\n If the current settings do not provide enough information regarding the\ncontent of the event, this is a finding.\"\n  tag \"fix\": \"Configure elasticsearch audit settings to contain sufficient\ninformation to establish the outcome of an event occurred.\n\nSee the official documentation for the instructions on audit configuration:\nhttps://www.elastic.co/guide/en/x-pack/current/auditing.html\"\n\n  begin\n    es_handle = es_helper(url:\"https://#{ELASTIC_IP}:#{ELASTIC_PORT}\",\n                    username: ES_ADMIN,\n                    password: ES_PASS,\n                    ssl_verify: SSL_VERIFY )\n\n    describe \"No nodes found\" do\n      subject { es_handle.nodes.nil? }\n      it { should_not be_truthy }\n    end if es_handle.nodes.nil?\n\n    es_handle.nodes.each do |node|\n      describe \"Audit Settings for Node: #{node.name}\" do\n        subject { node.audit }\n        its('enabled') { should eq 'true' }\n        its('outputs') { should include 'logfile' }\n        its('logfile.events.include') { should match_array ES_INCLUDED_LOGEVENTS }\n        its('logfile.events.exclude') { should match_array ES_EXCLUDED_LOGEVENTS }\n      end\n    end unless es_handle.nodes.nil?\n\n    describe \"Audit Settings from ES_CONF_YML\" do\n      subject { yaml(ELASTICSEARCH_CONF) }\n      its(['xpack.security.audit.enabled']) { should eq true }\n      its(['xpack.security.audit.outputs']) { should include 'logfile' }\n      its(['xpack.security.audit.logfile.events.include']) { should match_array ES_INCLUDED_LOGEVENTS }\n      its(['xpack.security.audit.logfile.events.exclude']) { should match_array ES_EXCLUDED_LOGEVENTS }\n    end\n\n  rescue Exception => msg\n    describe \"Exception: #{msg}\" do\n      it { should be_nil}\n    end\n  end\nend\n",
          "source_location": {
            "line": 54,
            "ref": "../elasticsearch-inspec/controls/audit/V-26905.rb"
          },
          "results": [
            {
              "status": "passed",
              "code_desc": "Audit Settings for Node: package-centos-72 enabled should eq \"true\"",
              "run_time": 0.000074,
              "start_time": "2018-02-11 14:26:43 -0500"
            },
            {
              "status": "passed",
              "code_desc": "Audit Settings for Node: package-centos-72 outputs should include \"logfile\"",
              "run_time": 0.000098,
              "start_time": "2018-02-11 14:26:43 -0500"
            },
            {
              "status": "passed",
              "code_desc": "Audit Settings for Node: package-centos-72 logfile.events.include should contain exactly \"access_denied\", \"anonymous_access_denied\", \"authentication_failed\", \"connection_denied\", \"tampered_request\", \"run_as_denied\", and \"run_as_granted\"",
              "run_time": 0.000117,
              "start_time": "2018-02-11 14:26:43 -0500"
            },
            {
              "status": "passed",
              "code_desc": "Audit Settings for Node: package-centos-72 logfile.events.exclude should contain exactly \"access_granted\"",
              "run_time": 0.000075,
              "start_time": "2018-02-11 14:26:43 -0500"
            },
            {
              "status": "passed",
              "code_desc": "Audit Settings from ES_CONF_YML [\"xpack.security.audit.enabled\"] should eq true",
              "run_time": 0.000468,
              "start_time": "2018-02-11 14:26:43 -0500"
            },
            {
              "status": "passed",
              "code_desc": "Audit Settings from ES_CONF_YML [\"xpack.security.audit.outputs\"] should include \"logfile\"",
              "run_time": 0.000469,
              "start_time": "2018-02-11 14:26:43 -0500"
            },
            {
              "status": "passed",
              "code_desc": "Audit Settings from ES_CONF_YML [\"xpack.security.audit.logfile.events.include\"] should contain exactly \"access_denied\", \"anonymous_access_denied\", \"authentication_failed\", \"connection_denied\", \"tampered_request\", \"run_as_denied\", and \"run_as_granted\"",
              "run_time": 0.000508,
              "start_time": "2018-02-11 14:26:43 -0500"
            },
            {
              "status": "passed",
              "code_desc": "Audit Settings from ES_CONF_YML [\"xpack.security.audit.logfile.events.exclude\"] should contain exactly \"access_granted\"",
              "run_time": 0.000493,
              "start_time": "2018-02-11 14:26:43 -0500"
            }
          ]
        },
        {
          "id": "V-27168",
          "title": "The application must support the requirement to back up audit data and\nrecords onto a different system or media than the system being audited on an\norganizational-defined frequency.",
          "desc": "Offload and centralize audit records retention to a separate system\nfrom the sources of audit records.",
          "impact": 0.5,
          "refs": [],
          "tags": {
            "nist": [
              "AU-9 (2)",
              "Rev_4"
            ],
            "severity": "medium",
            "rid": "SV-34467r1_rule",
            "gtitle": "SRG-APP-000125",
            "cci": "CCI-001348",
            "check": "Check Elasticsearch.yml settings and existing audit records are\nbeing recorded to an external system or media.\n\nAs the application administrator (usually elasticsearch, check the\nxpack.security.audit.outputs setting contains logfile by running the following:\n\n\n$ cat config/elasticsearch.yml | grep xpack.security.audit.outputs\n\nIf this configuration setting is not present, this is a finding.  If this\nconfiguration setting does not contain logfile, this is a finding.\n\nFor a complete list of extra information that can be added to log_line_prefix,\nsee the official documentation:\nhttps://www.elastic.co/guide/en/x-pack/current/auditing.html\n\n If the current settings do not provide enough information regarding the\ncontent of the event, this is a finding.",
            "fix": "Configure elasticsearch audit settings to an external system or\nmedia.\n\nSee the official documentation for the instructions on audit configuration:\nhttps://www.elastic.co/guide/en/x-pack/current/auditing.html"
          },
          "code": "control \"V-27168\" do\n  title \"The application must support the requirement to back up audit data and\nrecords onto a different system or media than the system being audited on an\norganizational-defined frequency.\"\n  desc  \"Offload and centralize audit records retention to a separate system\nfrom the sources of audit records.\"\n  impact 0.5\n  tag \"nist\": [\"AU-9 (2)\", \"Rev_4\"]\n  tag \"severity\": \"medium\"\n  tag \"rid\": \"SV-34467r1_rule\"\n  tag \"gtitle\": \"SRG-APP-000125\"\n  tag \"cci\": \"CCI-001348\"\n  tag \"check\": \"Check Elasticsearch.yml settings and existing audit records are\nbeing recorded to an external system or media.\n\nAs the application administrator (usually elasticsearch, check the\nxpack.security.audit.outputs setting contains logfile by running the following:\n\n\n$ cat config/elasticsearch.yml | grep xpack.security.audit.outputs\n\nIf this configuration setting is not present, this is a finding.  If this\nconfiguration setting does not contain logfile, this is a finding.\n\nFor a complete list of extra information that can be added to log_line_prefix,\nsee the official documentation:\nhttps://www.elastic.co/guide/en/x-pack/current/auditing.html\n\n If the current settings do not provide enough information regarding the\ncontent of the event, this is a finding.\"\n  tag \"fix\": \"Configure elasticsearch audit settings to an external system or\nmedia.\n\nSee the official documentation for the instructions on audit configuration:\nhttps://www.elastic.co/guide/en/x-pack/current/auditing.html\"\n\n  begin\n    es_handle = es_helper(url:\"https://#{ELASTIC_IP}:#{ELASTIC_PORT}\",\n                    username: ES_ADMIN,\n                    password: ES_PASS,\n                    ssl_verify: SSL_VERIFY )\n\n    describe \"No nodes found\" do\n      subject { es_handle.nodes.nil? }\n      it { should_not be_truthy }\n    end if es_handle.nodes.nil?\n\n    es_handle.nodes.each do |node|\n      describe \"Audit Settings for Node: #{node.name}\" do\n        subject { node.audit }\n        its('enabled') { should eq 'true' }\n        its('outputs') { should include 'logfile' }\n        its('logfile.events.include') { should match_array ES_INCLUDED_LOGEVENTS }\n        its('logfile.events.exclude') { should match_array ES_EXCLUDED_LOGEVENTS }\n      end\n    end unless es_handle.nodes.nil?\n\n    describe \"Audit Settings from ES_CONF_YML\" do\n      subject { yaml(ELASTICSEARCH_CONF) }\n      its(['xpack.security.audit.enabled']) { should eq true }\n      its(['xpack.security.audit.outputs']) { should include 'logfile' }\n      its(['xpack.security.audit.logfile.events.include']) { should match_array ES_INCLUDED_LOGEVENTS }\n      its(['xpack.security.audit.logfile.events.exclude']) { should match_array ES_EXCLUDED_LOGEVENTS }\n    end\n\n  rescue Exception => msg\n    describe \"Exception: #{msg}\" do\n      it { should be_nil}\n    end\n  end\nend\n",
          "source_location": {
            "line": 54,
            "ref": "../elasticsearch-inspec/controls/audit/V-27168.rb"
          },
          "results": [
            {
              "status": "passed",
              "code_desc": "Audit Settings for Node: package-centos-72 enabled should eq \"true\"",
              "run_time": 0.000106,
              "start_time": "2018-02-11 14:26:43 -0500"
            },
            {
              "status": "passed",
              "code_desc": "Audit Settings for Node: package-centos-72 outputs should include \"logfile\"",
              "run_time": 0.000075,
              "start_time": "2018-02-11 14:26:43 -0500"
            },
            {
              "status": "passed",
              "code_desc": "Audit Settings for Node: package-centos-72 logfile.events.include should contain exactly \"access_denied\", \"anonymous_access_denied\", \"authentication_failed\", \"connection_denied\", \"tampered_request\", \"run_as_denied\", and \"run_as_granted\"",
              "run_time": 0.000133,
              "start_time": "2018-02-11 14:26:43 -0500"
            },
            {
              "status": "passed",
              "code_desc": "Audit Settings for Node: package-centos-72 logfile.events.exclude should contain exactly \"access_granted\"",
              "run_time": 0.000115,
              "start_time": "2018-02-11 14:26:43 -0500"
            },
            {
              "status": "passed",
              "code_desc": "Audit Settings from ES_CONF_YML [\"xpack.security.audit.enabled\"] should eq true",
              "run_time": 0.000474,
              "start_time": "2018-02-11 14:26:43 -0500"
            },
            {
              "status": "passed",
              "code_desc": "Audit Settings from ES_CONF_YML [\"xpack.security.audit.outputs\"] should include \"logfile\"",
              "run_time": 0.00048,
              "start_time": "2018-02-11 14:26:43 -0500"
            },
            {
              "status": "passed",
              "code_desc": "Audit Settings from ES_CONF_YML [\"xpack.security.audit.logfile.events.include\"] should contain exactly \"access_denied\", \"anonymous_access_denied\", \"authentication_failed\", \"connection_denied\", \"tampered_request\", \"run_as_denied\", and \"run_as_granted\"",
              "run_time": 0.00051,
              "start_time": "2018-02-11 14:26:43 -0500"
            },
            {
              "status": "passed",
              "code_desc": "Audit Settings from ES_CONF_YML [\"xpack.security.audit.logfile.events.exclude\"] should contain exactly \"access_granted\"",
              "run_time": 0.000513,
              "start_time": "2018-02-11 14:26:43 -0500"
            }
          ]
        },
        {
          "id": "V-26868",
          "title": "Applications must include organizational-defined additional, more\ndetailed information in the audit records for audit events identified by type,\nlocation, or subject.",
          "desc": "Utilize perimeter, application, centralized authentication, and\nrepository audit controls to audit the use of systems in real time with\nsufficient context.  X-Pack Security audit controls should be enabled to audit\nthe defaults of all HTTP/S based access to Elasticsearch.  All applications\nshould use HTTP/S  rather than Elasticsearch transport protocol.",
          "impact": 0.5,
          "refs": [],
          "tags": {
            "nist": [
              "AU-3 (1)",
              "Rev_4"
            ],
            "severity": "medium",
            "rid": "SV-34148r1_rule",
            "gtitle": "SRG-APP-000101",
            "cci": "CCI-000135",
            "check": "Check Elasticsearch.yml settings and existing audit records to\nverify information specific to the necessary content of the event is being\ncaptured and stored with audit records.\n\nAs the application administrator (usually elasticsearch, check the\nxpack.security.audit.outputs setting contains logfile by running the following:\n\n\n$ cat config/elasticsearch.yml | grep xpack.security.audit.outputs\n\nIf this configuration setting is not present, this is a finding.  If this\nconfiguration setting does not contain logfile, this is a finding.\n\nFor a complete list of extra information that can be added to log_line_prefix,\nsee the official documentation:\nhttps://www.elastic.co/guide/en/x-pack/current/auditing.html\n\n If the current settings do not provide enough information regarding the\ncontent of the event, this is a finding.",
            "fix": "Configure elasticsearch audit settings to contain sufficient\ninformation to establish where an event occurred.\n\nSee the official documentation for the instructions on audit configuration:\nhttps://www.elastic.co/guide/en/x-pack/current/auditing.html"
          },
          "code": "control \"V-26868\" do\n  title \"Applications must include organizational-defined additional, more\ndetailed information in the audit records for audit events identified by type,\nlocation, or subject.\"\n  desc  \"Utilize perimeter, application, centralized authentication, and\nrepository audit controls to audit the use of systems in real time with\nsufficient context.  X-Pack Security audit controls should be enabled to audit\nthe defaults of all HTTP/S based access to Elasticsearch.  All applications\nshould use HTTP/S  rather than Elasticsearch transport protocol.\"\n  impact 0.5\n  tag \"nist\": [\"AU-3 (1)\", \"Rev_4\"]\n  tag \"severity\": \"medium\"\n  tag \"rid\": \"SV-34148r1_rule\"\n  tag \"gtitle\": \"SRG-APP-000101\"\n  tag \"cci\": \"CCI-000135\"\n  tag \"check\": \"Check Elasticsearch.yml settings and existing audit records to\nverify information specific to the necessary content of the event is being\ncaptured and stored with audit records.\n\nAs the application administrator (usually elasticsearch, check the\nxpack.security.audit.outputs setting contains logfile by running the following:\n\n\n$ cat config/elasticsearch.yml | grep xpack.security.audit.outputs\n\nIf this configuration setting is not present, this is a finding.  If this\nconfiguration setting does not contain logfile, this is a finding.\n\nFor a complete list of extra information that can be added to log_line_prefix,\nsee the official documentation:\nhttps://www.elastic.co/guide/en/x-pack/current/auditing.html\n\n If the current settings do not provide enough information regarding the\ncontent of the event, this is a finding.\"\n  tag \"fix\": \"Configure elasticsearch audit settings to contain sufficient\ninformation to establish where an event occurred.\n\nSee the official documentation for the instructions on audit configuration:\nhttps://www.elastic.co/guide/en/x-pack/current/auditing.html\"\n\n  begin\n    es_handle = es_helper(url:\"https://#{ELASTIC_IP}:#{ELASTIC_PORT}\",\n                    username: ES_ADMIN,\n                    password: ES_PASS,\n                    ssl_verify: SSL_VERIFY )\n\n    describe \"No nodes found\" do\n      subject { es_handle.nodes.nil? }\n      it { should_not be_truthy }\n    end if es_handle.nodes.nil?\n\n    es_handle.nodes.each do |node|\n      describe \"Audit Settings for Node: #{node.name}\" do\n        subject { node.audit }\n        its('enabled') { should eq 'true' }\n        its('outputs') { should include 'logfile' }\n        its('logfile.events.include') { should match_array ES_INCLUDED_LOGEVENTS }\n        its('logfile.events.exclude') { should match_array ES_EXCLUDED_LOGEVENTS }\n      end\n    end unless es_handle.nodes.nil?\n\n    describe \"Audit Settings from ES_CONF_YML\" do\n      subject { yaml(ELASTICSEARCH_CONF) }\n      its(['xpack.security.audit.enabled']) { should eq true }\n      its(['xpack.security.audit.outputs']) { should include 'logfile' }\n      its(['xpack.security.audit.logfile.events.include']) { should match_array ES_INCLUDED_LOGEVENTS }\n      its(['xpack.security.audit.logfile.events.exclude']) { should match_array ES_EXCLUDED_LOGEVENTS }\n    end\n\n  rescue Exception => msg\n    describe \"Exception: #{msg}\" do\n      it { should be_nil}\n    end\n  end\nend",
          "source_location": {
            "line": 54,
            "ref": "../elasticsearch-inspec/controls/audit/V-26868.rb"
          },
          "results": [
            {
              "status": "passed",
              "code_desc": "Audit Settings for Node: package-centos-72 enabled should eq \"true\"",
              "run_time": 0.000071,
              "start_time": "2018-02-11 14:26:43 -0500"
            },
            {
              "status": "passed",
              "code_desc": "Audit Settings for Node: package-centos-72 outputs should include \"logfile\"",
              "run_time": 0.000077,
              "start_time": "2018-02-11 14:26:43 -0500"
            },
            {
              "status": "passed",
              "code_desc": "Audit Settings for Node: package-centos-72 logfile.events.include should contain exactly \"access_denied\", \"anonymous_access_denied\", \"authentication_failed\", \"connection_denied\", \"tampered_request\", \"run_as_denied\", and \"run_as_granted\"",
              "run_time": 0.000116,
              "start_time": "2018-02-11 14:26:43 -0500"
            },
            {
              "status": "passed",
              "code_desc": "Audit Settings for Node: package-centos-72 logfile.events.exclude should contain exactly \"access_granted\"",
              "run_time": 0.000077,
              "start_time": "2018-02-11 14:26:43 -0500"
            },
            {
              "status": "passed",
              "code_desc": "Audit Settings from ES_CONF_YML [\"xpack.security.audit.enabled\"] should eq true",
              "run_time": 0.000507,
              "start_time": "2018-02-11 14:26:43 -0500"
            },
            {
              "status": "passed",
              "code_desc": "Audit Settings from ES_CONF_YML [\"xpack.security.audit.outputs\"] should include \"logfile\"",
              "run_time": 0.000487,
              "start_time": "2018-02-11 14:26:43 -0500"
            },
            {
              "status": "passed",
              "code_desc": "Audit Settings from ES_CONF_YML [\"xpack.security.audit.logfile.events.include\"] should contain exactly \"access_denied\", \"anonymous_access_denied\", \"authentication_failed\", \"connection_denied\", \"tampered_request\", \"run_as_denied\", and \"run_as_granted\"",
              "run_time": 0.000526,
              "start_time": "2018-02-11 14:26:43 -0500"
            },
            {
              "status": "passed",
              "code_desc": "Audit Settings from ES_CONF_YML [\"xpack.security.audit.logfile.events.exclude\"] should contain exactly \"access_granted\"",
              "run_time": 0.000475,
              "start_time": "2018-02-11 14:26:43 -0500"
            }
          ]
        },
        {
          "id": "V-26849",
          "title": "The application must produce audit records containing sufficient\ninformation to establish where the events occurred.",
          "desc": "Utilize perimeter, application, centralized authentication, and\nrepository audit controls to audit the use of systems in real time with\nsufficient context.  X-Pack Security audit controls should be enabled to audit\nthe defaults of all HTTP/S based access to Elasticsearch.  All applications\nshould use HTTP/S  rather than Elasticsearch transport protocol.",
          "impact": 0.5,
          "refs": [],
          "tags": {
            "nist": [
              "AU-3",
              "Rev_4"
            ],
            "severity": "medium",
            "rid": "SV-34129r1_rule",
            "gtitle": "SRG-APP-000097",
            "cci": "CCI-000132",
            "check": "Check Elasticsearch.yml settings and existing audit records to\nverify information specific to the necessary content of the event is being\ncaptured and stored with audit records.\n\nAs the application administrator (usually elasticsearch, check the\nxpack.security.audit.outputs setting contains logfile by running the following:\n\n\n$ cat config/elasticsearch.yml | grep xpack.security.audit.outputs\n\nIf this configuration setting is not present, this is a finding.  If this\nconfiguration setting does not contain logfile, this is a finding.\n\nFor a complete list of extra information that can be added to log_line_prefix,\nsee the official documentation:\nhttps://www.elastic.co/guide/en/x-pack/current/auditing.html\n\n If the current settings do not provide enough information regarding the\ncontent of the event, this is a finding.",
            "fix": "Configure elasticsearch audit settings to contain sufficient\ninformation to establish where an event occurred.\n\nSee the official documentation for the instructions on audit configuration:\nhttps://www.elastic.co/guide/en/x-pack/current/auditing.html"
          },
          "code": "control \"V-26849\" do\n  title \"The application must produce audit records containing sufficient\ninformation to establish where the events occurred.\"\n  desc  \"Utilize perimeter, application, centralized authentication, and\nrepository audit controls to audit the use of systems in real time with\nsufficient context.  X-Pack Security audit controls should be enabled to audit\nthe defaults of all HTTP/S based access to Elasticsearch.  All applications\nshould use HTTP/S  rather than Elasticsearch transport protocol.\"\n  impact 0.5\n  tag \"nist\": [\"AU-3\", \"Rev_4\"]\n  tag \"severity\": \"medium\"\n  tag \"rid\": \"SV-34129r1_rule\"\n  tag \"gtitle\": \"SRG-APP-000097\"\n  tag \"cci\": \"CCI-000132\"\n  tag \"check\": \"Check Elasticsearch.yml settings and existing audit records to\nverify information specific to the necessary content of the event is being\ncaptured and stored with audit records.\n\nAs the application administrator (usually elasticsearch, check the\nxpack.security.audit.outputs setting contains logfile by running the following:\n\n\n$ cat config/elasticsearch.yml | grep xpack.security.audit.outputs\n\nIf this configuration setting is not present, this is a finding.  If this\nconfiguration setting does not contain logfile, this is a finding.\n\nFor a complete list of extra information that can be added to log_line_prefix,\nsee the official documentation:\nhttps://www.elastic.co/guide/en/x-pack/current/auditing.html\n\n If the current settings do not provide enough information regarding the\ncontent of the event, this is a finding.\"\n  tag \"fix\": \"Configure elasticsearch audit settings to contain sufficient\ninformation to establish where an event occurred.\n\nSee the official documentation for the instructions on audit configuration:\nhttps://www.elastic.co/guide/en/x-pack/current/auditing.html\"\n\n  begin\n    es_handle = es_helper(url:\"https://#{ELASTIC_IP}:#{ELASTIC_PORT}\",\n                    username: ES_ADMIN,\n                    password: ES_PASS,\n                    ssl_verify: SSL_VERIFY )\n\n    describe \"No nodes found\" do\n      subject { es_handle.nodes.nil? }\n      it { should_not be_truthy }\n    end if es_handle.nodes.nil?\n\n    es_handle.nodes.each do |node|\n      describe \"Audit Settings for Node: #{node.name}\" do\n        subject { node.audit }\n        its('enabled') { should eq 'true' }\n        its('outputs') { should include 'logfile' }\n        its('logfile.events.include') { should match_array ES_INCLUDED_LOGEVENTS }\n        its('logfile.events.exclude') { should match_array ES_EXCLUDED_LOGEVENTS }\n      end\n    end unless es_handle.nodes.nil?\n\n    describe \"Audit Settings from ES_CONF_YML\" do\n      subject { yaml(ELASTICSEARCH_CONF) }\n      its(['xpack.security.audit.enabled']) { should eq true }\n      its(['xpack.security.audit.outputs']) { should include 'logfile' }\n      its(['xpack.security.audit.logfile.events.include']) { should match_array ES_INCLUDED_LOGEVENTS }\n      its(['xpack.security.audit.logfile.events.exclude']) { should match_array ES_EXCLUDED_LOGEVENTS }\n    end\n\n  rescue Exception => msg\n    describe \"Exception: #{msg}\" do\n      it { should be_nil}\n    end\n  end\nend",
          "source_location": {
            "line": 54,
            "ref": "../elasticsearch-inspec/controls/audit/V-26849.rb"
          },
          "results": [
            {
              "status": "passed",
              "code_desc": "Audit Settings for Node: package-centos-72 enabled should eq \"true\"",
              "run_time": 0.000075,
              "start_time": "2018-02-11 14:26:43 -0500"
            },
            {
              "status": "passed",
              "code_desc": "Audit Settings for Node: package-centos-72 outputs should include \"logfile\"",
              "run_time": 0.000075,
              "start_time": "2018-02-11 14:26:43 -0500"
            },
            {
              "status": "passed",
              "code_desc": "Audit Settings for Node: package-centos-72 logfile.events.include should contain exactly \"access_denied\", \"anonymous_access_denied\", \"authentication_failed\", \"connection_denied\", \"tampered_request\", \"run_as_denied\", and \"run_as_granted\"",
              "run_time": 0.000118,
              "start_time": "2018-02-11 14:26:43 -0500"
            },
            {
              "status": "passed",
              "code_desc": "Audit Settings for Node: package-centos-72 logfile.events.exclude should contain exactly \"access_granted\"",
              "run_time": 0.000091,
              "start_time": "2018-02-11 14:26:43 -0500"
            },
            {
              "status": "passed",
              "code_desc": "Audit Settings from ES_CONF_YML [\"xpack.security.audit.enabled\"] should eq true",
              "run_time": 0.000467,
              "start_time": "2018-02-11 14:26:43 -0500"
            },
            {
              "status": "passed",
              "code_desc": "Audit Settings from ES_CONF_YML [\"xpack.security.audit.outputs\"] should include \"logfile\"",
              "run_time": 0.0005,
              "start_time": "2018-02-11 14:26:43 -0500"
            },
            {
              "status": "passed",
              "code_desc": "Audit Settings from ES_CONF_YML [\"xpack.security.audit.logfile.events.include\"] should contain exactly \"access_denied\", \"anonymous_access_denied\", \"authentication_failed\", \"connection_denied\", \"tampered_request\", \"run_as_denied\", and \"run_as_granted\"",
              "run_time": 0.000512,
              "start_time": "2018-02-11 14:26:43 -0500"
            },
            {
              "status": "passed",
              "code_desc": "Audit Settings from ES_CONF_YML [\"xpack.security.audit.logfile.events.exclude\"] should contain exactly \"access_granted\"",
              "run_time": 0.000496,
              "start_time": "2018-02-11 14:26:43 -0500"
            }
          ]
        },
        {
          "id": "V-27064",
          "title": "The application must identify potentially security-relevant error\nconditions.",
          "desc": "Utilize perimeter, application, centralized authentication, and\nrepository audit controls to audit the use of systems in real time with\nsufficient context.  X-Pack Security audit controls should be enabled to audit\nthe defaults of all HTTP/S based access to Elasticsearch.  All applications\nshould use HTTP/S  rather than Elasticsearch transport protocol.",
          "impact": 0.5,
          "refs": [],
          "tags": {
            "nist": [
              "SI-11 a",
              "Rev_3"
            ],
            "severity": "medium",
            "rid": "SV-34359r1_rule",
            "gtitle": "SRG-APP-000265",
            "cci": "CCI-001311",
            "check": "Check Elasticsearch.yml settings and existing audit records to\nverify information specific to the necessary content of the event is being\ncaptured and stored with audit records.\n\nAs the application administrator (usually elasticsearch, check the\nxpack.security.audit.outputs setting contains logfile by running the following:\n\n\n$ cat config/elasticsearch.yml | grep xpack.security.audit.outputs\n\nIf this configuration setting is not present, this is a finding.  If this\nconfiguration setting does not contain logfile, this is a finding.\n\nFor a complete list of extra information that can be added to log_line_prefix,\nsee the official documentation:\nhttps://www.elastic.co/guide/en/x-pack/current/auditing.html\n\n If the current settings do not provide enough information regarding the\ncontent of the event, this is a finding.",
            "fix": "Configure elasticsearch audit settings to contain sufficient\ninformation to establish where an event occurred.\n\nSee the official documentation for the instructions on audit configuration:\nhttps://www.elastic.co/guide/en/x-pack/current/auditing.html"
          },
          "code": "control \"V-27064\" do\n  title \"The application must identify potentially security-relevant error\nconditions.\"\n  desc  \"Utilize perimeter, application, centralized authentication, and\nrepository audit controls to audit the use of systems in real time with\nsufficient context.  X-Pack Security audit controls should be enabled to audit\nthe defaults of all HTTP/S based access to Elasticsearch.  All applications\nshould use HTTP/S  rather than Elasticsearch transport protocol.\"\n  impact 0.5\n  tag \"nist\": [\"SI-11 a\", \"Rev_3\"]\n  tag \"severity\": \"medium\"\n  tag \"rid\": \"SV-34359r1_rule\"\n  tag \"gtitle\": \"SRG-APP-000265\"\n  tag \"cci\": \"CCI-001311\"\n  tag \"check\": \"Check Elasticsearch.yml settings and existing audit records to\nverify information specific to the necessary content of the event is being\ncaptured and stored with audit records.\n\nAs the application administrator (usually elasticsearch, check the\nxpack.security.audit.outputs setting contains logfile by running the following:\n\n\n$ cat config/elasticsearch.yml | grep xpack.security.audit.outputs\n\nIf this configuration setting is not present, this is a finding.  If this\nconfiguration setting does not contain logfile, this is a finding.\n\nFor a complete list of extra information that can be added to log_line_prefix,\nsee the official documentation:\nhttps://www.elastic.co/guide/en/x-pack/current/auditing.html\n\n If the current settings do not provide enough information regarding the\ncontent of the event, this is a finding.\"\n  tag \"fix\": \"Configure elasticsearch audit settings to contain sufficient\ninformation to establish where an event occurred.\n\nSee the official documentation for the instructions on audit configuration:\nhttps://www.elastic.co/guide/en/x-pack/current/auditing.html\"\n\n  begin\n    es_handle = es_helper(url:\"https://#{ELASTIC_IP}:#{ELASTIC_PORT}\",\n                    username: ES_ADMIN,\n                    password: ES_PASS,\n                    ssl_verify: SSL_VERIFY )\n\n    describe \"No nodes found\" do\n      subject { es_handle.nodes.nil? }\n      it { should_not be_truthy }\n    end if es_handle.nodes.nil?\n\n    es_handle.nodes.each do |node|\n      describe \"Audit Settings for Node: #{node.name}\" do\n        subject { node.audit }\n        its('enabled') { should eq 'true' }\n        its('outputs') { should include 'logfile' }\n        its('logfile.events.include') { should match_array ES_INCLUDED_LOGEVENTS }\n        its('logfile.events.exclude') { should match_array ES_EXCLUDED_LOGEVENTS }\n      end\n    end unless es_handle.nodes.nil?\n\n    describe \"Audit Settings from ES_CONF_YML\" do\n      subject { yaml(ELASTICSEARCH_CONF) }\n      its(['xpack.security.audit.enabled']) { should eq true }\n      its(['xpack.security.audit.outputs']) { should include 'logfile' }\n      its(['xpack.security.audit.logfile.events.include']) { should match_array ES_INCLUDED_LOGEVENTS }\n      its(['xpack.security.audit.logfile.events.exclude']) { should match_array ES_EXCLUDED_LOGEVENTS }\n    end\n\n  rescue Exception => msg\n    describe \"Exception: #{msg}\" do\n      it { should be_nil}\n    end\n  end\nend",
          "source_location": {
            "line": 54,
            "ref": "../elasticsearch-inspec/controls/audit/V-27064.rb"
          },
          "results": [
            {
              "status": "passed",
              "code_desc": "Audit Settings for Node: package-centos-72 enabled should eq \"true\"",
              "run_time": 0.000096,
              "start_time": "2018-02-11 14:26:43 -0500"
            },
            {
              "status": "passed",
              "code_desc": "Audit Settings for Node: package-centos-72 outputs should include \"logfile\"",
              "run_time": 0.000076,
              "start_time": "2018-02-11 14:26:43 -0500"
            },
            {
              "status": "passed",
              "code_desc": "Audit Settings for Node: package-centos-72 logfile.events.include should contain exactly \"access_denied\", \"anonymous_access_denied\", \"authentication_failed\", \"connection_denied\", \"tampered_request\", \"run_as_denied\", and \"run_as_granted\"",
              "run_time": 0.000136,
              "start_time": "2018-02-11 14:26:43 -0500"
            },
            {
              "status": "passed",
              "code_desc": "Audit Settings for Node: package-centos-72 logfile.events.exclude should contain exactly \"access_granted\"",
              "run_time": 0.000074,
              "start_time": "2018-02-11 14:26:43 -0500"
            },
            {
              "status": "passed",
              "code_desc": "Audit Settings from ES_CONF_YML [\"xpack.security.audit.enabled\"] should eq true",
              "run_time": 0.000462,
              "start_time": "2018-02-11 14:26:43 -0500"
            },
            {
              "status": "passed",
              "code_desc": "Audit Settings from ES_CONF_YML [\"xpack.security.audit.outputs\"] should include \"logfile\"",
              "run_time": 0.00048,
              "start_time": "2018-02-11 14:26:43 -0500"
            },
            {
              "status": "passed",
              "code_desc": "Audit Settings from ES_CONF_YML [\"xpack.security.audit.logfile.events.include\"] should contain exactly \"access_denied\", \"anonymous_access_denied\", \"authentication_failed\", \"connection_denied\", \"tampered_request\", \"run_as_denied\", and \"run_as_granted\"",
              "run_time": 0.000599,
              "start_time": "2018-02-11 14:26:43 -0500"
            },
            {
              "status": "passed",
              "code_desc": "Audit Settings from ES_CONF_YML [\"xpack.security.audit.logfile.events.exclude\"] should contain exactly \"access_granted\"",
              "run_time": 0.000482,
              "start_time": "2018-02-11 14:26:43 -0500"
            }
          ]
        },
        {
          "id": "V-26947",
          "title": "The organizational must audit non-local maintenance and diagnostic\nsessions.",
          "desc": "Utilize perimeter, application, centralized authentication, and\nrepository audit controls to audit the use of systems in real time with\nsufficient context.  X-Pack Security audit controls should be enabled to audit\nthe defaults of all HTTP/S based access to Elasticsearch.  All applications\nshould use HTTP/S  rather than Elasticsearch transport protocol.",
          "impact": 0.5,
          "refs": [],
          "tags": {
            "nist": [
              "MA-4 (1)",
              "Rev_3"
            ],
            "severity": "medium",
            "rid": "SV-34229r1_rule",
            "gtitle": "SRG-APP-NA",
            "cci": "CCI-000880",
            "check": "Check Elasticsearch.yml settings and existing audit records to\nverify information specific to the necessary content of the event is being\ncaptured and stored with audit records.\n\nAs the application administrator (usually elasticsearch, check the\nxpack.security.audit.outputs setting contains logfile by running the following:\n\n\n$ cat config/elasticsearch.yml | grep xpack.security.audit.outputs\n\nIf this configuration setting is not present, this is a finding.  If this\nconfiguration setting does not contain logfile, this is a finding.\n\nFor a complete list of extra information that can be added to log_line_prefix,\nsee the official documentation:\nhttps://www.elastic.co/guide/en/x-pack/current/auditing.html\n\n If the current settings do not provide enough information regarding the\ncontent of the event, this is a finding.",
            "fix": "Configure elasticsearch audit settings to audit non-local\nmaintenance and diagnostic sessions.\n\nSee the official documentation for the instructions on audit configuration:\nhttps://www.elastic.co/guide/en/x-pack/current/auditing.html"
          },
          "code": "control \"V-26947\" do\n  title \"The organizational must audit non-local maintenance and diagnostic\nsessions.\"\n  desc  \"Utilize perimeter, application, centralized authentication, and\nrepository audit controls to audit the use of systems in real time with\nsufficient context.  X-Pack Security audit controls should be enabled to audit\nthe defaults of all HTTP/S based access to Elasticsearch.  All applications\nshould use HTTP/S  rather than Elasticsearch transport protocol.\"\n  impact 0.5\n  tag \"nist\": [\"MA-4 (1)\", \"Rev_3\"]\n  tag \"severity\": \"medium\"\n  tag \"rid\": \"SV-34229r1_rule\"\n  tag \"gtitle\": \"SRG-APP-NA\"\n  tag \"cci\": \"CCI-000880\"\n  tag \"check\": \"Check Elasticsearch.yml settings and existing audit records to\nverify information specific to the necessary content of the event is being\ncaptured and stored with audit records.\n\nAs the application administrator (usually elasticsearch, check the\nxpack.security.audit.outputs setting contains logfile by running the following:\n\n\n$ cat config/elasticsearch.yml | grep xpack.security.audit.outputs\n\nIf this configuration setting is not present, this is a finding.  If this\nconfiguration setting does not contain logfile, this is a finding.\n\nFor a complete list of extra information that can be added to log_line_prefix,\nsee the official documentation:\nhttps://www.elastic.co/guide/en/x-pack/current/auditing.html\n\n If the current settings do not provide enough information regarding the\ncontent of the event, this is a finding.\"\n  tag \"fix\": \"Configure elasticsearch audit settings to audit non-local\nmaintenance and diagnostic sessions.\n\nSee the official documentation for the instructions on audit configuration:\nhttps://www.elastic.co/guide/en/x-pack/current/auditing.html\"\n\n  begin\n    es_handle = es_helper(url:\"https://#{ELASTIC_IP}:#{ELASTIC_PORT}\",\n                    username: ES_ADMIN,\n                    password: ES_PASS,\n                    ssl_verify: SSL_VERIFY )\n\n    describe \"No nodes found\" do\n      subject { es_handle.nodes.nil? }\n      it { should_not be_truthy }\n    end if es_handle.nodes.nil?\n\n    es_handle.nodes.each do |node|\n      describe \"Audit Settings for Node: #{node.name}\" do\n        subject { node.audit }\n        its('enabled') { should eq 'true' }\n        its('outputs') { should include 'logfile' }\n        its('logfile.events.include') { should match_array ES_INCLUDED_LOGEVENTS }\n        its('logfile.events.exclude') { should match_array ES_EXCLUDED_LOGEVENTS }\n      end\n    end unless es_handle.nodes.nil?\n\n    describe \"Audit Settings from ES_CONF_YML\" do\n      subject { yaml(ELASTICSEARCH_CONF) }\n      its(['xpack.security.audit.enabled']) { should eq true }\n      its(['xpack.security.audit.outputs']) { should include 'logfile' }\n      its(['xpack.security.audit.logfile.events.include']) { should match_array ES_INCLUDED_LOGEVENTS }\n      its(['xpack.security.audit.logfile.events.exclude']) { should match_array ES_EXCLUDED_LOGEVENTS }\n    end\n\n  rescue Exception => msg\n    describe \"Exception: #{msg}\" do\n      it { should be_nil}\n    end\n  end\nend\n",
          "source_location": {
            "line": 55,
            "ref": "../elasticsearch-inspec/controls/audit/V-26947.rb"
          },
          "results": [
            {
              "status": "passed",
              "code_desc": "Audit Settings for Node: package-centos-72 enabled should eq \"true\"",
              "run_time": 0.000104,
              "start_time": "2018-02-11 14:26:43 -0500"
            },
            {
              "status": "passed",
              "code_desc": "Audit Settings for Node: package-centos-72 outputs should include \"logfile\"",
              "run_time": 0.000077,
              "start_time": "2018-02-11 14:26:43 -0500"
            },
            {
              "status": "passed",
              "code_desc": "Audit Settings for Node: package-centos-72 logfile.events.include should contain exactly \"access_denied\", \"anonymous_access_denied\", \"authentication_failed\", \"connection_denied\", \"tampered_request\", \"run_as_denied\", and \"run_as_granted\"",
              "run_time": 0.00023,
              "start_time": "2018-02-11 14:26:43 -0500"
            },
            {
              "status": "passed",
              "code_desc": "Audit Settings for Node: package-centos-72 logfile.events.exclude should contain exactly \"access_granted\"",
              "run_time": 0.000119,
              "start_time": "2018-02-11 14:26:43 -0500"
            },
            {
              "status": "passed",
              "code_desc": "Audit Settings from ES_CONF_YML [\"xpack.security.audit.enabled\"] should eq true",
              "run_time": 0.000554,
              "start_time": "2018-02-11 14:26:43 -0500"
            },
            {
              "status": "passed",
              "code_desc": "Audit Settings from ES_CONF_YML [\"xpack.security.audit.outputs\"] should include \"logfile\"",
              "run_time": 0.000516,
              "start_time": "2018-02-11 14:26:43 -0500"
            },
            {
              "status": "passed",
              "code_desc": "Audit Settings from ES_CONF_YML [\"xpack.security.audit.logfile.events.include\"] should contain exactly \"access_denied\", \"anonymous_access_denied\", \"authentication_failed\", \"connection_denied\", \"tampered_request\", \"run_as_denied\", and \"run_as_granted\"",
              "run_time": 0.000625,
              "start_time": "2018-02-11 14:26:43 -0500"
            },
            {
              "status": "passed",
              "code_desc": "Audit Settings from ES_CONF_YML [\"xpack.security.audit.logfile.events.exclude\"] should contain exactly \"access_granted\"",
              "run_time": 0.000577,
              "start_time": "2018-02-11 14:26:43 -0500"
            }
          ]
        },
        {
          "id": "V-26906",
          "title": "The application must provide the capability to remotely view/hear all\ncontent related to an established user session in real time.",
          "desc": "Utilize perimeter, application, centralized authentication, and\nrepository audit controls to audit the use of systems in real time with\nsufficient context.  X-Pack Security audit controls should be enabled to audit\nthe defaults of all HTTP/S based access to Elasticsearch.  All applications\nshould use HTTP/S  rather than Elasticsearch transport protocol.",
          "impact": 0.5,
          "refs": [],
          "tags": {
            "nist": [
              "AU-14 b",
              "Rev_3"
            ],
            "severity": "medium",
            "rid": "SV-34186r1_rule",
            "gtitle": "SRG-APP-000094",
            "cci": "CCI-001463",
            "check": "Check Elasticsearch.yml settings and existing audit records to\nverify information specific to the necessary content of the event is being\ncaptured and stored with audit records.\n\nAs the application administrator (usually elasticsearch, check the\nxpack.security.audit.outputs setting contains logfile by running the following:\n\n\n$ cat config/elasticsearch.yml | grep xpack.security.audit.outputs\n\nIf this configuration setting is not present, this is a finding.  If this\nconfiguration setting does not contain logfile, this is a finding.\n\nFor a complete list of extra information that can be added to log_line_prefix,\nsee the official documentation:\nhttps://www.elastic.co/guide/en/x-pack/current/auditing.html\n\n If the current settings do not provide enough information regarding the\ncontent of the event, this is a finding.",
            "fix": "Configure elasticsearch audit settings to contain sufficient\ninformation to establish the outcome of an event occurred.\n\nSee the official documentation for the instructions on audit configuration:\nhttps://www.elastic.co/guide/en/x-pack/current/auditing.html"
          },
          "code": "control \"V-26906\" do\n  title \"The application must provide the capability to remotely view/hear all\ncontent related to an established user session in real time.\"\n  desc  \"Utilize perimeter, application, centralized authentication, and\nrepository audit controls to audit the use of systems in real time with\nsufficient context.  X-Pack Security audit controls should be enabled to audit\nthe defaults of all HTTP/S based access to Elasticsearch.  All applications\nshould use HTTP/S  rather than Elasticsearch transport protocol.\"\n  impact 0.5\n  tag \"nist\": [\"AU-14 b\", \"Rev_3\"]\n  tag \"severity\": \"medium\"\n  tag \"rid\": \"SV-34186r1_rule\"\n  tag \"gtitle\": \"SRG-APP-000094\"\n  tag \"cci\": \"CCI-001463\"\n  tag \"check\": \"Check Elasticsearch.yml settings and existing audit records to\nverify information specific to the necessary content of the event is being\ncaptured and stored with audit records.\n\nAs the application administrator (usually elasticsearch, check the\nxpack.security.audit.outputs setting contains logfile by running the following:\n\n\n$ cat config/elasticsearch.yml | grep xpack.security.audit.outputs\n\nIf this configuration setting is not present, this is a finding.  If this\nconfiguration setting does not contain logfile, this is a finding.\n\nFor a complete list of extra information that can be added to log_line_prefix,\nsee the official documentation:\nhttps://www.elastic.co/guide/en/x-pack/current/auditing.html\n\n If the current settings do not provide enough information regarding the\ncontent of the event, this is a finding.\"\n  tag \"fix\": \"Configure elasticsearch audit settings to contain sufficient\ninformation to establish the outcome of an event occurred.\n\nSee the official documentation for the instructions on audit configuration:\nhttps://www.elastic.co/guide/en/x-pack/current/auditing.html\"\n\n  begin\n    es_handle = es_helper(url:\"https://#{ELASTIC_IP}:#{ELASTIC_PORT}\",\n                    username: ES_ADMIN,\n                    password: ES_PASS,\n                    ssl_verify: SSL_VERIFY )\n\n    describe \"No nodes found\" do\n      subject { es_handle.nodes.nil? }\n      it { should_not be_truthy }\n    end if es_handle.nodes.nil?\n\n    es_handle.nodes.each do |node|\n      describe \"Audit Settings for Node: #{node.name}\" do\n        subject { node.audit }\n        its('enabled') { should eq 'true' }\n        its('outputs') { should include 'logfile' }\n        its('logfile.events.include') { should match_array ES_INCLUDED_LOGEVENTS }\n        its('logfile.events.exclude') { should match_array ES_EXCLUDED_LOGEVENTS }\n      end\n    end unless es_handle.nodes.nil?\n\n    describe \"Audit Settings from ES_CONF_YML\" do\n      subject { yaml(ELASTICSEARCH_CONF) }\n      its(['xpack.security.audit.enabled']) { should eq true }\n      its(['xpack.security.audit.outputs']) { should include 'logfile' }\n      its(['xpack.security.audit.logfile.events.include']) { should match_array ES_INCLUDED_LOGEVENTS }\n      its(['xpack.security.audit.logfile.events.exclude']) { should match_array ES_EXCLUDED_LOGEVENTS }\n    end\n\n  rescue Exception => msg\n    describe \"Exception: #{msg}\" do\n      it { should be_nil}\n    end\n  end\nend\n",
          "source_location": {
            "line": 54,
            "ref": "../elasticsearch-inspec/controls/audit/V-26906.rb"
          },
          "results": [
            {
              "status": "passed",
              "code_desc": "Audit Settings for Node: package-centos-72 enabled should eq \"true\"",
              "run_time": 0.000089,
              "start_time": "2018-02-11 14:26:43 -0500"
            },
            {
              "status": "passed",
              "code_desc": "Audit Settings for Node: package-centos-72 outputs should include \"logfile\"",
              "run_time": 0.000115,
              "start_time": "2018-02-11 14:26:43 -0500"
            },
            {
              "status": "passed",
              "code_desc": "Audit Settings for Node: package-centos-72 logfile.events.include should contain exactly \"access_denied\", \"anonymous_access_denied\", \"authentication_failed\", \"connection_denied\", \"tampered_request\", \"run_as_denied\", and \"run_as_granted\"",
              "run_time": 0.000134,
              "start_time": "2018-02-11 14:26:43 -0500"
            },
            {
              "status": "passed",
              "code_desc": "Audit Settings for Node: package-centos-72 logfile.events.exclude should contain exactly \"access_granted\"",
              "run_time": 0.000087,
              "start_time": "2018-02-11 14:26:43 -0500"
            },
            {
              "status": "passed",
              "code_desc": "Audit Settings from ES_CONF_YML [\"xpack.security.audit.enabled\"] should eq true",
              "run_time": 0.000536,
              "start_time": "2018-02-11 14:26:43 -0500"
            },
            {
              "status": "passed",
              "code_desc": "Audit Settings from ES_CONF_YML [\"xpack.security.audit.outputs\"] should include \"logfile\"",
              "run_time": 0.000559,
              "start_time": "2018-02-11 14:26:43 -0500"
            },
            {
              "status": "passed",
              "code_desc": "Audit Settings from ES_CONF_YML [\"xpack.security.audit.logfile.events.include\"] should contain exactly \"access_denied\", \"anonymous_access_denied\", \"authentication_failed\", \"connection_denied\", \"tampered_request\", \"run_as_denied\", and \"run_as_granted\"",
              "run_time": 0.000621,
              "start_time": "2018-02-11 14:26:43 -0500"
            },
            {
              "status": "passed",
              "code_desc": "Audit Settings from ES_CONF_YML [\"xpack.security.audit.logfile.events.exclude\"] should contain exactly \"access_granted\"",
              "run_time": 0.000566,
              "start_time": "2018-02-11 14:26:43 -0500"
            }
          ]
        },
        {
          "id": "V-26847",
          "title": "The application must produce audit records containing sufficient\ninformation to establish when (date and time) the events occurred.",
          "desc": "Utilize perimeter, application, centralized authentication, and\nrepository audit controls to audit the use of systems in real time with\nsufficient context.  X-Pack Security audit controls should be enabled to audit\nthe defaults of all HTTP/S based access to Elasticsearch.  All applications\nshould use HTTP/S  rather than Elasticsearch transport protocol.",
          "impact": 0.5,
          "refs": [],
          "tags": {
            "nist": [
              "AU-3",
              "Rev_4"
            ],
            "severity": "medium",
            "rid": "SV-34127r1_rule",
            "gtitle": "SRG-APP-000096",
            "cci": "CCI-000131",
            "check": "Check Elasticsearch.yml settings and existing audit records to\nverify information specific to the necessary content of the event is being\ncaptured and stored with audit records.\n\nAs the application administrator (usually elasticsearch, check the\nxpack.security.audit.outputs setting contains logfile by running the following:\n\n\n$ cat config/elasticsearch.yml | grep xpack.security.audit.outputs\n\nIf this configuration setting is not present, this is a finding.  If this\nconfiguration setting does not contain logfile, this is a finding.\n\nFor a complete list of extra information that can be added to log_line_prefix,\nsee the official documentation:\nhttps://www.elastic.co/guide/en/x-pack/current/auditing.html\n\n If the current settings do not provide enough information regarding the\ncontent of the event, this is a finding.",
            "fix": "Configure elasticsearch audit settings to contain sufficient\ninformation to establish where an event occurred.\n\nSee the official documentation for the instructions on audit configuration:\nhttps://www.elastic.co/guide/en/x-pack/current/auditing.html"
          },
          "code": "control \"V-26847\" do\n  title \"The application must produce audit records containing sufficient\ninformation to establish when (date and time) the events occurred.\"\n  desc  \"Utilize perimeter, application, centralized authentication, and\nrepository audit controls to audit the use of systems in real time with\nsufficient context.  X-Pack Security audit controls should be enabled to audit\nthe defaults of all HTTP/S based access to Elasticsearch.  All applications\nshould use HTTP/S  rather than Elasticsearch transport protocol.\"\n  impact 0.5\n  tag \"nist\": [\"AU-3\", \"Rev_4\"]\n  tag \"severity\": \"medium\"\n  tag \"rid\": \"SV-34127r1_rule\"\n  tag \"gtitle\": \"SRG-APP-000096\"\n  tag \"cci\": \"CCI-000131\"\n  tag \"check\": \"Check Elasticsearch.yml settings and existing audit records to\nverify information specific to the necessary content of the event is being\ncaptured and stored with audit records.\n\nAs the application administrator (usually elasticsearch, check the\nxpack.security.audit.outputs setting contains logfile by running the following:\n\n\n$ cat config/elasticsearch.yml | grep xpack.security.audit.outputs\n\nIf this configuration setting is not present, this is a finding.  If this\nconfiguration setting does not contain logfile, this is a finding.\n\nFor a complete list of extra information that can be added to log_line_prefix,\nsee the official documentation:\nhttps://www.elastic.co/guide/en/x-pack/current/auditing.html\n\n If the current settings do not provide enough information regarding the\ncontent of the event, this is a finding.\"\n  tag \"fix\": \"Configure elasticsearch audit settings to contain sufficient\ninformation to establish where an event occurred.\n\nSee the official documentation for the instructions on audit configuration:\nhttps://www.elastic.co/guide/en/x-pack/current/auditing.html\"\n\n  begin\n    es_handle = es_helper(url:\"https://#{ELASTIC_IP}:#{ELASTIC_PORT}\",\n                    username: ES_ADMIN,\n                    password: ES_PASS,\n                    ssl_verify: SSL_VERIFY )\n\n    describe \"No nodes found\" do\n      subject { es_handle.nodes.nil? }\n      it { should_not be_truthy }\n    end if es_handle.nodes.nil?\n\n    es_handle.nodes.each do |node|\n      describe \"Audit Settings for Node: #{node.name}\" do\n        subject { node.audit }\n        its('enabled') { should eq 'true' }\n        its('outputs') { should include 'logfile' }\n        its('logfile.events.include') { should match_array ES_INCLUDED_LOGEVENTS }\n        its('logfile.events.exclude') { should match_array ES_EXCLUDED_LOGEVENTS }\n      end\n    end unless es_handle.nodes.nil?\n\n    describe \"Audit Settings from ES_CONF_YML\" do\n      subject { yaml(ELASTICSEARCH_CONF) }\n      its(['xpack.security.audit.enabled']) { should eq true }\n      its(['xpack.security.audit.outputs']) { should include 'logfile' }\n      its(['xpack.security.audit.logfile.events.include']) { should match_array ES_INCLUDED_LOGEVENTS }\n      its(['xpack.security.audit.logfile.events.exclude']) { should match_array ES_EXCLUDED_LOGEVENTS }\n    end\n\n  rescue Exception => msg\n    describe \"Exception: #{msg}\" do\n      it { should be_nil}\n    end\n  end\nend\n",
          "source_location": {
            "line": 54,
            "ref": "../elasticsearch-inspec/controls/audit/V-26847.rb"
          },
          "results": [
            {
              "status": "passed",
              "code_desc": "Audit Settings for Node: package-centos-72 enabled should eq \"true\"",
              "run_time": 0.000086,
              "start_time": "2018-02-11 14:26:43 -0500"
            },
            {
              "status": "passed",
              "code_desc": "Audit Settings for Node: package-centos-72 outputs should include \"logfile\"",
              "run_time": 0.000087,
              "start_time": "2018-02-11 14:26:43 -0500"
            },
            {
              "status": "passed",
              "code_desc": "Audit Settings for Node: package-centos-72 logfile.events.include should contain exactly \"access_denied\", \"anonymous_access_denied\", \"authentication_failed\", \"connection_denied\", \"tampered_request\", \"run_as_denied\", and \"run_as_granted\"",
              "run_time": 0.000136,
              "start_time": "2018-02-11 14:26:43 -0500"
            },
            {
              "status": "passed",
              "code_desc": "Audit Settings for Node: package-centos-72 logfile.events.exclude should contain exactly \"access_granted\"",
              "run_time": 0.000089,
              "start_time": "2018-02-11 14:26:43 -0500"
            },
            {
              "status": "passed",
              "code_desc": "Audit Settings from ES_CONF_YML [\"xpack.security.audit.enabled\"] should eq true",
              "run_time": 0.000543,
              "start_time": "2018-02-11 14:26:43 -0500"
            },
            {
              "status": "passed",
              "code_desc": "Audit Settings from ES_CONF_YML [\"xpack.security.audit.outputs\"] should include \"logfile\"",
              "run_time": 0.00047,
              "start_time": "2018-02-11 14:26:43 -0500"
            },
            {
              "status": "passed",
              "code_desc": "Audit Settings from ES_CONF_YML [\"xpack.security.audit.logfile.events.include\"] should contain exactly \"access_denied\", \"anonymous_access_denied\", \"authentication_failed\", \"connection_denied\", \"tampered_request\", \"run_as_denied\", and \"run_as_granted\"",
              "run_time": 0.000507,
              "start_time": "2018-02-11 14:26:43 -0500"
            },
            {
              "status": "passed",
              "code_desc": "Audit Settings from ES_CONF_YML [\"xpack.security.audit.logfile.events.exclude\"] should contain exactly \"access_granted\"",
              "run_time": 0.000471,
              "start_time": "2018-02-11 14:26:43 -0500"
            }
          ]
        },
        {
          "id": "V-26903",
          "title": "Applications must generate audit records for the DoD selected list of\nauditable events.",
          "desc": "Utilize perimeter, application, centralized authentication, and\nrepository audit controls to audit the use of systems in real time with\nsufficient context.  X-Pack Security audit controls should be enabled to audit\nthe defaults of all HTTP/S based access to Elasticsearch.  All applications\nshould use HTTP/S  rather than Elasticsearch transport protocol.",
          "impact": 0.5,
          "refs": [],
          "tags": {
            "nist": [
              "AU-12 c",
              "Rev_4"
            ],
            "severity": "medium",
            "rid": "SV-34183r1_rule",
            "gtitle": "SRG-APP-000091",
            "cci": "CCI-000172",
            "check": "Check Elasticsearch.yml settings and existing audit records to\nverify information specific to the necessary content of the event is being\ncaptured and stored with audit records.\n\nAs the application administrator (usually elasticsearch, check the\nxpack.security.audit.outputs setting contains logfile by running the following:\n\n\n$ cat config/elasticsearch.yml | grep xpack.security.audit.outputs\n\nIf this configuration setting is not present, this is a finding.  If this\nconfiguration setting does not contain logfile, this is a finding.\n\nFor a complete list of extra information that can be added to log_line_prefix,\nsee the official documentation:\nhttps://www.elastic.co/guide/en/x-pack/current/auditing.html\n\n If the current settings do not provide enough information regarding the\ncontent of the event, this is a finding.",
            "fix": "Configure elasticsearch audit settings to contain sufficient\ninformation to establish where an event occurred.\n\nSee the official documentation for the instructions on audit configuration:\nhttps://www.elastic.co/guide/en/x-pack/current/auditing.html"
          },
          "code": "control \"V-26903\" do\n  title \"Applications must generate audit records for the DoD selected list of\nauditable events.\"\n  desc  \"Utilize perimeter, application, centralized authentication, and\nrepository audit controls to audit the use of systems in real time with\nsufficient context.  X-Pack Security audit controls should be enabled to audit\nthe defaults of all HTTP/S based access to Elasticsearch.  All applications\nshould use HTTP/S  rather than Elasticsearch transport protocol.\"\n  impact 0.5\n  tag \"nist\": [\"AU-12 c\", \"Rev_4\"]\n  tag \"severity\": \"medium\"\n  tag \"rid\": \"SV-34183r1_rule\"\n  tag \"gtitle\": \"SRG-APP-000091\"\n  tag \"cci\": \"CCI-000172\"\n  tag \"check\": \"Check Elasticsearch.yml settings and existing audit records to\nverify information specific to the necessary content of the event is being\ncaptured and stored with audit records.\n\nAs the application administrator (usually elasticsearch, check the\nxpack.security.audit.outputs setting contains logfile by running the following:\n\n\n$ cat config/elasticsearch.yml | grep xpack.security.audit.outputs\n\nIf this configuration setting is not present, this is a finding.  If this\nconfiguration setting does not contain logfile, this is a finding.\n\nFor a complete list of extra information that can be added to log_line_prefix,\nsee the official documentation:\nhttps://www.elastic.co/guide/en/x-pack/current/auditing.html\n\n If the current settings do not provide enough information regarding the\ncontent of the event, this is a finding.\"\n  tag \"fix\": \"Configure elasticsearch audit settings to contain sufficient\ninformation to establish where an event occurred.\n\nSee the official documentation for the instructions on audit configuration:\nhttps://www.elastic.co/guide/en/x-pack/current/auditing.html\"\n\n  begin\n    es_handle = es_helper(url:\"https://#{ELASTIC_IP}:#{ELASTIC_PORT}\",\n                    username: ES_ADMIN,\n                    password: ES_PASS,\n                    ssl_verify: SSL_VERIFY )\n\n    describe \"No nodes found\" do\n      subject { es_handle.nodes.nil? }\n      it { should_not be_truthy }\n    end if es_handle.nodes.nil?\n\n    es_handle.nodes.each do |node|\n      describe \"Audit Settings for Node: #{node.name}\" do\n        subject { node.audit }\n        its('enabled') { should eq 'true' }\n        its('outputs') { should include 'logfile' }\n        its('logfile.events.include') { should match_array ES_INCLUDED_LOGEVENTS }\n        its('logfile.events.exclude') { should match_array ES_EXCLUDED_LOGEVENTS }\n      end\n    end unless es_handle.nodes.nil?\n\n    describe \"Audit Settings from ES_CONF_YML\" do\n      subject { yaml(ELASTICSEARCH_CONF) }\n      its(['xpack.security.audit.enabled']) { should eq true }\n      its(['xpack.security.audit.outputs']) { should include 'logfile' }\n      its(['xpack.security.audit.logfile.events.include']) { should match_array ES_INCLUDED_LOGEVENTS }\n      its(['xpack.security.audit.logfile.events.exclude']) { should match_array ES_EXCLUDED_LOGEVENTS }\n    end\n\n  rescue Exception => msg\n    describe \"Exception: #{msg}\" do\n      it { should be_nil}\n    end\n  end\nend\n",
          "source_location": {
            "line": 54,
            "ref": "../elasticsearch-inspec/controls/audit/V-26903.rb"
          },
          "results": [
            {
              "status": "passed",
              "code_desc": "Audit Settings for Node: package-centos-72 enabled should eq \"true\"",
              "run_time": 0.000074,
              "start_time": "2018-02-11 14:26:43 -0500"
            },
            {
              "status": "passed",
              "code_desc": "Audit Settings for Node: package-centos-72 outputs should include \"logfile\"",
              "run_time": 0.000075,
              "start_time": "2018-02-11 14:26:43 -0500"
            },
            {
              "status": "passed",
              "code_desc": "Audit Settings for Node: package-centos-72 logfile.events.include should contain exactly \"access_denied\", \"anonymous_access_denied\", \"authentication_failed\", \"connection_denied\", \"tampered_request\", \"run_as_denied\", and \"run_as_granted\"",
              "run_time": 0.000126,
              "start_time": "2018-02-11 14:26:43 -0500"
            },
            {
              "status": "passed",
              "code_desc": "Audit Settings for Node: package-centos-72 logfile.events.exclude should contain exactly \"access_granted\"",
              "run_time": 0.000074,
              "start_time": "2018-02-11 14:26:43 -0500"
            },
            {
              "status": "passed",
              "code_desc": "Audit Settings from ES_CONF_YML [\"xpack.security.audit.enabled\"] should eq true",
              "run_time": 0.000484,
              "start_time": "2018-02-11 14:26:43 -0500"
            },
            {
              "status": "passed",
              "code_desc": "Audit Settings from ES_CONF_YML [\"xpack.security.audit.outputs\"] should include \"logfile\"",
              "run_time": 0.000478,
              "start_time": "2018-02-11 14:26:43 -0500"
            },
            {
              "status": "passed",
              "code_desc": "Audit Settings from ES_CONF_YML [\"xpack.security.audit.logfile.events.include\"] should contain exactly \"access_denied\", \"anonymous_access_denied\", \"authentication_failed\", \"connection_denied\", \"tampered_request\", \"run_as_denied\", and \"run_as_granted\"",
              "run_time": 0.000505,
              "start_time": "2018-02-11 14:26:43 -0500"
            },
            {
              "status": "passed",
              "code_desc": "Audit Settings from ES_CONF_YML [\"xpack.security.audit.logfile.events.exclude\"] should contain exactly \"access_granted\"",
              "run_time": 0.000479,
              "start_time": "2018-02-11 14:26:43 -0500"
            }
          ]
        },
        {
          "id": "V-26677",
          "title": "The application must provide the capability to specify administrative\nusers and grant them the right to change application security attributes\npertaining to application data.",
          "desc": "The application controlled data model for security labels and markings\nshould be human readable and present in all stored and transferred data models.",
          "impact": 0.5,
          "refs": [],
          "tags": {
            "nist": [
              "AC-16 (2)",
              "Rev_4"
            ],
            "severity": "medium",
            "rid": "SV-33849r1_rule",
            "gtitle": "SRG-APP-000010",
            "cci": "CCI-001425",
            "check": "The JSON data models used by a system must maintain\ndenormalized or linked security labels and markings for information such that\nthe security labels can be changed by administrative personnel. Data in transit\nis protected via TLS. Utilize X-Pack Security's Field and Document Level\nSecurity features to restrict access based on information within the document.\n\n\nAs the security administrator, run the following CURL command:\n\n$ curl -XGET  -H 'Content-Type: application/json' -u <TEST_USER> -p\n<TEST_CREDENTIALS> https://<elasticsearch>:9200/_xpack/security/role\n\nReview the role permissions, if any role is incorrect or does not provide\naccess to security labels of the underlying data model, this is a finding.",
            "fix": "As an administrative users, verify that you have access to\nsecurity labels within the data model.\n\nSee the official documentation for the complete  guide on authorization\nconfiguration:\nhttps://www.elastic.co/guide/en/x-pack/current/authorization.html"
          },
          "code": "control \"V-26677\" do\n  title \"The application must provide the capability to specify administrative\nusers and grant them the right to change application security attributes\npertaining to application data.\"\n  desc  \"The application controlled data model for security labels and markings\nshould be human readable and present in all stored and transferred data models.\"\n  impact 0.5\n  tag \"nist\": [\"AC-16 (2)\", \"Rev_4\"]\n  tag \"severity\": \"medium\"\n  tag \"rid\": \"SV-33849r1_rule\"\n  tag \"gtitle\": \"SRG-APP-000010\"\n  tag \"cci\": \"CCI-001425\"\n  tag \"check\": \"The JSON data models used by a system must maintain\ndenormalized or linked security labels and markings for information such that\nthe security labels can be changed by administrative personnel. Data in transit\nis protected via TLS. Utilize X-Pack Security's Field and Document Level\nSecurity features to restrict access based on information within the document.\n\n\nAs the security administrator, run the following CURL command:\n\n$ curl -XGET  -H 'Content-Type: application/json' -u <TEST_USER> -p\n<TEST_CREDENTIALS> https://<elasticsearch>:9200/_xpack/security/role\n\nReview the role permissions, if any role is incorrect or does not provide\naccess to security labels of the underlying data model, this is a finding.\"\n  tag \"fix\": \"As an administrative users, verify that you have access to\nsecurity labels within the data model.\n\nSee the official documentation for the complete  guide on authorization\nconfiguration:\nhttps://www.elastic.co/guide/en/x-pack/current/authorization.html\"\n\n  begin\n    es_handle = es_helper(url:\"https://#{ELASTIC_IP}:#{ELASTIC_PORT}\",\n                    username: ES_ADMIN,\n                    password: ES_PASS,\n                    ssl_verify: SSL_VERIFY )\n\n    describe \"No nodes found\" do\n      subject { es_handle.nodes.nil? }\n      it { should_not be_truthy }\n    end if es_handle.nodes.nil?\n\n    es_handle.nodes.each do |node|\n      describe \"SSL Settings for Node: #{node.name}\" do\n        subject { node }\n        its(\"http_ssl.enabled\") { should eq 'true' }\n        its(\"transport_ssl.enabled\") { should eq 'true' }\n      end\n    end unless es_handle.nodes.nil?\n\n    describe yaml(ELASTICSEARCH_CONF) do\n      its(['xpack.ssl.key']) { should_not be_nil }\n      its(['xpack.ssl.certificate']) { should_not be_nil }\n      its(['xpack.ssl.certificate_authorities']) { should_not be_nil }\n      its(['xpack.security.http.ssl.enabled']) { should eq true }\n      its(['xpack.security.transport.ssl.enabled']) { should eq true }\n    end\n\n    describe es_handle do\n      its('superusers') { should be_in DOCUMENTED_SUPER_ROLES}\n    end\n\n  rescue Exception => msg\n    describe \"Exception: #{msg}\" do\n      it { should be_nil}\n    end\n  end\nend\n",
          "source_location": {
            "line": 47,
            "ref": "../elasticsearch-inspec/controls/tls+role/V-26677.rb"
          },
          "results": [
            {
              "status": "passed",
              "code_desc": "SSL Settings for Node: package-centos-72 http_ssl.enabled should eq \"true\"",
              "run_time": 0.000074,
              "start_time": "2018-02-11 14:26:43 -0500"
            },
            {
              "status": "passed",
              "code_desc": "SSL Settings for Node: package-centos-72 transport_ssl.enabled should eq \"true\"",
              "run_time": 0.000075,
              "start_time": "2018-02-11 14:26:43 -0500"
            },
            {
              "status": "passed",
              "code_desc": "YAML /etc/elasticsearch/elasticsearch.yml [\"xpack.ssl.key\"] should not be nil",
              "run_time": 0.000071,
              "start_time": "2018-02-11 14:26:43 -0500"
            },
            {
              "status": "passed",
              "code_desc": "YAML /etc/elasticsearch/elasticsearch.yml [\"xpack.ssl.certificate\"] should not be nil",
              "run_time": 0.000057,
              "start_time": "2018-02-11 14:26:43 -0500"
            },
            {
              "status": "passed",
              "code_desc": "YAML /etc/elasticsearch/elasticsearch.yml [\"xpack.ssl.certificate_authorities\"] should not be nil",
              "run_time": 0.000074,
              "start_time": "2018-02-11 14:26:43 -0500"
            },
            {
              "status": "passed",
              "code_desc": "YAML /etc/elasticsearch/elasticsearch.yml [\"xpack.security.http.ssl.enabled\"] should eq true",
              "run_time": 0.000062,
              "start_time": "2018-02-11 14:26:43 -0500"
            },
            {
              "status": "passed",
              "code_desc": "YAML /etc/elasticsearch/elasticsearch.yml [\"xpack.security.transport.ssl.enabled\"] should eq true",
              "run_time": 0.00006,
              "start_time": "2018-02-11 14:26:43 -0500"
            },
            {
              "status": "passed",
              "code_desc": "Elasticsearch Cluster https://0.0.0.0:9200 superusers should be in \"superuser\"",
              "run_time": 1.317535,
              "start_time": "2018-02-11 14:26:43 -0500"
            }
          ]
        },
        {
          "id": "V-26673",
          "title": "The application must maintain and support the use of organizational\ndefined security attributes to stored information.",
          "desc": "The application controlled data model for security labels and markings\nshould be human readable and present in all stored and transferred data models.",
          "impact": 0.5,
          "refs": [],
          "tags": {
            "nist": [
              "AC-16",
              "Rev_3"
            ],
            "severity": "medium",
            "rid": "SV-33820r1_rule",
            "gtitle": "SRG-APP-000006",
            "cci": "CCI-001399",
            "check": "The JSON data models used by a system must maintain\ndenormalized or linked security labels and markings for information such that\nthe information can be used for safeguarding information. Data in transit is\nprotected via TLS. Utilize X-Pack Security's Field and Document Level Security\nfeatures to restrict access based on information within the document.\n\nAs the elasticsearch administrator, run the following CURL command:\n\n$ curl -XGET  -H 'Content-Type: application/json' -u <TEST_USER> -p\n<TEST_CREDENTIALS> https://<elasticsearch>:9200/_xpack/security/role\n\nReview the role permissions, if any role is incorrect or provides access to\ncluster configuration outside of administrative roles, this is a finding.",
            "fix": "As a data owner, build a data model that is denormalized or\nlinked security labels and markings for information such that the information\ncan be used for safeguarding information.\n\nSee the official documentation for the complete  guide on authorization\nconfiguration:\nhttps://www.elastic.co/guide/en/x-pack/current/authorization.html"
          },
          "code": "control \"V-26673\" do\n  title \"The application must maintain and support the use of organizational\ndefined security attributes to stored information.\"\n  desc  \"The application controlled data model for security labels and markings\nshould be human readable and present in all stored and transferred data models.\"\n  impact 0.5\n  tag \"nist\": [\"AC-16\", \"Rev_3\"]\n  tag \"severity\": \"medium\"\n  tag \"rid\": \"SV-33820r1_rule\"\n  tag \"gtitle\": \"SRG-APP-000006\"\n  tag \"cci\": \"CCI-001399\"\n  tag \"check\": \"The JSON data models used by a system must maintain\ndenormalized or linked security labels and markings for information such that\nthe information can be used for safeguarding information. Data in transit is\nprotected via TLS. Utilize X-Pack Security's Field and Document Level Security\nfeatures to restrict access based on information within the document.\n\nAs the elasticsearch administrator, run the following CURL command:\n\n$ curl -XGET  -H 'Content-Type: application/json' -u <TEST_USER> -p\n<TEST_CREDENTIALS> https://<elasticsearch>:9200/_xpack/security/role\n\nReview the role permissions, if any role is incorrect or provides access to\ncluster configuration outside of administrative roles, this is a finding.\"\n  tag \"fix\": \"As a data owner, build a data model that is denormalized or\nlinked security labels and markings for information such that the information\ncan be used for safeguarding information.\n\nSee the official documentation for the complete  guide on authorization\nconfiguration:\nhttps://www.elastic.co/guide/en/x-pack/current/authorization.html\"\n\n  begin\n    es_handle = es_helper(url:\"https://#{ELASTIC_IP}:#{ELASTIC_PORT}\",\n                    username: ES_ADMIN,\n                    password: ES_PASS,\n                    ssl_verify: SSL_VERIFY )\n\n    describe \"No nodes found\" do\n      subject { es_handle.nodes.nil? }\n      it { should_not be_truthy }\n    end if es_handle.nodes.nil?\n\n    es_handle.nodes.each do |node|\n      describe \"SSL Settings for Node: #{node.name}\" do\n        subject { node }\n        its(\"http_ssl.enabled\") { should eq 'true' }\n        its(\"transport_ssl.enabled\") { should eq 'true' }\n      end\n    end unless es_handle.nodes.nil?\n\n    describe yaml(ELASTICSEARCH_CONF) do\n      its(['xpack.ssl.key']) { should_not be_nil }\n      its(['xpack.ssl.certificate']) { should_not be_nil }\n      its(['xpack.ssl.certificate_authorities']) { should_not be_nil }\n      its(['xpack.security.http.ssl.enabled']) { should eq true }\n      its(['xpack.security.transport.ssl.enabled']) { should eq true }\n    end\n\n    describe es_handle do\n      its('superusers') { should be_in DOCUMENTED_SUPER_ROLES}\n    end\n\n  rescue Exception => msg\n    describe \"Exception: #{msg}\" do\n      it { should be_nil}\n    end\n  end\nend\n",
          "source_location": {
            "line": 46,
            "ref": "../elasticsearch-inspec/controls/tls+role/V-26673.rb"
          },
          "results": [
            {
              "status": "passed",
              "code_desc": "SSL Settings for Node: package-centos-72 http_ssl.enabled should eq \"true\"",
              "run_time": 0.000109,
              "start_time": "2018-02-11 14:26:45 -0500"
            },
            {
              "status": "passed",
              "code_desc": "SSL Settings for Node: package-centos-72 transport_ssl.enabled should eq \"true\"",
              "run_time": 0.000068,
              "start_time": "2018-02-11 14:26:45 -0500"
            },
            {
              "status": "passed",
              "code_desc": "YAML /etc/elasticsearch/elasticsearch.yml [\"xpack.ssl.key\"] should not be nil",
              "run_time": 0.000085,
              "start_time": "2018-02-11 14:26:45 -0500"
            },
            {
              "status": "passed",
              "code_desc": "YAML /etc/elasticsearch/elasticsearch.yml [\"xpack.ssl.certificate\"] should not be nil",
              "run_time": 0.000055,
              "start_time": "2018-02-11 14:26:45 -0500"
            },
            {
              "status": "passed",
              "code_desc": "YAML /etc/elasticsearch/elasticsearch.yml [\"xpack.ssl.certificate_authorities\"] should not be nil",
              "run_time": 0.000055,
              "start_time": "2018-02-11 14:26:45 -0500"
            },
            {
              "status": "passed",
              "code_desc": "YAML /etc/elasticsearch/elasticsearch.yml [\"xpack.security.http.ssl.enabled\"] should eq true",
              "run_time": 0.000061,
              "start_time": "2018-02-11 14:26:45 -0500"
            },
            {
              "status": "passed",
              "code_desc": "YAML /etc/elasticsearch/elasticsearch.yml [\"xpack.security.transport.ssl.enabled\"] should eq true",
              "run_time": 0.00006,
              "start_time": "2018-02-11 14:26:45 -0500"
            },
            {
              "status": "passed",
              "code_desc": "Elasticsearch Cluster https://0.0.0.0:9200 superusers should be in \"superuser\"",
              "run_time": 1.334112,
              "start_time": "2018-02-11 14:26:45 -0500"
            }
          ]
        },
        {
          "id": "V-26791",
          "title": "Applications must enforce organizational-defined limitations on the\nembedding of data types within other data types.",
          "desc": "The JSON data models used by a system must maintain denormalized or\nlinked security labels and markings for information such that the information\ncan be used for automated policy actions by applications and Elasticsearch\nsecurity infrastructure. Data in transit is protected via TLS. Utilize X-Pack\nSecurity's Field and Document Level Security features to restrict access based\non information within the document.",
          "impact": 0.5,
          "refs": [],
          "tags": {
            "nist": [
              "AC-4 (5)",
              "Rev_4"
            ],
            "severity": "medium",
            "rid": "SV-34041r1_rule",
            "gtitle": "SRG-APP-000057",
            "cci": "CCI-000029",
            "check": "The JSON data models used by a system must maintain\ndenormalized or linked security labels and markings for information such that\nthe security labels can be changed by administrative personnel. Data in transit\nis protected via TLS. Utilize X-Pack Security's Field and Document Level\nSecurity features to restrict access based on information within the document.\n\n\nAs the security administrator, run the following CURL command:\n\n$ curl -XGET  -H 'Content-Type: application/json' -u <TEST_USER> -p\n<TEST_CREDENTIALS> https://<elasticsearch>:9200/_xpack/security/role\n\nReview the role permissions, if any role is incorrect or does not provide\naccess to underliing data model, this is a finding.",
            "fix": "As an administrative users, verify that you have access to\nsecurity labels within the data model.\n\nSee the official documentation for the complete  guide on authorization\nconfiguration:\nhttps://www.elastic.co/guide/en/x-pack/current/authorization.html"
          },
          "code": "control \"V-26791\" do\n  title \"Applications must enforce organizational-defined limitations on the\nembedding of data types within other data types.\"\n  desc  \"The JSON data models used by a system must maintain denormalized or\nlinked security labels and markings for information such that the information\ncan be used for automated policy actions by applications and Elasticsearch\nsecurity infrastructure. Data in transit is protected via TLS. Utilize X-Pack\nSecurity's Field and Document Level Security features to restrict access based\non information within the document.\"\n  impact 0.5\n  tag \"nist\": [\"AC-4 (5)\", \"Rev_4\"]\n  tag \"severity\": \"medium\"\n  tag \"rid\": \"SV-34041r1_rule\"\n  tag \"gtitle\": \"SRG-APP-000057\"\n  tag \"cci\": \"CCI-000029\"\n  tag \"check\": \"The JSON data models used by a system must maintain\ndenormalized or linked security labels and markings for information such that\nthe security labels can be changed by administrative personnel. Data in transit\nis protected via TLS. Utilize X-Pack Security's Field and Document Level\nSecurity features to restrict access based on information within the document.\n\n\nAs the security administrator, run the following CURL command:\n\n$ curl -XGET  -H 'Content-Type: application/json' -u <TEST_USER> -p\n<TEST_CREDENTIALS> https://<elasticsearch>:9200/_xpack/security/role\n\nReview the role permissions, if any role is incorrect or does not provide\naccess to underliing data model, this is a finding.\"\n  tag \"fix\": \"As an administrative users, verify that you have access to\nsecurity labels within the data model.\n\nSee the official documentation for the complete  guide on authorization\nconfiguration:\nhttps://www.elastic.co/guide/en/x-pack/current/authorization.html\"\n\n  begin\n    es_handle = es_helper(url:\"https://#{ELASTIC_IP}:#{ELASTIC_PORT}\",\n                    username: ES_ADMIN,\n                    password: ES_PASS,\n                    ssl_verify: SSL_VERIFY )\n\n    describe \"No nodes found\" do\n      subject { es_handle.nodes.nil? }\n      it { should_not be_truthy }\n    end if es_handle.nodes.nil?\n\n    es_handle.nodes.each do |node|\n      describe \"SSL Settings for Node: #{node.name}\" do\n        subject { node }\n        its(\"http_ssl.enabled\") { should eq 'true' }\n        its(\"transport_ssl.enabled\") { should eq 'true' }\n      end\n    end unless es_handle.nodes.nil?\n\n    describe yaml(ELASTICSEARCH_CONF) do\n      its(['xpack.ssl.key']) { should_not be_nil }\n      its(['xpack.ssl.certificate']) { should_not be_nil }\n      its(['xpack.ssl.certificate_authorities']) { should_not be_nil }\n      its(['xpack.security.http.ssl.enabled']) { should eq true }\n      its(['xpack.security.transport.ssl.enabled']) { should eq true }\n    end\n\n    describe es_handle do\n      its('superusers') { should be_in DOCUMENTED_SUPER_ROLES}\n    end\n\n  rescue Exception => msg\n    describe \"Exception: #{msg}\" do\n      it { should be_nil}\n    end\n  end\nend\n",
          "source_location": {
            "line": 47,
            "ref": "../elasticsearch-inspec/controls/tls+role/V-26791.rb"
          },
          "results": [
            {
              "status": "passed",
              "code_desc": "SSL Settings for Node: package-centos-72 http_ssl.enabled should eq \"true\"",
              "run_time": 0.000113,
              "start_time": "2018-02-11 14:26:46 -0500"
            },
            {
              "status": "passed",
              "code_desc": "SSL Settings for Node: package-centos-72 transport_ssl.enabled should eq \"true\"",
              "run_time": 0.000069,
              "start_time": "2018-02-11 14:26:46 -0500"
            },
            {
              "status": "passed",
              "code_desc": "YAML /etc/elasticsearch/elasticsearch.yml [\"xpack.ssl.key\"] should not be nil",
              "run_time": 0.000072,
              "start_time": "2018-02-11 14:26:46 -0500"
            },
            {
              "status": "passed",
              "code_desc": "YAML /etc/elasticsearch/elasticsearch.yml [\"xpack.ssl.certificate\"] should not be nil",
              "run_time": 0.000069,
              "start_time": "2018-02-11 14:26:46 -0500"
            },
            {
              "status": "passed",
              "code_desc": "YAML /etc/elasticsearch/elasticsearch.yml [\"xpack.ssl.certificate_authorities\"] should not be nil",
              "run_time": 0.000069,
              "start_time": "2018-02-11 14:26:46 -0500"
            },
            {
              "status": "passed",
              "code_desc": "YAML /etc/elasticsearch/elasticsearch.yml [\"xpack.security.http.ssl.enabled\"] should eq true",
              "run_time": 0.000065,
              "start_time": "2018-02-11 14:26:46 -0500"
            },
            {
              "status": "passed",
              "code_desc": "YAML /etc/elasticsearch/elasticsearch.yml [\"xpack.security.transport.ssl.enabled\"] should eq true",
              "run_time": 0.000081,
              "start_time": "2018-02-11 14:26:46 -0500"
            },
            {
              "status": "passed",
              "code_desc": "Elasticsearch Cluster https://0.0.0.0:9200 superusers should be in \"superuser\"",
              "run_time": 1.302179,
              "start_time": "2018-02-11 14:26:46 -0500"
            }
          ]
        },
        {
          "id": "V-26779",
          "title": "The application must bind security attributes to information to\nfacilitate information flow policy enforcement.",
          "desc": "The application controlled data model for security labels and markings\nshould be human readable and present in all stored and transferred data models.",
          "impact": 0.5,
          "refs": [],
          "tags": {
            "nist": [
              "AC-4 (17) (b)",
              "Rev_3"
            ],
            "severity": "medium",
            "rid": "SV-34029r1_rule",
            "gtitle": "SRG-APP-000052",
            "cci": "CCI-000223",
            "check": "The JSON data models used by a system must maintain\ndenormalized or linked security labels and markings for information such that\nthe information can be used for attribution. Data in transit is protected via\nTLS. Utilize X-Pack Security's Field and Document Level Security features to\nrestrict access based on information within the document.\n\nAs the elasticsearch administrator, run the following CURL command:\n\n$ curl -XGET  -H 'Content-Type: application/json' -u <TEST_USER> -p\n<TEST_CREDENTIALS> https://<elasticsearch>:9200/_xpack/security/role\n\nReview the role permissions, if any role is incorrect or provides access to\ncluster configuration outside of administrative roles, this is a finding.",
            "fix": "As a data owner, build a data model that is denormalized or\nlinked security labels and markings for information such that the information\ncan be used for attribution.\n\nSee the official documentation for the complete  guide on authorization\nconfiguration:\nhttps://www.elastic.co/guide/en/x-pack/current/authorization.html"
          },
          "code": "control \"V-26779\" do\n  title \"The application must bind security attributes to information to\nfacilitate information flow policy enforcement.\"\n  desc  \"The application controlled data model for security labels and markings\nshould be human readable and present in all stored and transferred data models.\"\n  impact 0.5\n  tag \"nist\": [\"AC-4 (17) (b)\", \"Rev_3\"]\n  tag \"severity\": \"medium\"\n  tag \"rid\": \"SV-34029r1_rule\"\n  tag \"gtitle\": \"SRG-APP-000052\"\n  tag \"cci\": \"CCI-000223\"\n  tag \"check\": \"The JSON data models used by a system must maintain\ndenormalized or linked security labels and markings for information such that\nthe information can be used for attribution. Data in transit is protected via\nTLS. Utilize X-Pack Security's Field and Document Level Security features to\nrestrict access based on information within the document.\n\nAs the elasticsearch administrator, run the following CURL command:\n\n$ curl -XGET  -H 'Content-Type: application/json' -u <TEST_USER> -p\n<TEST_CREDENTIALS> https://<elasticsearch>:9200/_xpack/security/role\n\nReview the role permissions, if any role is incorrect or provides access to\ncluster configuration outside of administrative roles, this is a finding.\"\n  tag \"fix\": \"As a data owner, build a data model that is denormalized or\nlinked security labels and markings for information such that the information\ncan be used for attribution.\n\nSee the official documentation for the complete  guide on authorization\nconfiguration:\nhttps://www.elastic.co/guide/en/x-pack/current/authorization.html\"\n\n  begin\n    es_handle = es_helper(url:\"https://#{ELASTIC_IP}:#{ELASTIC_PORT}\",\n                    username: ES_ADMIN,\n                    password: ES_PASS,\n                    ssl_verify: SSL_VERIFY )\n\n    describe \"No nodes found\" do\n      subject { es_handle.nodes.nil? }\n      it { should_not be_truthy }\n    end if es_handle.nodes.nil?\n\n    es_handle.nodes.each do |node|\n      describe \"SSL Settings for Node: #{node.name}\" do\n        subject { node }\n        its(\"http_ssl.enabled\") { should eq 'true' }\n        its(\"transport_ssl.enabled\") { should eq 'true' }\n      end\n    end unless es_handle.nodes.nil?\n\n    describe yaml(ELASTICSEARCH_CONF) do\n      its(['xpack.ssl.key']) { should_not be_nil }\n      its(['xpack.ssl.certificate']) { should_not be_nil }\n      its(['xpack.ssl.certificate_authorities']) { should_not be_nil }\n      its(['xpack.security.http.ssl.enabled']) { should eq true }\n      its(['xpack.security.transport.ssl.enabled']) { should eq true }\n    end\n\n    describe es_handle do\n      its('superusers') { should be_in DOCUMENTED_SUPER_ROLES}\n    end\n\n  rescue Exception => msg\n    describe \"Exception: #{msg}\" do\n      it { should be_nil}\n    end\n  end\nend\n",
          "source_location": {
            "line": 41,
            "ref": "../elasticsearch-inspec/controls/tls+role/V-26779.rb"
          },
          "results": [
            {
              "status": "passed",
              "code_desc": "SSL Settings for Node: package-centos-72 http_ssl.enabled should eq \"true\"",
              "run_time": 0.000158,
              "start_time": "2018-02-11 14:26:47 -0500"
            },
            {
              "status": "passed",
              "code_desc": "SSL Settings for Node: package-centos-72 transport_ssl.enabled should eq \"true\"",
              "run_time": 0.000101,
              "start_time": "2018-02-11 14:26:47 -0500"
            },
            {
              "status": "passed",
              "code_desc": "YAML /etc/elasticsearch/elasticsearch.yml [\"xpack.ssl.key\"] should not be nil",
              "run_time": 0.000091,
              "start_time": "2018-02-11 14:26:47 -0500"
            },
            {
              "status": "passed",
              "code_desc": "YAML /etc/elasticsearch/elasticsearch.yml [\"xpack.ssl.certificate\"] should not be nil",
              "run_time": 0.000081,
              "start_time": "2018-02-11 14:26:47 -0500"
            },
            {
              "status": "passed",
              "code_desc": "YAML /etc/elasticsearch/elasticsearch.yml [\"xpack.ssl.certificate_authorities\"] should not be nil",
              "run_time": 0.000099,
              "start_time": "2018-02-11 14:26:47 -0500"
            },
            {
              "status": "passed",
              "code_desc": "YAML /etc/elasticsearch/elasticsearch.yml [\"xpack.security.http.ssl.enabled\"] should eq true",
              "run_time": 0.00009,
              "start_time": "2018-02-11 14:26:47 -0500"
            },
            {
              "status": "passed",
              "code_desc": "YAML /etc/elasticsearch/elasticsearch.yml [\"xpack.security.transport.ssl.enabled\"] should eq true",
              "run_time": 0.000076,
              "start_time": "2018-02-11 14:26:47 -0500"
            },
            {
              "status": "passed",
              "code_desc": "Elasticsearch Cluster https://0.0.0.0:9200 superusers should be in \"superuser\"",
              "run_time": 1.369801,
              "start_time": "2018-02-11 14:26:47 -0500"
            }
          ]
        },
        {
          "id": "V-26679",
          "title": "The  application must allow authorized users to associate security\nattributes with information.",
          "desc": "The JSON data models used by a system must maintain denormalized or\nlinked security labels and markings for information such that the information\ncan be used for automated policy actions by applications and Elasticsearch\nsecurity infrastructure. Utilize X-Pack Security's Field and Document Level\nSecurity features to restrict access based on information within the document.",
          "impact": 0.5,
          "refs": [],
          "tags": {
            "nist": [
              "AC-16 (4)",
              "Rev_3"
            ],
            "severity": "medium",
            "rid": "SV-33878r1_rule",
            "gtitle": "SRG-APP-000012",
            "cci": "CCI-001427",
            "check": "The JSON data models used by a system must maintain\ndenormalized or linked security labels and markings for information such that\nthe security labels can be changed by administrative personnel. Data in transit\nis protected via TLS. Utilize X-Pack Security's Field and Document Level\nSecurity features to restrict access based on information within the document.\n\n\nAs the security administrator, run the following CURL command:\n\n$ curl -XGET  -H 'Content-Type: application/json' -u <TEST_USER> -p\n<TEST_CREDENTIALS> https://<elasticsearch>:9200/_xpack/security/role\n\nReview the role permissions, if any role is incorrect or does not provide\naccess to security labels of the underlying data model, this is a finding.",
            "fix": "As an administrative users, verify that you have access to\nsecurity labels within the data model.\n\nSee the official documentation for the complete  guide on authorization\nconfiguration:\nhttps://www.elastic.co/guide/en/x-pack/current/authorization.html"
          },
          "code": "control \"V-26679\" do\n  title \"The  application must allow authorized users to associate security\nattributes with information.\"\n  desc  \"The JSON data models used by a system must maintain denormalized or\nlinked security labels and markings for information such that the information\ncan be used for automated policy actions by applications and Elasticsearch\nsecurity infrastructure. Utilize X-Pack Security's Field and Document Level\nSecurity features to restrict access based on information within the document.\"\n  impact 0.5\n  tag \"nist\": [\"AC-16 (4)\", \"Rev_3\"]\n  tag \"severity\": \"medium\"\n  tag \"rid\": \"SV-33878r1_rule\"\n  tag \"gtitle\": \"SRG-APP-000012\"\n  tag \"cci\": \"CCI-001427\"\n  tag \"check\": \"The JSON data models used by a system must maintain\ndenormalized or linked security labels and markings for information such that\nthe security labels can be changed by administrative personnel. Data in transit\nis protected via TLS. Utilize X-Pack Security's Field and Document Level\nSecurity features to restrict access based on information within the document.\n\n\nAs the security administrator, run the following CURL command:\n\n$ curl -XGET  -H 'Content-Type: application/json' -u <TEST_USER> -p\n<TEST_CREDENTIALS> https://<elasticsearch>:9200/_xpack/security/role\n\nReview the role permissions, if any role is incorrect or does not provide\naccess to security labels of the underlying data model, this is a finding.\"\n  tag \"fix\": \"As an administrative users, verify that you have access to\nsecurity labels within the data model.\n\nSee the official documentation for the complete  guide on authorization\nconfiguration:\nhttps://www.elastic.co/guide/en/x-pack/current/authorization.html\"\n\n  begin\n    es_handle = es_helper(url:\"https://#{ELASTIC_IP}:#{ELASTIC_PORT}\",\n                    username: ES_ADMIN,\n                    password: ES_PASS,\n                    ssl_verify: SSL_VERIFY )\n\n    describe \"No nodes found\" do\n      subject { es_handle.nodes.nil? }\n      it { should_not be_truthy }\n    end if es_handle.nodes.nil?\n\n    es_handle.nodes.each do |node|\n      describe \"SSL Settings for Node: #{node.name}\" do\n        subject { node }\n        its(\"http_ssl.enabled\") { should eq 'true' }\n        its(\"transport_ssl.enabled\") { should eq 'true' }\n      end\n    end unless es_handle.nodes.nil?\n\n    describe yaml(ELASTICSEARCH_CONF) do\n      its(['xpack.ssl.key']) { should_not be_nil }\n      its(['xpack.ssl.certificate']) { should_not be_nil }\n      its(['xpack.ssl.certificate_authorities']) { should_not be_nil }\n      its(['xpack.security.http.ssl.enabled']) { should eq true }\n      its(['xpack.security.transport.ssl.enabled']) { should eq true }\n    end\n\n    describe es_handle do\n      its('superusers') { should be_in DOCUMENTED_SUPER_ROLES}\n    end\n\n  rescue Exception => msg\n    describe \"Exception: #{msg}\" do\n      it { should be_nil}\n    end\n  end\nend\n",
          "source_location": {
            "line": 47,
            "ref": "../elasticsearch-inspec/controls/tls+role/V-26679.rb"
          },
          "results": [
            {
              "status": "passed",
              "code_desc": "SSL Settings for Node: package-centos-72 http_ssl.enabled should eq \"true\"",
              "run_time": 0.000125,
              "start_time": "2018-02-11 14:26:49 -0500"
            },
            {
              "status": "passed",
              "code_desc": "SSL Settings for Node: package-centos-72 transport_ssl.enabled should eq \"true\"",
              "run_time": 0.000094,
              "start_time": "2018-02-11 14:26:49 -0500"
            },
            {
              "status": "passed",
              "code_desc": "YAML /etc/elasticsearch/elasticsearch.yml [\"xpack.ssl.key\"] should not be nil",
              "run_time": 0.000083,
              "start_time": "2018-02-11 14:26:49 -0500"
            },
            {
              "status": "passed",
              "code_desc": "YAML /etc/elasticsearch/elasticsearch.yml [\"xpack.ssl.certificate\"] should not be nil",
              "run_time": 0.000063,
              "start_time": "2018-02-11 14:26:49 -0500"
            },
            {
              "status": "passed",
              "code_desc": "YAML /etc/elasticsearch/elasticsearch.yml [\"xpack.ssl.certificate_authorities\"] should not be nil",
              "run_time": 0.000067,
              "start_time": "2018-02-11 14:26:49 -0500"
            },
            {
              "status": "passed",
              "code_desc": "YAML /etc/elasticsearch/elasticsearch.yml [\"xpack.security.http.ssl.enabled\"] should eq true",
              "run_time": 0.000076,
              "start_time": "2018-02-11 14:26:49 -0500"
            },
            {
              "status": "passed",
              "code_desc": "YAML /etc/elasticsearch/elasticsearch.yml [\"xpack.security.transport.ssl.enabled\"] should eq true",
              "run_time": 0.00007,
              "start_time": "2018-02-11 14:26:49 -0500"
            },
            {
              "status": "passed",
              "code_desc": "Elasticsearch Cluster https://0.0.0.0:9200 superusers should be in \"superuser\"",
              "run_time": 1.28433,
              "start_time": "2018-02-11 14:26:49 -0500"
            }
          ]
        },
        {
          "id": "V-26734",
          "title": "The application must employ automated mechanisms enabling authorized\nusers to make information sharing decisions based on access authorizations of\nsharing partners and access restrictions on information to be shared.",
          "desc": "Plan for the capability to implement Discretionary Access Control\n(DAC) with includes or excludes access to the single user. Utilize X-Pack\nSecurity's Field and Document Level Security features to restrict access based\non information within the document.",
          "impact": 0.5,
          "refs": [],
          "tags": {
            "nist": [
              "AC-21 (1)",
              "Rev_4"
            ],
            "severity": "medium",
            "rid": "SV-33982r1_rule",
            "gtitle": "SRG-APP-000032",
            "cci": "CCI-000099",
            "check": "The JSON data models used by a system must maintain\ndenormalized or linked security labels and markings for information such that\nthe information can be used for automated policy actions by applications and\nElasticsearch security infrastructure. Data in transit is protected via TLS.\nUtilize X-Pack Security's Field and Document Level Security features to\nrestrict access based on information within the document.\n\nAs the elasticsearch administrator, run the following CURL command:\n\n$ curl -XGET  -H 'Content-Type: application/json' -u <TEST_USER> -p\n<TEST_CREDENTIALS> https://<elasticsearch>:9200/_xpack/security/role\n\nReview the role permissions, if any role is incorrect or provides access to\ncluster configuration outside of administrative roles, this is a finding.",
            "fix": "As a data owner, build a data model that is denormalized or\nlinked security labels and markings for information such that the information\ncan be used for automated policy actions by applications and Elasticsearch\nsecurity infrastructure.\n\nSee the official documentation for the complete  guide on authorization\nconfiguration:\nhttps://www.elastic.co/guide/en/x-pack/current/authorization.html"
          },
          "code": "control \"V-26734\" do\n  title \"The application must employ automated mechanisms enabling authorized\nusers to make information sharing decisions based on access authorizations of\nsharing partners and access restrictions on information to be shared.\"\n  desc  \"Plan for the capability to implement Discretionary Access Control\n(DAC) with includes or excludes access to the single user. Utilize X-Pack\nSecurity's Field and Document Level Security features to restrict access based\non information within the document.\"\n  impact 0.5\n  tag \"nist\": [\"AC-21 (1)\", \"Rev_4\"]\n  tag \"severity\": \"medium\"\n  tag \"rid\": \"SV-33982r1_rule\"\n  tag \"gtitle\": \"SRG-APP-000032\"\n  tag \"cci\": \"CCI-000099\"\n  tag \"check\": \"The JSON data models used by a system must maintain\ndenormalized or linked security labels and markings for information such that\nthe information can be used for automated policy actions by applications and\nElasticsearch security infrastructure. Data in transit is protected via TLS.\nUtilize X-Pack Security's Field and Document Level Security features to\nrestrict access based on information within the document.\n\nAs the elasticsearch administrator, run the following CURL command:\n\n$ curl -XGET  -H 'Content-Type: application/json' -u <TEST_USER> -p\n<TEST_CREDENTIALS> https://<elasticsearch>:9200/_xpack/security/role\n\nReview the role permissions, if any role is incorrect or provides access to\ncluster configuration outside of administrative roles, this is a finding.\"\n  tag \"fix\": \"As a data owner, build a data model that is denormalized or\nlinked security labels and markings for information such that the information\ncan be used for automated policy actions by applications and Elasticsearch\nsecurity infrastructure.\n\nSee the official documentation for the complete  guide on authorization\nconfiguration:\nhttps://www.elastic.co/guide/en/x-pack/current/authorization.html\"\n\n  begin\n    es_handle = es_helper(url:\"https://#{ELASTIC_IP}:#{ELASTIC_PORT}\",\n                    username: ES_ADMIN,\n                    password: ES_PASS,\n                    ssl_verify: SSL_VERIFY )\n\n    describe \"No nodes found\" do\n      subject { es_handle.nodes.nil? }\n      it { should_not be_truthy }\n    end if es_handle.nodes.nil?\n\n    es_handle.nodes.each do |node|\n      describe \"SSL Settings for Node: #{node.name}\" do\n        subject { node }\n        its(\"http_ssl.enabled\") { should eq 'true' }\n        its(\"transport_ssl.enabled\") { should eq 'true' }\n      end\n    end unless es_handle.nodes.nil?\n\n    describe yaml(ELASTICSEARCH_CONF) do\n      its(['xpack.ssl.key']) { should_not be_nil }\n      its(['xpack.ssl.certificate']) { should_not be_nil }\n      its(['xpack.ssl.certificate_authorities']) { should_not be_nil }\n      its(['xpack.security.http.ssl.enabled']) { should eq true }\n      its(['xpack.security.transport.ssl.enabled']) { should eq true }\n    end\n\n    describe es_handle do\n      its('superusers') { should be_in DOCUMENTED_SUPER_ROLES}\n    end\n\n  rescue Exception => msg\n    describe \"Exception: #{msg}\" do\n      it { should be_nil}\n    end\n  end\nend\n",
          "source_location": {
            "line": 47,
            "ref": "../elasticsearch-inspec/controls/tls+role/V-26734.rb"
          },
          "results": [
            {
              "status": "passed",
              "code_desc": "SSL Settings for Node: package-centos-72 http_ssl.enabled should eq \"true\"",
              "run_time": 0.000109,
              "start_time": "2018-02-11 14:26:50 -0500"
            },
            {
              "status": "passed",
              "code_desc": "SSL Settings for Node: package-centos-72 transport_ssl.enabled should eq \"true\"",
              "run_time": 0.000068,
              "start_time": "2018-02-11 14:26:50 -0500"
            },
            {
              "status": "passed",
              "code_desc": "YAML /etc/elasticsearch/elasticsearch.yml [\"xpack.ssl.key\"] should not be nil",
              "run_time": 0.00007,
              "start_time": "2018-02-11 14:26:50 -0500"
            },
            {
              "status": "passed",
              "code_desc": "YAML /etc/elasticsearch/elasticsearch.yml [\"xpack.ssl.certificate\"] should not be nil",
              "run_time": 0.000055,
              "start_time": "2018-02-11 14:26:50 -0500"
            },
            {
              "status": "passed",
              "code_desc": "YAML /etc/elasticsearch/elasticsearch.yml [\"xpack.ssl.certificate_authorities\"] should not be nil",
              "run_time": 0.000053,
              "start_time": "2018-02-11 14:26:50 -0500"
            },
            {
              "status": "passed",
              "code_desc": "YAML /etc/elasticsearch/elasticsearch.yml [\"xpack.security.http.ssl.enabled\"] should eq true",
              "run_time": 0.000092,
              "start_time": "2018-02-11 14:26:50 -0500"
            },
            {
              "status": "passed",
              "code_desc": "YAML /etc/elasticsearch/elasticsearch.yml [\"xpack.security.transport.ssl.enabled\"] should eq true",
              "run_time": 0.000058,
              "start_time": "2018-02-11 14:26:50 -0500"
            },
            {
              "status": "passed",
              "code_desc": "Elasticsearch Cluster https://0.0.0.0:9200 superusers should be in \"superuser\"",
              "run_time": 1.272655,
              "start_time": "2018-02-11 14:26:50 -0500"
            }
          ]
        },
        {
          "id": "V-26674",
          "title": "The application must support and maintain the binding of\norganizational defined security attributes to information in process.",
          "desc": "The application controlled data model for security labels and markings\nshould be human readable and present in all stored and transferred data models.",
          "impact": 0.5,
          "refs": [],
          "tags": {
            "nist": [
              "AC-16",
              "Rev_3"
            ],
            "severity": "medium",
            "rid": "SV-33821r1_rule",
            "gtitle": "SRG-APP-000007",
            "cci": "CCI-001400",
            "check": "The JSON data models used by a system must maintain\ndenormalized or linked security labels and markings for information such that\nthe information can be used for automated policy actions by applications and\nElasticsearch security infrastructure. Data in transit is protected via TLS.\nUtilize X-Pack Security's Field and Document Level Security features to\nrestrict access based on information within the document.\n\nAs the elasticsearch administrator, run the following CURL command:\n\n$ curl -XGET  -H 'Content-Type: application/json' -u  -p\n https://:9200/_xpack/security/role\n\nReview the role permissions, if any role is incorrect or provides access to\ncluster configuration outside of administrative roles, this is a finding.",
            "fix": "As a data owner, build a data model that is denormalized or\nlinked security labels and markings for information such that the information\ncan be used for automated policy actions by applications and Elasticsearch\nsecurity infrastructure."
          },
          "code": "control \"V-26674\" do\n  title \"The application must support and maintain the binding of\norganizational defined security attributes to information in process.\"\n  desc  \"The application controlled data model for security labels and markings\nshould be human readable and present in all stored and transferred data models.\"\n  impact 0.5\n  tag \"nist\": [\"AC-16\", \"Rev_3\"]\n  tag \"severity\": \"medium\"\n  tag \"rid\": \"SV-33821r1_rule\"\n  tag \"gtitle\": \"SRG-APP-000007\"\n  tag \"cci\": \"CCI-001400\"\n  tag \"check\": \"The JSON data models used by a system must maintain\ndenormalized or linked security labels and markings for information such that\nthe information can be used for automated policy actions by applications and\nElasticsearch security infrastructure. Data in transit is protected via TLS.\nUtilize X-Pack Security's Field and Document Level Security features to\nrestrict access based on information within the document.\n\nAs the elasticsearch administrator, run the following CURL command:\n\n$ curl -XGET  -H 'Content-Type: application/json' -u  -p\n https://:9200/_xpack/security/role\n\nReview the role permissions, if any role is incorrect or provides access to\ncluster configuration outside of administrative roles, this is a finding.\"\n  tag \"fix\": \"As a data owner, build a data model that is denormalized or\nlinked security labels and markings for information such that the information\ncan be used for automated policy actions by applications and Elasticsearch\nsecurity infrastructure.\"\n\n  begin\n    es_handle = es_helper(url:\"https://#{ELASTIC_IP}:#{ELASTIC_PORT}\",\n                    username: ES_ADMIN,\n                    password: ES_PASS,\n                    ssl_verify: SSL_VERIFY )\n\n    describe \"No nodes found\" do\n      subject { es_handle.nodes.nil? }\n      it { should_not be_truthy }\n    end if es_handle.nodes.nil?\n\n    es_handle.nodes.each do |node|\n      describe \"SSL Settings for Node: #{node.name}\" do\n        subject { node }\n        its(\"http_ssl.enabled\") { should eq 'true' }\n        its(\"transport_ssl.enabled\") { should eq 'true' }\n      end\n    end unless es_handle.nodes.nil?\n\n    describe yaml(ELASTICSEARCH_CONF) do\n      its(['xpack.ssl.key']) { should_not be_nil }\n      its(['xpack.ssl.certificate']) { should_not be_nil }\n      its(['xpack.ssl.certificate_authorities']) { should_not be_nil }\n      its(['xpack.security.http.ssl.enabled']) { should eq true }\n      its(['xpack.security.transport.ssl.enabled']) { should eq true }\n    end\n\n\n    describe es_handle do\n      its('superusers') { should be_in DOCUMENTED_SUPER_ROLES}\n    end\n\n  rescue Exception => msg\n    describe \"Exception: #{msg}\" do\n      it { should be_nil}\n    end\n  end\nend\n",
          "source_location": {
            "line": 46,
            "ref": "../elasticsearch-inspec/controls/tls+role/V-26674.rb"
          },
          "results": [
            {
              "status": "passed",
              "code_desc": "SSL Settings for Node: package-centos-72 http_ssl.enabled should eq \"true\"",
              "run_time": 0.000139,
              "start_time": "2018-02-11 14:26:51 -0500"
            },
            {
              "status": "passed",
              "code_desc": "SSL Settings for Node: package-centos-72 transport_ssl.enabled should eq \"true\"",
              "run_time": 0.00007,
              "start_time": "2018-02-11 14:26:51 -0500"
            },
            {
              "status": "passed",
              "code_desc": "YAML /etc/elasticsearch/elasticsearch.yml [\"xpack.ssl.key\"] should not be nil",
              "run_time": 0.000098,
              "start_time": "2018-02-11 14:26:51 -0500"
            },
            {
              "status": "passed",
              "code_desc": "YAML /etc/elasticsearch/elasticsearch.yml [\"xpack.ssl.certificate\"] should not be nil",
              "run_time": 0.000058,
              "start_time": "2018-02-11 14:26:51 -0500"
            },
            {
              "status": "passed",
              "code_desc": "YAML /etc/elasticsearch/elasticsearch.yml [\"xpack.ssl.certificate_authorities\"] should not be nil",
              "run_time": 0.000088,
              "start_time": "2018-02-11 14:26:51 -0500"
            },
            {
              "status": "passed",
              "code_desc": "YAML /etc/elasticsearch/elasticsearch.yml [\"xpack.security.http.ssl.enabled\"] should eq true",
              "run_time": 0.000063,
              "start_time": "2018-02-11 14:26:51 -0500"
            },
            {
              "status": "passed",
              "code_desc": "YAML /etc/elasticsearch/elasticsearch.yml [\"xpack.security.transport.ssl.enabled\"] should eq true",
              "run_time": 0.000061,
              "start_time": "2018-02-11 14:26:51 -0500"
            },
            {
              "status": "passed",
              "code_desc": "Elasticsearch Cluster https://0.0.0.0:9200 superusers should be in \"superuser\"",
              "run_time": 1.415274,
              "start_time": "2018-02-11 14:26:51 -0500"
            }
          ]
        },
        {
          "id": "V-27135",
          "title": "Applications must provide automated support for the management of\ndistributed security testing.",
          "desc": "Present the human readable, organizational defined security labels on\nall information transmitted from Elasticsearch either in the original records\nor information products derived from that information so that it can be\nappropriately handled by other systems or as a derived dataset within\nElasticsearch",
          "impact": 0.5,
          "refs": [],
          "tags": {
            "nist": [
              "SI-6 (2)",
              "Rev_4"
            ],
            "severity": "medium",
            "rid": "SV-34434r1_rule",
            "gtitle": "SRG-APP-000263",
            "cci": "CCI-001295",
            "check": "The JSON data models used by a system must maintain\ndenormalized or linked security labels and markings for information such that\nthe information can be used for safeguarding information. Data in transit is\nprotected via TLS. Utilize X-Pack Security's Field and Document Level Security\nfeatures to restrict access based on information within the document.\n\nAs the elasticsearch administrator, run the following CURL command:\n\n$ curl -XGET  -H 'Content-Type: application/json' -u <TEST_USER> -p\n<TEST_CREDENTIALS> https://<elasticsearch>:9200/_xpack/security/role\n\nReview the role permissions, if any role is incorrect or provides access to\ncluster configuration outside of administrative roles, this is a finding.",
            "fix": "As a data owner, build a data model that is denormalized or\nlinked security labels and markings for information such that the information\ncan be used for distributed security testing.\n\nSee the official documentation for the complete  guide on authorization\nconfiguration:\nhttps://www.elastic.co/guide/en/x-pack/current/authorization.html"
          },
          "code": "control \"V-27135\" do\n  title \"Applications must provide automated support for the management of\ndistributed security testing.\"\n  desc  \"Present the human readable, organizational defined security labels on\nall information transmitted from Elasticsearch either in the original records\nor information products derived from that information so that it can be\nappropriately handled by other systems or as a derived dataset within\nElasticsearch\"\n  impact 0.5\n  tag \"nist\": [\"SI-6 (2)\", \"Rev_4\"]\n  tag \"severity\": \"medium\"\n  tag \"rid\": \"SV-34434r1_rule\"\n  tag \"gtitle\": \"SRG-APP-000263\"\n  tag \"cci\": \"CCI-001295\"\n  tag \"check\": \"The JSON data models used by a system must maintain\ndenormalized or linked security labels and markings for information such that\nthe information can be used for safeguarding information. Data in transit is\nprotected via TLS. Utilize X-Pack Security's Field and Document Level Security\nfeatures to restrict access based on information within the document.\n\nAs the elasticsearch administrator, run the following CURL command:\n\n$ curl -XGET  -H 'Content-Type: application/json' -u <TEST_USER> -p\n<TEST_CREDENTIALS> https://<elasticsearch>:9200/_xpack/security/role\n\nReview the role permissions, if any role is incorrect or provides access to\ncluster configuration outside of administrative roles, this is a finding.\"\n  tag \"fix\": \"As a data owner, build a data model that is denormalized or\nlinked security labels and markings for information such that the information\ncan be used for distributed security testing.\n\nSee the official documentation for the complete  guide on authorization\nconfiguration:\nhttps://www.elastic.co/guide/en/x-pack/current/authorization.html\"\n\n  begin\n    es_handle = es_helper(url:\"https://#{ELASTIC_IP}:#{ELASTIC_PORT}\",\n                    username: ES_ADMIN,\n                    password: ES_PASS,\n                    ssl_verify: SSL_VERIFY )\n\n    describe \"No nodes found\" do\n      subject { es_handle.nodes.nil? }\n      it { should_not be_truthy }\n    end if es_handle.nodes.nil?\n\n    es_handle.nodes.each do |node|\n      describe \"SSL Settings for Node: #{node.name}\" do\n        subject { node }\n        its(\"http_ssl.enabled\") { should eq 'true' }\n        its(\"transport_ssl.enabled\") { should eq 'true' }\n      end\n    end unless es_handle.nodes.nil?\n\n    describe yaml(ELASTICSEARCH_CONF) do\n      its(['xpack.ssl.key']) { should_not be_nil }\n      its(['xpack.ssl.certificate']) { should_not be_nil }\n      its(['xpack.ssl.certificate_authorities']) { should_not be_nil }\n      its(['xpack.security.http.ssl.enabled']) { should eq true }\n      its(['xpack.security.transport.ssl.enabled']) { should eq true }\n    end\n\n    describe es_handle do\n      its('superusers') { should be_in DOCUMENTED_SUPER_ROLES}\n    end\n\n  rescue Exception => msg\n    describe \"Exception: #{msg}\" do\n      it { should be_nil}\n    end\n  end\nend\n",
          "source_location": {
            "line": 47,
            "ref": "../elasticsearch-inspec/controls/tls+role/V-27135.rb"
          },
          "results": [
            {
              "status": "passed",
              "code_desc": "SSL Settings for Node: package-centos-72 http_ssl.enabled should eq \"true\"",
              "run_time": 0.000108,
              "start_time": "2018-02-11 14:26:53 -0500"
            },
            {
              "status": "passed",
              "code_desc": "SSL Settings for Node: package-centos-72 transport_ssl.enabled should eq \"true\"",
              "run_time": 0.000069,
              "start_time": "2018-02-11 14:26:53 -0500"
            },
            {
              "status": "passed",
              "code_desc": "YAML /etc/elasticsearch/elasticsearch.yml [\"xpack.ssl.key\"] should not be nil",
              "run_time": 0.000094,
              "start_time": "2018-02-11 14:26:53 -0500"
            },
            {
              "status": "passed",
              "code_desc": "YAML /etc/elasticsearch/elasticsearch.yml [\"xpack.ssl.certificate\"] should not be nil",
              "run_time": 0.000056,
              "start_time": "2018-02-11 14:26:53 -0500"
            },
            {
              "status": "passed",
              "code_desc": "YAML /etc/elasticsearch/elasticsearch.yml [\"xpack.ssl.certificate_authorities\"] should not be nil",
              "run_time": 0.000054,
              "start_time": "2018-02-11 14:26:53 -0500"
            },
            {
              "status": "passed",
              "code_desc": "YAML /etc/elasticsearch/elasticsearch.yml [\"xpack.security.http.ssl.enabled\"] should eq true",
              "run_time": 0.000064,
              "start_time": "2018-02-11 14:26:53 -0500"
            },
            {
              "status": "passed",
              "code_desc": "YAML /etc/elasticsearch/elasticsearch.yml [\"xpack.security.transport.ssl.enabled\"] should eq true",
              "run_time": 0.00006,
              "start_time": "2018-02-11 14:26:53 -0500"
            },
            {
              "status": "passed",
              "code_desc": "Elasticsearch Cluster https://0.0.0.0:9200 superusers should be in \"superuser\"",
              "run_time": 1.47816,
              "start_time": "2018-02-11 14:26:53 -0500"
            }
          ]
        },
        {
          "id": "V-27034",
          "title": "Applications must prevent unauthorized and unintended information\ntransfer via shared system resources.",
          "desc": "Separate access to production Elasticsearch systems from developers\nboth at the host operating system, storage subsystems, networks, and\nElasticsearch software through Role Based Access Control as required by policy.\nAccess to the internal network of the Elasticsearch cluster should not allow\naccess to production data.",
          "impact": 0.5,
          "refs": [],
          "tags": {
            "nist": [
              "SC-4",
              "Rev_4"
            ],
            "severity": "medium",
            "rid": "SV-34328r1_rule",
            "gtitle": "SRG-APP-000243",
            "cci": "CCI-001090",
            "check": "The JSON data models used by a system must maintain\ndenormalized or linked security labels and markings for information such that\nthe security labels can be changed by administrative personnel. Data in transit\nis protected via TLS. Utilize X-Pack Security's Field and Document Level\nSecurity features to restrict access based on information within the document.\n\n\nAs the security administrator, run the following CURL command:\n\n$ curl -XGET  -H 'Content-Type: application/json' -u <TEST_USER> -p\n<TEST_CREDENTIALS> https://<elasticsearch>:9200/_xpack/security/role\n\nReview the role permissions, if any role is incorrect or does not provide\naccess to security labels of the underlying data model, this is a finding.",
            "fix": "As an administrative users, verify that you have access to\nsecurity labels within the data model.\n\nSee the official documentation for the complete  guide on authorization\nconfiguration:\nhttps://www.elastic.co/guide/en/x-pack/current/authorization.html"
          },
          "code": "control \"V-27034\" do\n  title \"Applications must prevent unauthorized and unintended information\ntransfer via shared system resources.\"\n  desc  \"Separate access to production Elasticsearch systems from developers\nboth at the host operating system, storage subsystems, networks, and\nElasticsearch software through Role Based Access Control as required by policy.\nAccess to the internal network of the Elasticsearch cluster should not allow\naccess to production data.\"\n  impact 0.5\n  tag \"nist\": [\"SC-4\", \"Rev_4\"]\n  tag \"severity\": \"medium\"\n  tag \"rid\": \"SV-34328r1_rule\"\n  tag \"gtitle\": \"SRG-APP-000243\"\n  tag \"cci\": \"CCI-001090\"\n  tag \"check\": \"The JSON data models used by a system must maintain\ndenormalized or linked security labels and markings for information such that\nthe security labels can be changed by administrative personnel. Data in transit\nis protected via TLS. Utilize X-Pack Security's Field and Document Level\nSecurity features to restrict access based on information within the document.\n\n\nAs the security administrator, run the following CURL command:\n\n$ curl -XGET  -H 'Content-Type: application/json' -u <TEST_USER> -p\n<TEST_CREDENTIALS> https://<elasticsearch>:9200/_xpack/security/role\n\nReview the role permissions, if any role is incorrect or does not provide\naccess to security labels of the underlying data model, this is a finding.\"\n  tag \"fix\": \"As an administrative users, verify that you have access to\nsecurity labels within the data model.\n\nSee the official documentation for the complete  guide on authorization\nconfiguration:\nhttps://www.elastic.co/guide/en/x-pack/current/authorization.html\"\n\n  begin\n    es_handle = es_helper(url:\"https://#{ELASTIC_IP}:#{ELASTIC_PORT}\",\n                    username: ES_ADMIN,\n                    password: ES_PASS,\n                    ssl_verify: SSL_VERIFY )\n\n    describe \"No nodes found\" do\n      subject { es_handle.nodes.nil? }\n      it { should_not be_truthy }\n    end if es_handle.nodes.nil?\n\n    es_handle.nodes.each do |node|\n      describe \"SSL Settings for Node: #{node.name}\" do\n        subject { node }\n        its(\"http_ssl.enabled\") { should eq 'true' }\n        its(\"transport_ssl.enabled\") { should eq 'true' }\n      end\n    end unless es_handle.nodes.nil?\n\n    describe yaml(ELASTICSEARCH_CONF) do\n      its(['xpack.ssl.key']) { should_not be_nil }\n      its(['xpack.ssl.certificate']) { should_not be_nil }\n      its(['xpack.ssl.certificate_authorities']) { should_not be_nil }\n      its(['xpack.security.http.ssl.enabled']) { should eq true }\n      its(['xpack.security.transport.ssl.enabled']) { should eq true }\n    end\n\n    describe es_handle do\n      its('superusers') { should be_in DOCUMENTED_SUPER_ROLES}\n    end\n\n  rescue Exception => msg\n    describe \"Exception: #{msg}\" do\n      it { should be_nil}\n    end\n  end\nend\n",
          "source_location": {
            "line": 47,
            "ref": "../elasticsearch-inspec/controls/tls+role/V-27034.rb"
          },
          "results": [
            {
              "status": "passed",
              "code_desc": "SSL Settings for Node: package-centos-72 http_ssl.enabled should eq \"true\"",
              "run_time": 0.000108,
              "start_time": "2018-02-11 14:26:54 -0500"
            },
            {
              "status": "passed",
              "code_desc": "SSL Settings for Node: package-centos-72 transport_ssl.enabled should eq \"true\"",
              "run_time": 0.000069,
              "start_time": "2018-02-11 14:26:54 -0500"
            },
            {
              "status": "passed",
              "code_desc": "YAML /etc/elasticsearch/elasticsearch.yml [\"xpack.ssl.key\"] should not be nil",
              "run_time": 0.000092,
              "start_time": "2018-02-11 14:26:54 -0500"
            },
            {
              "status": "passed",
              "code_desc": "YAML /etc/elasticsearch/elasticsearch.yml [\"xpack.ssl.certificate\"] should not be nil",
              "run_time": 0.000057,
              "start_time": "2018-02-11 14:26:54 -0500"
            },
            {
              "status": "passed",
              "code_desc": "YAML /etc/elasticsearch/elasticsearch.yml [\"xpack.ssl.certificate_authorities\"] should not be nil",
              "run_time": 0.000055,
              "start_time": "2018-02-11 14:26:54 -0500"
            },
            {
              "status": "passed",
              "code_desc": "YAML /etc/elasticsearch/elasticsearch.yml [\"xpack.security.http.ssl.enabled\"] should eq true",
              "run_time": 0.000082,
              "start_time": "2018-02-11 14:26:54 -0500"
            },
            {
              "status": "passed",
              "code_desc": "YAML /etc/elasticsearch/elasticsearch.yml [\"xpack.security.transport.ssl.enabled\"] should eq true",
              "run_time": 0.000059,
              "start_time": "2018-02-11 14:26:54 -0500"
            },
            {
              "status": "passed",
              "code_desc": "Elasticsearch Cluster https://0.0.0.0:9200 superusers should be in \"superuser\"",
              "run_time": 1.284994,
              "start_time": "2018-02-11 14:26:54 -0500"
            }
          ]
        },
        {
          "id": "V-27036",
          "title": "Applications must protect against or limit the effects of the\norganizational-defined or referenced types of Denial of Service (DoS) attacks.",
          "desc": "Utilize network safeguards to limit the ability of Elasticsearch to\nlaunch DOS attacks. Dynamic scripting is disabled by default, limiting the\nability of an Elasticsearch process to affect resources outside of the\nElasticsearch cluster. The snapshot and recovery function of elasticsearch,\nwhich can target a URL, should be granted only to the appropriate roles using\nRBAC privileges (cluster:admin/snapshot/*) and is required to be given a\nwhitelist of targets (repositories.url.allowed_urls).",
          "impact": 0.5,
          "refs": [],
          "tags": {
            "nist": [
              "SC-5",
              "Rev_3"
            ],
            "severity": "medium",
            "rid": "SV-34330r1_rule",
            "gtitle": "SRG-APP-000245",
            "cci": "CCI-001092",
            "check": "Utilize network safeguards to limit the ability of\nElasticsearch to launch DOS attacks. Painless, a sandboxed scripting is the\nonly script enabled by default, limiting the ability of an Elasticsearch\nprocess to affect resources outside of the Elasticsearch cluster.\n\nAs the application administrator (usually elasticsearch, check the\nscript.engine setting do not enable other languages by running the following:\n\n\n$ cat config/elasticsearch.yml | grep script.engine\n\nThis setting should not be present, return true for painless, or false for\njavascript, groovy, python, and java.\n\nAs the application administrator (usually elasticsearch, check the plugins\nfolder does not include other scripting languages by running the following:\n\n$ ls <ES_HOME>/plugins/lang-javascript\n$ ls <ES_HOME>/plugins/lang-python\n\nIf any of these return a response other than 'No such file or directory',\nthis is a finding.\n",
            "fix": "Limit the effects of DoS by setting up network safeguards.\n\nSee the official documentation for the safeguading of scripts:\nhttps://www.elastic.co/guide/en/elasticsearch/reference/current/modules-scripting-security.html\n\n\nAs the application administrator (usually elasticsearch, check the plugins\nfolder does not include other scripting languages by running the following:\n\n$ sudo bin/elasticsearch-plugin remove lang-javascript\n$ sudo bin/elasticsearch-plugin remove lang-python\n"
          },
          "code": "control \"V-27036\" do\n  title \"Applications must protect against or limit the effects of the\norganizational-defined or referenced types of Denial of Service (DoS) attacks.\"\n  desc  \"Utilize network safeguards to limit the ability of Elasticsearch to\nlaunch DOS attacks. Dynamic scripting is disabled by default, limiting the\nability of an Elasticsearch process to affect resources outside of the\nElasticsearch cluster. The snapshot and recovery function of elasticsearch,\nwhich can target a URL, should be granted only to the appropriate roles using\nRBAC privileges (cluster:admin/snapshot/*) and is required to be given a\nwhitelist of targets (repositories.url.allowed_urls).\"\n  impact 0.5\n  tag \"nist\": [\"SC-5\", \"Rev_3\"]\n  tag \"severity\": \"medium\"\n  tag \"rid\": \"SV-34330r1_rule\"\n  tag \"gtitle\": \"SRG-APP-000245\"\n  tag \"cci\": \"CCI-001092\"\n  tag \"check\": \"Utilize network safeguards to limit the ability of\nElasticsearch to launch DOS attacks. Painless, a sandboxed scripting is the\nonly script enabled by default, limiting the ability of an Elasticsearch\nprocess to affect resources outside of the Elasticsearch cluster.\n\nAs the application administrator (usually elasticsearch, check the\nscript.engine setting do not enable other languages by running the following:\n\n\n$ cat config/elasticsearch.yml | grep script.engine\n\nThis setting should not be present, return true for painless, or false for\njavascript, groovy, python, and java.\n\nAs the application administrator (usually elasticsearch, check the plugins\nfolder does not include other scripting languages by running the following:\n\n$ ls <ES_HOME>/plugins/lang-javascript\n$ ls <ES_HOME>/plugins/lang-python\n\nIf any of these return a response other than 'No such file or directory',\nthis is a finding.\n\"\n  tag \"fix\": \"Limit the effects of DoS by setting up network safeguards.\n\nSee the official documentation for the safeguading of scripts:\nhttps://www.elastic.co/guide/en/elasticsearch/reference/current/modules-scripting-security.html\n\n\nAs the application administrator (usually elasticsearch, check the plugins\nfolder does not include other scripting languages by running the following:\n\n$ sudo bin/elasticsearch-plugin remove lang-javascript\n$ sudo bin/elasticsearch-plugin remove lang-python\n\"\n\n  begin\n\n    es_handle = es_helper(url:\"https://#{ELASTIC_IP}:#{ELASTIC_PORT}\",\n                    username: ES_ADMIN,\n                    password: ES_PASS,\n                    ssl_verify: SSL_VERIFY )\n\n    describe \"No nodes found\" do\n      subject { es_handle.nodes.nil? }\n      it { should_not be_truthy }\n    end if es_handle.nodes.nil?\n\n    es_handle.nodes.each do |node|\n      describe \"Script Engine Settings for Node: #{node.name}\" do\n        subject { node.script_setting }\n        its('inline') { should eq 'false' }\n        its('file') { should eq 'false' }\n        its('stored') { should eq 'false' }\n      end\n    end unless es_handle.nodes.nil?\n\n    describe \"Script Plugins\" do\n      subject { es_handle.modules.flatten.map(&:name) }\n      it{ should_not include('lang-javascript') }\n      it{ should_not include('lang-python') }\n    end\n\n  rescue Exception => msg\n    describe \"Exception: #{msg}\" do\n      it { should be_nil}\n    end\n  end\nend\n",
          "source_location": {
            "line": 35,
            "ref": "../elasticsearch-inspec/controls/scripts/V-27036.rb"
          },
          "results": [
            {
              "status": "passed",
              "code_desc": "Script Engine Settings for Node: package-centos-72 inline should eq \"false\"",
              "run_time": 0.000133,
              "start_time": "2018-02-11 14:26:55 -0500"
            },
            {
              "status": "passed",
              "code_desc": "Script Engine Settings for Node: package-centos-72 file should eq \"false\"",
              "run_time": 0.00007,
              "start_time": "2018-02-11 14:26:55 -0500"
            },
            {
              "status": "passed",
              "code_desc": "Script Engine Settings for Node: package-centos-72 stored should eq \"false\"",
              "run_time": 0.000067,
              "start_time": "2018-02-11 14:26:55 -0500"
            },
            {
              "status": "passed",
              "code_desc": "Script Plugins should not include \"lang-javascript\"",
              "run_time": 0.000137,
              "start_time": "2018-02-11 14:26:55 -0500"
            },
            {
              "status": "passed",
              "code_desc": "Script Plugins should not include \"lang-python\"",
              "run_time": 0.000092,
              "start_time": "2018-02-11 14:26:55 -0500"
            }
          ]
        },
        {
          "id": "V-27039",
          "title": "Applications must restrict the ability of users to launch Denial of\nService (DoS) attacks against other information systems or networks.",
          "desc": "Utilize network safeguards to limit the ability of Elasticsearch to\nlaunch DOS attacks. Dynamic scripting is disabled by default, limiting the\nability of an Elasticsearch process to affect resources outside of the\nElasticsearch cluster. The snapshot and recovery function of elasticsearch,\nwhich can target a URL, should be granted only to the appropriate roles using\nRBAC privileges (cluster:admin/snapshot/*) and is required to be given a\nwhitelist of targets (repositories.url.allowed_urls).",
          "impact": 0.5,
          "refs": [],
          "tags": {
            "nist": [
              "SC-5 (1)",
              "Rev_4"
            ],
            "severity": "medium",
            "rid": "SV-34333r1_rule",
            "gtitle": "SRG-APP-000246",
            "cci": "CCI-001094",
            "check": "Utilize network safeguards to limit the ability of\nElasticsearch to launch DOS attacks. Painless, a sandboxed scripting is the\nonly script enabled by default, limiting the ability of an Elasticsearch\nprocess to affect resources outside of the Elasticsearch cluster.\n\nAs the application administrator (usually elasticsearch, check the\nscript.engine setting do not enable other languages by running the following:\n\n\n$ cat config/elasticsearch.yml | grep script.engine\n\nThis setting should not be present, return true for painless, or false for\njavascript, groovy, python, and java.\n\nAs the application administrator (usually elasticsearch, check the plugins\nfolder does not include other scripting languages by running the following:\n\n$ ls <ES_HOME>/plugins/lang-javascript\n$ ls <ES_HOME>/plugins/lang-python\n\nIf any of these return a response other than 'No such file or directory',\nthis is a finding.\n",
            "fix": "Limit the effects of DoS by setting up network safeguards.\n\nSee the official documentation for the safeguading of scripts:\nhttps://www.elastic.co/guide/en/elasticsearch/reference/current/modules-scripting-security.html\n\n\nAs the application administrator (usually elasticsearch, check the plugins\nfolder does not include other scripting languages by running the following:\n\n$ sudo bin/elasticsearch-plugin remove lang-javascript\n$ sudo bin/elasticsearch-plugin remove lang-python\n"
          },
          "code": "control \"V-27039\" do\n  title \"Applications must restrict the ability of users to launch Denial of\nService (DoS) attacks against other information systems or networks.\"\n  desc  \"Utilize network safeguards to limit the ability of Elasticsearch to\nlaunch DOS attacks. Dynamic scripting is disabled by default, limiting the\nability of an Elasticsearch process to affect resources outside of the\nElasticsearch cluster. The snapshot and recovery function of elasticsearch,\nwhich can target a URL, should be granted only to the appropriate roles using\nRBAC privileges (cluster:admin/snapshot/*) and is required to be given a\nwhitelist of targets (repositories.url.allowed_urls).\"\n  impact 0.5\n  tag \"nist\": [\"SC-5 (1)\", \"Rev_4\"]\n  tag \"severity\": \"medium\"\n  tag \"rid\": \"SV-34333r1_rule\"\n  tag \"gtitle\": \"SRG-APP-000246\"\n  tag \"cci\": \"CCI-001094\"\n  tag \"check\": \"Utilize network safeguards to limit the ability of\nElasticsearch to launch DOS attacks. Painless, a sandboxed scripting is the\nonly script enabled by default, limiting the ability of an Elasticsearch\nprocess to affect resources outside of the Elasticsearch cluster.\n\nAs the application administrator (usually elasticsearch, check the\nscript.engine setting do not enable other languages by running the following:\n\n\n$ cat config/elasticsearch.yml | grep script.engine\n\nThis setting should not be present, return true for painless, or false for\njavascript, groovy, python, and java.\n\nAs the application administrator (usually elasticsearch, check the plugins\nfolder does not include other scripting languages by running the following:\n\n$ ls <ES_HOME>/plugins/lang-javascript\n$ ls <ES_HOME>/plugins/lang-python\n\nIf any of these return a response other than 'No such file or directory',\nthis is a finding.\n\"\n  tag \"fix\": \"Limit the effects of DoS by setting up network safeguards.\n\nSee the official documentation for the safeguading of scripts:\nhttps://www.elastic.co/guide/en/elasticsearch/reference/current/modules-scripting-security.html\n\n\nAs the application administrator (usually elasticsearch, check the plugins\nfolder does not include other scripting languages by running the following:\n\n$ sudo bin/elasticsearch-plugin remove lang-javascript\n$ sudo bin/elasticsearch-plugin remove lang-python\n\"\n\n  begin\n\n    es_handle = es_helper(url:\"https://#{ELASTIC_IP}:#{ELASTIC_PORT}\",\n                    username: ES_ADMIN,\n                    password: ES_PASS,\n                    ssl_verify: SSL_VERIFY )\n\n    describe \"No nodes found\" do\n      subject { es_handle.nodes.nil? }\n      it { should_not be_truthy }\n    end if es_handle.nodes.nil?\n\n    es_handle.nodes.each do |node|\n      describe \"Script Engine Settings for Node: #{node.name}\" do\n        subject { node.script_setting }\n        its('inline') { should eq 'false' }\n        its('file') { should eq 'false' }\n        its('stored') { should eq 'false' }\n      end\n    end unless es_handle.nodes.nil?\n\n    describe \"Script Plugins\" do\n      subject { es_handle.modules.flatten.map(&:name) }\n      it{ should_not include('lang-javascript') }\n      it{ should_not include('lang-python') }\n    end\n\n  rescue Exception => msg\n    describe \"Exception: #{msg}\" do\n      it { should be_nil}\n    end\n  end\nend\n",
          "source_location": {
            "line": 35,
            "ref": "../elasticsearch-inspec/controls/scripts/V-27039.rb"
          },
          "results": [
            {
              "status": "passed",
              "code_desc": "Script Engine Settings for Node: package-centos-72 inline should eq \"false\"",
              "run_time": 0.000071,
              "start_time": "2018-02-11 14:26:55 -0500"
            },
            {
              "status": "passed",
              "code_desc": "Script Engine Settings for Node: package-centos-72 file should eq \"false\"",
              "run_time": 0.000068,
              "start_time": "2018-02-11 14:26:55 -0500"
            },
            {
              "status": "passed",
              "code_desc": "Script Engine Settings for Node: package-centos-72 stored should eq \"false\"",
              "run_time": 0.000078,
              "start_time": "2018-02-11 14:26:55 -0500"
            },
            {
              "status": "passed",
              "code_desc": "Script Plugins should not include \"lang-javascript\"",
              "run_time": 0.000115,
              "start_time": "2018-02-11 14:26:55 -0500"
            },
            {
              "status": "passed",
              "code_desc": "Script Plugins should not include \"lang-python\"",
              "run_time": 0.000111,
              "start_time": "2018-02-11 14:26:55 -0500"
            }
          ]
        },
        {
          "id": "V-27040",
          "title": "Applications must manage excess capacity, bandwidth, or other\nredundancy to limit the effects of information flooding types of Denial of\nService (DoS) attacks.",
          "desc": "Utilize network safeguards to limit the ability of Elasticsearch to\nlaunch DOS attacks. Dynamic scripting is disabled by default, limiting the\nability of an Elasticsearch process to affect resources outside of the\nElasticsearch cluster. The snapshot and recovery function of elasticsearch,\nwhich can target a URL, should be granted only to the appropriate roles using\nRBAC privileges (cluster:admin/snapshot/*) and is required to be given a\nwhitelist of targets (repositories.url.allowed_urls).",
          "impact": 0.5,
          "refs": [],
          "tags": {
            "nist": [
              "SC-5 (2)",
              "Rev_4"
            ],
            "severity": "medium",
            "rid": "SV-34334r1_rule",
            "gtitle": "SRG-APP-000247",
            "cci": "CCI-001095",
            "check": "Utilize network safeguards to limit the ability of\nElasticsearch to launch DOS attacks. Painless, a sandboxed scripting is the\nonly script enabled by default, limiting the ability of an Elasticsearch\nprocess to affect resources outside of the Elasticsearch cluster.\n\nAs the application administrator (usually elasticsearch, check the\nscript.engine setting do not enable other languages by running the following:\n\n\n$ cat config/elasticsearch.yml | grep script.engine\n\nThis setting should not be present, return true for painless, or false for\njavascript, groovy, python, and java.\n\nAs the application administrator (usually elasticsearch, check the plugins\nfolder does not include other scripting languages by running the following:\n\n$ ls <ES_HOME>/plugins/lang-javascript\n$ ls <ES_HOME>/plugins/lang-python\n\nIf any of these return a response other than 'No such file or directory',\nthis is a finding.\n",
            "fix": "Limit the effects of DoS by setting up network safeguards.\n\nSee the official documentation for the safeguading of scripts:\nhttps://www.elastic.co/guide/en/elasticsearch/reference/current/modules-scripting-security.html\n\n\nAs the application administrator (usually elasticsearch, check the plugins\nfolder does not include other scripting languages by running the following:\n\n$ sudo bin/elasticsearch-plugin remove lang-javascript\n$ sudo bin/elasticsearch-plugin remove lang-python\n"
          },
          "code": "control \"V-27040\" do\n  title \"Applications must manage excess capacity, bandwidth, or other\nredundancy to limit the effects of information flooding types of Denial of\nService (DoS) attacks.\"\n  desc  \"Utilize network safeguards to limit the ability of Elasticsearch to\nlaunch DOS attacks. Dynamic scripting is disabled by default, limiting the\nability of an Elasticsearch process to affect resources outside of the\nElasticsearch cluster. The snapshot and recovery function of elasticsearch,\nwhich can target a URL, should be granted only to the appropriate roles using\nRBAC privileges (cluster:admin/snapshot/*) and is required to be given a\nwhitelist of targets (repositories.url.allowed_urls).\"\n  impact 0.5\n  tag \"nist\": [\"SC-5 (2)\", \"Rev_4\"]\n  tag \"severity\": \"medium\"\n  tag \"rid\": \"SV-34334r1_rule\"\n  tag \"gtitle\": \"SRG-APP-000247\"\n  tag \"cci\": \"CCI-001095\"\n  tag \"check\": \"Utilize network safeguards to limit the ability of\nElasticsearch to launch DOS attacks. Painless, a sandboxed scripting is the\nonly script enabled by default, limiting the ability of an Elasticsearch\nprocess to affect resources outside of the Elasticsearch cluster.\n\nAs the application administrator (usually elasticsearch, check the\nscript.engine setting do not enable other languages by running the following:\n\n\n$ cat config/elasticsearch.yml | grep script.engine\n\nThis setting should not be present, return true for painless, or false for\njavascript, groovy, python, and java.\n\nAs the application administrator (usually elasticsearch, check the plugins\nfolder does not include other scripting languages by running the following:\n\n$ ls <ES_HOME>/plugins/lang-javascript\n$ ls <ES_HOME>/plugins/lang-python\n\nIf any of these return a response other than 'No such file or directory',\nthis is a finding.\n\"\n  tag \"fix\": \"Limit the effects of DoS by setting up network safeguards.\n\nSee the official documentation for the safeguading of scripts:\nhttps://www.elastic.co/guide/en/elasticsearch/reference/current/modules-scripting-security.html\n\n\nAs the application administrator (usually elasticsearch, check the plugins\nfolder does not include other scripting languages by running the following:\n\n$ sudo bin/elasticsearch-plugin remove lang-javascript\n$ sudo bin/elasticsearch-plugin remove lang-python\n\"\n\n  begin\n\n    es_handle = es_helper(url:\"https://#{ELASTIC_IP}:#{ELASTIC_PORT}\",\n                    username: ES_ADMIN,\n                    password: ES_PASS,\n                    ssl_verify: SSL_VERIFY )\n\n    describe \"No nodes found\" do\n      subject { es_handle.nodes.nil? }\n      it { should_not be_truthy }\n    end if es_handle.nodes.nil?\n\n    es_handle.nodes.each do |node|\n      describe \"Script Engine Settings for Node: #{node.name}\" do\n        subject { node.script_setting }\n        its('inline') { should eq 'false' }\n        its('file') { should eq 'false' }\n        its('stored') { should eq 'false' }\n      end\n    end unless es_handle.nodes.nil?\n\n    describe \"Script Plugins\" do\n      subject { es_handle.modules.flatten.map(&:name) }\n      it{ should_not include('lang-javascript') }\n      it{ should_not include('lang-python') }\n    end\n\n  rescue Exception => msg\n    describe \"Exception: #{msg}\" do\n      it { should be_nil}\n    end\n  end\nend\n",
          "source_location": {
            "line": 35,
            "ref": "../elasticsearch-inspec/controls/scripts/V-27040.rb"
          },
          "results": [
            {
              "status": "passed",
              "code_desc": "Script Engine Settings for Node: package-centos-72 inline should eq \"false\"",
              "run_time": 0.000069,
              "start_time": "2018-02-11 14:26:55 -0500"
            },
            {
              "status": "passed",
              "code_desc": "Script Engine Settings for Node: package-centos-72 file should eq \"false\"",
              "run_time": 0.000077,
              "start_time": "2018-02-11 14:26:55 -0500"
            },
            {
              "status": "passed",
              "code_desc": "Script Engine Settings for Node: package-centos-72 stored should eq \"false\"",
              "run_time": 0.00006,
              "start_time": "2018-02-11 14:26:55 -0500"
            },
            {
              "status": "passed",
              "code_desc": "Script Plugins should not include \"lang-javascript\"",
              "run_time": 0.000113,
              "start_time": "2018-02-11 14:26:55 -0500"
            },
            {
              "status": "passed",
              "code_desc": "Script Plugins should not include \"lang-python\"",
              "run_time": 0.000099,
              "start_time": "2018-02-11 14:26:55 -0500"
            }
          ]
        },
        {
          "id": "V-26974",
          "title": "The application must be capable of taking organizational-defined\nactions upon audit failure (e.g., overwrite oldest audit records, stop\ngenerating audit records, cease processing, notify of audit failure).",
          "desc": "Monitor the health and resources (such as remaining storage) of\nsystems running Elasticsearch software and notify operators when safety\nthresholds have been exceeded. Automated system notification via email or http\nendpoint can be built as an action in Watcher.",
          "impact": 0.5,
          "refs": [],
          "tags": {
            "nist": [
              "AU-5 b",
              "Rev_4"
            ],
            "severity": "medium",
            "rid": "SV-34262r1_rule",
            "gtitle": "SRG-APP-000109",
            "cci": "CCI-000140",
            "check": "Verify the audit records are stored on a separate disk than\noperating system.\n\nCheck the system configuration to determine the partition the audit records are\nbeing written to with the following command:\n\n# grep log_file /etc/audit/auditd.conf log_file =\n/var/log/elasticsearch/audit/audit.log\n\nCheck the size of the partition that audit records are written to (with the\nexample being \\\"/var/log/elasticsearch/audit/\\\"):\n\n# df -h /var/log/elasticsearch/audit/ 0.9G /var/log/elasticsearch/audit\n\nIf the audit records are not being written to a partition specifically created\nfor audit records (in this example \\\"/var/log/elasticsearch/audit\\\" is a\nseparate partition), this is a finding.",
            "fix": "Configure the audit storage to a separate partition for audit\nstorage.\n\nCheck the system configuration to determine the partition the audit records are\nbeing written to:\n\n# grep log_file /etc/audit/auditd.conf\n\nDetermine the size of the partition that audit records are written to (with the\nexample being \\\"/var/log/elasticsearch/audit/\\\"):\n\n# df -h /var/log/elasticsearch/audit/    "
          },
          "code": "control \"V-26974\" do\n  title \"The application must be capable of taking organizational-defined\nactions upon audit failure (e.g., overwrite oldest audit records, stop\ngenerating audit records, cease processing, notify of audit failure).\"\n  desc  \"Monitor the health and resources (such as remaining storage) of\nsystems running Elasticsearch software and notify operators when safety\nthresholds have been exceeded. Automated system notification via email or http\nendpoint can be built as an action in Watcher.\"\n  impact 0.5\n  tag \"nist\": [\"AU-5 b\", \"Rev_4\"]\n  tag \"severity\": \"medium\"\n  tag \"rid\": \"SV-34262r1_rule\"\n  tag \"gtitle\": \"SRG-APP-000109\"\n  tag \"cci\": \"CCI-000140\"\n  tag \"check\": \"Verify the audit records are stored on a separate disk than\noperating system.\n\nCheck the system configuration to determine the partition the audit records are\nbeing written to with the following command:\n\n# grep log_file /etc/audit/auditd.conf log_file =\n/var/log/elasticsearch/audit/audit.log\n\nCheck the size of the partition that audit records are written to (with the\nexample being \\\\\\\"/var/log/elasticsearch/audit/\\\\\\\"):\n\n# df -h /var/log/elasticsearch/audit/ 0.9G /var/log/elasticsearch/audit\n\nIf the audit records are not being written to a partition specifically created\nfor audit records (in this example \\\\\\\"/var/log/elasticsearch/audit\\\\\\\" is a\nseparate partition), this is a finding.\"\n  tag \"fix\": \"Configure the audit storage to a separate partition for audit\nstorage.\n\nCheck the system configuration to determine the partition the audit records are\nbeing written to:\n\n# grep log_file /etc/audit/auditd.conf\n\nDetermine the size of the partition that audit records are written to (with the\nexample being \\\\\\\"/var/log/elasticsearch/audit/\\\\\\\"):\n\n# df -h /var/log/elasticsearch/audit/    \"\n\n  begin\n    log_partition_name = command(\"df #{AUDITD_LOG_FILE} | awk '/^\\\\/dev/ {print $1}'\").stdout.strip()\n    log_partition_size = command(\"df #{AUDITD_LOG_FILE} | awk '/^\\\\/dev/ {print $2}'\").stdout.strip().to_f / 1000\n    space_left = ((AUDITD_SPACE_LEFT_THRESHOLD_PRECENT*0.01) * log_partition_size).round\n\n    describe auditd_conf do\n      its('log_file') { should cmp AUDITD_LOG_FILE}\n      its('space_left.to_i') { should > space_left}\n    end\n\n  rescue Exception => msg\n    describe do\n      skip \"Exception: #{msg}\"\n    end\n  end\nend",
          "source_location": {
            "line": 18,
            "ref": "../elasticsearch-inspec/controls/auditd/V-26974.rb"
          },
          "results": [
            {
              "status": "passed",
              "code_desc": "Audit Daemon Config log_file should cmp == \"/var/log/audit/audit.log\"",
              "run_time": 0.032813,
              "start_time": "2018-02-11 14:26:55 -0500"
            },
            {
              "status": "failed",
              "code_desc": "Audit Daemon Config space_left.to_i should > 9816",
              "run_time": 0.001456,
              "start_time": "2018-02-11 14:26:55 -0500"
            }
          ]
        },
        {
          "id": "V-26970",
          "title": "The application must alert designated organizational officials in the\nevent of an audit processing failure.",
          "desc": "Utilize perimeter, application, centralized authentication, and\nrepository audit controls to audit the use of systems in real time with\nsufficient context.  X-Pack Security audit controls should be enabled to audit\nthe defaults of all HTTP/S based access to Elasticsearch.  All applications\nshould use HTTP/S  rather than Elasticsearch transport protocol.",
          "impact": 0.5,
          "refs": [],
          "tags": {
            "nist": [
              "AU-5 a",
              "Rev_4"
            ],
            "severity": "medium",
            "rid": "SV-34257r1_rule",
            "gtitle": "SRG-APP-000108",
            "cci": "CCI-000139",
            "check": "Verify the operating system immediately notifies the SA and\nISSO (at a minimum) when allocated audit record storage volume reaches\n<DETERMINED_THRESHOLD> percent of the repository maximum audit record storage\ncapacity.\n\nCheck the system configuration to determine the partition the audit records are\nbeing written to with the following command:\n\n# grep log_file /etc/audit/auditd.conf log_file =\n/var/log/elasticsearch/audit/audit.log\n\nCheck the size of the partition that audit records are written to (with the\nexample being \\\"/var/log/elasticsearch/audit/\\\"):\n\n# df -h /var/log/elasticsearch/audit/ 0.9G /var/log/elasticsearch/audit\n\nIf the audit records are not being written to a partition specifically created\nfor audit records (in this example \\\"/var/log/elasticsearch/audit\\\" is a\nseparate partition), determine the amount of space other files in the partition\nare currently occupying with the following command:\n\n# du -sh <partition> 1.8G /var  Determine what the threshold is for the system\nto take action when <DETERMINED_THRESHOLD> percent of the repository maximum\naudit record storage capacity is reached:\n\n# grep -i space_left /etc/audit/auditd.conf space_left = 225\n\nIf the value of the \\\"space_left\\\" keyword is not set to\nABS(1-<DETERMINED_THRESHOLD>) percent of the total partition size, this is a\nfinding.",
            "fix": "Configure the operating system to immediately notify the SA and\nISSO (at a minimum) when allocated audit record storage volume reaches\n<DETERMINED_THRESHOLD> percent of the repository maximum audit record storage\ncapacity.\n\nCheck the system configuration to determine the partition the audit records are\nbeing written to:\n\n# grep log_file /etc/audit/auditd.conf\n\nDetermine the size of the partition that audit records are written to (with the\nexample being \\\"/var/log/elasticsearch/audit/\\\"):\n\n# df -h /var/log/elasticsearch/audit/\n\nSet the value of the \\\"space_left\\\" keyword in\n\\\"/etc/audit/auditd.conf\\\" to <DETERMINED_THRESHOLD> percent of the\npartition size."
          },
          "code": "control \"V-26970\" do\n  title \"The application must alert designated organizational officials in the\nevent of an audit processing failure.\"\n  desc  \"Utilize perimeter, application, centralized authentication, and\nrepository audit controls to audit the use of systems in real time with\nsufficient context.  X-Pack Security audit controls should be enabled to audit\nthe defaults of all HTTP/S based access to Elasticsearch.  All applications\nshould use HTTP/S  rather than Elasticsearch transport protocol.\"\n  impact 0.5\n  tag \"nist\": [\"AU-5 a\", \"Rev_4\"]\n  tag \"severity\": \"medium\"\n  tag \"rid\": \"SV-34257r1_rule\"\n  tag \"gtitle\": \"SRG-APP-000108\"\n  tag \"cci\": \"CCI-000139\"\n  tag \"check\": \"Verify the operating system immediately notifies the SA and\nISSO (at a minimum) when allocated audit record storage volume reaches\n<DETERMINED_THRESHOLD> percent of the repository maximum audit record storage\ncapacity.\n\nCheck the system configuration to determine the partition the audit records are\nbeing written to with the following command:\n\n# grep log_file /etc/audit/auditd.conf log_file =\n/var/log/elasticsearch/audit/audit.log\n\nCheck the size of the partition that audit records are written to (with the\nexample being \\\\\\\"/var/log/elasticsearch/audit/\\\\\\\"):\n\n# df -h /var/log/elasticsearch/audit/ 0.9G /var/log/elasticsearch/audit\n\nIf the audit records are not being written to a partition specifically created\nfor audit records (in this example \\\\\\\"/var/log/elasticsearch/audit\\\\\\\" is a\nseparate partition), determine the amount of space other files in the partition\nare currently occupying with the following command:\n\n# du -sh <partition> 1.8G /var  Determine what the threshold is for the system\nto take action when <DETERMINED_THRESHOLD> percent of the repository maximum\naudit record storage capacity is reached:\n\n# grep -i space_left /etc/audit/auditd.conf space_left = 225\n\nIf the value of the \\\\\\\"space_left\\\\\\\" keyword is not set to\nABS(1-<DETERMINED_THRESHOLD>) percent of the total partition size, this is a\nfinding.\"\n  tag \"fix\": \"Configure the operating system to immediately notify the SA and\nISSO (at a minimum) when allocated audit record storage volume reaches\n<DETERMINED_THRESHOLD> percent of the repository maximum audit record storage\ncapacity.\n\nCheck the system configuration to determine the partition the audit records are\nbeing written to:\n\n# grep log_file /etc/audit/auditd.conf\n\nDetermine the size of the partition that audit records are written to (with the\nexample being \\\\\\\"/var/log/elasticsearch/audit/\\\\\\\"):\n\n# df -h /var/log/elasticsearch/audit/\n\nSet the value of the \\\\\\\"space_left\\\\\\\" keyword in\n\\\\\\\"/etc/audit/auditd.conf\\\\\\\" to <DETERMINED_THRESHOLD> percent of the\npartition size.\"\n\n  begin\n    log_partition_name = command(\"df #{AUDITD_LOG_FILE} | awk '/^\\\\/dev/ {print $1}'\").stdout.strip()\n    log_partition_size = command(\"df #{AUDITD_LOG_FILE} | awk '/^\\\\/dev/ {print $2}'\").stdout.strip().to_f / 1000\n    space_left = ((AUDITD_SPACE_LEFT_THRESHOLD_PRECENT*0.01) * log_partition_size).round\n\n    describe auditd_conf do\n      its('log_file') { should cmp AUDITD_LOG_FILE}\n      its('space_left.to_i') { should > space_left}\n    end\n\n  rescue Exception => msg\n    describe do\n      skip \"Exception: #{msg}\"\n    end\n  end\nend\n",
          "source_location": {
            "line": 18,
            "ref": "../elasticsearch-inspec/controls/auditd/V-26970.rb"
          },
          "results": [
            {
              "status": "passed",
              "code_desc": "Audit Daemon Config log_file should cmp == \"/var/log/audit/audit.log\"",
              "run_time": 0.000349,
              "start_time": "2018-02-11 14:26:55 -0500"
            },
            {
              "status": "failed",
              "code_desc": "Audit Daemon Config space_left.to_i should > 9816",
              "run_time": 0.000139,
              "start_time": "2018-02-11 14:26:55 -0500"
            }
          ]
        },
        {
          "id": "V-26889",
          "title": "Applications themselves, or the logging mechanism the application\nutilizes, must provide a warning when allocated audit record storage volume\nreaches an organizational-defined percentage of maximum audit record storage\ncapacity.",
          "desc": "Monitor the health and resources (such as remaining storage) of\nsystems running Elasticsearch software and notify operators when safety\nthresholds have been exceeded.",
          "impact": 0.5,
          "refs": [],
          "tags": {
            "nist": [
              "AU-5 (1)",
              "Rev_3"
            ],
            "severity": "medium",
            "rid": "SV-34169r1_rule",
            "gtitle": "SRG-APP-000103",
            "cci": "CCI-000143",
            "check": "Verify the operating system immediately notifies the SA and\nISSO (at a minimum) when allocated audit record storage volume reaches\n<DETERMINED_THRESHOLD> percent of the repository maximum audit record storage\ncapacity.\n\nCheck the system configuration to determine the partition the audit records are\nbeing written to with the following command:\n\n# grep log_file /etc/audit/auditd.conf log_file =\n/var/log/elasticsearch/audit/audit.log\n\nCheck the size of the partition that audit records are written to (with the\nexample being '/var/log/elasticsearch/audit/'):\n\n# df -h /var/log/elasticsearch/audit/ 0.9G /var/log/elasticsearch/audit\n\nIf the audit records are not being written to a partition specifically created\nfor audit records (in this example '/var/log/elasticsearch/audit' is a\nseparate partition), determine the amount of space other files in the partition\nare currently occupying with the following command:\n\n# du -sh <partition> 1.8G /var  Determine what the threshold is for the system\nto take action when <DETERMINED_THRESHOLD> percent of the repository maximum\naudit record storage capacity is reached:\n\n# grep -i space_left /etc/audit/auditd.conf space_left = 225\n\nIf the value of the 'space_left' keyword is not set to\nABS(1-<DETERMINED_THRESHOLD>) percent of the total partition size, this is a\nfinding.",
            "fix": "Configure the operating system to immediately notify the SA and\nISSO (at a minimum) when allocated audit record storage volume reaches\n<DETERMINED_THRESHOLD> percent of the repository maximum audit record storage\ncapacity.\n\nCheck the system configuration to determine the partition the audit records are\nbeing written to:\n\n# grep log_file /etc/audit/auditd.conf\n\nDetermine the size of the partition that audit records are written to (with the\nexample being '/var/log/elasticsearch/audit/'):\n\n# df -h /var/log/elasticsearch/audit/\n\nSet the value of the 'space_left' keyword in\n'/etc/audit/auditd.conf' to <DETERMINED_THRESHOLD> percent of the\npartition size."
          },
          "code": "control \"V-26889\" do\n  title \"Applications themselves, or the logging mechanism the application\nutilizes, must provide a warning when allocated audit record storage volume\nreaches an organizational-defined percentage of maximum audit record storage\ncapacity.\"\n  desc  \"Monitor the health and resources (such as remaining storage) of\nsystems running Elasticsearch software and notify operators when safety\nthresholds have been exceeded. \"\n  impact 0.5\n  tag \"nist\": [\"AU-5 (1)\", \"Rev_3\"]\n  tag \"severity\": \"medium\"\n  tag \"rid\": \"SV-34169r1_rule\"\n  tag \"gtitle\": \"SRG-APP-000103\"\n  tag \"cci\": \"CCI-000143\"\n  tag \"check\": \"Verify the operating system immediately notifies the SA and\nISSO (at a minimum) when allocated audit record storage volume reaches\n<DETERMINED_THRESHOLD> percent of the repository maximum audit record storage\ncapacity.\n\nCheck the system configuration to determine the partition the audit records are\nbeing written to with the following command:\n\n# grep log_file /etc/audit/auditd.conf log_file =\n/var/log/elasticsearch/audit/audit.log\n\nCheck the size of the partition that audit records are written to (with the\nexample being '/var/log/elasticsearch/audit/'):\n\n# df -h /var/log/elasticsearch/audit/ 0.9G /var/log/elasticsearch/audit\n\nIf the audit records are not being written to a partition specifically created\nfor audit records (in this example '/var/log/elasticsearch/audit' is a\nseparate partition), determine the amount of space other files in the partition\nare currently occupying with the following command:\n\n# du -sh <partition> 1.8G /var  Determine what the threshold is for the system\nto take action when <DETERMINED_THRESHOLD> percent of the repository maximum\naudit record storage capacity is reached:\n\n# grep -i space_left /etc/audit/auditd.conf space_left = 225\n\nIf the value of the 'space_left' keyword is not set to\nABS(1-<DETERMINED_THRESHOLD>) percent of the total partition size, this is a\nfinding.\"\n  tag \"fix\": \"Configure the operating system to immediately notify the SA and\nISSO (at a minimum) when allocated audit record storage volume reaches\n<DETERMINED_THRESHOLD> percent of the repository maximum audit record storage\ncapacity.\n\nCheck the system configuration to determine the partition the audit records are\nbeing written to:\n\n# grep log_file /etc/audit/auditd.conf\n\nDetermine the size of the partition that audit records are written to (with the\nexample being '/var/log/elasticsearch/audit/'):\n\n# df -h /var/log/elasticsearch/audit/\n\nSet the value of the 'space_left' keyword in\n'/etc/audit/auditd.conf' to <DETERMINED_THRESHOLD> percent of the\npartition size.\"\n\n  begin\n    log_partition_name = command(\"df #{AUDITD_LOG_FILE} | awk '/^\\\\/dev/ {print $1}'\").stdout.strip()\n    log_partition_size = command(\"df #{AUDITD_LOG_FILE} | awk '/^\\\\/dev/ {print $2}'\").stdout.strip().to_f / 1000\n    space_left = ((AUDITD_SPACE_LEFT_THRESHOLD_PRECENT*0.01) * log_partition_size).round\n\n    describe auditd_conf do\n      its('log_file') { should cmp AUDITD_LOG_FILE}\n      its('space_left.to_i') { should > space_left}\n    end\n\n  rescue Exception => msg\n    describe do\n      skip \"Exception: #{msg}\"\n    end\n  end\nend\n",
          "source_location": {
            "line": 18,
            "ref": "../elasticsearch-inspec/controls/auditd/V-26889.rb"
          },
          "results": [
            {
              "status": "passed",
              "code_desc": "Audit Daemon Config log_file should cmp == \"/var/log/audit/audit.log\"",
              "run_time": 0.000283,
              "start_time": "2018-02-11 14:26:55 -0500"
            },
            {
              "status": "failed",
              "code_desc": "Audit Daemon Config space_left.to_i should > 9816",
              "run_time": 0.000142,
              "start_time": "2018-02-11 14:26:55 -0500"
            }
          ]
        },
        {
          "id": "V-26968",
          "title": "The application must invoke a system shutdown in the event of an audit\nfailure, unless an alternative audit capability exists.",
          "desc": "Configure automated alarms to proactively notify when the security or\nstability of the system is threatened",
          "impact": 0.5,
          "refs": [],
          "tags": {
            "nist": [
              "AU-5 (4)",
              "Rev_3"
            ],
            "severity": "medium",
            "rid": "SV-34254r1_rule",
            "gtitle": "SRG-APP-000107",
            "cci": "CCI-001343",
            "check": "Verify the operating system immediately notifies the SA and\nISSO (at a minimum) when allocated audit record storage volume reaches\n<DETERMINED_THRESHOLD> percent of the repository maximum audit record storage\ncapacity.\n\nCheck the system configuration to determine the partition the audit records are\nbeing written to with the following command:\n\n# grep log_file /etc/audit/auditd.conf log_file =\n/var/log/elasticsearch/audit/audit.log\n\nCheck the size of the partition that audit records are written to (with the\nexample being \\\"/var/log/elasticsearch/audit/\\\"):\n\n# df -h /var/log/elasticsearch/audit/ 0.9G /var/log/elasticsearch/audit\n\nIf the audit records are not being written to a partition specifically created\nfor audit records (in this example \\\"/var/log/elasticsearch/audit\\\" is a\nseparate partition), determine the amount of space other files in the partition\nare currently occupying with the following command:\n\n# du -sh <partition> 1.8G /var  Determine what the threshold is for the system\nto take action when <DETERMINED_THRESHOLD> percent of the repository maximum\naudit record storage capacity is reached:\n\n# grep -i space_left /etc/audit/auditd.conf space_left = 225\n\nIf the value of the \\\"space_left\\\" keyword is not set to\nABS(1-<DETERMINED_THRESHOLD>) percent of the total partition size, this is a\nfinding.",
            "fix": "Configure the operating system to immediately notify the SA and\nISSO (at a minimum) when allocated audit record storage volume reaches\n<DETERMINED_THRESHOLD> percent of the repository maximum audit record storage\ncapacity.\n\nCheck the system configuration to determine the partition the audit records are\nbeing written to:\n\n# grep log_file /etc/audit/auditd.conf\n\nDetermine the size of the partition that audit records are written to (with the\nexample being \\\"/var/log/elasticsearch/audit/\\\"):\n\n# df -h /var/log/elasticsearch/audit/\n\nSet the value of the \\\"space_left\\\" keyword in\n\\\"/etc/audit/auditd.conf\\\" to <DETERMINED_THRESHOLD> percent of the\npartition size."
          },
          "code": "control \"V-26968\" do\n  title \"The application must invoke a system shutdown in the event of an audit\nfailure, unless an alternative audit capability exists.\"\n  desc  \"Configure automated alarms to proactively notify when the security or\nstability of the system is threatened\"\n  impact 0.5\n  tag \"nist\": [\"AU-5 (4)\", \"Rev_3\"]\n  tag \"severity\": \"medium\"\n  tag \"rid\": \"SV-34254r1_rule\"\n  tag \"gtitle\": \"SRG-APP-000107\"\n  tag \"cci\": \"CCI-001343\"\n  tag \"check\": \"Verify the operating system immediately notifies the SA and\nISSO (at a minimum) when allocated audit record storage volume reaches\n<DETERMINED_THRESHOLD> percent of the repository maximum audit record storage\ncapacity.\n\nCheck the system configuration to determine the partition the audit records are\nbeing written to with the following command:\n\n# grep log_file /etc/audit/auditd.conf log_file =\n/var/log/elasticsearch/audit/audit.log\n\nCheck the size of the partition that audit records are written to (with the\nexample being \\\\\\\"/var/log/elasticsearch/audit/\\\\\\\"):\n\n# df -h /var/log/elasticsearch/audit/ 0.9G /var/log/elasticsearch/audit\n\nIf the audit records are not being written to a partition specifically created\nfor audit records (in this example \\\\\\\"/var/log/elasticsearch/audit\\\\\\\" is a\nseparate partition), determine the amount of space other files in the partition\nare currently occupying with the following command:\n\n# du -sh <partition> 1.8G /var  Determine what the threshold is for the system\nto take action when <DETERMINED_THRESHOLD> percent of the repository maximum\naudit record storage capacity is reached:\n\n# grep -i space_left /etc/audit/auditd.conf space_left = 225\n\nIf the value of the \\\\\\\"space_left\\\\\\\" keyword is not set to\nABS(1-<DETERMINED_THRESHOLD>) percent of the total partition size, this is a\nfinding.\"\n  tag \"fix\": \"Configure the operating system to immediately notify the SA and\nISSO (at a minimum) when allocated audit record storage volume reaches\n<DETERMINED_THRESHOLD> percent of the repository maximum audit record storage\ncapacity.\n\nCheck the system configuration to determine the partition the audit records are\nbeing written to:\n\n# grep log_file /etc/audit/auditd.conf\n\nDetermine the size of the partition that audit records are written to (with the\nexample being \\\\\\\"/var/log/elasticsearch/audit/\\\\\\\"):\n\n# df -h /var/log/elasticsearch/audit/\n\nSet the value of the \\\\\\\"space_left\\\\\\\" keyword in\n\\\\\\\"/etc/audit/auditd.conf\\\\\\\" to <DETERMINED_THRESHOLD> percent of the\npartition size.\"\n\n  begin\n    log_partition_name = command(\"df #{AUDITD_LOG_FILE} | awk '/^\\\\/dev/ {print $1}'\").stdout.strip()\n    log_partition_size = command(\"df #{AUDITD_LOG_FILE} | awk '/^\\\\/dev/ {print $2}'\").stdout.strip().to_f / 1000\n    space_left = ((AUDITD_SPACE_LEFT_THRESHOLD_PRECENT*0.01) * log_partition_size).round\n\n    describe auditd_conf do\n      its('log_file') { should cmp AUDITD_LOG_FILE}\n      its('space_left.to_i') { should > space_left}\n    end\n\n  rescue Exception => msg\n    describe do\n      skip \"Exception: #{msg}\"\n    end\n  end\nend",
          "source_location": {
            "line": 18,
            "ref": "../elasticsearch-inspec/controls/auditd/V-26968.rb"
          },
          "results": [
            {
              "status": "passed",
              "code_desc": "Audit Daemon Config log_file should cmp == \"/var/log/audit/audit.log\"",
              "run_time": 0.000285,
              "start_time": "2018-02-11 14:26:55 -0500"
            },
            {
              "status": "failed",
              "code_desc": "Audit Daemon Config space_left.to_i should > 9816",
              "run_time": 0.00012,
              "start_time": "2018-02-11 14:26:55 -0500"
            }
          ]
        },
        {
          "id": "V-26967",
          "title": "The application must reject or delay, as defined by the\norganizational, network traffic generated above configurable traffic volume\nthresholds.",
          "desc": "Allocate Hard drive space for audit logs for minimum number of days\nfor normal load. Monitor the health and resources (such as remaining storage)\nof systems running Elasticsearch software and notify operators when safety\nthresholds have been exceeded. Automated system notification via email or http\nendpoint can be built as an action in Watcher.",
          "impact": 0.5,
          "refs": [],
          "tags": {
            "nist": [
              "AU-5 (3)",
              "Rev_3"
            ],
            "severity": "medium",
            "rid": "SV-34252r1_rule",
            "gtitle": "SRG-APP-000106",
            "cci": "CCI-001574",
            "check": "Verify the audit records are stored on a separate disk than\noperating system.\n\nCheck the system configuration to determine the partition the audit records are\nbeing written to with the following command:\n\n# grep log_file /etc/audit/auditd.conf log_file =\n/var/log/elasticsearch/audit/audit.log\n\nCheck the size of the partition that audit records are written to (with the\nexample being '/var/log/elasticsearch/audit/'):\n\n# df -h /var/log/elasticsearch/audit/ 0.9G /var/log/elasticsearch/audit\n\nIf the audit records are not being written to a partition specifically created\nfor audit records (in this example '/var/log/elasticsearch/audit' is a\nseparate partition), this is a finding.",
            "fix": "Configure the audit storage to a separate partition for audit\nstorage.\n\nCheck the system configuration to determine the partition the audit records are\nbeing written to:\n\n# grep log_file /etc/audit/auditd.conf\n\nDetermine the size of the partition that audit records are written to (with the\nexample being '/var/log/elasticsearch/audit/'):\n\n# df -h /var/log/elasticsearch/audit/    "
          },
          "code": "control \"V-26967\" do\n  title \"The application must reject or delay, as defined by the\norganizational, network traffic generated above configurable traffic volume\nthresholds.\"\n  desc  \"Allocate Hard drive space for audit logs for minimum number of days\nfor normal load. Monitor the health and resources (such as remaining storage)\nof systems running Elasticsearch software and notify operators when safety\nthresholds have been exceeded. Automated system notification via email or http\nendpoint can be built as an action in Watcher.\"\n  impact 0.5\n  tag \"nist\": [\"AU-5 (3)\", \"Rev_3\"]\n  tag \"severity\": \"medium\"\n  tag \"rid\": \"SV-34252r1_rule\"\n  tag \"gtitle\": \"SRG-APP-000106\"\n  tag \"cci\": \"CCI-001574\"\n  tag \"check\": \"Verify the audit records are stored on a separate disk than\noperating system.\n\nCheck the system configuration to determine the partition the audit records are\nbeing written to with the following command:\n\n# grep log_file /etc/audit/auditd.conf log_file =\n/var/log/elasticsearch/audit/audit.log\n\nCheck the size of the partition that audit records are written to (with the\nexample being '/var/log/elasticsearch/audit/'):\n\n# df -h /var/log/elasticsearch/audit/ 0.9G /var/log/elasticsearch/audit\n\nIf the audit records are not being written to a partition specifically created\nfor audit records (in this example '/var/log/elasticsearch/audit' is a\nseparate partition), this is a finding.\"\n  tag \"fix\": \"Configure the audit storage to a separate partition for audit\nstorage.\n\nCheck the system configuration to determine the partition the audit records are\nbeing written to:\n\n# grep log_file /etc/audit/auditd.conf\n\nDetermine the size of the partition that audit records are written to (with the\nexample being '/var/log/elasticsearch/audit/'):\n\n# df -h /var/log/elasticsearch/audit/    \"\n\n  begin\n    log_partition_name = command(\"df #{AUDITD_LOG_FILE} | awk '/^\\\\/dev/ {print $1}'\").stdout.strip()\n    log_partition_size = command(\"df #{AUDITD_LOG_FILE} | awk '/^\\\\/dev/ {print $2}'\").stdout.strip().to_f / 1000\n    space_left = ((AUDITD_SPACE_LEFT_THRESHOLD_PRECENT*0.01) * log_partition_size).round\n\n    describe auditd_conf do\n      its('log_file') { should cmp AUDITD_LOG_FILE}\n      its('space_left.to_i') { should > space_left}\n    end\n\n  rescue Exception => msg\n    describe do\n      skip \"Exception: #{msg}\"\n    end\n  end\nend\n",
          "source_location": {
            "line": 18,
            "ref": "../elasticsearch-inspec/controls/auditd/V-26967.rb"
          },
          "results": [
            {
              "status": "passed",
              "code_desc": "Audit Daemon Config log_file should cmp == \"/var/log/audit/audit.log\"",
              "run_time": 0.000301,
              "start_time": "2018-02-11 14:26:55 -0500"
            },
            {
              "status": "failed",
              "code_desc": "Audit Daemon Config space_left.to_i should > 9816",
              "run_time": 0.000131,
              "start_time": "2018-02-11 14:26:55 -0500"
            }
          ]
        },
        {
          "id": "V-26790",
          "title": "Applications must prevent encrypted data from bypassing\ncontent-checking mechanisms.",
          "desc": "Limit network access to Elasticsearch software from known points of\norigin with the use of software and hardware firewalls as well as X-Pack\nSecurity IP Filtering. Change the elasticsearch cluster name to an instance\nunique value for all elasticsearch nodes and transport client nodes in the\nsystem.",
          "impact": 0.5,
          "refs": [],
          "tags": {
            "nist": [
              "AC-4 (4)",
              "Rev_4"
            ],
            "severity": "medium",
            "rid": "SV-34040r1_rule",
            "gtitle": "SRG-APP-000056",
            "cci": "CCI-000028",
            "check": "Check Elasticsearch.yml settings and existing IP filtering\nrules to verify that only specific IP behind hardware/software 'Managed\naccess control points' are listed.\n\nAs the application administrator (usually elasticsearch, check the\nxpack.security.http.filter setting contains IP address(es) of the  'Managed\naccess control points':\n\n$cat elasticsearch.yml | grep 'xpack.security.http.filter', Verify all three\nsettings; xpack.security.http.filter.enabled: true;\nxpack.security.http.filter.allow: 'Managed access control points';\nxpack.security.http.filter.deny: _all\n\nAs an elasticsearch administrator test; verify runtime environment within\n_culster settings are set to '{}' OR Verify all three settings are\nxpack.security.http.filter.enabled: true; xpack.security.http.filter.allow:\n'Managed access control points'; xpack.security.http.filter.deny: _all\n\n$curl -H 'Content-Type: application/json' -u <TEST_USER> -p <TEST_CREDENTIALS>\n-XGET 'http://<elasticsearch>:9200/_cluster/settings'\n\nIf these configuration setting are disabled, or not pointing to the 'Managed\naccess control points', this is a finding. ",
            "fix": "Note: The following instructions use the ES_HOME environment\nvariable. See supplementary content APPENDIX-XXX for\ninstructions on configuring ES_HOME.\n\nTo change the Managed access control points of the application, as the\napplication administrator, change the following setting in elasticsearch.yml:\n\n\n$ sudo su - elasticsearch\n$ vi $ES_HOME/config/elasticsearch.yml\n\nChange the Managed access control points parameter to the desired addresses,\ni.e.:\n     xpack.security.http.filter.enabled: true\n     xpack.security.http.filter.allow: 'Managed access control points'\n     xpack.security.http.filter.deny: _all\n\nNext, restart the application:\n$ sudo su - elasticsearch\n\n# SYSTEMD SERVER ONLY\n$ systemctl restart elasticsearch"
          },
          "code": "control \"V-26790\" do\n  title \"Applications must prevent encrypted data from bypassing\ncontent-checking mechanisms.\"\n  desc  \"Limit network access to Elasticsearch software from known points of\norigin with the use of software and hardware firewalls as well as X-Pack\nSecurity IP Filtering. Change the elasticsearch cluster name to an instance\nunique value for all elasticsearch nodes and transport client nodes in the\nsystem.\"\n  impact 0.5\n  tag \"nist\": [\"AC-4 (4)\", \"Rev_4\"]\n  tag \"severity\": \"medium\"\n  tag \"rid\": \"SV-34040r1_rule\"\n  tag \"gtitle\": \"SRG-APP-000056\"\n  tag \"cci\": \"CCI-000028\"\n  tag \"check\": \"Check Elasticsearch.yml settings and existing IP filtering\nrules to verify that only specific IP behind hardware/software 'Managed\naccess control points' are listed.\n\nAs the application administrator (usually elasticsearch, check the\nxpack.security.http.filter setting contains IP address(es) of the  'Managed\naccess control points':\n\n$cat elasticsearch.yml | grep 'xpack.security.http.filter', Verify all three\nsettings; xpack.security.http.filter.enabled: true;\nxpack.security.http.filter.allow: 'Managed access control points';\nxpack.security.http.filter.deny: _all\n\nAs an elasticsearch administrator test; verify runtime environment within\n_culster settings are set to '{}' OR Verify all three settings are\nxpack.security.http.filter.enabled: true; xpack.security.http.filter.allow:\n'Managed access control points'; xpack.security.http.filter.deny: _all\n\n$curl -H 'Content-Type: application/json' -u <TEST_USER> -p <TEST_CREDENTIALS>\n-XGET 'http://<elasticsearch>:9200/_cluster/settings'\n\nIf these configuration setting are disabled, or not pointing to the 'Managed\naccess control points', this is a finding. \"\n  tag \"fix\": \"Note: The following instructions use the ES_HOME environment\nvariable. See supplementary content APPENDIX-XXX for\ninstructions on configuring ES_HOME.\n\nTo change the Managed access control points of the application, as the\napplication administrator, change the following setting in elasticsearch.yml:\n\n\n$ sudo su - elasticsearch\n$ vi $ES_HOME/config/elasticsearch.yml\n\nChange the Managed access control points parameter to the desired addresses,\ni.e.:\n     xpack.security.http.filter.enabled: true\n     xpack.security.http.filter.allow: 'Managed access control points'\n     xpack.security.http.filter.deny: _all\n\nNext, restart the application:\n$ sudo su - elasticsearch\n\n# SYSTEMD SERVER ONLY\n$ systemctl restart elasticsearch\"\n\n  begin\n\n    es_handle = es_helper(url:\"https://#{ELASTIC_IP}:#{ELASTIC_PORT}\",\n                    username: ES_ADMIN,\n                    password: ES_PASS,\n                    ssl_verify: SSL_VERIFY )\n\n    describe \"No nodes found\" do\n      subject { es_handle.nodes.nil? }\n      it { should_not be_truthy }\n    end if es_handle.nodes.nil?\n\n\n    es_handle.nodes.each do |node|\n      describe \"IP filtering rules for Node: #{node.name}\" do\n        subject { node.ip_filter }\n        its('enabled') { should eq 'true' }\n        its('allow')  { should be_in MANAGED_ACCESS_POINTS }\n        its('deny') { should eq '_all' }\n      end\n    end unless es_handle.nodes.nil?\n\n    describe \"IP filtering rules\" do\n      subject { yaml(ELASTICSEARCH_CONF) }\n      its(['xpack.security.http.filter.enabled']) { should eq true }\n      its(['xpack.security.http.filter.allow']) { should be_in MANAGED_ACCESS_POINTS }\n      its(['xpack.security.http.filter.deny']) { should eq '_all' }\n    end\n\n    describe \"Cluster Setting:\" do\n      subject{ es_handle.cluster_settings }\n      its(['persistent']) { should be_empty }\n      its(['transient']) { should be_empty }\n    end\n\n  rescue Exception => msg\n    describe \"Exception: #{msg}\" do\n      it { should be_nil}\n    end\n  end\nend\n",
          "source_location": {
            "line": 45,
            "ref": "../elasticsearch-inspec/controls/ip_fil/V-26790.rb"
          },
          "results": [
            {
              "status": "passed",
              "code_desc": "IP filtering rules for Node: package-centos-72 enabled should eq \"true\"",
              "run_time": 0.000093,
              "start_time": "2018-02-11 14:26:55 -0500"
            },
            {
              "status": "passed",
              "code_desc": "IP filtering rules for Node: package-centos-72 allow should be in \"10.0.2.15\"",
              "run_time": 0.000134,
              "start_time": "2018-02-11 14:26:55 -0500"
            },
            {
              "status": "passed",
              "code_desc": "IP filtering rules for Node: package-centos-72 deny should eq \"_all\"",
              "run_time": 0.000102,
              "start_time": "2018-02-11 14:26:55 -0500"
            },
            {
              "status": "passed",
              "code_desc": "IP filtering rules [\"xpack.security.http.filter.enabled\"] should eq true",
              "run_time": 0.000622,
              "start_time": "2018-02-11 14:26:55 -0500"
            },
            {
              "status": "passed",
              "code_desc": "IP filtering rules [\"xpack.security.http.filter.allow\"] should be in \"10.0.2.15\"",
              "run_time": 0.000582,
              "start_time": "2018-02-11 14:26:55 -0500"
            },
            {
              "status": "passed",
              "code_desc": "IP filtering rules [\"xpack.security.http.filter.deny\"] should eq \"_all\"",
              "run_time": 0.000551,
              "start_time": "2018-02-11 14:26:55 -0500"
            },
            {
              "status": "passed",
              "code_desc": "Cluster Setting: [\"persistent\"] should be empty",
              "run_time": 0.071995,
              "start_time": "2018-02-11 14:26:55 -0500"
            },
            {
              "status": "passed",
              "code_desc": "Cluster Setting: [\"transient\"] should be empty",
              "run_time": 0.110771,
              "start_time": "2018-02-11 14:26:55 -0500"
            }
          ]
        },
        {
          "id": "V-26685",
          "title": "Applications providing remote access must have capabilities that allow\nall remote access to be routed through managed access control points.",
          "desc": "Limit network access to Elasticsearch software from known points of\norigin with the use of software and hardware firewalls as well as X-Pack\nSecurity IP Filtering. Change the elasticsearch cluster name to an instance\nunique value for all elasticsearch nodes and all applications should use HTTP/S\n rather than Elasticsearch transport protocol.",
          "impact": 0.5,
          "refs": [],
          "tags": {
            "nist": [
              "AC-17 (3)",
              "Rev_4"
            ],
            "severity": "medium",
            "rid": "SV-33908r1_rule",
            "gtitle": "SRG-APP-000017",
            "cci": "CCI-000069",
            "check": "Check Elasticsearch.yml settings and existing IP filtering\nrules to verify that only specific IP behind hardware/software 'Managed\naccess control points' are listed.\n\nAs the application administrator (usually elasticsearch, check the\nxpack.security.http.filter setting contains IP address(es) of the  'Managed\naccess control points':\n\n$cat elasticsearch.yml | grep 'xpack.security.http.filter', Verify all three\nsettings; xpack.security.http.filter.enabled: true;\nxpack.security.http.filter.allow: 'Managed access control points';\nxpack.security.http.filter.deny: _all\n\nAs an elasticsearch administrator test; verify runtime environment within\n_culster settings are set to '{}' OR Verify all three settings are\nxpack.security.http.filter.enabled: true; xpack.security.http.filter.allow:\n'Managed access control points'; xpack.security.http.filter.deny: _all\n\n$curl -H 'Content-Type: application/json' -u <TEST_USER> -p <TEST_CREDENTIALS>\n-XGET 'http://<elasticsearch>:9200/_cluster/settings'\n\nIf these configuration setting are disabled, or not pointing to the 'Managed\naccess control points', this is a finding. ",
            "fix": "Note: The following instructions use the ES_HOME environment\nvariable. See supplementary content APPENDIX-XXX for\ninstructions on configuring ES_HOME.\n\nTo change the Managed access control points of the application, as the\napplication administrator, change the following setting in elasticsearch.yml:\n\n\n$ sudo su - elasticsearch\n$ vi $ES_HOME/config/elasticsearch.yml\n\nChange the Managed access control points parameter to the desired addresses,\ni.e.:\n     xpack.security.http.filter.enabled: true\n     xpack.security.http.filter.allow: 'Managed access control points'\n     xpack.security.http.filter.deny: _all\n\nNext, restart the application:\n$ sudo su - elasticsearch\n\n# SYSTEMD SERVER ONLY\n$ systemctl restart elasticsearch"
          },
          "code": "control \"V-26685\" do\n  title \"Applications providing remote access must have capabilities that allow\nall remote access to be routed through managed access control points.\"\n  desc  \"Limit network access to Elasticsearch software from known points of\norigin with the use of software and hardware firewalls as well as X-Pack\nSecurity IP Filtering. Change the elasticsearch cluster name to an instance\nunique value for all elasticsearch nodes and all applications should use HTTP/S\n rather than Elasticsearch transport protocol.\"\n  impact 0.5\n  tag \"nist\": [\"AC-17 (3)\", \"Rev_4\"]\n  tag \"severity\": \"medium\"\n  tag \"rid\": \"SV-33908r1_rule\"\n  tag \"gtitle\": \"SRG-APP-000017\"\n  tag \"cci\": \"CCI-000069\"\n  tag \"check\": \"Check Elasticsearch.yml settings and existing IP filtering\nrules to verify that only specific IP behind hardware/software 'Managed\naccess control points' are listed.\n\nAs the application administrator (usually elasticsearch, check the\nxpack.security.http.filter setting contains IP address(es) of the  'Managed\naccess control points':\n\n$cat elasticsearch.yml | grep 'xpack.security.http.filter', Verify all three\nsettings; xpack.security.http.filter.enabled: true;\nxpack.security.http.filter.allow: 'Managed access control points';\nxpack.security.http.filter.deny: _all\n\nAs an elasticsearch administrator test; verify runtime environment within\n_culster settings are set to '{}' OR Verify all three settings are\nxpack.security.http.filter.enabled: true; xpack.security.http.filter.allow:\n'Managed access control points'; xpack.security.http.filter.deny: _all\n\n$curl -H 'Content-Type: application/json' -u <TEST_USER> -p <TEST_CREDENTIALS>\n-XGET 'http://<elasticsearch>:9200/_cluster/settings'\n\nIf these configuration setting are disabled, or not pointing to the 'Managed\naccess control points', this is a finding. \"\n  tag \"fix\": \"Note: The following instructions use the ES_HOME environment\nvariable. See supplementary content APPENDIX-XXX for\ninstructions on configuring ES_HOME.\n\nTo change the Managed access control points of the application, as the\napplication administrator, change the following setting in elasticsearch.yml:\n\n\n$ sudo su - elasticsearch\n$ vi $ES_HOME/config/elasticsearch.yml\n\nChange the Managed access control points parameter to the desired addresses,\ni.e.:\n     xpack.security.http.filter.enabled: true\n     xpack.security.http.filter.allow: 'Managed access control points'\n     xpack.security.http.filter.deny: _all\n\nNext, restart the application:\n$ sudo su - elasticsearch\n\n# SYSTEMD SERVER ONLY\n$ systemctl restart elasticsearch\"\n\n  begin\n\n    es_handle = es_helper(url:\"https://#{ELASTIC_IP}:#{ELASTIC_PORT}\",\n                    username: ES_ADMIN,\n                    password: ES_PASS,\n                    ssl_verify: SSL_VERIFY )\n\n    describe \"No nodes found\" do\n      subject { es_handle.nodes.nil? }\n      it { should_not be_truthy }\n    end if es_handle.nodes.nil?\n\n\n    es_handle.nodes.each do |node|\n      describe \"IP filtering rules for Node: #{node.name}\" do\n        subject { node.ip_filter }\n        its('enabled') { should eq 'true' }\n        its('allow')  { should be_in MANAGED_ACCESS_POINTS }\n        its('deny') { should eq '_all' }\n      end\n    end unless es_handle.nodes.nil?\n\n    describe \"IP filtering rules\" do\n      subject { yaml(ELASTICSEARCH_CONF) }\n      its(['xpack.security.http.filter.enabled']) { should eq true }\n      its(['xpack.security.http.filter.allow']) { should be_in MANAGED_ACCESS_POINTS }\n      its(['xpack.security.http.filter.deny']) { should eq '_all' }\n    end\n\n    describe \"Cluster Setting:\" do\n      subject{ es_handle.cluster_settings }\n      its(['persistent']) { should be_empty }\n      its(['transient']) { should be_empty }\n    end\n\n  rescue Exception => msg\n    describe \"Exception: #{msg}\" do\n      it { should be_nil}\n    end\n  end\nend",
          "source_location": {
            "line": 52,
            "ref": "../elasticsearch-inspec/controls/ip_fil/V-26685.rb"
          },
          "results": [
            {
              "status": "passed",
              "code_desc": "IP filtering rules for Node: package-centos-72 enabled should eq \"true\"",
              "run_time": 0.000157,
              "start_time": "2018-02-11 14:26:56 -0500"
            },
            {
              "status": "passed",
              "code_desc": "IP filtering rules for Node: package-centos-72 allow should be in \"10.0.2.15\"",
              "run_time": 0.000148,
              "start_time": "2018-02-11 14:26:56 -0500"
            },
            {
              "status": "passed",
              "code_desc": "IP filtering rules for Node: package-centos-72 deny should eq \"_all\"",
              "run_time": 0.000077,
              "start_time": "2018-02-11 14:26:56 -0500"
            },
            {
              "status": "passed",
              "code_desc": "IP filtering rules [\"xpack.security.http.filter.enabled\"] should eq true",
              "run_time": 0.000633,
              "start_time": "2018-02-11 14:26:56 -0500"
            },
            {
              "status": "passed",
              "code_desc": "IP filtering rules [\"xpack.security.http.filter.allow\"] should be in \"10.0.2.15\"",
              "run_time": 0.00059,
              "start_time": "2018-02-11 14:26:56 -0500"
            },
            {
              "status": "passed",
              "code_desc": "IP filtering rules [\"xpack.security.http.filter.deny\"] should eq \"_all\"",
              "run_time": 0.00055,
              "start_time": "2018-02-11 14:26:56 -0500"
            },
            {
              "status": "passed",
              "code_desc": "Cluster Setting: [\"persistent\"] should be empty",
              "run_time": 0.079959,
              "start_time": "2018-02-11 14:26:56 -0500"
            },
            {
              "status": "passed",
              "code_desc": "Cluster Setting: [\"transient\"] should be empty",
              "run_time": 0.074688,
              "start_time": "2018-02-11 14:26:56 -0500"
            }
          ]
        },
        {
          "id": "V-26777",
          "title": "Applications must uniquely identify destination domains for\ninformation transfer.",
          "desc": "Limit network access to Elasticsearch software from known points of\norigin with the use of software and hardware firewalls as well as X-Pack\nSecurity IP Filtering. Change the elasticsearch cluster name to an instance\nunique value for all elasticsearch nodes and transport client nodes in the\nsystem.",
          "impact": 0.5,
          "refs": [],
          "tags": {
            "nist": [
              "AC-4 (17) (a)",
              "Rev_3"
            ],
            "severity": "medium",
            "rid": "SV-34027r1_rule",
            "gtitle": "SRG-APP-000051",
            "cci": "CCI-001555",
            "check": "Check Elasticsearch.yml settings and existing IP filtering\nrules to verify that only specific IP behind hardware/software 'Managed\naccess control points' are listed.\n\nAs the application administrator (usually elasticsearch, check the\nxpack.security.http.filter setting contains IP address(es) of the  'Managed\naccess control points':\n\n$cat elasticsearch.yml | grep 'xpack.security.http.filter', Verify all three\nsettings; xpack.security.http.filter.enabled: true;\nxpack.security.http.filter.allow: 'Managed access control points';\nxpack.security.http.filter.deny: _all\n\nAs an elasticsearch administrator test; verify runtime environment within\n_culster settings are set to '{}' OR Verify all three settings are\nxpack.security.http.filter.enabled: true; xpack.security.http.filter.allow:\n'Managed access control points'; xpack.security.http.filter.deny: _all\n\n$curl -H 'Content-Type: application/json' -u <TEST_USER> -p <TEST_CREDENTIALS>\n-XGET 'http://<elasticsearch>:9200/_cluster/settings'\n\nIf these configuration setting are disabled, or not pointing to the 'Managed\naccess control points', this is a finding. ",
            "fix": "Note: The following instructions use the ES_HOME environment\nvariable. See supplementary content APPENDIX-XXX for\ninstructions on configuring ES_HOME.\n\nTo change the Managed access control points of the application, as the\napplication administrator, change the following setting in elasticsearch.yml:\n\n\n$ sudo su - elasticsearch\n$ vi $ES_HOME/config/elasticsearch.yml\n\nChange the Managed access control points parameter to the desired addresses,\ni.e.:\n     xpack.security.http.filter.enabled: true\n     xpack.security.http.filter.allow: 'Managed access control points'\n     xpack.security.http.filter.deny: _all\n\nNext, restart the application:\n$ sudo su - elasticsearch\n\n# SYSTEMD SERVER ONLY\n$ systemctl restart elasticsearch"
          },
          "code": "control \"V-26777\" do\n  title \"Applications must uniquely identify destination domains for\ninformation transfer.\"\n  desc  \"Limit network access to Elasticsearch software from known points of\norigin with the use of software and hardware firewalls as well as X-Pack\nSecurity IP Filtering. Change the elasticsearch cluster name to an instance\nunique value for all elasticsearch nodes and transport client nodes in the\nsystem.\"\n  impact 0.5\n  tag \"nist\": [\"AC-4 (17) (a)\", \"Rev_3\"]\n  tag \"severity\": \"medium\"\n  tag \"rid\": \"SV-34027r1_rule\"\n  tag \"gtitle\": \"SRG-APP-000051\"\n  tag \"cci\": \"CCI-001555\"\n  tag \"check\": \"Check Elasticsearch.yml settings and existing IP filtering\nrules to verify that only specific IP behind hardware/software 'Managed\naccess control points' are listed.\n\nAs the application administrator (usually elasticsearch, check the\nxpack.security.http.filter setting contains IP address(es) of the  'Managed\naccess control points':\n\n$cat elasticsearch.yml | grep 'xpack.security.http.filter', Verify all three\nsettings; xpack.security.http.filter.enabled: true;\nxpack.security.http.filter.allow: 'Managed access control points';\nxpack.security.http.filter.deny: _all\n\nAs an elasticsearch administrator test; verify runtime environment within\n_culster settings are set to '{}' OR Verify all three settings are\nxpack.security.http.filter.enabled: true; xpack.security.http.filter.allow:\n'Managed access control points'; xpack.security.http.filter.deny: _all\n\n$curl -H 'Content-Type: application/json' -u <TEST_USER> -p <TEST_CREDENTIALS>\n-XGET 'http://<elasticsearch>:9200/_cluster/settings'\n\nIf these configuration setting are disabled, or not pointing to the 'Managed\naccess control points', this is a finding. \"\n  tag \"fix\": \"Note: The following instructions use the ES_HOME environment\nvariable. See supplementary content APPENDIX-XXX for\ninstructions on configuring ES_HOME.\n\nTo change the Managed access control points of the application, as the\napplication administrator, change the following setting in elasticsearch.yml:\n\n\n$ sudo su - elasticsearch\n$ vi $ES_HOME/config/elasticsearch.yml\n\nChange the Managed access control points parameter to the desired addresses,\ni.e.:\n     xpack.security.http.filter.enabled: true\n     xpack.security.http.filter.allow: 'Managed access control points'\n     xpack.security.http.filter.deny: _all\n\nNext, restart the application:\n$ sudo su - elasticsearch\n\n# SYSTEMD SERVER ONLY\n$ systemctl restart elasticsearch\"\n\n  begin\n\n    es_handle = es_helper(url:\"https://#{ELASTIC_IP}:#{ELASTIC_PORT}\",\n                    username: ES_ADMIN,\n                    password: ES_PASS,\n                    ssl_verify: SSL_VERIFY )\n\n    describe \"No nodes found\" do\n      subject { es_handle.nodes.nil? }\n      it { should_not be_truthy }\n    end if es_handle.nodes.nil?\n\n\n    es_handle.nodes.each do |node|\n      describe \"IP filtering rules for Node: #{node.name}\" do\n        subject { node.ip_filter }\n        its('enabled') { should eq 'true' }\n        its('allow')  { should be_in MANAGED_ACCESS_POINTS }\n        its('deny') { should eq '_all' }\n      end\n    end unless es_handle.nodes.nil?\n\n    describe \"IP filtering rules\" do\n      subject { yaml(ELASTICSEARCH_CONF) }\n      its(['xpack.security.http.filter.enabled']) { should eq true }\n      its(['xpack.security.http.filter.allow']) { should be_in MANAGED_ACCESS_POINTS }\n      its(['xpack.security.http.filter.deny']) { should eq '_all' }\n    end\n\n    describe \"Cluster Setting:\" do\n      subject{ es_handle.cluster_settings }\n      its(['persistent']) { should be_empty }\n      its(['transient']) { should be_empty }\n    end\n\n  rescue Exception => msg\n    describe \"Exception: #{msg}\" do\n      it { should be_nil}\n    end\n  end\nend",
          "source_location": {
            "line": 45,
            "ref": "../elasticsearch-inspec/controls/ip_fil/V-26777.rb"
          },
          "results": [
            {
              "status": "passed",
              "code_desc": "IP filtering rules for Node: package-centos-72 enabled should eq \"true\"",
              "run_time": 0.000123,
              "start_time": "2018-02-11 14:26:56 -0500"
            },
            {
              "status": "passed",
              "code_desc": "IP filtering rules for Node: package-centos-72 allow should be in \"10.0.2.15\"",
              "run_time": 0.000116,
              "start_time": "2018-02-11 14:26:56 -0500"
            },
            {
              "status": "passed",
              "code_desc": "IP filtering rules for Node: package-centos-72 deny should eq \"_all\"",
              "run_time": 0.000069,
              "start_time": "2018-02-11 14:26:56 -0500"
            },
            {
              "status": "passed",
              "code_desc": "IP filtering rules [\"xpack.security.http.filter.enabled\"] should eq true",
              "run_time": 0.00055,
              "start_time": "2018-02-11 14:26:56 -0500"
            },
            {
              "status": "passed",
              "code_desc": "IP filtering rules [\"xpack.security.http.filter.allow\"] should be in \"10.0.2.15\"",
              "run_time": 0.000526,
              "start_time": "2018-02-11 14:26:56 -0500"
            },
            {
              "status": "passed",
              "code_desc": "IP filtering rules [\"xpack.security.http.filter.deny\"] should eq \"_all\"",
              "run_time": 0.000476,
              "start_time": "2018-02-11 14:26:56 -0500"
            },
            {
              "status": "passed",
              "code_desc": "Cluster Setting: [\"persistent\"] should be empty",
              "run_time": 0.078172,
              "start_time": "2018-02-11 14:26:56 -0500"
            },
            {
              "status": "passed",
              "code_desc": "Cluster Setting: [\"transient\"] should be empty",
              "run_time": 0.078005,
              "start_time": "2018-02-11 14:26:56 -0500"
            }
          ]
        },
        {
          "id": "V-26776",
          "title": "Applications must uniquely authenticate source domains for information\ntransfer.",
          "desc": "Limit network access to Elasticsearch software from known points of\norigin with the use of software and hardware firewalls as well as X-Pack\nSecurity IP Filtering. Change the elasticsearch cluster name to an instance\nunique value for all elasticsearch nodes and transport client nodes in the\nsystem.",
          "impact": 0.5,
          "refs": [],
          "tags": {
            "nist": [
              "AC-4 (17) (a)",
              "Rev_3"
            ],
            "severity": "medium",
            "rid": "SV-34026r1_rule",
            "gtitle": "SRG-APP-000050",
            "cci": "CCI-001377",
            "check": "Check Elasticsearch.yml settings and existing IP filtering\nrules to verify that only specific IP behind hardware/software 'Managed\naccess control points' are listed.\n\nAs the application administrator (usually elasticsearch, check the\nxpack.security.http.filter setting contains IP address(es) of the  'Managed\naccess control points':\n\n$cat elasticsearch.yml | grep 'xpack.security.http.filter', Verify all three\nsettings; xpack.security.http.filter.enabled: true;\nxpack.security.http.filter.allow: 'Managed access control points';\nxpack.security.http.filter.deny: _all\n\nAs an elasticsearch administrator test; verify runtime environment within\n_culster settings are set to '{}' OR Verify all three settings are\nxpack.security.http.filter.enabled: true; xpack.security.http.filter.allow:\n'Managed access control points'; xpack.security.http.filter.deny: _all\n\n$curl -H 'Content-Type: application/json' -u <TEST_USER> -p <TEST_CREDENTIALS>\n-XGET 'http://<elasticsearch>:9200/_cluster/settings'\n\nIf these configuration setting are disabled, or not pointing to the 'Managed\naccess control points', this is a finding. ",
            "fix": "Note: The following instructions use the ES_HOME environment\nvariable. See supplementary content APPENDIX-XXX for\ninstructions on configuring ES_HOME.\n\nTo change the Managed access control points of the application, as the\napplication administrator, change the following setting in elasticsearch.yml:\n\n\n$ sudo su - elasticsearch\n$ vi $ES_HOME/config/elasticsearch.yml\n\nChange the Managed access control points parameter to the desired addresses,\ni.e.:\n     xpack.security.http.filter.enabled: true\n     xpack.security.http.filter.allow: 'Managed access control points'\n     xpack.security.http.filter.deny: _all\n\nNext, restart the application:\n$ sudo su - elasticsearch\n\n# SYSTEMD SERVER ONLY\n$ systemctl restart elasticsearch"
          },
          "code": "control \"V-26776\" do\n  title \"Applications must uniquely authenticate source domains for information\ntransfer.\"\n  desc  \"Limit network access to Elasticsearch software from known points of\norigin with the use of software and hardware firewalls as well as X-Pack\nSecurity IP Filtering. Change the elasticsearch cluster name to an instance\nunique value for all elasticsearch nodes and transport client nodes in the\nsystem.\"\n  impact 0.5\n  tag \"nist\": [\"AC-4 (17) (a)\", \"Rev_3\"]\n  tag \"severity\": \"medium\"\n  tag \"rid\": \"SV-34026r1_rule\"\n  tag \"gtitle\": \"SRG-APP-000050\"\n  tag \"cci\": \"CCI-001377\"\n  tag \"check\": \"Check Elasticsearch.yml settings and existing IP filtering\nrules to verify that only specific IP behind hardware/software 'Managed\naccess control points' are listed.\n\nAs the application administrator (usually elasticsearch, check the\nxpack.security.http.filter setting contains IP address(es) of the  'Managed\naccess control points':\n\n$cat elasticsearch.yml | grep 'xpack.security.http.filter', Verify all three\nsettings; xpack.security.http.filter.enabled: true;\nxpack.security.http.filter.allow: 'Managed access control points';\nxpack.security.http.filter.deny: _all\n\nAs an elasticsearch administrator test; verify runtime environment within\n_culster settings are set to '{}' OR Verify all three settings are\nxpack.security.http.filter.enabled: true; xpack.security.http.filter.allow:\n'Managed access control points'; xpack.security.http.filter.deny: _all\n\n$curl -H 'Content-Type: application/json' -u <TEST_USER> -p <TEST_CREDENTIALS>\n-XGET 'http://<elasticsearch>:9200/_cluster/settings'\n\nIf these configuration setting are disabled, or not pointing to the 'Managed\naccess control points', this is a finding. \"\n  tag \"fix\": \"Note: The following instructions use the ES_HOME environment\nvariable. See supplementary content APPENDIX-XXX for\ninstructions on configuring ES_HOME.\n\nTo change the Managed access control points of the application, as the\napplication administrator, change the following setting in elasticsearch.yml:\n\n\n$ sudo su - elasticsearch\n$ vi $ES_HOME/config/elasticsearch.yml\n\nChange the Managed access control points parameter to the desired addresses,\ni.e.:\n     xpack.security.http.filter.enabled: true\n     xpack.security.http.filter.allow: 'Managed access control points'\n     xpack.security.http.filter.deny: _all\n\nNext, restart the application:\n$ sudo su - elasticsearch\n\n# SYSTEMD SERVER ONLY\n$ systemctl restart elasticsearch\"\n\n  begin\n\n    es_handle = es_helper(url:\"https://#{ELASTIC_IP}:#{ELASTIC_PORT}\",\n                    username: ES_ADMIN,\n                    password: ES_PASS,\n                    ssl_verify: SSL_VERIFY )\n\n    describe \"No nodes found\" do\n      subject { es_handle.nodes.nil? }\n      it { should_not be_truthy }\n    end if es_handle.nodes.nil?\n\n\n    es_handle.nodes.each do |node|\n      describe \"IP filtering rules for Node: #{node.name}\" do\n        subject { node.ip_filter }\n        its('enabled') { should eq 'true' }\n        its('allow')  { should be_in MANAGED_ACCESS_POINTS }\n        its('deny') { should eq '_all' }\n      end\n    end unless es_handle.nodes.nil?\n\n    describe \"IP filtering rules\" do\n      subject { yaml(ELASTICSEARCH_CONF) }\n      its(['xpack.security.http.filter.enabled']) { should eq true }\n      its(['xpack.security.http.filter.allow']) { should be_in MANAGED_ACCESS_POINTS }\n      its(['xpack.security.http.filter.deny']) { should eq '_all' }\n    end\n\n    describe \"Cluster Setting:\" do\n      subject{ es_handle.cluster_settings }\n      its(['persistent']) { should be_empty }\n      its(['transient']) { should be_empty }\n    end\n\n  rescue Exception => msg\n    describe \"Exception: #{msg}\" do\n      it { should be_nil}\n    end\n  end\nend",
          "source_location": {
            "line": 45,
            "ref": "../elasticsearch-inspec/controls/ip_fil/V-26776.rb"
          },
          "results": [
            {
              "status": "passed",
              "code_desc": "IP filtering rules for Node: package-centos-72 enabled should eq \"true\"",
              "run_time": 0.000127,
              "start_time": "2018-02-11 14:26:56 -0500"
            },
            {
              "status": "passed",
              "code_desc": "IP filtering rules for Node: package-centos-72 allow should be in \"10.0.2.15\"",
              "run_time": 0.00012,
              "start_time": "2018-02-11 14:26:56 -0500"
            },
            {
              "status": "passed",
              "code_desc": "IP filtering rules for Node: package-centos-72 deny should eq \"_all\"",
              "run_time": 0.00007,
              "start_time": "2018-02-11 14:26:56 -0500"
            },
            {
              "status": "passed",
              "code_desc": "IP filtering rules [\"xpack.security.http.filter.enabled\"] should eq true",
              "run_time": 0.000589,
              "start_time": "2018-02-11 14:26:56 -0500"
            },
            {
              "status": "passed",
              "code_desc": "IP filtering rules [\"xpack.security.http.filter.allow\"] should be in \"10.0.2.15\"",
              "run_time": 0.000531,
              "start_time": "2018-02-11 14:26:56 -0500"
            },
            {
              "status": "passed",
              "code_desc": "IP filtering rules [\"xpack.security.http.filter.deny\"] should eq \"_all\"",
              "run_time": 0.00047,
              "start_time": "2018-02-11 14:26:56 -0500"
            },
            {
              "status": "passed",
              "code_desc": "Cluster Setting: [\"persistent\"] should be empty",
              "run_time": 0.077446,
              "start_time": "2018-02-11 14:26:56 -0500"
            },
            {
              "status": "passed",
              "code_desc": "Cluster Setting: [\"transient\"] should be empty",
              "run_time": 0.081553,
              "start_time": "2018-02-11 14:26:56 -0500"
            }
          ]
        },
        {
          "id": "V-26688",
          "title": "Applications must support the capability to disable network protocols\ndeemed by the organizational to be nonsecure except for explicitly identified\ncomponents in support of specific operational requirements.",
          "desc": "Limit network access to Elasticsearch software from known points of\norigin with the use of software and hardware firewalls as well as X-Pack\nSecurity IP Filtering. Change the elasticsearch cluster name to an instance\nunique value for all elasticsearch nodes and all applications should use HTTP/S\n rather than Elasticsearch transport protocol.",
          "impact": 0.5,
          "refs": [],
          "tags": {
            "nist": [
              "AC-17 (8)",
              "Rev_3"
            ],
            "severity": "medium",
            "rid": "SV-33911r1_rule",
            "gtitle": "SRG-APP-000020",
            "cci": "CCI-001436",
            "check": "Check Elasticsearch.yml settings and existing IP filtering\nrules to verify that only specific IP behind hardware/software 'Managed\naccess control points' are listed.\n\nAs the application administrator (usually elasticsearch, check the\nxpack.security.http.filter setting contains IP address(es) of the  'Managed\naccess control points':\n\n$cat elasticsearch.yml | grep 'xpack.security.http.filter', Verify all three\nsettings; xpack.security.http.filter.enabled: true;\nxpack.security.http.filter.allow: 'Managed access control points';\nxpack.security.http.filter.deny: _all\n\nAs an elasticsearch administrator test; verify runtime environment within\n_culster settings are set to '{}' OR Verify all three settings are\nxpack.security.http.filter.enabled: true; xpack.security.http.filter.allow:\n'Managed access control points'; xpack.security.http.filter.deny: _all\n\n$ curl -h content_type:application-json    -XGET\n'http://<elasticsearch>:9200/_cluster/settings'\n\nIf these configuration setting are disabled, or not pointing to the 'Managed\naccess control points', this is a finding. ",
            "fix": "Note: The following instructions use the ES_HOME environment\nvariable. See supplementary content APPENDIX-XXX for\ninstructions on configuring ES_HOME.\n\nTo change the Managed access control points of the application, as the\napplication administrator, change the following setting in elasticsearch.yml:\n\n\n$ sudo su - elasticsearch\n$ vi $ES_HOME/config/elasticsearch.yml\n\nChange the Managed access control points parameter to the desired addresses,\ni.e.:\n     xpack.security.http.filter.enabled: true\n     xpack.security.http.filter.allow: 'Managed access control points'\n     xpack.security.http.filter.deny: _all\n\nNext, restart the application:\n$ sudo su - elasticsearch\n\n# SYSTEMD SERVER ONLY\n$ systemctl restart elasticsearch"
          },
          "code": "control \"V-26688\" do\n  title \"Applications must support the capability to disable network protocols\ndeemed by the organizational to be nonsecure except for explicitly identified\ncomponents in support of specific operational requirements.\"\n  desc  \"Limit network access to Elasticsearch software from known points of\norigin with the use of software and hardware firewalls as well as X-Pack\nSecurity IP Filtering. Change the elasticsearch cluster name to an instance\nunique value for all elasticsearch nodes and all applications should use HTTP/S\n rather than Elasticsearch transport protocol.\"\n  impact 0.5\n  tag \"nist\": [\"AC-17 (8)\", \"Rev_3\"]\n  tag \"severity\": \"medium\"\n  tag \"rid\": \"SV-33911r1_rule\"\n  tag \"gtitle\": \"SRG-APP-000020\"\n  tag \"cci\": \"CCI-001436\"\n  tag \"check\": \"Check Elasticsearch.yml settings and existing IP filtering\nrules to verify that only specific IP behind hardware/software 'Managed\naccess control points' are listed.\n\nAs the application administrator (usually elasticsearch, check the\nxpack.security.http.filter setting contains IP address(es) of the  'Managed\naccess control points':\n\n$cat elasticsearch.yml | grep 'xpack.security.http.filter', Verify all three\nsettings; xpack.security.http.filter.enabled: true;\nxpack.security.http.filter.allow: 'Managed access control points';\nxpack.security.http.filter.deny: _all\n\nAs an elasticsearch administrator test; verify runtime environment within\n_culster settings are set to '{}' OR Verify all three settings are\nxpack.security.http.filter.enabled: true; xpack.security.http.filter.allow:\n'Managed access control points'; xpack.security.http.filter.deny: _all\n\n$ curl -h content_type:application-json    -XGET\n'http://<elasticsearch>:9200/_cluster/settings'\n\nIf these configuration setting are disabled, or not pointing to the 'Managed\naccess control points', this is a finding. \"\n  tag \"fix\": \"Note: The following instructions use the ES_HOME environment\nvariable. See supplementary content APPENDIX-XXX for\ninstructions on configuring ES_HOME.\n\nTo change the Managed access control points of the application, as the\napplication administrator, change the following setting in elasticsearch.yml:\n\n\n$ sudo su - elasticsearch\n$ vi $ES_HOME/config/elasticsearch.yml\n\nChange the Managed access control points parameter to the desired addresses,\ni.e.:\n     xpack.security.http.filter.enabled: true\n     xpack.security.http.filter.allow: 'Managed access control points'\n     xpack.security.http.filter.deny: _all\n\nNext, restart the application:\n$ sudo su - elasticsearch\n\n# SYSTEMD SERVER ONLY\n$ systemctl restart elasticsearch\"\n  begin\n\n    es_handle = es_helper(url:\"https://#{ELASTIC_IP}:#{ELASTIC_PORT}\",\n                    username: ES_ADMIN,\n                    password: ES_PASS,\n                    ssl_verify: SSL_VERIFY )\n\n    describe \"No nodes found\" do\n      subject { es_handle.nodes.nil? }\n      it { should_not be_truthy }\n    end if es_handle.nodes.nil?\n\n\n    es_handle.nodes.each do |node|\n      describe \"IP filtering rules for Node: #{node.name}\" do\n        subject { node.ip_filter }\n        its('enabled') { should eq 'true' }\n        its('allow')  { should be_in MANAGED_ACCESS_POINTS }\n        its('deny') { should eq '_all' }\n      end\n    end unless es_handle.nodes.nil?\n\n    describe \"IP filtering rules\" do\n      subject { yaml(ELASTICSEARCH_CONF) }\n      its(['xpack.security.http.filter.enabled']) { should eq true }\n      its(['xpack.security.http.filter.allow']) { should be_in MANAGED_ACCESS_POINTS }\n      its(['xpack.security.http.filter.deny']) { should eq '_all' }\n    end\n\n    describe \"Cluster Setting:\" do\n      subject{ es_handle.cluster_settings }\n      its(['persistent']) { should be_empty }\n      its(['transient']) { should be_empty }\n    end\n\n  rescue Exception => msg\n    describe \"Exception: #{msg}\" do\n      it { should be_nil}\n    end\n  end\nend\n",
          "source_location": {
            "line": 45,
            "ref": "../elasticsearch-inspec/controls/ip_fil/V-26688.rb"
          },
          "results": [
            {
              "status": "passed",
              "code_desc": "IP filtering rules for Node: package-centos-72 enabled should eq \"true\"",
              "run_time": 0.000131,
              "start_time": "2018-02-11 14:26:56 -0500"
            },
            {
              "status": "passed",
              "code_desc": "IP filtering rules for Node: package-centos-72 allow should be in \"10.0.2.15\"",
              "run_time": 0.000124,
              "start_time": "2018-02-11 14:26:56 -0500"
            },
            {
              "status": "passed",
              "code_desc": "IP filtering rules for Node: package-centos-72 deny should eq \"_all\"",
              "run_time": 0.000082,
              "start_time": "2018-02-11 14:26:56 -0500"
            },
            {
              "status": "passed",
              "code_desc": "IP filtering rules [\"xpack.security.http.filter.enabled\"] should eq true",
              "run_time": 0.000555,
              "start_time": "2018-02-11 14:26:56 -0500"
            },
            {
              "status": "passed",
              "code_desc": "IP filtering rules [\"xpack.security.http.filter.allow\"] should be in \"10.0.2.15\"",
              "run_time": 0.000515,
              "start_time": "2018-02-11 14:26:56 -0500"
            },
            {
              "status": "passed",
              "code_desc": "IP filtering rules [\"xpack.security.http.filter.deny\"] should eq \"_all\"",
              "run_time": 0.000475,
              "start_time": "2018-02-11 14:26:56 -0500"
            },
            {
              "status": "passed",
              "code_desc": "Cluster Setting: [\"persistent\"] should be empty",
              "run_time": 0.073711,
              "start_time": "2018-02-11 14:26:56 -0500"
            },
            {
              "status": "passed",
              "code_desc": "Cluster Setting: [\"transient\"] should be empty",
              "run_time": 0.078367,
              "start_time": "2018-02-11 14:26:56 -0500"
            }
          ]
        },
        {
          "id": "V-26687",
          "title": "The application must ensure remote sessions for accessing an\norganizational-defined list of security functions and security-relevant\ninformation are audited.",
          "desc": "Utilize perimeter, application, centralized authentication, and\nrepository audit controls to audit the use of systems in real time with\nsufficient context.  X-Pack Security audit controls should be enabled to audit\nthe defaults of all HTTP/S based access to Elasticsearch.  All applications\nshould use HTTP/S  rather than Elasticsearch transport protocol.",
          "impact": 0.5,
          "refs": [],
          "tags": {
            "nist": [
              "AC-17 (7)",
              "Rev_3"
            ],
            "severity": "medium",
            "rid": "SV-33910r1_rule",
            "gtitle": "SRG-APP-000019",
            "cci": "CCI-001454",
            "check": "Check Elasticsearch.yml settings and existing IP filtering\nrules to verify that only specific IP behind hardware/software 'Managed\naccess control points' are listed.\n\nAs the application administrator (usually elasticsearch, check the\nxpack.security.http.filter setting contains IP address(es) of the  'Managed\naccess control points':\n\n$cat elasticsearch.yml | grep 'xpack.security.http.filter', Verify all three\nsettings; xpack.security.http.filter.enabled: true;\nxpack.security.http.filter.allow: 'Managed access control points';\nxpack.security.http.filter.deny: _all\n\nAs an elasticsearch administrator test; verify runtime environment within\n_culster settings are set to '{}' OR Verify all three settings are\nxpack.security.http.filter.enabled: true; xpack.security.http.filter.allow:\n'Managed access control points'; xpack.security.http.filter.deny: _all\n\n$ curl -h content_type:application-json    -XGET\n'http://<elasticsearch>:9200/_cluster/settings'\n\nIf these configuration setting are disabled, or not pointing to the 'Managed\naccess control points', this is a finding. ",
            "fix": "Note: The following instructions use the ES_HOME environment\nvariable. See supplementary content APPENDIX-XXX for\ninstructions on configuring ES_HOME.\n\nTo change the Managed access control points of the application, as the\napplication administrator, change the following setting in elasticsearch.yml:\n\n\n$ sudo su - elasticsearch\n$ vi $ES_HOME/config/elasticsearch.yml\n\nChange the Managed access control points parameter to the desired addresses,\ni.e.:\n     xpack.security.http.filter.enabled: true\n     xpack.security.http.filter.allow: 'Managed access control points'\n     xpack.security.http.filter.deny: _all\n\nNext, restart the application:\n$ sudo su - elasticsearch\n\n# SYSTEMD SERVER ONLY\n$ systemctl restart elasticsearch"
          },
          "code": "control \"V-26687\" do\n  title \"The application must ensure remote sessions for accessing an\norganizational-defined list of security functions and security-relevant\ninformation are audited.\"\n  desc  \"Utilize perimeter, application, centralized authentication, and\nrepository audit controls to audit the use of systems in real time with\nsufficient context.  X-Pack Security audit controls should be enabled to audit\nthe defaults of all HTTP/S based access to Elasticsearch.  All applications\nshould use HTTP/S  rather than Elasticsearch transport protocol.\"\n  impact 0.5\n  tag \"nist\": [\"AC-17 (7)\", \"Rev_3\"]\n  tag \"severity\": \"medium\"\n  tag \"rid\": \"SV-33910r1_rule\"\n  tag \"gtitle\": \"SRG-APP-000019\"\n  tag \"cci\": \"CCI-001454\"\n  tag \"check\": \"Check Elasticsearch.yml settings and existing IP filtering\nrules to verify that only specific IP behind hardware/software 'Managed\naccess control points' are listed.\n\nAs the application administrator (usually elasticsearch, check the\nxpack.security.http.filter setting contains IP address(es) of the  'Managed\naccess control points':\n\n$cat elasticsearch.yml | grep 'xpack.security.http.filter', Verify all three\nsettings; xpack.security.http.filter.enabled: true;\nxpack.security.http.filter.allow: 'Managed access control points';\nxpack.security.http.filter.deny: _all\n\nAs an elasticsearch administrator test; verify runtime environment within\n_culster settings are set to '{}' OR Verify all three settings are\nxpack.security.http.filter.enabled: true; xpack.security.http.filter.allow:\n'Managed access control points'; xpack.security.http.filter.deny: _all\n\n$ curl -h content_type:application-json    -XGET\n'http://<elasticsearch>:9200/_cluster/settings'\n\nIf these configuration setting are disabled, or not pointing to the 'Managed\naccess control points', this is a finding. \"\n  tag \"fix\": \"Note: The following instructions use the ES_HOME environment\nvariable. See supplementary content APPENDIX-XXX for\ninstructions on configuring ES_HOME.\n\nTo change the Managed access control points of the application, as the\napplication administrator, change the following setting in elasticsearch.yml:\n\n\n$ sudo su - elasticsearch\n$ vi $ES_HOME/config/elasticsearch.yml\n\nChange the Managed access control points parameter to the desired addresses,\ni.e.:\n     xpack.security.http.filter.enabled: true\n     xpack.security.http.filter.allow: 'Managed access control points'\n     xpack.security.http.filter.deny: _all\n\nNext, restart the application:\n$ sudo su - elasticsearch\n\n# SYSTEMD SERVER ONLY\n$ systemctl restart elasticsearch\"\n\n  begin\n\n    es_handle = es_helper(url:\"https://#{ELASTIC_IP}:#{ELASTIC_PORT}\",\n                    username: ES_ADMIN,\n                    password: ES_PASS,\n                    ssl_verify: SSL_VERIFY )\n\n    describe \"No nodes found\" do\n      subject { es_handle.nodes.nil? }\n      it { should_not be_truthy }\n    end if es_handle.nodes.nil?\n\n\n    es_handle.nodes.each do |node|\n      describe \"IP filtering rules for Node: #{node.name}\" do\n        subject { node.ip_filter }\n        its('enabled') { should eq 'true' }\n        its('allow')  { should be_in MANAGED_ACCESS_POINTS }\n        its('deny') { should eq '_all' }\n      end\n    end unless es_handle.nodes.nil?\n\n    describe \"IP filtering rules\" do\n      subject { yaml(ELASTICSEARCH_CONF) }\n      its(['xpack.security.http.filter.enabled']) { should eq true }\n      its(['xpack.security.http.filter.allow']) { should be_in MANAGED_ACCESS_POINTS }\n      its(['xpack.security.http.filter.deny']) { should eq '_all' }\n    end\n\n    describe \"Cluster Setting:\" do\n      subject{ es_handle.cluster_settings }\n      its(['persistent']) { should be_empty }\n      its(['transient']) { should be_empty }\n    end\n\n  rescue Exception => msg\n    describe \"Exception: #{msg}\" do\n      it { should be_nil}\n    end\n  end\nend",
          "source_location": {
            "line": 45,
            "ref": "../elasticsearch-inspec/controls/ip_fil/V-26687.rb"
          },
          "results": [
            {
              "status": "passed",
              "code_desc": "IP filtering rules for Node: package-centos-72 enabled should eq \"true\"",
              "run_time": 0.000138,
              "start_time": "2018-02-11 14:26:56 -0500"
            },
            {
              "status": "passed",
              "code_desc": "IP filtering rules for Node: package-centos-72 allow should be in \"10.0.2.15\"",
              "run_time": 0.00013,
              "start_time": "2018-02-11 14:26:56 -0500"
            },
            {
              "status": "passed",
              "code_desc": "IP filtering rules for Node: package-centos-72 deny should eq \"_all\"",
              "run_time": 0.000076,
              "start_time": "2018-02-11 14:26:56 -0500"
            },
            {
              "status": "passed",
              "code_desc": "IP filtering rules [\"xpack.security.http.filter.enabled\"] should eq true",
              "run_time": 0.000658,
              "start_time": "2018-02-11 14:26:56 -0500"
            },
            {
              "status": "passed",
              "code_desc": "IP filtering rules [\"xpack.security.http.filter.allow\"] should be in \"10.0.2.15\"",
              "run_time": 0.000589,
              "start_time": "2018-02-11 14:26:56 -0500"
            },
            {
              "status": "passed",
              "code_desc": "IP filtering rules [\"xpack.security.http.filter.deny\"] should eq \"_all\"",
              "run_time": 0.000545,
              "start_time": "2018-02-11 14:26:56 -0500"
            },
            {
              "status": "passed",
              "code_desc": "Cluster Setting: [\"persistent\"] should be empty",
              "run_time": 0.073449,
              "start_time": "2018-02-11 14:26:56 -0500"
            },
            {
              "status": "passed",
              "code_desc": "Cluster Setting: [\"transient\"] should be empty",
              "run_time": 0.074166,
              "start_time": "2018-02-11 14:26:56 -0500"
            }
          ]
        },
        {
          "id": "V-27035",
          "title": "Applications must not share resources used to interface with systems\noperating at different security levels.",
          "desc": "Limit network access to Elasticsearch software from known points of\norigin with the use of software and hardware firewalls as well as X-Pack\nSecurity IP Filtering. Change the elasticsearch cluster name to an instance\nunique value for all elasticsearch nodes and transport client nodes in the\nsystem.",
          "impact": 0.5,
          "refs": [],
          "tags": {
            "nist": [
              "SC-4 (1)",
              "Rev_3"
            ],
            "severity": "medium",
            "rid": "SV-34329r1_rule",
            "gtitle": "SRG-APP-000244",
            "cci": "CCI-001091",
            "check": "Check Elasticsearch.yml settings and existing IP filtering\nrules to verify that only specific IP behind hardware/software 'Managed\naccess control points' are listed.\n\nAs the application administrator (usually elasticsearch, check the\nxpack.security.http.filter setting contains IP address(es) of the  'Managed\naccess control points':\n\n$cat elasticsearch.yml | grep 'xpack.security.http.filter', Verify all three\nsettings; xpack.security.http.filter.enabled: true;\nxpack.security.http.filter.allow: 'Managed access control points';\nxpack.security.http.filter.deny: _all\n\nAs an elasticsearch administrator test; verify runtime environment within\n_culster settings are set to '{}' OR Verify all three settings are\nxpack.security.http.filter.enabled: true; xpack.security.http.filter.allow:\n'Managed access control points'; xpack.security.http.filter.deny: _all\n\n$curl -H 'Content-Type: application/json' -u <TEST_USER> -p <TEST_CREDENTIALS>\n -XGET 'http://<elasticsearch>:9200/_cluster/settings'\n\nIf these configuration setting are disabled, or not pointing to the 'Managed\naccess control points', this is a finding. ",
            "fix": "Note: The following instructions use the ES_HOME environment\nvariable. See supplementary content APPENDIX-XXX for\ninstructions on configuring ES_HOME.\n\nTo change the Managed access control points of the application, as the\napplication administrator, change the following setting in elasticsearch.yml:\n\n\n$ sudo su - elasticsearch\n$ vi $ES_HOME/config/elasticsearch.yml\n\nChange the Managed access control points parameter to the desired addresses,\ni.e.:\n     xpack.security.http.filter.enabled: true\n     xpack.security.http.filter.allow: 'Managed access control points'\n     xpack.security.http.filter.deny: _all\n\nNext, restart the application:\n$ sudo su - elasticsearch\n\n# SYSTEMD SERVER ONLY\n$ systemctl restart elasticsearch"
          },
          "code": "control \"V-27035\" do\n  title \"Applications must not share resources used to interface with systems\noperating at different security levels.\"\n  desc  \"Limit network access to Elasticsearch software from known points of\norigin with the use of software and hardware firewalls as well as X-Pack\nSecurity IP Filtering. Change the elasticsearch cluster name to an instance\nunique value for all elasticsearch nodes and transport client nodes in the\nsystem.\"\n  impact 0.5\n  tag \"nist\": [\"SC-4 (1)\", \"Rev_3\"]\n  tag \"severity\": \"medium\"\n  tag \"rid\": \"SV-34329r1_rule\"\n  tag \"gtitle\": \"SRG-APP-000244\"\n  tag \"cci\": \"CCI-001091\"\n  tag \"check\": \"Check Elasticsearch.yml settings and existing IP filtering\nrules to verify that only specific IP behind hardware/software 'Managed\naccess control points' are listed.\n\nAs the application administrator (usually elasticsearch, check the\nxpack.security.http.filter setting contains IP address(es) of the  'Managed\naccess control points':\n\n$cat elasticsearch.yml | grep 'xpack.security.http.filter', Verify all three\nsettings; xpack.security.http.filter.enabled: true;\nxpack.security.http.filter.allow: 'Managed access control points';\nxpack.security.http.filter.deny: _all\n\nAs an elasticsearch administrator test; verify runtime environment within\n_culster settings are set to '{}' OR Verify all three settings are\nxpack.security.http.filter.enabled: true; xpack.security.http.filter.allow:\n'Managed access control points'; xpack.security.http.filter.deny: _all\n\n$curl -H 'Content-Type: application/json' -u <TEST_USER> -p <TEST_CREDENTIALS>\n -XGET 'http://<elasticsearch>:9200/_cluster/settings'\n\nIf these configuration setting are disabled, or not pointing to the 'Managed\naccess control points', this is a finding. \"\n  tag \"fix\": \"Note: The following instructions use the ES_HOME environment\nvariable. See supplementary content APPENDIX-XXX for\ninstructions on configuring ES_HOME.\n\nTo change the Managed access control points of the application, as the\napplication administrator, change the following setting in elasticsearch.yml:\n\n\n$ sudo su - elasticsearch\n$ vi $ES_HOME/config/elasticsearch.yml\n\nChange the Managed access control points parameter to the desired addresses,\ni.e.:\n     xpack.security.http.filter.enabled: true\n     xpack.security.http.filter.allow: 'Managed access control points'\n     xpack.security.http.filter.deny: _all\n\nNext, restart the application:\n$ sudo su - elasticsearch\n\n# SYSTEMD SERVER ONLY\n$ systemctl restart elasticsearch\"\n\n  begin\n\n    es_handle = es_helper(url:\"https://#{ELASTIC_IP}:#{ELASTIC_PORT}\",\n                    username: ES_ADMIN,\n                    password: ES_PASS,\n                    ssl_verify: SSL_VERIFY )\n\n    describe \"No nodes found\" do\n      subject { es_handle.nodes.nil? }\n      it { should_not be_truthy }\n    end if es_handle.nodes.nil?\n\n\n    es_handle.nodes.each do |node|\n      describe \"IP filtering rules for Node: #{node.name}\" do\n        subject { node.ip_filter }\n        its('enabled') { should eq 'true' }\n        its('allow')  { should be_in MANAGED_ACCESS_POINTS }\n        its('deny') { should eq '_all' }\n      end\n    end unless es_handle.nodes.nil?\n\n    describe \"IP filtering rules\" do\n      subject { yaml(ELASTICSEARCH_CONF) }\n      its(['xpack.security.http.filter.enabled']) { should eq true }\n      its(['xpack.security.http.filter.allow']) { should be_in MANAGED_ACCESS_POINTS }\n      its(['xpack.security.http.filter.deny']) { should eq '_all' }\n    end\n\n    describe \"Cluster Setting:\" do\n      subject{ es_handle.cluster_settings }\n      its(['persistent']) { should be_empty }\n      its(['transient']) { should be_empty }\n    end\n\n  rescue Exception => msg\n    describe \"Exception: #{msg}\" do\n      it { should be_nil}\n    end\n  end\nend",
          "source_location": {
            "line": 52,
            "ref": "../elasticsearch-inspec/controls/ip_fil/V-27035.rb"
          },
          "results": [
            {
              "status": "passed",
              "code_desc": "IP filtering rules for Node: package-centos-72 enabled should eq \"true\"",
              "run_time": 0.00012,
              "start_time": "2018-02-11 14:26:56 -0500"
            },
            {
              "status": "passed",
              "code_desc": "IP filtering rules for Node: package-centos-72 allow should be in \"10.0.2.15\"",
              "run_time": 0.000131,
              "start_time": "2018-02-11 14:26:56 -0500"
            },
            {
              "status": "passed",
              "code_desc": "IP filtering rules for Node: package-centos-72 deny should eq \"_all\"",
              "run_time": 0.000082,
              "start_time": "2018-02-11 14:26:56 -0500"
            },
            {
              "status": "passed",
              "code_desc": "IP filtering rules [\"xpack.security.http.filter.enabled\"] should eq true",
              "run_time": 0.000556,
              "start_time": "2018-02-11 14:26:56 -0500"
            },
            {
              "status": "passed",
              "code_desc": "IP filtering rules [\"xpack.security.http.filter.allow\"] should be in \"10.0.2.15\"",
              "run_time": 0.000539,
              "start_time": "2018-02-11 14:26:56 -0500"
            },
            {
              "status": "passed",
              "code_desc": "IP filtering rules [\"xpack.security.http.filter.deny\"] should eq \"_all\"",
              "run_time": 0.000482,
              "start_time": "2018-02-11 14:26:56 -0500"
            },
            {
              "status": "passed",
              "code_desc": "Cluster Setting: [\"persistent\"] should be empty",
              "run_time": 0.073639,
              "start_time": "2018-02-11 14:26:56 -0500"
            },
            {
              "status": "passed",
              "code_desc": "Cluster Setting: [\"transient\"] should be empty",
              "run_time": 0.090539,
              "start_time": "2018-02-11 14:26:56 -0500"
            }
          ]
        },
        {
          "id": "V-26775",
          "title": "Applications must uniquely identify source domains for information\ntransfer.",
          "desc": "Limit network access to Elasticsearch software from known points of\norigin with the use of software and hardware firewalls as well as X-Pack\nSecurity IP Filtering. Change the elasticsearch cluster name to an instance\nunique value for all elasticsearch nodes and transport client nodes in the\nsystem.",
          "impact": 0.5,
          "refs": [],
          "tags": {
            "nist": [
              "AC-4 (17) (a)",
              "Rev_3"
            ],
            "severity": "medium",
            "rid": "SV-34025r1_rule",
            "gtitle": "SRG-APP-000049",
            "cci": "CCI-001376",
            "check": "Check Elasticsearch.yml settings and existing IP filtering\nrules to verify that only specific IP behind hardware/software 'Managed\naccess control points' are listed.\n\nAs the application administrator (usually elasticsearch, check the\nxpack.security.http.filter setting contains IP address(es) of the  'Managed\naccess control points':\n\n$cat elasticsearch.yml | grep 'xpack.security.http.filter', Verify all three\nsettings; xpack.security.http.filter.enabled: true;\nxpack.security.http.filter.allow: 'Managed access control points';\nxpack.security.http.filter.deny: _all\n\nAs an elasticsearch administrator test; verify runtime environment within\n_culster settings are set to '{}' OR Verify all three settings are\nxpack.security.http.filter.enabled: true; xpack.security.http.filter.allow:\n'Managed access control points'; xpack.security.http.filter.deny: _all\n\n$ curl -h content_type:application/json    -XGET\n'http://<elasticsearch>:9200/_cluster/settings'\n\nIf these configuration setting are disabled, or not pointing to the 'Managed\naccess control points', this is a finding. ",
            "fix": "Note: The following instructions use the ES_HOME environment\nvariable. See supplementary content APPENDIX-XXX for\ninstructions on configuring ES_HOME.\n\nTo change the Managed access control points of the application, as the\napplication administrator, change the following setting in elasticsearch.yml:\n\n\n$ sudo su - elasticsearch\n$ vi $ES_HOME/config/elasticsearch.yml\n\nChange the Managed access control points parameter to the desired addresses,\ni.e.:\n     xpack.security.http.filter.enabled: true\n     xpack.security.http.filter.allow: 'Managed access control points'\n     xpack.security.http.filter.deny: _all\n\nNext, restart the application:\n$ sudo su - elasticsearch\n\n# SYSTEMD SERVER ONLY\n$ systemctl restart elasticsearch"
          },
          "code": "control \"V-26775\" do\n  title \"Applications must uniquely identify source domains for information\ntransfer.\"\n  desc  \"Limit network access to Elasticsearch software from known points of\norigin with the use of software and hardware firewalls as well as X-Pack\nSecurity IP Filtering. Change the elasticsearch cluster name to an instance\nunique value for all elasticsearch nodes and transport client nodes in the\nsystem.\"\n  impact 0.5\n  tag \"nist\": [\"AC-4 (17) (a)\", \"Rev_3\"]\n  tag \"severity\": \"medium\"\n  tag \"rid\": \"SV-34025r1_rule\"\n  tag \"gtitle\": \"SRG-APP-000049\"\n  tag \"cci\": \"CCI-001376\"\n  tag \"check\": \"Check Elasticsearch.yml settings and existing IP filtering\nrules to verify that only specific IP behind hardware/software 'Managed\naccess control points' are listed.\n\nAs the application administrator (usually elasticsearch, check the\nxpack.security.http.filter setting contains IP address(es) of the  'Managed\naccess control points':\n\n$cat elasticsearch.yml | grep 'xpack.security.http.filter', Verify all three\nsettings; xpack.security.http.filter.enabled: true;\nxpack.security.http.filter.allow: 'Managed access control points';\nxpack.security.http.filter.deny: _all\n\nAs an elasticsearch administrator test; verify runtime environment within\n_culster settings are set to '{}' OR Verify all three settings are\nxpack.security.http.filter.enabled: true; xpack.security.http.filter.allow:\n'Managed access control points'; xpack.security.http.filter.deny: _all\n\n$ curl -h content_type:application/json    -XGET\n'http://<elasticsearch>:9200/_cluster/settings'\n\nIf these configuration setting are disabled, or not pointing to the 'Managed\naccess control points', this is a finding. \"\n  tag \"fix\": \"Note: The following instructions use the ES_HOME environment\nvariable. See supplementary content APPENDIX-XXX for\ninstructions on configuring ES_HOME.\n\nTo change the Managed access control points of the application, as the\napplication administrator, change the following setting in elasticsearch.yml:\n\n\n$ sudo su - elasticsearch\n$ vi $ES_HOME/config/elasticsearch.yml\n\nChange the Managed access control points parameter to the desired addresses,\ni.e.:\n     xpack.security.http.filter.enabled: true\n     xpack.security.http.filter.allow: 'Managed access control points'\n     xpack.security.http.filter.deny: _all\n\nNext, restart the application:\n$ sudo su - elasticsearch\n\n# SYSTEMD SERVER ONLY\n$ systemctl restart elasticsearch\"\n\n  begin\n\n    es_handle = es_helper(url:\"https://#{ELASTIC_IP}:#{ELASTIC_PORT}\",\n                    username: ES_ADMIN,\n                    password: ES_PASS,\n                    ssl_verify: SSL_VERIFY )\n\n    describe \"No nodes found\" do\n      subject { es_handle.nodes.nil? }\n      it { should_not be_truthy }\n    end if es_handle.nodes.nil?\n\n\n    es_handle.nodes.each do |node|\n      describe \"IP filtering rules for Node: #{node.name}\" do\n        subject { node.ip_filter }\n        its('enabled') { should eq 'true' }\n        its('allow')  { should be_in MANAGED_ACCESS_POINTS }\n        its('deny') { should eq '_all' }\n      end\n    end unless es_handle.nodes.nil?\n\n    describe \"IP filtering rules\" do\n      subject { yaml(ELASTICSEARCH_CONF) }\n      its(['xpack.security.http.filter.enabled']) { should eq true }\n      its(['xpack.security.http.filter.allow']) { should be_in MANAGED_ACCESS_POINTS }\n      its(['xpack.security.http.filter.deny']) { should eq '_all' }\n    end\n\n    describe \"Cluster Setting:\" do\n      subject{ es_handle.cluster_settings }\n      its(['persistent']) { should be_empty }\n      its(['transient']) { should be_empty }\n    end\n\n  rescue Exception => msg\n    describe \"Exception: #{msg}\" do\n      it { should be_nil}\n    end\n  end\nend\n",
          "source_location": {
            "line": 46,
            "ref": "../elasticsearch-inspec/controls/ip_fil/V-26775.rb"
          },
          "results": [
            {
              "status": "passed",
              "code_desc": "IP filtering rules for Node: package-centos-72 enabled should eq \"true\"",
              "run_time": 0.000171,
              "start_time": "2018-02-11 14:26:57 -0500"
            },
            {
              "status": "passed",
              "code_desc": "IP filtering rules for Node: package-centos-72 allow should be in \"10.0.2.15\"",
              "run_time": 0.000213,
              "start_time": "2018-02-11 14:26:57 -0500"
            },
            {
              "status": "passed",
              "code_desc": "IP filtering rules for Node: package-centos-72 deny should eq \"_all\"",
              "run_time": 0.000149,
              "start_time": "2018-02-11 14:26:57 -0500"
            },
            {
              "status": "passed",
              "code_desc": "IP filtering rules [\"xpack.security.http.filter.enabled\"] should eq true",
              "run_time": 0.001033,
              "start_time": "2018-02-11 14:26:57 -0500"
            },
            {
              "status": "passed",
              "code_desc": "IP filtering rules [\"xpack.security.http.filter.allow\"] should be in \"10.0.2.15\"",
              "run_time": 0.000975,
              "start_time": "2018-02-11 14:26:57 -0500"
            },
            {
              "status": "passed",
              "code_desc": "IP filtering rules [\"xpack.security.http.filter.deny\"] should eq \"_all\"",
              "run_time": 0.000921,
              "start_time": "2018-02-11 14:26:57 -0500"
            },
            {
              "status": "passed",
              "code_desc": "Cluster Setting: [\"persistent\"] should be empty",
              "run_time": 0.096187,
              "start_time": "2018-02-11 14:26:57 -0500"
            },
            {
              "status": "passed",
              "code_desc": "Cluster Setting: [\"transient\"] should be empty",
              "run_time": 0.071532,
              "start_time": "2018-02-11 14:26:57 -0500"
            }
          ]
        },
        {
          "id": "V-26786",
          "title": "Applications must enforce information flow control using protected\nprocessing domains (e.g., domain type-enforcement) as a basis for flow control\ndecisions.",
          "desc": "Limit network access to Elasticsearch software from known points of\norigin with the use of software and hardware firewalls as well as X-Pack\nSecurity IP Filtering. Change the elasticsearch cluster name to an instance\nunique value for all elasticsearch nodes and transport client nodes in the\nsystem.",
          "impact": 0.5,
          "refs": [],
          "tags": {
            "nist": [
              "AC-4 (2)",
              "Rev_4"
            ],
            "severity": "medium",
            "rid": "SV-34036r1_rule",
            "gtitle": "SRG-APP-000054",
            "cci": "CCI-000026",
            "check": "Check Elasticsearch.yml settings and existing IP filtering\nrules to verify that only specific IP behind hardware/software 'Managed\naccess control points' are listed.\n\nAs the application administrator (usually elasticsearch, check the\nxpack.security.http.filter setting contains IP address(es) of the  'Managed\naccess control points':\n\n$cat elasticsearch.yml | grep 'xpack.security.http.filter', Verify all three\nsettings; xpack.security.http.filter.enabled: true;\nxpack.security.http.filter.allow: 'Managed access control points';\nxpack.security.http.filter.deny: _all\n\nAs an elasticsearch administrator test; verify runtime environment within\n_culster settings are set to '{}' OR Verify all three settings are\nxpack.security.http.filter.enabled: true; xpack.security.http.filter.allow:\n'Managed access control points'; xpack.security.http.filter.deny: _all\n\n$curl -H 'Content-Type: application/json' -u <TEST_USER> -p <TEST_CREDENTIALS>\n-XGET 'http://<elasticsearch>:9200/_cluster/settings'\n\nIf these configuration setting are disabled, or not pointing to the 'Managed\naccess control points', this is a finding. ",
            "fix": "Note: The following instructions use the ES_HOME environment\nvariable. See supplementary content APPENDIX-XXX for\ninstructions on configuring ES_HOME.\n\nTo change the Managed access control points of the application, as the\napplication administrator, change the following setting in elasticsearch.yml:\n\n\n$ sudo su - elasticsearch\n$ vi $ES_HOME/config/elasticsearch.yml\n\nChange the Managed access control points parameter to the desired addresses,\ni.e.:\n     xpack.security.http.filter.enabled: true\n     xpack.security.http.filter.allow: 'Managed access control points'\n     xpack.security.http.filter.deny: _all\n\nNext, restart the application:\n$ sudo su - elasticsearch\n\n# SYSTEMD SERVER ONLY\n$ systemctl restart elasticsearch"
          },
          "code": "control \"V-26786\" do\n  title \"Applications must enforce information flow control using protected\nprocessing domains (e.g., domain type-enforcement) as a basis for flow control\ndecisions.\"\n  desc  \"Limit network access to Elasticsearch software from known points of\norigin with the use of software and hardware firewalls as well as X-Pack\nSecurity IP Filtering. Change the elasticsearch cluster name to an instance\nunique value for all elasticsearch nodes and transport client nodes in the\nsystem.\"\n  impact 0.5\n  tag \"nist\": [\"AC-4 (2)\", \"Rev_4\"]\n  tag \"severity\": \"medium\"\n  tag \"rid\": \"SV-34036r1_rule\"\n  tag \"gtitle\": \"SRG-APP-000054\"\n  tag \"cci\": \"CCI-000026\"\n  tag \"check\": \"Check Elasticsearch.yml settings and existing IP filtering\nrules to verify that only specific IP behind hardware/software 'Managed\naccess control points' are listed.\n\nAs the application administrator (usually elasticsearch, check the\nxpack.security.http.filter setting contains IP address(es) of the  'Managed\naccess control points':\n\n$cat elasticsearch.yml | grep 'xpack.security.http.filter', Verify all three\nsettings; xpack.security.http.filter.enabled: true;\nxpack.security.http.filter.allow: 'Managed access control points';\nxpack.security.http.filter.deny: _all\n\nAs an elasticsearch administrator test; verify runtime environment within\n_culster settings are set to '{}' OR Verify all three settings are\nxpack.security.http.filter.enabled: true; xpack.security.http.filter.allow:\n'Managed access control points'; xpack.security.http.filter.deny: _all\n\n$curl -H 'Content-Type: application/json' -u <TEST_USER> -p <TEST_CREDENTIALS>\n-XGET 'http://<elasticsearch>:9200/_cluster/settings'\n\nIf these configuration setting are disabled, or not pointing to the 'Managed\naccess control points', this is a finding. \"\n  tag \"fix\": \"Note: The following instructions use the ES_HOME environment\nvariable. See supplementary content APPENDIX-XXX for\ninstructions on configuring ES_HOME.\n\nTo change the Managed access control points of the application, as the\napplication administrator, change the following setting in elasticsearch.yml:\n\n\n$ sudo su - elasticsearch\n$ vi $ES_HOME/config/elasticsearch.yml\n\nChange the Managed access control points parameter to the desired addresses,\ni.e.:\n     xpack.security.http.filter.enabled: true\n     xpack.security.http.filter.allow: 'Managed access control points'\n     xpack.security.http.filter.deny: _all\n\nNext, restart the application:\n$ sudo su - elasticsearch\n\n# SYSTEMD SERVER ONLY\n$ systemctl restart elasticsearch\"\n\n  begin\n\n    es_handle = es_helper(url:\"https://#{ELASTIC_IP}:#{ELASTIC_PORT}\",\n                    username: ES_ADMIN,\n                    password: ES_PASS,\n                    ssl_verify: SSL_VERIFY )\n\n    describe \"No nodes found\" do\n      subject { es_handle.nodes.nil? }\n      it { should_not be_truthy }\n    end if es_handle.nodes.nil?\n\n\n    es_handle.nodes.each do |node|\n      describe \"IP filtering rules for Node: #{node.name}\" do\n        subject { node.ip_filter }\n        its('enabled') { should eq 'true' }\n        its('allow')  { should be_in MANAGED_ACCESS_POINTS }\n        its('deny') { should eq '_all' }\n      end\n    end unless es_handle.nodes.nil?\n\n    describe \"IP filtering rules\" do\n      subject { yaml(ELASTICSEARCH_CONF) }\n      its(['xpack.security.http.filter.enabled']) { should eq true }\n      its(['xpack.security.http.filter.allow']) { should be_in MANAGED_ACCESS_POINTS }\n      its(['xpack.security.http.filter.deny']) { should eq '_all' }\n    end\n\n    describe \"Cluster Setting:\" do\n      subject{ es_handle.cluster_settings }\n      its(['persistent']) { should be_empty }\n      its(['transient']) { should be_empty }\n    end\n\n  rescue Exception => msg\n    describe \"Exception: #{msg}\" do\n      it { should be_nil}\n    end\n  end\nend\n",
          "source_location": {
            "line": 45,
            "ref": "../elasticsearch-inspec/controls/ip_fil/V-26786.rb"
          },
          "results": [
            {
              "status": "passed",
              "code_desc": "IP filtering rules for Node: package-centos-72 enabled should eq \"true\"",
              "run_time": 0.000125,
              "start_time": "2018-02-11 14:26:57 -0500"
            },
            {
              "status": "passed",
              "code_desc": "IP filtering rules for Node: package-centos-72 allow should be in \"10.0.2.15\"",
              "run_time": 0.000125,
              "start_time": "2018-02-11 14:26:57 -0500"
            },
            {
              "status": "passed",
              "code_desc": "IP filtering rules for Node: package-centos-72 deny should eq \"_all\"",
              "run_time": 0.000073,
              "start_time": "2018-02-11 14:26:57 -0500"
            },
            {
              "status": "passed",
              "code_desc": "IP filtering rules [\"xpack.security.http.filter.enabled\"] should eq true",
              "run_time": 0.000586,
              "start_time": "2018-02-11 14:26:57 -0500"
            },
            {
              "status": "passed",
              "code_desc": "IP filtering rules [\"xpack.security.http.filter.allow\"] should be in \"10.0.2.15\"",
              "run_time": 0.000539,
              "start_time": "2018-02-11 14:26:57 -0500"
            },
            {
              "status": "passed",
              "code_desc": "IP filtering rules [\"xpack.security.http.filter.deny\"] should eq \"_all\"",
              "run_time": 0.00047,
              "start_time": "2018-02-11 14:26:57 -0500"
            },
            {
              "status": "passed",
              "code_desc": "Cluster Setting: [\"persistent\"] should be empty",
              "run_time": 0.06905,
              "start_time": "2018-02-11 14:26:57 -0500"
            },
            {
              "status": "passed",
              "code_desc": "Cluster Setting: [\"transient\"] should be empty",
              "run_time": 0.070981,
              "start_time": "2018-02-11 14:26:57 -0500"
            }
          ]
        },
        {
          "id": "V-26962",
          "title": "The application must support the organizational requirements to\nspecifically prohibit or restrict the use of unauthorized functions, ports,\nprotocols, and/or services.",
          "desc": "Configure Elasticsearch to only use ports and protocols acceptable by\norganizational policies. Disable the HTTP, Thrift, or Transport protocols if\nthey are unused and verify that they are configured to bind only to acceptable\nnetwork devices on acceptable ports as documented in the system's security\nplan.",
          "impact": 0.5,
          "refs": [],
          "tags": {
            "nist": [
              "CM-7 b",
              "Rev_4"
            ],
            "severity": "medium",
            "rid": "SV-34247r1_rule",
            "gtitle": "SRG-APP-000142",
            "cci": "CCI-000382",
            "check": "Check Elasticsearch.yml settings and existing IP filtering\nrules to verify that only specific IP behind hardware/software 'Managed\naccess control points' are listed.\n\nAs the application administrator (usually elasticsearch, check the\nxpack.security.http.filter setting contains IP address(es) of the  'Managed\naccess control points':\n\n$cat elasticsearch.yml | grep 'xpack.security.http.filter', Verify all three\nsettings; xpack.security.http.filter.enabled: true;\nxpack.security.http.filter.allow: 'Managed access control points';\nxpack.security.http.filter.deny: _all\n\nAs an elasticsearch administrator test; verify runtime environment within\n_culster settings are set to '{}' OR Verify all three settings are\nxpack.security.http.filter.enabled: true; xpack.security.http.filter.allow:\n'Managed access control points'; xpack.security.http.filter.deny: _all\n\n$ curl -h content_type:application-json    -XGET\n'http://<elasticsearch>:9200/_cluster/settings'\n\nIf these configuration setting are disabled, or not pointing to the 'Managed\naccess control points', this is a finding. ",
            "fix": "Note: The following instructions use the ES_HOME environment\nvariable. See supplementary content APPENDIX-XXX for\ninstructions on configuring ES_HOME.\n\nTo change the Managed access control points of the application, as the\napplication administrator, change the following setting in elasticsearch.yml:\n\n\n$ sudo su - elasticsearch\n$ vi $ES_HOME/config/elasticsearch.yml\n\nChange the Managed access control points parameter to the desired addresses,\ni.e.:\n     xpack.security.http.filter.enabled: true\n     xpack.security.http.filter.allow: 'Managed access control points'\n     xpack.security.http.filter.deny: _all\n\nNext, restart the application:\n$ sudo su - elasticsearch\n\n# SYSTEMD SERVER ONLY\n$ systemctl restart elasticsearch"
          },
          "code": "control \"V-26962\" do\n  title \"The application must support the organizational requirements to\nspecifically prohibit or restrict the use of unauthorized functions, ports,\nprotocols, and/or services.\"\n  desc  \"Configure Elasticsearch to only use ports and protocols acceptable by\norganizational policies. Disable the HTTP, Thrift, or Transport protocols if\nthey are unused and verify that they are configured to bind only to acceptable\nnetwork devices on acceptable ports as documented in the system's security\nplan.\"\n  impact 0.5\n  tag \"nist\": [\"CM-7 b\", \"Rev_4\"]\n  tag \"severity\": \"medium\"\n  tag \"rid\": \"SV-34247r1_rule\"\n  tag \"gtitle\": \"SRG-APP-000142\"\n  tag \"cci\": \"CCI-000382\"\n  tag \"check\": \"Check Elasticsearch.yml settings and existing IP filtering\nrules to verify that only specific IP behind hardware/software 'Managed\naccess control points' are listed.\n\nAs the application administrator (usually elasticsearch, check the\nxpack.security.http.filter setting contains IP address(es) of the  'Managed\naccess control points':\n\n$cat elasticsearch.yml | grep 'xpack.security.http.filter', Verify all three\nsettings; xpack.security.http.filter.enabled: true;\nxpack.security.http.filter.allow: 'Managed access control points';\nxpack.security.http.filter.deny: _all\n\nAs an elasticsearch administrator test; verify runtime environment within\n_culster settings are set to '{}' OR Verify all three settings are\nxpack.security.http.filter.enabled: true; xpack.security.http.filter.allow:\n'Managed access control points'; xpack.security.http.filter.deny: _all\n\n$ curl -h content_type:application-json    -XGET\n'http://<elasticsearch>:9200/_cluster/settings'\n\nIf these configuration setting are disabled, or not pointing to the 'Managed\naccess control points', this is a finding. \"\n  tag \"fix\": \"Note: The following instructions use the ES_HOME environment\nvariable. See supplementary content APPENDIX-XXX for\ninstructions on configuring ES_HOME.\n\nTo change the Managed access control points of the application, as the\napplication administrator, change the following setting in elasticsearch.yml:\n\n\n$ sudo su - elasticsearch\n$ vi $ES_HOME/config/elasticsearch.yml\n\nChange the Managed access control points parameter to the desired addresses,\ni.e.:\n     xpack.security.http.filter.enabled: true\n     xpack.security.http.filter.allow: 'Managed access control points'\n     xpack.security.http.filter.deny: _all\n\nNext, restart the application:\n$ sudo su - elasticsearch\n\n# SYSTEMD SERVER ONLY\n$ systemctl restart elasticsearch\"\n\n  begin\n    es_handle = es_helper(url:\"https://#{ELASTIC_IP}:#{ELASTIC_PORT}\",\n                      username: ES_ADMIN,\n                      password: ES_PASS,\n                      ssl_verify: SSL_VERIFY )\n\n    es_handle.nodes.each do |node|\n      describe \"IP filtering rules for Node:#{node.name}\" do\n        subject { node.ip_filter }\n        its('enabled') { should eq 'true' }\n        its('allow')  { should be_in MANAGED_ACCESS_POINTS }\n        its('deny') { should eq '_all' }\n      end\n    end unless es_handle.nodes.nil?\n\n    describe \"IP filtering rules from ES_CONF\" do\n      subject { yaml(ELASTICSEARCH_CONF) }\n      its(['xpack.security.http.filter.enabled']) { should eq true }\n      its(['xpack.security.http.filter.allow']) { should be_in MANAGED_ACCESS_POINTS }\n      its(['xpack.security.http.filter.deny']) { should eq '_all' }\n    end\n\n    describe \"Cluster Settings\" do\n      subject { es_handle.cluster_settings }\n      its(['persistent']) { should be_empty }\n      its(['transient']) { should be_empty }\n    end\n\n  rescue Exception => msg\n    describe \"Exception: #{msg}\" do\n      it { should be_nil}\n    end\n  end\nend\n",
          "source_location": {
            "line": 44,
            "ref": "../elasticsearch-inspec/controls/ip_fil/V-26962.rb"
          },
          "results": [
            {
              "status": "passed",
              "code_desc": "IP filtering rules for Node:package-centos-72 enabled should eq \"true\"",
              "run_time": 0.000124,
              "start_time": "2018-02-11 14:26:57 -0500"
            },
            {
              "status": "passed",
              "code_desc": "IP filtering rules for Node:package-centos-72 allow should be in \"10.0.2.15\"",
              "run_time": 0.000128,
              "start_time": "2018-02-11 14:26:57 -0500"
            },
            {
              "status": "passed",
              "code_desc": "IP filtering rules for Node:package-centos-72 deny should eq \"_all\"",
              "run_time": 0.000075,
              "start_time": "2018-02-11 14:26:57 -0500"
            },
            {
              "status": "passed",
              "code_desc": "IP filtering rules from ES_CONF [\"xpack.security.http.filter.enabled\"] should eq true",
              "run_time": 0.000568,
              "start_time": "2018-02-11 14:26:57 -0500"
            },
            {
              "status": "passed",
              "code_desc": "IP filtering rules from ES_CONF [\"xpack.security.http.filter.allow\"] should be in \"10.0.2.15\"",
              "run_time": 0.000529,
              "start_time": "2018-02-11 14:26:57 -0500"
            },
            {
              "status": "passed",
              "code_desc": "IP filtering rules from ES_CONF [\"xpack.security.http.filter.deny\"] should eq \"_all\"",
              "run_time": 0.000482,
              "start_time": "2018-02-11 14:26:57 -0500"
            },
            {
              "status": "passed",
              "code_desc": "Cluster Settings [\"persistent\"] should be empty",
              "run_time": 0.068669,
              "start_time": "2018-02-11 14:26:57 -0500"
            },
            {
              "status": "passed",
              "code_desc": "Cluster Settings [\"transient\"] should be empty",
              "run_time": 0.075965,
              "start_time": "2018-02-11 14:26:57 -0500"
            }
          ]
        },
        {
          "id": "V-27163",
          "title": "The application must protect audit tools from unauthorized access.",
          "desc": "Utilize perimeter, application, centralized authentication, and\nrepository audit controls to audit the use of systems in real time with\nsufficient context.  X-Pack Security audit controls should be enabled to audit\nthe defaults of all HTTP/S based access to Elasticsearch.  All applications\nshould use HTTP/S  rather than Elasticsearch transport protocol.",
          "impact": 0.5,
          "refs": [],
          "tags": {
            "nist": [
              "AU-9",
              "Rev_4"
            ],
            "severity": "medium",
            "rid": "SV-34462r1_rule",
            "gtitle": "SRG-APP-000121",
            "cci": "CCI-001493",
            "check": "The owner of all log files written by the application should be\nelasticsearch. These log files are determined by the\nxpack.security.audit.output parameter in elasticsearch.yml and typically all\nappear in /var/log/elasticsearch/audit. To see the owner of a given log file,\nrun the following command:\n\n$ ls -l LOGFILE\n\nIf the owner is not root, this is a finding.",
            "fix": "The owner of all log files written by the application should be\nelasticsearch. These log files are determined by the\nxpack.security.audit.output parameter in elasticsearch.yml and typically all\nappear in /var/log/elasticsearch/audit.\n\nFor each log file LOGFILE referenced in /etc/rsyslog.conf, run the following\ncommand to inspect the file's owner:\n\n$ ls -l LOGFILE\n\nIf the owner is not elasticsearch, run the following command to correct this:\n\n$ sudo chown elasticsearch LOGFILE"
          },
          "code": "control \"V-27163\" do\n  title \"The application must protect audit tools from unauthorized access.\"\n  desc  \"Utilize perimeter, application, centralized authentication, and\nrepository audit controls to audit the use of systems in real time with\nsufficient context.  X-Pack Security audit controls should be enabled to audit\nthe defaults of all HTTP/S based access to Elasticsearch.  All applications\nshould use HTTP/S  rather than Elasticsearch transport protocol.\"\n  impact 0.5\n  tag \"nist\": [\"AU-9\", \"Rev_4\"]\n  tag \"severity\": \"medium\"\n  tag \"rid\": \"SV-34462r1_rule\"\n  tag \"gtitle\": \"SRG-APP-000121\"\n  tag \"cci\": \"CCI-001493\"\n  tag \"check\": \"The owner of all log files written by the application should be\nelasticsearch. These log files are determined by the\nxpack.security.audit.output parameter in elasticsearch.yml and typically all\nappear in /var/log/elasticsearch/audit. To see the owner of a given log file,\nrun the following command:\n\n$ ls -l LOGFILE\n\nIf the owner is not root, this is a finding.\"\n  tag \"fix\": \"The owner of all log files written by the application should be\nelasticsearch. These log files are determined by the\nxpack.security.audit.output parameter in elasticsearch.yml and typically all\nappear in /var/log/elasticsearch/audit.\n\nFor each log file LOGFILE referenced in /etc/rsyslog.conf, run the following\ncommand to inspect the file's owner:\n\n$ ls -l LOGFILE\n\nIf the owner is not elasticsearch, run the following command to correct this:\n\n$ sudo chown elasticsearch LOGFILE\"\n\n  begin\n\n    command(\"find #{ES_LOGS_DIR}\").stdout.split.each do |log_file|\n      describe \"Log File: #{log_file}\" do\n        subject { file(log_file) }\n        its('owner') { should eq ES_OWNER }\n        its('group') { should eq ES_GROUP }\n      end\n    end\n\n    describe \"Log Dir: #{ES_LOGS_DIR}\" do\n      subject { file(ES_LOGS_DIR) }\n      its('owner') { should eq ES_OWNER }\n      its('group') { should eq ES_GROUP }\n    end\n\n  rescue Exception => msg\n    describe \"Exception: #{msg}\" do\n      it { should be_nil}\n    end\n  end\nend\n",
          "source_location": {
            "line": 53,
            "ref": "../elasticsearch-inspec/controls/log/V-27163.rb"
          },
          "results": [
            {
              "status": "passed",
              "code_desc": "Log File: /var/log/elasticsearch owner should eq \"elasticsearch\"",
              "run_time": 0.01411,
              "start_time": "2018-02-11 14:26:57 -0500"
            },
            {
              "status": "passed",
              "code_desc": "Log File: /var/log/elasticsearch group should eq \"elasticsearch\"",
              "run_time": 0.000126,
              "start_time": "2018-02-11 14:26:57 -0500"
            },
            {
              "status": "passed",
              "code_desc": "Log File: /var/log/elasticsearch/elasticsearch.log owner should eq \"elasticsearch\"",
              "run_time": 0.015249,
              "start_time": "2018-02-11 14:26:57 -0500"
            },
            {
              "status": "passed",
              "code_desc": "Log File: /var/log/elasticsearch/elasticsearch.log group should eq \"elasticsearch\"",
              "run_time": 0.000121,
              "start_time": "2018-02-11 14:26:57 -0500"
            },
            {
              "status": "passed",
              "code_desc": "Log File: /var/log/elasticsearch/elasticsearch_deprecation.log owner should eq \"elasticsearch\"",
              "run_time": 0.013916,
              "start_time": "2018-02-11 14:26:57 -0500"
            },
            {
              "status": "passed",
              "code_desc": "Log File: /var/log/elasticsearch/elasticsearch_deprecation.log group should eq \"elasticsearch\"",
              "run_time": 0.000123,
              "start_time": "2018-02-11 14:26:57 -0500"
            },
            {
              "status": "passed",
              "code_desc": "Log File: /var/log/elasticsearch/elasticsearch_index_search_slowlog.log owner should eq \"elasticsearch\"",
              "run_time": 0.014368,
              "start_time": "2018-02-11 14:26:57 -0500"
            },
            {
              "status": "passed",
              "code_desc": "Log File: /var/log/elasticsearch/elasticsearch_index_search_slowlog.log group should eq \"elasticsearch\"",
              "run_time": 0.000116,
              "start_time": "2018-02-11 14:26:57 -0500"
            },
            {
              "status": "passed",
              "code_desc": "Log File: /var/log/elasticsearch/elasticsearch_index_indexing_slowlog.log owner should eq \"elasticsearch\"",
              "run_time": 0.015121,
              "start_time": "2018-02-11 14:26:57 -0500"
            },
            {
              "status": "passed",
              "code_desc": "Log File: /var/log/elasticsearch/elasticsearch_index_indexing_slowlog.log group should eq \"elasticsearch\"",
              "run_time": 0.000125,
              "start_time": "2018-02-11 14:26:57 -0500"
            },
            {
              "status": "passed",
              "code_desc": "Log File: /var/log/elasticsearch/audit owner should eq \"elasticsearch\"",
              "run_time": 0.000093,
              "start_time": "2018-02-11 14:26:57 -0500"
            },
            {
              "status": "passed",
              "code_desc": "Log File: /var/log/elasticsearch/audit group should eq \"elasticsearch\"",
              "run_time": 0.000078,
              "start_time": "2018-02-11 14:26:57 -0500"
            },
            {
              "status": "passed",
              "code_desc": "Log File: /var/log/elasticsearch/elasticsearch_access.log owner should eq \"elasticsearch\"",
              "run_time": 0.015385,
              "start_time": "2018-02-11 14:26:57 -0500"
            },
            {
              "status": "passed",
              "code_desc": "Log File: /var/log/elasticsearch/elasticsearch_access.log group should eq \"elasticsearch\"",
              "run_time": 0.000134,
              "start_time": "2018-02-11 14:26:57 -0500"
            },
            {
              "status": "passed",
              "code_desc": "Log Dir: /var/log/elasticsearch owner should eq \"elasticsearch\"",
              "run_time": 0.000098,
              "start_time": "2018-02-11 14:26:57 -0500"
            },
            {
              "status": "passed",
              "code_desc": "Log Dir: /var/log/elasticsearch group should eq \"elasticsearch\"",
              "run_time": 0.000083,
              "start_time": "2018-02-11 14:26:57 -0500"
            }
          ]
        },
        {
          "id": "V-27148",
          "title": "The application must protect audit information from any type of\nunauthorized access.",
          "desc": "Utilize perimeter, application, centralized authentication, and\nrepository audit controls to audit the use of systems in real time with\nsufficient context.  X-Pack Security audit controls should be enabled to audit\nthe defaults of all HTTP/S based access to Elasticsearch.  All applications\nshould use HTTP/S  rather than Elasticsearch transport protocol.",
          "impact": 0.5,
          "refs": [],
          "tags": {
            "nist": [
              "AU-9",
              "Rev_4"
            ],
            "severity": "medium",
            "rid": "SV-34447r1_rule",
            "gtitle": "SRG-APP-000118",
            "cci": "CCI-000162",
            "check": "The owner of all log files written by the application should be\nelasticsearch. These log files are determined by the\nxpack.security.audit.output parameter in elasticsearch.yml and typically all\nappear in /var/log/elasticsearch/audit. To see the owner of a given log file,\nrun the following command:\n\n$ ls -l LOGFILE\n\nIf the owner is not root, this is a finding.",
            "fix": "The owner of all log files written by the application should be\nelasticsearch. These log files are determined by the\nxpack.security.audit.output parameter in elasticsearch.yml and typically all\nappear in /var/log/elasticsearch/audit.\n\nFor each log file LOGFILE referenced in xpack.security.audit.output from\nelasticsearch.yml, run the following command to inspect the file's owner:\n\n$ ls -l LOGFILE\n\nIf the owner is not elasticsearch, run the following command to correct this:\n\n$ sudo chown elasticsearch LOGFILE"
          },
          "code": "control \"V-27148\" do\n  title \"The application must protect audit information from any type of\nunauthorized access.\"\n  desc  \"Utilize perimeter, application, centralized authentication, and\nrepository audit controls to audit the use of systems in real time with\nsufficient context.  X-Pack Security audit controls should be enabled to audit\nthe defaults of all HTTP/S based access to Elasticsearch.  All applications\nshould use HTTP/S  rather than Elasticsearch transport protocol.\"\n  impact 0.5\n  tag \"nist\": [\"AU-9\", \"Rev_4\"]\n  tag \"severity\": \"medium\"\n  tag \"rid\": \"SV-34447r1_rule\"\n  tag \"gtitle\": \"SRG-APP-000118\"\n  tag \"cci\": \"CCI-000162\"\n  tag \"check\": \"The owner of all log files written by the application should be\nelasticsearch. These log files are determined by the\nxpack.security.audit.output parameter in elasticsearch.yml and typically all\nappear in /var/log/elasticsearch/audit. To see the owner of a given log file,\nrun the following command:\n\n$ ls -l LOGFILE\n\nIf the owner is not root, this is a finding.\"\n  tag \"fix\": \"The owner of all log files written by the application should be\nelasticsearch. These log files are determined by the\nxpack.security.audit.output parameter in elasticsearch.yml and typically all\nappear in /var/log/elasticsearch/audit.\n\nFor each log file LOGFILE referenced in xpack.security.audit.output from\nelasticsearch.yml, run the following command to inspect the file's owner:\n\n$ ls -l LOGFILE\n\nIf the owner is not elasticsearch, run the following command to correct this:\n\n$ sudo chown elasticsearch LOGFILE\"\n\n  begin\n\n    command(\"find #{ES_LOGS_DIR}\").stdout.split.each do |log_file|\n      describe \"Log File: #{log_file}\" do\n        subject { file(log_file) }\n        its('owner') { should eq ES_OWNER }\n        its('group') { should eq ES_GROUP }\n      end\n    end\n\n    describe \"Log Dir: #{ES_LOGS_DIR}\" do\n      subject { file(ES_LOGS_DIR) }\n      its('owner') { should eq ES_OWNER }\n      its('group') { should eq ES_GROUP }\n    end\n\n  rescue Exception => msg\n    describe \"Exception: #{msg}\" do\n      it { should be_nil}\n    end\n  end\nend",
          "source_location": {
            "line": 53,
            "ref": "../elasticsearch-inspec/controls/log/V-27148.rb"
          },
          "results": [
            {
              "status": "passed",
              "code_desc": "Log File: /var/log/elasticsearch owner should eq \"elasticsearch\"",
              "run_time": 0.000085,
              "start_time": "2018-02-11 14:26:57 -0500"
            },
            {
              "status": "passed",
              "code_desc": "Log File: /var/log/elasticsearch group should eq \"elasticsearch\"",
              "run_time": 0.000074,
              "start_time": "2018-02-11 14:26:57 -0500"
            },
            {
              "status": "passed",
              "code_desc": "Log File: /var/log/elasticsearch/elasticsearch.log owner should eq \"elasticsearch\"",
              "run_time": 0.000079,
              "start_time": "2018-02-11 14:26:57 -0500"
            },
            {
              "status": "passed",
              "code_desc": "Log File: /var/log/elasticsearch/elasticsearch.log group should eq \"elasticsearch\"",
              "run_time": 0.00008,
              "start_time": "2018-02-11 14:26:57 -0500"
            },
            {
              "status": "passed",
              "code_desc": "Log File: /var/log/elasticsearch/elasticsearch_deprecation.log owner should eq \"elasticsearch\"",
              "run_time": 0.000084,
              "start_time": "2018-02-11 14:26:57 -0500"
            },
            {
              "status": "passed",
              "code_desc": "Log File: /var/log/elasticsearch/elasticsearch_deprecation.log group should eq \"elasticsearch\"",
              "run_time": 0.000092,
              "start_time": "2018-02-11 14:26:57 -0500"
            },
            {
              "status": "passed",
              "code_desc": "Log File: /var/log/elasticsearch/elasticsearch_index_search_slowlog.log owner should eq \"elasticsearch\"",
              "run_time": 0.000088,
              "start_time": "2018-02-11 14:26:57 -0500"
            },
            {
              "status": "passed",
              "code_desc": "Log File: /var/log/elasticsearch/elasticsearch_index_search_slowlog.log group should eq \"elasticsearch\"",
              "run_time": 0.00008,
              "start_time": "2018-02-11 14:26:57 -0500"
            },
            {
              "status": "passed",
              "code_desc": "Log File: /var/log/elasticsearch/elasticsearch_index_indexing_slowlog.log owner should eq \"elasticsearch\"",
              "run_time": 0.000075,
              "start_time": "2018-02-11 14:26:57 -0500"
            },
            {
              "status": "passed",
              "code_desc": "Log File: /var/log/elasticsearch/elasticsearch_index_indexing_slowlog.log group should eq \"elasticsearch\"",
              "run_time": 0.000076,
              "start_time": "2018-02-11 14:26:57 -0500"
            },
            {
              "status": "passed",
              "code_desc": "Log File: /var/log/elasticsearch/audit owner should eq \"elasticsearch\"",
              "run_time": 0.000081,
              "start_time": "2018-02-11 14:26:57 -0500"
            },
            {
              "status": "passed",
              "code_desc": "Log File: /var/log/elasticsearch/audit group should eq \"elasticsearch\"",
              "run_time": 0.000073,
              "start_time": "2018-02-11 14:26:57 -0500"
            },
            {
              "status": "passed",
              "code_desc": "Log File: /var/log/elasticsearch/elasticsearch_access.log owner should eq \"elasticsearch\"",
              "run_time": 0.000082,
              "start_time": "2018-02-11 14:26:57 -0500"
            },
            {
              "status": "passed",
              "code_desc": "Log File: /var/log/elasticsearch/elasticsearch_access.log group should eq \"elasticsearch\"",
              "run_time": 0.000078,
              "start_time": "2018-02-11 14:26:57 -0500"
            },
            {
              "status": "passed",
              "code_desc": "Log Dir: /var/log/elasticsearch owner should eq \"elasticsearch\"",
              "run_time": 0.000087,
              "start_time": "2018-02-11 14:26:57 -0500"
            },
            {
              "status": "passed",
              "code_desc": "Log Dir: /var/log/elasticsearch group should eq \"elasticsearch\"",
              "run_time": 0.000081,
              "start_time": "2018-02-11 14:26:57 -0500"
            }
          ]
        },
        {
          "id": "V-26914",
          "title": "Applications must support organizational requirements to disable user\naccounts after an organizational-defined time period of inactivity.",
          "desc": "Configure the centralized authentication service to enforce\norganizational policies such as password strength, lockout, expiration,\nnotification, and screen obfuscation.",
          "impact": 0.5,
          "refs": [],
          "tags": {
            "nist": [
              "IA-4 e",
              "Rev_4"
            ],
            "severity": "medium",
            "rid": "SV-34194r1_rule",
            "gtitle": "SRG-APP-000163",
            "cci": "CCI-000795",
            "check": "Guidance in Appendix B - System accounts cannot be disabled and\nelasticsearch does not enforce password complexity rules.\n\nElasticsearch supports LDAP, Active Directory, and PKI.\n\nIf the external authentication is Active Directory; verify the following\nsettings.\n\n$ cat config/elasticsearch.yml | grep -A 6 -B 6 'type: \\?active_directory'\n\n\n xpack:\n  security:\n    authc:\n      realms:\n        active_directory:\n          type: active_directory\n          order: 0\n          domain_name: ad.example.com\n          url: ldaps://ad.example.com:636\n          unmapped_groups_as_roles: true | false\n\nIf these settings are not correct or missing, this is a finding.\n\nIf the external authentication is LDAP; verify the following settings.\n\n$ cat config/elasticsearch.yml | grep -A 16 -B 6 'type: \\?ldap'\n\nxpack:\n  security:\n    authc:\n      realms:\n        ldap1:\n          type: ldap\n          order: 0\n          url: 'ldaps://ldap.example.com:636'\n          bind_dn: 'cn=ldapuser, ou=users, o=services, dc=example, dc=com'\n          bind_password: changeme\n          user_search:\n            base_dn: 'dc=example,dc=com'\n            attribute: cn\n          group_search:\n            base_dn: 'dc=example,dc=com'\n          files:\n            role_mapping: 'CONFIG_DIR/x-pack/role_mapping.yml\n\nIf these settings are not correct or missing, this is a finding.\n\nIf the external authentication is PKI; verify the following settings.\n\n$ cat config/elasticsearch.yml | grep -A 6 -B 6 'type: \\?pki'\n\n xpack:\n  security:\n    authc:\n      realms:\n        pki1:\n          type: pki\n          username_pattern: 'EMAILADDRESS=(.*?)(?:,|$)'\n\nIf these settings are not correct or missing, this is a finding.\n\n",
            "fix": "Configure elasticsearch realms settings to point to\norganizational supported authentication mechanism\n\nSee the official documentation for the instructions on realm configuration:\nhttps://www.elastic.co/guide/en/x-pack/current/_how_authentication_works.html"
          },
          "code": "control \"V-26914\" do\n  title \"Applications must support organizational requirements to disable user\naccounts after an organizational-defined time period of inactivity.\"\n  desc  \"Configure the centralized authentication service to enforce\norganizational policies such as password strength, lockout, expiration,\nnotification, and screen obfuscation.\"\n  impact 0.5\n  tag \"nist\": [\"IA-4 e\", \"Rev_4\"]\n  tag \"severity\": \"medium\"\n  tag \"rid\": \"SV-34194r1_rule\"\n  tag \"gtitle\": \"SRG-APP-000163\"\n  tag \"cci\": \"CCI-000795\"\n  tag \"check\": \"Guidance in Appendix B - System accounts cannot be disabled and\nelasticsearch does not enforce password complexity rules.\n\nElasticsearch supports LDAP, Active Directory, and PKI.\n\nIf the external authentication is Active Directory; verify the following\nsettings.\n\n$ cat config/elasticsearch.yml | grep -A 6 -B 6 'type: \\\\?active_directory'\n\n\n xpack:\n  security:\n    authc:\n      realms:\n        active_directory:\n          type: active_directory\n          order: 0\n          domain_name: ad.example.com\n          url: ldaps://ad.example.com:636\n          unmapped_groups_as_roles: true | false\n\nIf these settings are not correct or missing, this is a finding.\n\nIf the external authentication is LDAP; verify the following settings.\n\n$ cat config/elasticsearch.yml | grep -A 16 -B 6 'type: \\\\?ldap'\n\nxpack:\n  security:\n    authc:\n      realms:\n        ldap1:\n          type: ldap\n          order: 0\n          url: 'ldaps://ldap.example.com:636'\n          bind_dn: 'cn=ldapuser, ou=users, o=services, dc=example, dc=com'\n          bind_password: changeme\n          user_search:\n            base_dn: 'dc=example,dc=com'\n            attribute: cn\n          group_search:\n            base_dn: 'dc=example,dc=com'\n          files:\n            role_mapping: 'CONFIG_DIR/x-pack/role_mapping.yml\n\nIf these settings are not correct or missing, this is a finding.\n\nIf the external authentication is PKI; verify the following settings.\n\n$ cat config/elasticsearch.yml | grep -A 6 -B 6 'type: \\\\?pki'\n\n xpack:\n  security:\n    authc:\n      realms:\n        pki1:\n          type: pki\n          username_pattern: 'EMAILADDRESS=(.*?)(?:,|$)'\n\nIf these settings are not correct or missing, this is a finding.\n\n\"\n  tag \"fix\": \"Configure elasticsearch realms settings to point to\norganizational supported authentication mechanism\n\nSee the official documentation for the instructions on realm configuration:\nhttps://www.elastic.co/guide/en/x-pack/current/_how_authentication_works.html\"\n\n\n  begin\n\n    es_handle = es_helper(url:\"https://#{ELASTIC_IP}:#{ELASTIC_PORT}\",\n                    username: ES_ADMIN,\n                    password: ES_PASS,\n                    ssl_verify: SSL_VERIFY )\n\n    describe \"No nodes found\" do\n      subject { es_handle.nodes.nil? }\n      it { should_not be_truthy }\n    end if es_handle.nodes.nil?\n\n\n    es_handle.nodes.each do |node|\n      describe \"Authentication methods includes AD, LDAP or PKI for Node: #{node.name}\" do\n        subject { node.authc_method.any? { |x| ['pki','active_directory','ldap'].include?(x) } }\n        it{ should be true }\n      end\n    end unless es_handle.nodes.nil?\n\n    es_handle.nodes.each do |node|\n      describe.one do\n        node.authc_realm.keys.each do |auth_method|\n          describe \"Active Directory Settings for Node: #{node.name}\" do\n            subject { es_handle.settings.first.xpack.security.authc.realms[auth_method] }\n            its ('order') { should_not be_nil }\n            its ('domain_name') { should_not be_nil }\n            its ('url') { should_not be_nil }\n            its ('unmapped_groups_as_roles') { should_not be_nil }\n          end if node.authc_realm[auth_method].type.eql?('active_directory')\n\n          describe \"LDAP Settings for Node: #{node.name}\" do\n            subject { es_handle.settings.first.xpack.security.authc.realms[auth_method] }\n            its ('order') { should_not be_nil }\n            its ('url') { should_not be_nil }\n            its ('bind_dn') { should_not be_nil }\n            its ('bind_password') { should_not be_nil }\n            its ('user_search.base_dn') { should_not be_nil }\n            its ('user_search.attribute') { should_not be_nil }\n            its ('group_search.base_dn') { should_not be_nil }\n            its ('files.role_mapping') { should_not be_nil }\n          end if node.authc_realm[auth_method].type.eql?('ldap')\n\n          describe \"PKI Settings for Node: #{node.name}\" do\n            subject { node.authc_realm[auth_method] }\n            its ('order') { should_not be_nil }\n            its ('username_pattern') { should_not be_nil }\n          end if node.authc_realm[auth_method].type.eql?('pki')\n        end\n      end\n    end unless es_handle.nodes.nil?\n\n  rescue Exception => msg\n    describe \"Exception: #{msg}\" do\n      it { should be_nil}\n    end\n  end\nend",
          "source_location": {
            "line": 36,
            "ref": "../elasticsearch-inspec/controls/ad+ldap+pki/V-26914.rb"
          },
          "results": [
            {
              "status": "passed",
              "code_desc": "Authentication methods includes AD, LDAP or PKI for Node: package-centos-72 should equal true",
              "run_time": 0.000089,
              "start_time": "2018-02-11 14:26:57 -0500"
            },
            {
              "status": "passed",
              "code_desc": "PKI Settings for Node: package-centos-72 order should not be nil",
              "run_time": 0.00009,
              "start_time": "2018-02-11 14:26:57 -0500"
            },
            {
              "status": "passed",
              "code_desc": "PKI Settings for Node: package-centos-72 username_pattern should not be nil",
              "run_time": 0.000065,
              "start_time": "2018-02-11 14:26:57 -0500"
            }
          ]
        },
        {
          "id": "V-26920",
          "title": "The application must support organizational requirements to enforce\npassword complexity by the number of numeric characters used.",
          "desc": "Configure the centralized authentication service to enforce\norganizational policies such as password strength, lockout, expiration,\nnotification, and screen obfuscation.",
          "impact": 0.5,
          "refs": [],
          "tags": {
            "nist": [
              "IA-5 (1) (a)",
              "Rev_4"
            ],
            "severity": "medium",
            "rid": "SV-34200r1_rule",
            "gtitle": "SRG-APP-000168",
            "cci": "CCI-000194",
            "check": "Guidance in Appendix B - System accounts cannot be disabled and\nelasticsearch does not enforce password complexity rules.\n\nElasticsearch supports LDAP, Active Directory, and PKI.\n\nIf the external authentication is Active Directory; verify the following\nsettings.\n\n$ cat config/elasticsearch.yml | grep -A 6 -B 6 'type: \\?active_directory'\n\n\n xpack:\n  security:\n    authc:\n      realms:\n        active_directory:\n          type: active_directory\n          order: 0\n          domain_name: ad.example.com\n          url: ldaps://ad.example.com:636\n          unmapped_groups_as_roles: true | false\n\nIf these settings are not correct or missing, this is a finding.\n\nIf the external authentication is LDAP; verify the following settings.\n\n$ cat config/elasticsearch.yml | grep -A 16 -B 6 'type: \\?ldap'\n\nxpack:\n  security:\n    authc:\n      realms:\n        ldap1:\n          type: ldap\n          order: 0\n          url: 'ldaps://ldap.example.com:636'\n          bind_dn: 'cn=ldapuser, ou=users, o=services, dc=example, dc=com'\n          bind_password: changeme\n          user_search:\n            base_dn: 'dc=example,dc=com'\n            attribute: cn\n          group_search:\n            base_dn: 'dc=example,dc=com'\n          files:\n            role_mapping: 'CONFIG_DIR/x-pack/role_mapping.yml\n\nIf these settings are not correct or missing, this is a finding.\n\nIf the external authentication is PKI; verify the following settings.\n\n$ cat config/elasticsearch.yml | grep -A 6 -B 6 'type: \\?pki'\n\n xpack:\n  security:\n    authc:\n      realms:\n        pki1:\n          type: pki\n          username_pattern: 'EMAILADDRESS=(.*?)(?:,|$)'\n\nIf these settings are not correct or missing, this is a finding.\n\n",
            "fix": "Configure elasticsearch realms settings to point to\norganizational supported authentication mechanism\n\nSee the official documentation for the instructions on realm configuration:\nhttps://www.elastic.co/guide/en/x-pack/current/_how_authentication_works.html"
          },
          "code": "control \"V-26920\" do\n  title \"The application must support organizational requirements to enforce\npassword complexity by the number of numeric characters used.\"\n  desc  \"Configure the centralized authentication service to enforce\norganizational policies such as password strength, lockout, expiration,\nnotification, and screen obfuscation.\"\n  impact 0.5\n  tag \"nist\": [\"IA-5 (1) (a)\", \"Rev_4\"]\n  tag \"severity\": \"medium\"\n  tag \"rid\": \"SV-34200r1_rule\"\n  tag \"gtitle\": \"SRG-APP-000168\"\n  tag \"cci\": \"CCI-000194\"\n  tag \"check\": \"Guidance in Appendix B - System accounts cannot be disabled and\nelasticsearch does not enforce password complexity rules.\n\nElasticsearch supports LDAP, Active Directory, and PKI.\n\nIf the external authentication is Active Directory; verify the following\nsettings.\n\n$ cat config/elasticsearch.yml | grep -A 6 -B 6 'type: \\\\?active_directory'\n\n\n xpack:\n  security:\n    authc:\n      realms:\n        active_directory:\n          type: active_directory\n          order: 0\n          domain_name: ad.example.com\n          url: ldaps://ad.example.com:636\n          unmapped_groups_as_roles: true | false\n\nIf these settings are not correct or missing, this is a finding.\n\nIf the external authentication is LDAP; verify the following settings.\n\n$ cat config/elasticsearch.yml | grep -A 16 -B 6 'type: \\\\?ldap'\n\nxpack:\n  security:\n    authc:\n      realms:\n        ldap1:\n          type: ldap\n          order: 0\n          url: 'ldaps://ldap.example.com:636'\n          bind_dn: 'cn=ldapuser, ou=users, o=services, dc=example, dc=com'\n          bind_password: changeme\n          user_search:\n            base_dn: 'dc=example,dc=com'\n            attribute: cn\n          group_search:\n            base_dn: 'dc=example,dc=com'\n          files:\n            role_mapping: 'CONFIG_DIR/x-pack/role_mapping.yml\n\nIf these settings are not correct or missing, this is a finding.\n\nIf the external authentication is PKI; verify the following settings.\n\n$ cat config/elasticsearch.yml | grep -A 6 -B 6 'type: \\\\?pki'\n\n xpack:\n  security:\n    authc:\n      realms:\n        pki1:\n          type: pki\n          username_pattern: 'EMAILADDRESS=(.*?)(?:,|$)'\n\nIf these settings are not correct or missing, this is a finding.\n\n\"\n  tag \"fix\": \"Configure elasticsearch realms settings to point to\norganizational supported authentication mechanism\n\nSee the official documentation for the instructions on realm configuration:\nhttps://www.elastic.co/guide/en/x-pack/current/_how_authentication_works.html\"\n\n  begin\n\n    es_handle = es_helper(url:\"https://#{ELASTIC_IP}:#{ELASTIC_PORT}\",\n                    username: ES_ADMIN,\n                    password: ES_PASS,\n                    ssl_verify: SSL_VERIFY )\n\n    describe \"No nodes found\" do\n      subject { es_handle.nodes.nil? }\n      it { should_not be_truthy }\n    end if es_handle.nodes.nil?\n\n\n    es_handle.nodes.each do |node|\n      describe \"Authentication methods includes AD, LDAP or PKI for Node: #{node.name}\" do\n        subject { node.authc_method.any? { |x| ['pki','active_directory','ldap'].include?(x) } }\n        it{ should be true }\n      end\n    end unless es_handle.nodes.nil?\n\n    es_handle.nodes.each do |node|\n      describe.one do\n        node.authc_realm.keys.each do |auth_method|\n          describe \"Active Directory Settings for Node: #{node.name}\" do\n            subject { es_handle.settings.first.xpack.security.authc.realms[auth_method] }\n            its ('order') { should_not be_nil }\n            its ('domain_name') { should_not be_nil }\n            its ('url') { should_not be_nil }\n            its ('unmapped_groups_as_roles') { should_not be_nil }\n          end if node.authc_realm[auth_method].type.eql?('active_directory')\n\n          describe \"LDAP Settings for Node: #{node.name}\" do\n            subject { es_handle.settings.first.xpack.security.authc.realms[auth_method] }\n            its ('order') { should_not be_nil }\n            its ('url') { should_not be_nil }\n            its ('bind_dn') { should_not be_nil }\n            its ('bind_password') { should_not be_nil }\n            its ('user_search.base_dn') { should_not be_nil }\n            its ('user_search.attribute') { should_not be_nil }\n            its ('group_search.base_dn') { should_not be_nil }\n            its ('files.role_mapping') { should_not be_nil }\n          end if node.authc_realm[auth_method].type.eql?('ldap')\n\n          describe \"PKI Settings for Node: #{node.name}\" do\n            subject { node.authc_realm[auth_method] }\n            its ('order') { should_not be_nil }\n            its ('username_pattern') { should_not be_nil }\n          end if node.authc_realm[auth_method].type.eql?('pki')\n        end\n      end\n    end unless es_handle.nodes.nil?\n\n  rescue Exception => msg\n    describe \"Exception: #{msg}\" do\n      it { should be_nil}\n    end\n  end\nend",
          "source_location": {
            "line": 36,
            "ref": "../elasticsearch-inspec/controls/ad+ldap+pki/V-26920.rb"
          },
          "results": [
            {
              "status": "passed",
              "code_desc": "Authentication methods includes AD, LDAP or PKI for Node: package-centos-72 should equal true",
              "run_time": 0.000077,
              "start_time": "2018-02-11 14:26:57 -0500"
            },
            {
              "status": "passed",
              "code_desc": "PKI Settings for Node: package-centos-72 order should not be nil",
              "run_time": 0.000074,
              "start_time": "2018-02-11 14:26:57 -0500"
            },
            {
              "status": "passed",
              "code_desc": "PKI Settings for Node: package-centos-72 username_pattern should not be nil",
              "run_time": 0.000071,
              "start_time": "2018-02-11 14:26:57 -0500"
            }
          ]
        },
        {
          "id": "V-26732",
          "title": "Applications must support the organizational requirement to\nautomatically monitor on atypical usage of accounts.",
          "desc": "Utilize perimeter, application, centralized authentication, and\nrepository audit controls to audit the use of systems in real time with\nsufficient context.  X-Pack Security audit controls should be enabled to audit\nthe defaults of all HTTP/S based access to Elasticsearch.  All applications\nshould use HTTP/S  rather than Elasticsearch transport protocol.",
          "impact": 0.5,
          "refs": [],
          "tags": {
            "nist": [
              "AC-2 (5) (c)",
              "Rev_3"
            ],
            "severity": "medium",
            "rid": "SV-33980r1_rule",
            "gtitle": "SRG-APP-000030",
            "cci": "CCI-001356",
            "check": "Guidance in Appendix B - System accounts cannot be disabled and\nelasticsearch does not enforce password complexity rules.\n\nElasticsearch supports LDAP, Active Directory, and PKI.\n\nIf the external authentication is Active Directory; verify the following\nsettings.\n\n$ cat config/elasticsearch.yml | grep -A 6 -B 6 'type: \\?active_directory'\n\n\n xpack:\n  security:\n    authc:\n      realms:\n        active_directory:\n          type: active_directory\n          order: 0\n          domain_name: ad.example.com\n          url: ldaps://ad.example.com:636\n          unmapped_groups_as_roles: true | false\n\nIf these settings are not correct or missing, this is a finding.\n\nIf the external authentication is LDAP; verify the following settings.\n\n$ cat config/elasticsearch.yml | grep -A 16 -B 6 'type: \\?ldap'\n\nxpack:\n  security:\n    authc:\n      realms:\n        ldap1:\n          type: ldap\n          order: 0\n          url: 'ldaps://ldap.example.com:636'\n          bind_dn: 'cn=ldapuser, ou=users, o=services, dc=example, dc=com'\n          bind_password: changeme\n          user_search:\n            base_dn: 'dc=example,dc=com'\n            attribute: cn\n          group_search:\n            base_dn: 'dc=example,dc=com'\n          files:\n            role_mapping: 'CONFIG_DIR/x-pack/role_mapping.yml\n\nIf these settings are not correct or missing, this is a finding.\n\nIf the external authentication is PKI; verify the following settings.\n\n$ cat config/elasticsearch.yml | grep -A 6 -B 6 'type: \\?pki'\n\n xpack:\n  security:\n    authc:\n      realms:\n        pki1:\n          type: pki\n          username_pattern: 'EMAILADDRESS=(.*?)(?:,|$)'\n\nIf these settings are not correct or missing, this is a finding.\n\n",
            "fix": "Configure elasticsearch realms settings to point to\norganizational supported authentication mechanism to allow for monitoring of\natypical account usage.\n\nSee the official documentation for the instructions on realm configuration:\nhttps://www.elastic.co/guide/en/x-pack/current/_how_authentication_works.html"
          },
          "code": "control \"V-26732\" do\n  title \"Applications must support the organizational requirement to\nautomatically monitor on atypical usage of accounts.\"\n  desc  \"Utilize perimeter, application, centralized authentication, and\nrepository audit controls to audit the use of systems in real time with\nsufficient context.  X-Pack Security audit controls should be enabled to audit\nthe defaults of all HTTP/S based access to Elasticsearch.  All applications\nshould use HTTP/S  rather than Elasticsearch transport protocol.\"\n  impact 0.5\n  tag \"nist\": [\"AC-2 (5) (c)\", \"Rev_3\"]\n  tag \"severity\": \"medium\"\n  tag \"rid\": \"SV-33980r1_rule\"\n  tag \"gtitle\": \"SRG-APP-000030\"\n  tag \"cci\": \"CCI-001356\"\n  tag \"check\": \"Guidance in Appendix B - System accounts cannot be disabled and\nelasticsearch does not enforce password complexity rules.\n\nElasticsearch supports LDAP, Active Directory, and PKI.\n\nIf the external authentication is Active Directory; verify the following\nsettings.\n\n$ cat config/elasticsearch.yml | grep -A 6 -B 6 'type: \\\\?active_directory'\n\n\n xpack:\n  security:\n    authc:\n      realms:\n        active_directory:\n          type: active_directory\n          order: 0\n          domain_name: ad.example.com\n          url: ldaps://ad.example.com:636\n          unmapped_groups_as_roles: true | false\n\nIf these settings are not correct or missing, this is a finding.\n\nIf the external authentication is LDAP; verify the following settings.\n\n$ cat config/elasticsearch.yml | grep -A 16 -B 6 'type: \\\\?ldap'\n\nxpack:\n  security:\n    authc:\n      realms:\n        ldap1:\n          type: ldap\n          order: 0\n          url: 'ldaps://ldap.example.com:636'\n          bind_dn: 'cn=ldapuser, ou=users, o=services, dc=example, dc=com'\n          bind_password: changeme\n          user_search:\n            base_dn: 'dc=example,dc=com'\n            attribute: cn\n          group_search:\n            base_dn: 'dc=example,dc=com'\n          files:\n            role_mapping: 'CONFIG_DIR/x-pack/role_mapping.yml\n\nIf these settings are not correct or missing, this is a finding.\n\nIf the external authentication is PKI; verify the following settings.\n\n$ cat config/elasticsearch.yml | grep -A 6 -B 6 'type: \\\\?pki'\n\n xpack:\n  security:\n    authc:\n      realms:\n        pki1:\n          type: pki\n          username_pattern: 'EMAILADDRESS=(.*?)(?:,|$)'\n\nIf these settings are not correct or missing, this is a finding.\n\n\"\n  tag \"fix\": \"Configure elasticsearch realms settings to point to\norganizational supported authentication mechanism to allow for monitoring of\natypical account usage.\n\nSee the official documentation for the instructions on realm configuration:\nhttps://www.elastic.co/guide/en/x-pack/current/_how_authentication_works.html\"\n\n\n  begin\n\n    es_handle = es_helper(url:\"https://#{ELASTIC_IP}:#{ELASTIC_PORT}\",\n                    username: ES_ADMIN,\n                    password: ES_PASS,\n                    ssl_verify: SSL_VERIFY )\n\n    describe \"No nodes found\" do\n      subject { es_handle.nodes.nil? }\n      it { should_not be_truthy }\n    end if es_handle.nodes.nil?\n\n\n    es_handle.nodes.each do |node|\n      describe \"Authentication methods includes AD, LDAP or PKI for Node: #{node.name}\" do\n        subject { node.authc_method.any? { |x| ['pki','active_directory','ldap'].include?(x) } }\n        it{ should be true }\n      end\n    end unless es_handle.nodes.nil?\n\n    es_handle.nodes.each do |node|\n      describe.one do\n        node.authc_realm.keys.each do |auth_method|\n          describe \"Active Directory Settings for Node: #{node.name}\" do\n            subject { es_handle.settings.first.xpack.security.authc.realms[auth_method] }\n            its ('order') { should_not be_nil }\n            its ('domain_name') { should_not be_nil }\n            its ('url') { should_not be_nil }\n            its ('unmapped_groups_as_roles') { should_not be_nil }\n          end if node.authc_realm[auth_method].type.eql?('active_directory')\n\n          describe \"LDAP Settings for Node: #{node.name}\" do\n            subject { es_handle.settings.first.xpack.security.authc.realms[auth_method] }\n            its ('order') { should_not be_nil }\n            its ('url') { should_not be_nil }\n            its ('bind_dn') { should_not be_nil }\n            its ('bind_password') { should_not be_nil }\n            its ('user_search.base_dn') { should_not be_nil }\n            its ('user_search.attribute') { should_not be_nil }\n            its ('group_search.base_dn') { should_not be_nil }\n            its ('files.role_mapping') { should_not be_nil }\n          end if node.authc_realm[auth_method].type.eql?('ldap')\n\n          describe \"PKI Settings for Node: #{node.name}\" do\n            subject { node.authc_realm[auth_method] }\n            its ('order') { should_not be_nil }\n            its ('username_pattern') { should_not be_nil }\n          end if node.authc_realm[auth_method].type.eql?('pki')\n        end\n      end\n    end unless es_handle.nodes.nil?\n\n  rescue Exception => msg\n    describe \"Exception: #{msg}\" do\n      it { should be_nil}\n    end\n  end\nend\n",
          "source_location": {
            "line": 36,
            "ref": "../elasticsearch-inspec/controls/ad+ldap+pki/V-26732.rb"
          },
          "results": [
            {
              "status": "passed",
              "code_desc": "Authentication methods includes AD, LDAP or PKI for Node: package-centos-72 should equal true",
              "run_time": 0.00007,
              "start_time": "2018-02-11 14:26:57 -0500"
            },
            {
              "status": "passed",
              "code_desc": "PKI Settings for Node: package-centos-72 order should not be nil",
              "run_time": 0.000064,
              "start_time": "2018-02-11 14:26:57 -0500"
            },
            {
              "status": "passed",
              "code_desc": "PKI Settings for Node: package-centos-72 username_pattern should not be nil",
              "run_time": 0.000062,
              "start_time": "2018-02-11 14:26:57 -0500"
            }
          ]
        },
        {
          "id": "V-26883",
          "title": "In order to inform the user of the number of successful login attempts\nmade with the users account, the application must notify the user of the number\nof successful logins/accesses occurring during an organizational-defined time\nperiod.",
          "desc": "Configure the centralized authentication service to enforce\norganizational policies such as password strength, lockout, expiration,\nnotification, and screen obfuscation.",
          "impact": 0.5,
          "refs": [],
          "tags": {
            "nist": [
              "AC-9 (2)",
              "Rev_4"
            ],
            "severity": "medium",
            "rid": "SV-34163r1_rule",
            "gtitle": "SRG-APP-000077",
            "cci": "CCI-001391",
            "check": "Guidance in Appendix B - System accounts cannot be disabled and\nelasticsearch does not enforce password complexity rules.\n\nElasticsearch supports LDAP, Active Directory, and PKI.\n\nIf the external authentication is Active Directory; verify the following\nsettings.\n\n$ cat config/elasticsearch.yml | grep -A 6 -B 6 'type: \\?active_directory'\n\n\n xpack:\n  security:\n    authc:\n      realms:\n        active_directory:\n          type: active_directory\n          order: 0\n          domain_name: ad.example.com\n          url: ldaps://ad.example.com:636\n          unmapped_groups_as_roles: true | false\n\nIf these settings are not correct or missing, this is a finding.\n\nIf the external authentication is LDAP; verify the following settings.\n\n$ cat config/elasticsearch.yml | grep -A 16 -B 6 'type: \\?ldap'\n\nxpack:\n  security:\n    authc:\n      realms:\n        ldap1:\n          type: ldap\n          order: 0\n          url: 'ldaps://ldap.example.com:636'\n          bind_dn: 'cn=ldapuser, ou=users, o=services, dc=example, dc=com'\n          bind_password: changeme\n          user_search:\n            base_dn: 'dc=example,dc=com'\n            attribute: cn\n          group_search:\n            base_dn: 'dc=example,dc=com'\n          files:\n            role_mapping: 'CONFIG_DIR/x-pack/role_mapping.yml\n\nIf these settings are not correct or missing, this is a finding.\n\nIf the external authentication is PKI; verify the following settings.\n\n$ cat config/elasticsearch.yml | grep -A 6 -B 6 'type: \\?pki'\n\n xpack:\n  security:\n    authc:\n      realms:\n        pki1:\n          type: pki\n          username_pattern: 'EMAILADDRESS=(.*?)(?:,|$)'\n\nIf these settings are not correct or missing, this is a finding.\n\n",
            "fix": "Configure elasticsearch realms settings to point to\norganizational supported authentication mechanism\n\nSee the official documentation for the instructions on realm configuration:\nhttps://www.elastic.co/guide/en/x-pack/current/_how_authentication_works.html"
          },
          "code": "control \"V-26883\" do\n  title \"In order to inform the user of the number of successful login attempts\nmade with the users account, the application must notify the user of the number\nof successful logins/accesses occurring during an organizational-defined time\nperiod.\"\n  desc  \"Configure the centralized authentication service to enforce\norganizational policies such as password strength, lockout, expiration,\nnotification, and screen obfuscation.\"\n  impact 0.5\n  tag \"nist\": [\"AC-9 (2)\", \"Rev_4\"]\n  tag \"severity\": \"medium\"\n  tag \"rid\": \"SV-34163r1_rule\"\n  tag \"gtitle\": \"SRG-APP-000077\"\n  tag \"cci\": \"CCI-001391\"\n  tag \"check\": \"Guidance in Appendix B - System accounts cannot be disabled and\nelasticsearch does not enforce password complexity rules.\n\nElasticsearch supports LDAP, Active Directory, and PKI.\n\nIf the external authentication is Active Directory; verify the following\nsettings.\n\n$ cat config/elasticsearch.yml | grep -A 6 -B 6 'type: \\\\?active_directory'\n\n\n xpack:\n  security:\n    authc:\n      realms:\n        active_directory:\n          type: active_directory\n          order: 0\n          domain_name: ad.example.com\n          url: ldaps://ad.example.com:636\n          unmapped_groups_as_roles: true | false\n\nIf these settings are not correct or missing, this is a finding.\n\nIf the external authentication is LDAP; verify the following settings.\n\n$ cat config/elasticsearch.yml | grep -A 16 -B 6 'type: \\\\?ldap'\n\nxpack:\n  security:\n    authc:\n      realms:\n        ldap1:\n          type: ldap\n          order: 0\n          url: 'ldaps://ldap.example.com:636'\n          bind_dn: 'cn=ldapuser, ou=users, o=services, dc=example, dc=com'\n          bind_password: changeme\n          user_search:\n            base_dn: 'dc=example,dc=com'\n            attribute: cn\n          group_search:\n            base_dn: 'dc=example,dc=com'\n          files:\n            role_mapping: 'CONFIG_DIR/x-pack/role_mapping.yml\n\nIf these settings are not correct or missing, this is a finding.\n\nIf the external authentication is PKI; verify the following settings.\n\n$ cat config/elasticsearch.yml | grep -A 6 -B 6 'type: \\\\?pki'\n\n xpack:\n  security:\n    authc:\n      realms:\n        pki1:\n          type: pki\n          username_pattern: 'EMAILADDRESS=(.*?)(?:,|$)'\n\nIf these settings are not correct or missing, this is a finding.\n\n\"\n  tag \"fix\": \"Configure elasticsearch realms settings to point to\norganizational supported authentication mechanism\n\nSee the official documentation for the instructions on realm configuration:\nhttps://www.elastic.co/guide/en/x-pack/current/_how_authentication_works.html\"\n\n\n  begin\n\n    es_handle = es_helper(url:\"https://#{ELASTIC_IP}:#{ELASTIC_PORT}\",\n                    username: ES_ADMIN,\n                    password: ES_PASS,\n                    ssl_verify: SSL_VERIFY )\n\n    describe \"No nodes found\" do\n      subject { es_handle.nodes.nil? }\n      it { should_not be_truthy }\n    end if es_handle.nodes.nil?\n\n\n    es_handle.nodes.each do |node|\n      describe \"Authentication methods includes AD, LDAP or PKI for Node: #{node.name}\" do\n        subject { node.authc_method.any? { |x| ['pki','active_directory','ldap'].include?(x) } }\n        it{ should be true }\n      end\n    end unless es_handle.nodes.nil?\n\n    es_handle.nodes.each do |node|\n      describe.one do\n        node.authc_realm.keys.each do |auth_method|\n          describe \"Active Directory Settings for Node: #{node.name}\" do\n            subject { es_handle.settings.first.xpack.security.authc.realms[auth_method] }\n            its ('order') { should_not be_nil }\n            its ('domain_name') { should_not be_nil }\n            its ('url') { should_not be_nil }\n            its ('unmapped_groups_as_roles') { should_not be_nil }\n          end if node.authc_realm[auth_method].type.eql?('active_directory')\n\n          describe \"LDAP Settings for Node: #{node.name}\" do\n            subject { es_handle.settings.first.xpack.security.authc.realms[auth_method] }\n            its ('order') { should_not be_nil }\n            its ('url') { should_not be_nil }\n            its ('bind_dn') { should_not be_nil }\n            its ('bind_password') { should_not be_nil }\n            its ('user_search.base_dn') { should_not be_nil }\n            its ('user_search.attribute') { should_not be_nil }\n            its ('group_search.base_dn') { should_not be_nil }\n            its ('files.role_mapping') { should_not be_nil }\n          end if node.authc_realm[auth_method].type.eql?('ldap')\n\n          describe \"PKI Settings for Node: #{node.name}\" do\n            subject { node.authc_realm[auth_method] }\n            its ('order') { should_not be_nil }\n            its ('username_pattern') { should_not be_nil }\n          end if node.authc_realm[auth_method].type.eql?('pki')\n        end\n      end\n    end unless es_handle.nodes.nil?\n\n  rescue Exception => msg\n    describe \"Exception: #{msg}\" do\n      it { should be_nil}\n    end\n  end\nend\n",
          "source_location": {
            "line": 35,
            "ref": "../elasticsearch-inspec/controls/ad+ldap+pki/V-26883.rb"
          },
          "results": [
            {
              "status": "passed",
              "code_desc": "Authentication methods includes AD, LDAP or PKI for Node: package-centos-72 should equal true",
              "run_time": 0.000073,
              "start_time": "2018-02-11 14:26:57 -0500"
            },
            {
              "status": "passed",
              "code_desc": "PKI Settings for Node: package-centos-72 order should not be nil",
              "run_time": 0.000066,
              "start_time": "2018-02-11 14:26:57 -0500"
            },
            {
              "status": "passed",
              "code_desc": "PKI Settings for Node: package-centos-72 username_pattern should not be nil",
              "run_time": 0.000059,
              "start_time": "2018-02-11 14:26:57 -0500"
            }
          ]
        },
        {
          "id": "V-26930",
          "title": "Applications must ensure that PKI-based authentication maps the\nauthenticated identity to the user account.",
          "desc": "Configure the centralized authentication service to enforce\norganizational policies such as password strength, lockout, expiration,\nnotification, and screen obfuscation.",
          "impact": 0.5,
          "refs": [],
          "tags": {
            "nist": [
              "IA-5 (2) (c)",
              "Rev_4"
            ],
            "severity": "medium",
            "rid": "SV-34210r1_rule",
            "gtitle": "SRG-APP-000177",
            "cci": "CCI-000187",
            "check": "Guidance in Appendix B - System accounts cannot be disabled and\nelasticsearch does not enforce password complexity rules.\n\nElasticsearch supports LDAP, Active Directory, and PKI.\n\nIf the external authentication is Active Directory; verify the following\nsettings.\n\n$ cat config/elasticsearch.yml | grep -A 6 -B 6 'type: \\?active_directory'\n\n\n xpack:\n  security:\n    authc:\n      realms:\n        active_directory:\n          type: active_directory\n          order: 0\n          domain_name: ad.example.com\n          url: ldaps://ad.example.com:636\n          unmapped_groups_as_roles: true | false\n\nIf these settings are not correct or missing, this is a finding.\n\nIf the external authentication is LDAP; verify the following settings.\n\n$ cat config/elasticsearch.yml | grep -A 16 -B 6 'type: \\?ldap'\n\nxpack:\n  security:\n    authc:\n      realms:\n        ldap1:\n          type: ldap\n          order: 0\n          url: 'ldaps://ldap.example.com:636'\n          bind_dn: 'cn=ldapuser, ou=users, o=services, dc=example, dc=com'\n          bind_password: changeme\n          user_search:\n            base_dn: 'dc=example,dc=com'\n            attribute: cn\n          group_search:\n            base_dn: 'dc=example,dc=com'\n          files:\n            role_mapping: 'CONFIG_DIR/x-pack/role_mapping.yml\n\nIf these settings are not correct or missing, this is a finding.\n\nIf the external authentication is PKI; verify the following settings.\n\n$ cat config/elasticsearch.yml | grep -A 6 -B 6 'type: \\?pki'\n\n xpack:\n  security:\n    authc:\n      realms:\n        pki1:\n          type: pki\n          username_pattern: 'EMAILADDRESS=(.*?)(?:,|$)'\n\nIf these settings are not correct or missing, this is a finding.\n\n",
            "fix": "Configure elasticsearch realms settings to point to\norganizational supported authentication mechanism\n\nSee the official documentation for the instructions on realm configuration:\nhttps://www.elastic.co/guide/en/x-pack/current/_how_authentication_works.html"
          },
          "code": "control \"V-26930\" do\n  title \"Applications must ensure that PKI-based authentication maps the\nauthenticated identity to the user account.\"\n  desc  \"Configure the centralized authentication service to enforce\norganizational policies such as password strength, lockout, expiration,\nnotification, and screen obfuscation.\"\n  impact 0.5\n  tag \"nist\": [\"IA-5 (2) (c)\", \"Rev_4\"]\n  tag \"severity\": \"medium\"\n  tag \"rid\": \"SV-34210r1_rule\"\n  tag \"gtitle\": \"SRG-APP-000177\"\n  tag \"cci\": \"CCI-000187\"\n  tag \"check\": \"Guidance in Appendix B - System accounts cannot be disabled and\nelasticsearch does not enforce password complexity rules.\n\nElasticsearch supports LDAP, Active Directory, and PKI.\n\nIf the external authentication is Active Directory; verify the following\nsettings.\n\n$ cat config/elasticsearch.yml | grep -A 6 -B 6 'type: \\\\?active_directory'\n\n\n xpack:\n  security:\n    authc:\n      realms:\n        active_directory:\n          type: active_directory\n          order: 0\n          domain_name: ad.example.com\n          url: ldaps://ad.example.com:636\n          unmapped_groups_as_roles: true | false\n\nIf these settings are not correct or missing, this is a finding.\n\nIf the external authentication is LDAP; verify the following settings.\n\n$ cat config/elasticsearch.yml | grep -A 16 -B 6 'type: \\\\?ldap'\n\nxpack:\n  security:\n    authc:\n      realms:\n        ldap1:\n          type: ldap\n          order: 0\n          url: 'ldaps://ldap.example.com:636'\n          bind_dn: 'cn=ldapuser, ou=users, o=services, dc=example, dc=com'\n          bind_password: changeme\n          user_search:\n            base_dn: 'dc=example,dc=com'\n            attribute: cn\n          group_search:\n            base_dn: 'dc=example,dc=com'\n          files:\n            role_mapping: 'CONFIG_DIR/x-pack/role_mapping.yml\n\nIf these settings are not correct or missing, this is a finding.\n\nIf the external authentication is PKI; verify the following settings.\n\n$ cat config/elasticsearch.yml | grep -A 6 -B 6 'type: \\\\?pki'\n\n xpack:\n  security:\n    authc:\n      realms:\n        pki1:\n          type: pki\n          username_pattern: 'EMAILADDRESS=(.*?)(?:,|$)'\n\nIf these settings are not correct or missing, this is a finding.\n\n\"\n  tag \"fix\": \"Configure elasticsearch realms settings to point to\norganizational supported authentication mechanism\n\nSee the official documentation for the instructions on realm configuration:\nhttps://www.elastic.co/guide/en/x-pack/current/_how_authentication_works.html\"\n\n  begin\n\n    es_handle = es_helper(url:\"https://#{ELASTIC_IP}:#{ELASTIC_PORT}\",\n                    username: ES_ADMIN,\n                    password: ES_PASS,\n                    ssl_verify: SSL_VERIFY )\n\n    describe \"No nodes found\" do\n      subject { es_handle.nodes.nil? }\n      it { should_not be_truthy }\n    end if es_handle.nodes.nil?\n\n\n    es_handle.nodes.each do |node|\n      describe \"Authentication methods includes AD, LDAP or PKI for Node: #{node.name}\" do\n        subject { node.authc_method.any? { |x| ['pki','active_directory','ldap'].include?(x) } }\n        it{ should be true }\n      end\n    end unless es_handle.nodes.nil?\n\n    es_handle.nodes.each do |node|\n      describe.one do\n        node.authc_realm.keys.each do |auth_method|\n          describe \"Active Directory Settings for Node: #{node.name}\" do\n            subject { es_handle.settings.first.xpack.security.authc.realms[auth_method] }\n            its ('order') { should_not be_nil }\n            its ('domain_name') { should_not be_nil }\n            its ('url') { should_not be_nil }\n            its ('unmapped_groups_as_roles') { should_not be_nil }\n          end if node.authc_realm[auth_method].type.eql?('active_directory')\n\n          describe \"LDAP Settings for Node: #{node.name}\" do\n            subject { es_handle.settings.first.xpack.security.authc.realms[auth_method] }\n            its ('order') { should_not be_nil }\n            its ('url') { should_not be_nil }\n            its ('bind_dn') { should_not be_nil }\n            its ('bind_password') { should_not be_nil }\n            its ('user_search.base_dn') { should_not be_nil }\n            its ('user_search.attribute') { should_not be_nil }\n            its ('group_search.base_dn') { should_not be_nil }\n            its ('files.role_mapping') { should_not be_nil }\n          end if node.authc_realm[auth_method].type.eql?('ldap')\n\n          describe \"PKI Settings for Node: #{node.name}\" do\n            subject { node.authc_realm[auth_method] }\n            its ('order') { should_not be_nil }\n            its ('username_pattern') { should_not be_nil }\n          end if node.authc_realm[auth_method].type.eql?('pki')\n        end\n      end\n    end unless es_handle.nodes.nil?\n\n  rescue Exception => msg\n    describe \"Exception: #{msg}\" do\n      it { should be_nil}\n    end\n  end\nend",
          "source_location": {
            "line": 36,
            "ref": "../elasticsearch-inspec/controls/ad+ldap+pki/V-26930.rb"
          },
          "results": [
            {
              "status": "passed",
              "code_desc": "Authentication methods includes AD, LDAP or PKI for Node: package-centos-72 should equal true",
              "run_time": 0.00007,
              "start_time": "2018-02-11 14:26:57 -0500"
            },
            {
              "status": "passed",
              "code_desc": "PKI Settings for Node: package-centos-72 order should not be nil",
              "run_time": 0.000059,
              "start_time": "2018-02-11 14:26:57 -0500"
            },
            {
              "status": "passed",
              "code_desc": "PKI Settings for Node: package-centos-72 username_pattern should not be nil",
              "run_time": 0.000064,
              "start_time": "2018-02-11 14:26:57 -0500"
            }
          ]
        },
        {
          "id": "V-26925",
          "title": "Applications must enforce password minimum lifetime restrictions.",
          "desc": "Configure the centralized authentication service to enforce\norganizational policies such as password strength, lockout, expiration,\nnotification, and screen obfuscation.",
          "impact": 0.5,
          "refs": [],
          "tags": {
            "nist": [
              "IA-5 (1) (d)",
              "Rev_4"
            ],
            "severity": "medium",
            "rid": "SV-34205r1_rule",
            "gtitle": "SRG-APP-000173",
            "cci": "CCI-000198",
            "check": "Guidance in Appendix B - System accounts cannot be disabled and\nelasticsearch does not enforce password complexity rules.\n\nElasticsearch supports LDAP, Active Directory, and PKI.\n\nIf the external authentication is Active Directory; verify the following\nsettings.\n\n$ cat config/elasticsearch.yml | grep -A 6 -B 6 'type: \\?active_directory'\n\n\n xpack:\n  security:\n    authc:\n      realms:\n        active_directory:\n          type: active_directory\n          order: 0\n          domain_name: ad.example.com\n          url: ldaps://ad.example.com:636\n          unmapped_groups_as_roles: true | false\n\nIf these settings are not correct or missing, this is a finding.\n\nIf the external authentication is LDAP; verify the following settings.\n\n$ cat config/elasticsearch.yml | grep -A 16 -B 6 'type: \\?ldap'\n\nxpack:\n  security:\n    authc:\n      realms:\n        ldap1:\n          type: ldap\n          order: 0\n          url: 'ldaps://ldap.example.com:636'\n          bind_dn: 'cn=ldapuser, ou=users, o=services, dc=example, dc=com'\n          bind_password: changeme\n          user_search:\n            base_dn: 'dc=example,dc=com'\n            attribute: cn\n          group_search:\n            base_dn: 'dc=example,dc=com'\n          files:\n            role_mapping: 'CONFIG_DIR/x-pack/role_mapping.yml\n\nIf these settings are not correct or missing, this is a finding.\n\nIf the external authentication is PKI; verify the following settings.\n\n$ cat config/elasticsearch.yml | grep -A 6 -B 6 'type: \\?pki'\n\n xpack:\n  security:\n    authc:\n      realms:\n        pki1:\n          type: pki\n          username_pattern: 'EMAILADDRESS=(.*?)(?:,|$)'\n\nIf these settings are not correct or missing, this is a finding.\n\n",
            "fix": "Configure elasticsearch realms settings to point to\norganizational supported authentication mechanism\n\nSee the official documentation for the instructions on realm configuration:\nhttps://www.elastic.co/guide/en/x-pack/current/_how_authentication_works.html"
          },
          "code": "control \"V-26925\" do\n  title \"Applications must enforce password minimum lifetime restrictions.\"\n  desc  \"Configure the centralized authentication service to enforce\norganizational policies such as password strength, lockout, expiration,\nnotification, and screen obfuscation.\"\n  impact 0.5\n  tag \"nist\": [\"IA-5 (1) (d)\", \"Rev_4\"]\n  tag \"severity\": \"medium\"\n  tag \"rid\": \"SV-34205r1_rule\"\n  tag \"gtitle\": \"SRG-APP-000173\"\n  tag \"cci\": \"CCI-000198\"\n  tag \"check\": \"Guidance in Appendix B - System accounts cannot be disabled and\nelasticsearch does not enforce password complexity rules.\n\nElasticsearch supports LDAP, Active Directory, and PKI.\n\nIf the external authentication is Active Directory; verify the following\nsettings.\n\n$ cat config/elasticsearch.yml | grep -A 6 -B 6 'type: \\\\?active_directory'\n\n\n xpack:\n  security:\n    authc:\n      realms:\n        active_directory:\n          type: active_directory\n          order: 0\n          domain_name: ad.example.com\n          url: ldaps://ad.example.com:636\n          unmapped_groups_as_roles: true | false\n\nIf these settings are not correct or missing, this is a finding.\n\nIf the external authentication is LDAP; verify the following settings.\n\n$ cat config/elasticsearch.yml | grep -A 16 -B 6 'type: \\\\?ldap'\n\nxpack:\n  security:\n    authc:\n      realms:\n        ldap1:\n          type: ldap\n          order: 0\n          url: 'ldaps://ldap.example.com:636'\n          bind_dn: 'cn=ldapuser, ou=users, o=services, dc=example, dc=com'\n          bind_password: changeme\n          user_search:\n            base_dn: 'dc=example,dc=com'\n            attribute: cn\n          group_search:\n            base_dn: 'dc=example,dc=com'\n          files:\n            role_mapping: 'CONFIG_DIR/x-pack/role_mapping.yml\n\nIf these settings are not correct or missing, this is a finding.\n\nIf the external authentication is PKI; verify the following settings.\n\n$ cat config/elasticsearch.yml | grep -A 6 -B 6 'type: \\\\?pki'\n\n xpack:\n  security:\n    authc:\n      realms:\n        pki1:\n          type: pki\n          username_pattern: 'EMAILADDRESS=(.*?)(?:,|$)'\n\nIf these settings are not correct or missing, this is a finding.\n\n\"\n  tag \"fix\": \"Configure elasticsearch realms settings to point to\norganizational supported authentication mechanism\n\nSee the official documentation for the instructions on realm configuration:\nhttps://www.elastic.co/guide/en/x-pack/current/_how_authentication_works.html\"\n\n  begin\n\n    es_handle = es_helper(url:\"https://#{ELASTIC_IP}:#{ELASTIC_PORT}\",\n                    username: ES_ADMIN,\n                    password: ES_PASS,\n                    ssl_verify: SSL_VERIFY )\n\n    describe \"No nodes found\" do\n      subject { es_handle.nodes.nil? }\n      it { should_not be_truthy }\n    end if es_handle.nodes.nil?\n\n\n    es_handle.nodes.each do |node|\n      describe \"Authentication methods includes AD, LDAP or PKI for Node: #{node.name}\" do\n        subject { node.authc_method.any? { |x| ['pki','active_directory','ldap'].include?(x) } }\n        it{ should be true }\n      end\n    end unless es_handle.nodes.nil?\n\n    es_handle.nodes.each do |node|\n      describe.one do\n        node.authc_realm.keys.each do |auth_method|\n          describe \"Active Directory Settings for Node: #{node.name}\" do\n            subject { es_handle.settings.first.xpack.security.authc.realms[auth_method] }\n            its ('order') { should_not be_nil }\n            its ('domain_name') { should_not be_nil }\n            its ('url') { should_not be_nil }\n            its ('unmapped_groups_as_roles') { should_not be_nil }\n          end if node.authc_realm[auth_method].type.eql?('active_directory')\n\n          describe \"LDAP Settings for Node: #{node.name}\" do\n            subject { es_handle.settings.first.xpack.security.authc.realms[auth_method] }\n            its ('order') { should_not be_nil }\n            its ('url') { should_not be_nil }\n            its ('bind_dn') { should_not be_nil }\n            its ('bind_password') { should_not be_nil }\n            its ('user_search.base_dn') { should_not be_nil }\n            its ('user_search.attribute') { should_not be_nil }\n            its ('group_search.base_dn') { should_not be_nil }\n            its ('files.role_mapping') { should_not be_nil }\n          end if node.authc_realm[auth_method].type.eql?('ldap')\n\n          describe \"PKI Settings for Node: #{node.name}\" do\n            subject { node.authc_realm[auth_method] }\n            its ('order') { should_not be_nil }\n            its ('username_pattern') { should_not be_nil }\n          end if node.authc_realm[auth_method].type.eql?('pki')\n        end\n      end\n    end unless es_handle.nodes.nil?\n\n  rescue Exception => msg\n    describe \"Exception: #{msg}\" do\n      it { should be_nil}\n    end\n  end\nend",
          "source_location": {
            "line": 36,
            "ref": "../elasticsearch-inspec/controls/ad+ldap+pki/V-26925.rb"
          },
          "results": [
            {
              "status": "passed",
              "code_desc": "Authentication methods includes AD, LDAP or PKI for Node: package-centos-72 should equal true",
              "run_time": 0.000083,
              "start_time": "2018-02-11 14:26:57 -0500"
            },
            {
              "status": "passed",
              "code_desc": "PKI Settings for Node: package-centos-72 order should not be nil",
              "run_time": 0.000069,
              "start_time": "2018-02-11 14:26:57 -0500"
            },
            {
              "status": "passed",
              "code_desc": "PKI Settings for Node: package-centos-72 username_pattern should not be nil",
              "run_time": 0.00006,
              "start_time": "2018-02-11 14:26:57 -0500"
            }
          ]
        },
        {
          "id": "V-26886",
          "title": "Applications must notify users of  organizational-defined\nsecurity-related changes to the users account occurring during the\norganizational-defined time period.",
          "desc": "Configure the centralized authentication service to enforce\norganizational policies such as password strength, lockout, expiration,\nnotification, and screen obfuscation.",
          "impact": 0.5,
          "refs": [],
          "tags": {
            "nist": [
              "AC-9 (3)",
              "Rev_4"
            ],
            "severity": "medium",
            "rid": "SV-34166r1_rule",
            "gtitle": "SRG-APP-000079",
            "cci": "CCI-001395",
            "check": "Guidance in Appendix B - System accounts cannot be disabled and\nelasticsearch does not enforce password complexity rules.\n\nElasticsearch supports LDAP, Active Directory, and PKI.\n\nIf the external authentication is Active Directory; verify the following\nsettings.\n\n$ cat config/elasticsearch.yml | grep -A 6 -B 6 'type: \\?active_directory'\n\n\n xpack:\n  security:\n    authc:\n      realms:\n        active_directory:\n          type: active_directory\n          order: 0\n          domain_name: ad.example.com\n          url: ldaps://ad.example.com:636\n          unmapped_groups_as_roles: true | false\n\nIf these settings are not correct or missing, this is a finding.\n\nIf the external authentication is LDAP; verify the following settings.\n\n$ cat config/elasticsearch.yml | grep -A 16 -B 6 'type: \\?ldap'\n\nxpack:\n  security:\n    authc:\n      realms:\n        ldap1:\n          type: ldap\n          order: 0\n          url: 'ldaps://ldap.example.com:636'\n          bind_dn: 'cn=ldapuser, ou=users, o=services, dc=example, dc=com'\n          bind_password: changeme\n          user_search:\n            base_dn: 'dc=example,dc=com'\n            attribute: cn\n          group_search:\n            base_dn: 'dc=example,dc=com'\n          files:\n            role_mapping: 'CONFIG_DIR/x-pack/role_mapping.yml\n\nIf these settings are not correct or missing, this is a finding.\n\nIf the external authentication is PKI; verify the following settings.\n\n$ cat config/elasticsearch.yml | grep -A 6 -B 6 'type: \\?pki'\n\n xpack:\n  security:\n    authc:\n      realms:\n        pki1:\n          type: pki\n          username_pattern: 'EMAILADDRESS=(.*?)(?:,|$)'\n\nIf these settings are not correct or missing, this is a finding.\n\n",
            "fix": "Configure elasticsearch realms settings to point to\norganizational supported authentication mechanism\n\nSee the official documentation for the instructions on realm configuration:\nhttps://www.elastic.co/guide/en/x-pack/current/_how_authentication_works.html"
          },
          "code": "control \"V-26886\" do\n  title \"Applications must notify users of  organizational-defined\nsecurity-related changes to the user\\u0089s account occurring during the\norganizational-defined time period.\"\n  desc  \"Configure the centralized authentication service to enforce\norganizational policies such as password strength, lockout, expiration,\nnotification, and screen obfuscation.\"\n  impact 0.5\n  tag \"nist\": [\"AC-9 (3)\", \"Rev_4\"]\n  tag \"severity\": \"medium\"\n  tag \"rid\": \"SV-34166r1_rule\"\n  tag \"gtitle\": \"SRG-APP-000079\"\n  tag \"cci\": \"CCI-001395\"\n  tag \"check\": \"Guidance in Appendix B - System accounts cannot be disabled and\nelasticsearch does not enforce password complexity rules.\n\nElasticsearch supports LDAP, Active Directory, and PKI.\n\nIf the external authentication is Active Directory; verify the following\nsettings.\n\n$ cat config/elasticsearch.yml | grep -A 6 -B 6 'type: \\\\?active_directory'\n\n\n xpack:\n  security:\n    authc:\n      realms:\n        active_directory:\n          type: active_directory\n          order: 0\n          domain_name: ad.example.com\n          url: ldaps://ad.example.com:636\n          unmapped_groups_as_roles: true | false\n\nIf these settings are not correct or missing, this is a finding.\n\nIf the external authentication is LDAP; verify the following settings.\n\n$ cat config/elasticsearch.yml | grep -A 16 -B 6 'type: \\\\?ldap'\n\nxpack:\n  security:\n    authc:\n      realms:\n        ldap1:\n          type: ldap\n          order: 0\n          url: 'ldaps://ldap.example.com:636'\n          bind_dn: 'cn=ldapuser, ou=users, o=services, dc=example, dc=com'\n          bind_password: changeme\n          user_search:\n            base_dn: 'dc=example,dc=com'\n            attribute: cn\n          group_search:\n            base_dn: 'dc=example,dc=com'\n          files:\n            role_mapping: 'CONFIG_DIR/x-pack/role_mapping.yml\n\nIf these settings are not correct or missing, this is a finding.\n\nIf the external authentication is PKI; verify the following settings.\n\n$ cat config/elasticsearch.yml | grep -A 6 -B 6 'type: \\\\?pki'\n\n xpack:\n  security:\n    authc:\n      realms:\n        pki1:\n          type: pki\n          username_pattern: 'EMAILADDRESS=(.*?)(?:,|$)'\n\nIf these settings are not correct or missing, this is a finding.\n\n\"\n  tag \"fix\": \"Configure elasticsearch realms settings to point to\norganizational supported authentication mechanism\n\nSee the official documentation for the instructions on realm configuration:\nhttps://www.elastic.co/guide/en/x-pack/current/_how_authentication_works.html\"\n\n\n  begin\n\n    es_handle = es_helper(url:\"https://#{ELASTIC_IP}:#{ELASTIC_PORT}\",\n                    username: ES_ADMIN,\n                    password: ES_PASS,\n                    ssl_verify: SSL_VERIFY )\n\n    describe \"No nodes found\" do\n      subject { es_handle.nodes.nil? }\n      it { should_not be_truthy }\n    end if es_handle.nodes.nil?\n\n\n    es_handle.nodes.each do |node|\n      describe \"Authentication methods includes AD, LDAP or PKI for Node: #{node.name}\" do\n        subject { node.authc_method.any? { |x| ['pki','active_directory','ldap'].include?(x) } }\n        it{ should be true }\n      end\n    end unless es_handle.nodes.nil?\n\n    es_handle.nodes.each do |node|\n      describe.one do\n        node.authc_realm.keys.each do |auth_method|\n          describe \"Active Directory Settings for Node: #{node.name}\" do\n            subject { es_handle.settings.first.xpack.security.authc.realms[auth_method] }\n            its ('order') { should_not be_nil }\n            its ('domain_name') { should_not be_nil }\n            its ('url') { should_not be_nil }\n            its ('unmapped_groups_as_roles') { should_not be_nil }\n          end if node.authc_realm[auth_method].type.eql?('active_directory')\n\n          describe \"LDAP Settings for Node: #{node.name}\" do\n            subject { es_handle.settings.first.xpack.security.authc.realms[auth_method] }\n            its ('order') { should_not be_nil }\n            its ('url') { should_not be_nil }\n            its ('bind_dn') { should_not be_nil }\n            its ('bind_password') { should_not be_nil }\n            its ('user_search.base_dn') { should_not be_nil }\n            its ('user_search.attribute') { should_not be_nil }\n            its ('group_search.base_dn') { should_not be_nil }\n            its ('files.role_mapping') { should_not be_nil }\n          end if node.authc_realm[auth_method].type.eql?('ldap')\n\n          describe \"PKI Settings for Node: #{node.name}\" do\n            subject { node.authc_realm[auth_method] }\n            its ('order') { should_not be_nil }\n            its ('username_pattern') { should_not be_nil }\n          end if node.authc_realm[auth_method].type.eql?('pki')\n        end\n      end\n    end unless es_handle.nodes.nil?\n\n  rescue Exception => msg\n    describe \"Exception: #{msg}\" do\n      it { should be_nil}\n    end\n  end\nend\n",
          "source_location": {
            "line": 36,
            "ref": "../elasticsearch-inspec/controls/ad+ldap+pki/V-26886.rb"
          },
          "results": [
            {
              "status": "passed",
              "code_desc": "Authentication methods includes AD, LDAP or PKI for Node: package-centos-72 should equal true",
              "run_time": 0.000071,
              "start_time": "2018-02-11 14:26:57 -0500"
            },
            {
              "status": "passed",
              "code_desc": "PKI Settings for Node: package-centos-72 order should not be nil",
              "run_time": 0.000066,
              "start_time": "2018-02-11 14:26:57 -0500"
            },
            {
              "status": "passed",
              "code_desc": "PKI Settings for Node: package-centos-72 username_pattern should not be nil",
              "run_time": 0.000059,
              "start_time": "2018-02-11 14:26:57 -0500"
            }
          ]
        },
        {
          "id": "V-26915",
          "title": "The application must support organizational requirements to enforce\nminimum password length.",
          "desc": "Configure the centralized authentication service to enforce\norganizational policies such as password strength, lockout, expiration,\nnotification, and screen obfuscation.",
          "impact": 0.5,
          "refs": [],
          "tags": {
            "nist": [
              "IA-5 (1) (a)",
              "Rev_4"
            ],
            "severity": "medium",
            "rid": "SV-34195r1_rule",
            "gtitle": "SRG-APP-000164",
            "cci": "CCI-000205",
            "check": "Guidance in Appendix B - System accounts cannot be disabled and\nelasticsearch does not enforce password complexity rules.\n\nElasticsearch supports LDAP, Active Directory, and PKI.\n\nIf the external authentication is Active Directory; verify the following\nsettings.\n\n$ cat config/elasticsearch.yml | grep -A 6 -B 6 'type: \\?active_directory'\n\n\n xpack:\n  security:\n    authc:\n      realms:\n        active_directory:\n          type: active_directory\n          order: 0\n          domain_name: ad.example.com\n          url: ldaps://ad.example.com:636\n          unmapped_groups_as_roles: true | false\n\nIf these settings are not correct or missing, this is a finding.\n\nIf the external authentication is LDAP; verify the following settings.\n\n$ cat config/elasticsearch.yml | grep -A 16 -B 6 'type: \\?ldap'\n\nxpack:\n  security:\n    authc:\n      realms:\n        ldap1:\n          type: ldap\n          order: 0\n          url: 'ldaps://ldap.example.com:636'\n          bind_dn: 'cn=ldapuser, ou=users, o=services, dc=example, dc=com'\n          bind_password: changeme\n          user_search:\n            base_dn: 'dc=example,dc=com'\n            attribute: cn\n          group_search:\n            base_dn: 'dc=example,dc=com'\n          files:\n            role_mapping: 'CONFIG_DIR/x-pack/role_mapping.yml\n\nIf these settings are not correct or missing, this is a finding.\n\nIf the external authentication is PKI; verify the following settings.\n\n$ cat config/elasticsearch.yml | grep -A 6 -B 6 'type: \\?pki'\n\n xpack:\n  security:\n    authc:\n      realms:\n        pki1:\n          type: pki\n          username_pattern: 'EMAILADDRESS=(.*?)(?:,|$)'\n\nIf these settings are not correct or missing, this is a finding.\n\n",
            "fix": "Configure elasticsearch realms settings to point to\norganizational supported authentication mechanism\n\nSee the official documentation for the instructions on realm configuration:\nhttps://www.elastic.co/guide/en/x-pack/current/_how_authentication_works.html"
          },
          "code": "control \"V-26915\" do\n  title \"The application must support organizational requirements to enforce\nminimum password length.\"\n  desc  \"Configure the centralized authentication service to enforce\norganizational policies such as password strength, lockout, expiration,\nnotification, and screen obfuscation.\"\n  impact 0.5\n  tag \"nist\": [\"IA-5 (1) (a)\", \"Rev_4\"]\n  tag \"severity\": \"medium\"\n  tag \"rid\": \"SV-34195r1_rule\"\n  tag \"gtitle\": \"SRG-APP-000164\"\n  tag \"cci\": \"CCI-000205\"\n  tag \"check\": \"Guidance in Appendix B - System accounts cannot be disabled and\nelasticsearch does not enforce password complexity rules.\n\nElasticsearch supports LDAP, Active Directory, and PKI.\n\nIf the external authentication is Active Directory; verify the following\nsettings.\n\n$ cat config/elasticsearch.yml | grep -A 6 -B 6 'type: \\\\?active_directory'\n\n\n xpack:\n  security:\n    authc:\n      realms:\n        active_directory:\n          type: active_directory\n          order: 0\n          domain_name: ad.example.com\n          url: ldaps://ad.example.com:636\n          unmapped_groups_as_roles: true | false\n\nIf these settings are not correct or missing, this is a finding.\n\nIf the external authentication is LDAP; verify the following settings.\n\n$ cat config/elasticsearch.yml | grep -A 16 -B 6 'type: \\\\?ldap'\n\nxpack:\n  security:\n    authc:\n      realms:\n        ldap1:\n          type: ldap\n          order: 0\n          url: 'ldaps://ldap.example.com:636'\n          bind_dn: 'cn=ldapuser, ou=users, o=services, dc=example, dc=com'\n          bind_password: changeme\n          user_search:\n            base_dn: 'dc=example,dc=com'\n            attribute: cn\n          group_search:\n            base_dn: 'dc=example,dc=com'\n          files:\n            role_mapping: 'CONFIG_DIR/x-pack/role_mapping.yml\n\nIf these settings are not correct or missing, this is a finding.\n\nIf the external authentication is PKI; verify the following settings.\n\n$ cat config/elasticsearch.yml | grep -A 6 -B 6 'type: \\\\?pki'\n\n xpack:\n  security:\n    authc:\n      realms:\n        pki1:\n          type: pki\n          username_pattern: 'EMAILADDRESS=(.*?)(?:,|$)'\n\nIf these settings are not correct or missing, this is a finding.\n\n\"\n  tag \"fix\": \"Configure elasticsearch realms settings to point to\norganizational supported authentication mechanism\n\nSee the official documentation for the instructions on realm configuration:\nhttps://www.elastic.co/guide/en/x-pack/current/_how_authentication_works.html\"\n\n\n  begin\n\n    es_handle = es_helper(url:\"https://#{ELASTIC_IP}:#{ELASTIC_PORT}\",\n                    username: ES_ADMIN,\n                    password: ES_PASS,\n                    ssl_verify: SSL_VERIFY )\n\n    describe \"No nodes found\" do\n      subject { es_handle.nodes.nil? }\n      it { should_not be_truthy }\n    end if es_handle.nodes.nil?\n\n\n    es_handle.nodes.each do |node|\n      describe \"Authentication methods includes AD, LDAP or PKI for Node: #{node.name}\" do\n        subject { node.authc_method.any? { |x| ['pki','active_directory','ldap'].include?(x) } }\n        it{ should be true }\n      end\n    end unless es_handle.nodes.nil?\n\n    es_handle.nodes.each do |node|\n      describe.one do\n        node.authc_realm.keys.each do |auth_method|\n          describe \"Active Directory Settings for Node: #{node.name}\" do\n            subject { es_handle.settings.first.xpack.security.authc.realms[auth_method] }\n            its ('order') { should_not be_nil }\n            its ('domain_name') { should_not be_nil }\n            its ('url') { should_not be_nil }\n            its ('unmapped_groups_as_roles') { should_not be_nil }\n          end if node.authc_realm[auth_method].type.eql?('active_directory')\n\n          describe \"LDAP Settings for Node: #{node.name}\" do\n            subject { es_handle.settings.first.xpack.security.authc.realms[auth_method] }\n            its ('order') { should_not be_nil }\n            its ('url') { should_not be_nil }\n            its ('bind_dn') { should_not be_nil }\n            its ('bind_password') { should_not be_nil }\n            its ('user_search.base_dn') { should_not be_nil }\n            its ('user_search.attribute') { should_not be_nil }\n            its ('group_search.base_dn') { should_not be_nil }\n            its ('files.role_mapping') { should_not be_nil }\n          end if node.authc_realm[auth_method].type.eql?('ldap')\n\n          describe \"PKI Settings for Node: #{node.name}\" do\n            subject { node.authc_realm[auth_method] }\n            its ('order') { should_not be_nil }\n            its ('username_pattern') { should_not be_nil }\n          end if node.authc_realm[auth_method].type.eql?('pki')\n        end\n      end\n    end unless es_handle.nodes.nil?\n\n  rescue Exception => msg\n    describe \"Exception: #{msg}\" do\n      it { should be_nil}\n    end\n  end\nend\n",
          "source_location": {
            "line": 36,
            "ref": "../elasticsearch-inspec/controls/ad+ldap+pki/V-26915.rb"
          },
          "results": [
            {
              "status": "passed",
              "code_desc": "Authentication methods includes AD, LDAP or PKI for Node: package-centos-72 should equal true",
              "run_time": 0.000078,
              "start_time": "2018-02-11 14:26:57 -0500"
            },
            {
              "status": "passed",
              "code_desc": "PKI Settings for Node: package-centos-72 order should not be nil",
              "run_time": 0.000062,
              "start_time": "2018-02-11 14:26:57 -0500"
            },
            {
              "status": "passed",
              "code_desc": "PKI Settings for Node: package-centos-72 username_pattern should not be nil",
              "run_time": 0.000054,
              "start_time": "2018-02-11 14:26:57 -0500"
            }
          ]
        },
        {
          "id": "V-26855",
          "title": "The application must enforce the organizational-defined time period\nduring which the limit of consecutive invalid access attempts by a user is\ncounted.",
          "desc": "Configure the centralized authentication service to enforce\norganizational policies such as password strength, lockout, expiration,\nnotification, and screen obfuscation.",
          "impact": 0.5,
          "refs": [],
          "tags": {
            "nist": [
              "AC-7 a",
              "Rev_3"
            ],
            "severity": "medium",
            "rid": "SV-34135r1_rule",
            "gtitle": "SRG-APP-000066",
            "cci": "CCI-001452",
            "check": "Guidance in Appendix B - System accounts cannot be disabled and\nelasticsearch does not enforce password complexity rules.\n\nElasticsearch supports LDAP, Active Directory, and PKI.\n\nIf the external authentication is Active Directory; verify the following\nsettings.\n\n$ cat config/elasticsearch.yml | grep -A 6 -B 6 'type: \\?active_directory'\n\n\n xpack:\n  security:\n    authc:\n      realms:\n        active_directory:\n          type: active_directory\n          order: 0\n          domain_name: ad.example.com\n          url: ldaps://ad.example.com:636\n          unmapped_groups_as_roles: true | false\n\nIf these settings are not correct or missing, this is a finding.\n\nIf the external authentication is LDAP; verify the following settings.\n\n$ cat config/elasticsearch.yml | grep -A 16 -B 6 'type: \\?ldap'\n\nxpack:\n  security:\n    authc:\n      realms:\n        ldap1:\n          type: ldap\n          order: 0\n          url: 'ldaps://ldap.example.com:636'\n          bind_dn: 'cn=ldapuser, ou=users, o=services, dc=example, dc=com'\n          bind_password: changeme\n          user_search:\n            base_dn: 'dc=example,dc=com'\n            attribute: cn\n          group_search:\n            base_dn: 'dc=example,dc=com'\n          files:\n            role_mapping: 'CONFIG_DIR/x-pack/role_mapping.yml\n\nIf these settings are not correct or missing, this is a finding.\n\nIf the external authentication is PKI; verify the following settings.\n\n$ cat config/elasticsearch.yml | grep -A 6 -B 6 'type: \\?pki'\n\n xpack:\n  security:\n    authc:\n      realms:\n        pki1:\n          type: pki\n          username_pattern: 'EMAILADDRESS=(.*?)(?:,|$)'\n\nIf these settings are not correct or missing, this is a finding.\n\n",
            "fix": "Configure elasticsearch realms settings to point to\norganizational supported authentication mechanism\n\nSee the official documentation for the instructions on realm configuration:\nhttps://www.elastic.co/guide/en/x-pack/current/_how_authentication_works.html"
          },
          "code": "control \"V-26855\" do\n  title \"The application must enforce the organizational-defined time period\nduring which the limit of consecutive invalid access attempts by a user is\ncounted.\"\n  desc  \"Configure the centralized authentication service to enforce\norganizational policies such as password strength, lockout, expiration,\nnotification, and screen obfuscation.\"\n  impact 0.5\n  tag \"nist\": [\"AC-7 a\", \"Rev_3\"]\n  tag \"severity\": \"medium\"\n  tag \"rid\": \"SV-34135r1_rule\"\n  tag \"gtitle\": \"SRG-APP-000066\"\n  tag \"cci\": \"CCI-001452\"\n  tag \"check\": \"Guidance in Appendix B - System accounts cannot be disabled and\nelasticsearch does not enforce password complexity rules.\n\nElasticsearch supports LDAP, Active Directory, and PKI.\n\nIf the external authentication is Active Directory; verify the following\nsettings.\n\n$ cat config/elasticsearch.yml | grep -A 6 -B 6 'type: \\\\?active_directory'\n\n\n xpack:\n  security:\n    authc:\n      realms:\n        active_directory:\n          type: active_directory\n          order: 0\n          domain_name: ad.example.com\n          url: ldaps://ad.example.com:636\n          unmapped_groups_as_roles: true | false\n\nIf these settings are not correct or missing, this is a finding.\n\nIf the external authentication is LDAP; verify the following settings.\n\n$ cat config/elasticsearch.yml | grep -A 16 -B 6 'type: \\\\?ldap'\n\nxpack:\n  security:\n    authc:\n      realms:\n        ldap1:\n          type: ldap\n          order: 0\n          url: 'ldaps://ldap.example.com:636'\n          bind_dn: 'cn=ldapuser, ou=users, o=services, dc=example, dc=com'\n          bind_password: changeme\n          user_search:\n            base_dn: 'dc=example,dc=com'\n            attribute: cn\n          group_search:\n            base_dn: 'dc=example,dc=com'\n          files:\n            role_mapping: 'CONFIG_DIR/x-pack/role_mapping.yml\n\nIf these settings are not correct or missing, this is a finding.\n\nIf the external authentication is PKI; verify the following settings.\n\n$ cat config/elasticsearch.yml | grep -A 6 -B 6 'type: \\\\?pki'\n\n xpack:\n  security:\n    authc:\n      realms:\n        pki1:\n          type: pki\n          username_pattern: 'EMAILADDRESS=(.*?)(?:,|$)'\n\nIf these settings are not correct or missing, this is a finding.\n\n\"\n  tag \"fix\": \"Configure elasticsearch realms settings to point to\norganizational supported authentication mechanism\n\nSee the official documentation for the instructions on realm configuration:\nhttps://www.elastic.co/guide/en/x-pack/current/_how_authentication_works.html\"\n\n\n  begin\n\n    es_handle = es_helper(url:\"https://#{ELASTIC_IP}:#{ELASTIC_PORT}\",\n                    username: ES_ADMIN,\n                    password: ES_PASS,\n                    ssl_verify: SSL_VERIFY )\n\n    describe \"No nodes found\" do\n      subject { es_handle.nodes.nil? }\n      it { should_not be_truthy }\n    end if es_handle.nodes.nil?\n\n\n    es_handle.nodes.each do |node|\n      describe \"Authentication methods includes AD, LDAP or PKI for Node: #{node.name}\" do\n        subject { node.authc_method.any? { |x| ['pki','active_directory','ldap'].include?(x) } }\n        it{ should be true }\n      end\n    end unless es_handle.nodes.nil?\n\n    es_handle.nodes.each do |node|\n      describe.one do\n        node.authc_realm.keys.each do |auth_method|\n          describe \"Active Directory Settings for Node: #{node.name}\" do\n            subject { es_handle.settings.first.xpack.security.authc.realms[auth_method] }\n            its ('order') { should_not be_nil }\n            its ('domain_name') { should_not be_nil }\n            its ('url') { should_not be_nil }\n            its ('unmapped_groups_as_roles') { should_not be_nil }\n          end if node.authc_realm[auth_method].type.eql?('active_directory')\n\n          describe \"LDAP Settings for Node: #{node.name}\" do\n            subject { es_handle.settings.first.xpack.security.authc.realms[auth_method] }\n            its ('order') { should_not be_nil }\n            its ('url') { should_not be_nil }\n            its ('bind_dn') { should_not be_nil }\n            its ('bind_password') { should_not be_nil }\n            its ('user_search.base_dn') { should_not be_nil }\n            its ('user_search.attribute') { should_not be_nil }\n            its ('group_search.base_dn') { should_not be_nil }\n            its ('files.role_mapping') { should_not be_nil }\n          end if node.authc_realm[auth_method].type.eql?('ldap')\n\n          describe \"PKI Settings for Node: #{node.name}\" do\n            subject { node.authc_realm[auth_method] }\n            its ('order') { should_not be_nil }\n            its ('username_pattern') { should_not be_nil }\n          end if node.authc_realm[auth_method].type.eql?('pki')\n        end\n      end\n    end unless es_handle.nodes.nil?\n\n  rescue Exception => msg\n    describe \"Exception: #{msg}\" do\n      it { should be_nil}\n    end\n  end\nend\n",
          "source_location": {
            "line": 35,
            "ref": "../elasticsearch-inspec/controls/ad+ldap+pki/V-26855.rb"
          },
          "results": [
            {
              "status": "passed",
              "code_desc": "Authentication methods includes AD, LDAP or PKI for Node: package-centos-72 should equal true",
              "run_time": 0.000072,
              "start_time": "2018-02-11 14:26:57 -0500"
            },
            {
              "status": "passed",
              "code_desc": "PKI Settings for Node: package-centos-72 order should not be nil",
              "run_time": 0.000066,
              "start_time": "2018-02-11 14:26:57 -0500"
            },
            {
              "status": "passed",
              "code_desc": "PKI Settings for Node: package-centos-72 username_pattern should not be nil",
              "run_time": 0.000063,
              "start_time": "2018-02-11 14:26:57 -0500"
            }
          ]
        },
        {
          "id": "V-26921",
          "title": "The application must support organizational requirements to enforce\npassword complexity by the number of special characters used.",
          "desc": "Configure the centralized authentication service to enforce\norganizational policies such as password strength, lockout, expiration,\nnotification, and screen obfuscation.",
          "impact": 0.5,
          "refs": [],
          "tags": {
            "nist": [
              "IA-5 (1) (a)",
              "Rev_4"
            ],
            "severity": "medium",
            "rid": "SV-34201r1_rule",
            "gtitle": "SRG-APP-000169",
            "cci": "CCI-001619",
            "check": "Guidance in Appendix B - System accounts cannot be disabled and\nelasticsearch does not enforce password complexity rules.\n\nElasticsearch supports LDAP, Active Directory, and PKI.\n\nIf the external authentication is Active Directory; verify the following\nsettings.\n\n$ cat config/elasticsearch.yml | grep -A 6 -B 6 'type: \\?active_directory'\n\n\n xpack:\n  security:\n    authc:\n      realms:\n        active_directory:\n          type: active_directory\n          order: 0\n          domain_name: ad.example.com\n          url: ldaps://ad.example.com:636\n          unmapped_groups_as_roles: true | false\n\nIf these settings are not correct or missing, this is a finding.\n\nIf the external authentication is LDAP; verify the following settings.\n\n$ cat config/elasticsearch.yml | grep -A 16 -B 6 'type: \\?ldap'\n\nxpack:\n  security:\n    authc:\n      realms:\n        ldap1:\n          type: ldap\n          order: 0\n          url: 'ldaps://ldap.example.com:636'\n          bind_dn: 'cn=ldapuser, ou=users, o=services, dc=example, dc=com'\n          bind_password: changeme\n          user_search:\n            base_dn: 'dc=example,dc=com'\n            attribute: cn\n          group_search:\n            base_dn: 'dc=example,dc=com'\n          files:\n            role_mapping: 'CONFIG_DIR/x-pack/role_mapping.yml\n\nIf these settings are not correct or missing, this is a finding.\n\nIf the external authentication is PKI; verify the following settings.\n\n$ cat config/elasticsearch.yml | grep -A 6 -B 6 'type: \\?pki'\n\n xpack:\n  security:\n    authc:\n      realms:\n        pki1:\n          type: pki\n          username_pattern: 'EMAILADDRESS=(.*?)(?:,|$)'\n\nIf these settings are not correct or missing, this is a finding.\n\n",
            "fix": "Configure elasticsearch realms settings to point to\norganizational supported authentication mechanism\n\nSee the official documentation for the instructions on realm configuration:\nhttps://www.elastic.co/guide/en/x-pack/current/_how_authentication_works.html"
          },
          "code": "control \"V-26921\" do\n  title \"The application must support organizational requirements to enforce\npassword complexity by the number of special characters used.\"\n  desc  \"Configure the centralized authentication service to enforce\norganizational policies such as password strength, lockout, expiration,\nnotification, and screen obfuscation.\"\n  impact 0.5\n  tag \"nist\": [\"IA-5 (1) (a)\", \"Rev_4\"]\n  tag \"severity\": \"medium\"\n  tag \"rid\": \"SV-34201r1_rule\"\n  tag \"gtitle\": \"SRG-APP-000169\"\n  tag \"cci\": \"CCI-001619\"\n  tag \"check\": \"Guidance in Appendix B - System accounts cannot be disabled and\nelasticsearch does not enforce password complexity rules.\n\nElasticsearch supports LDAP, Active Directory, and PKI.\n\nIf the external authentication is Active Directory; verify the following\nsettings.\n\n$ cat config/elasticsearch.yml | grep -A 6 -B 6 'type: \\\\?active_directory'\n\n\n xpack:\n  security:\n    authc:\n      realms:\n        active_directory:\n          type: active_directory\n          order: 0\n          domain_name: ad.example.com\n          url: ldaps://ad.example.com:636\n          unmapped_groups_as_roles: true | false\n\nIf these settings are not correct or missing, this is a finding.\n\nIf the external authentication is LDAP; verify the following settings.\n\n$ cat config/elasticsearch.yml | grep -A 16 -B 6 'type: \\\\?ldap'\n\nxpack:\n  security:\n    authc:\n      realms:\n        ldap1:\n          type: ldap\n          order: 0\n          url: 'ldaps://ldap.example.com:636'\n          bind_dn: 'cn=ldapuser, ou=users, o=services, dc=example, dc=com'\n          bind_password: changeme\n          user_search:\n            base_dn: 'dc=example,dc=com'\n            attribute: cn\n          group_search:\n            base_dn: 'dc=example,dc=com'\n          files:\n            role_mapping: 'CONFIG_DIR/x-pack/role_mapping.yml\n\nIf these settings are not correct or missing, this is a finding.\n\nIf the external authentication is PKI; verify the following settings.\n\n$ cat config/elasticsearch.yml | grep -A 6 -B 6 'type: \\\\?pki'\n\n xpack:\n  security:\n    authc:\n      realms:\n        pki1:\n          type: pki\n          username_pattern: 'EMAILADDRESS=(.*?)(?:,|$)'\n\nIf these settings are not correct or missing, this is a finding.\n\n\"\n  tag \"fix\": \"Configure elasticsearch realms settings to point to\norganizational supported authentication mechanism\n\nSee the official documentation for the instructions on realm configuration:\nhttps://www.elastic.co/guide/en/x-pack/current/_how_authentication_works.html\"\n\n  begin\n\n    es_handle = es_helper(url:\"https://#{ELASTIC_IP}:#{ELASTIC_PORT}\",\n                    username: ES_ADMIN,\n                    password: ES_PASS,\n                    ssl_verify: SSL_VERIFY )\n\n    describe \"No nodes found\" do\n      subject { es_handle.nodes.nil? }\n      it { should_not be_truthy }\n    end if es_handle.nodes.nil?\n\n\n    es_handle.nodes.each do |node|\n      describe \"Authentication methods includes AD, LDAP or PKI for Node: #{node.name}\" do\n        subject { node.authc_method.any? { |x| ['pki','active_directory','ldap'].include?(x) } }\n        it{ should be true }\n      end\n    end unless es_handle.nodes.nil?\n\n    es_handle.nodes.each do |node|\n      describe.one do\n        node.authc_realm.keys.each do |auth_method|\n          describe \"Active Directory Settings for Node: #{node.name}\" do\n            subject { es_handle.settings.first.xpack.security.authc.realms[auth_method] }\n            its ('order') { should_not be_nil }\n            its ('domain_name') { should_not be_nil }\n            its ('url') { should_not be_nil }\n            its ('unmapped_groups_as_roles') { should_not be_nil }\n          end if node.authc_realm[auth_method].type.eql?('active_directory')\n\n          describe \"LDAP Settings for Node: #{node.name}\" do\n            subject { es_handle.settings.first.xpack.security.authc.realms[auth_method] }\n            its ('order') { should_not be_nil }\n            its ('url') { should_not be_nil }\n            its ('bind_dn') { should_not be_nil }\n            its ('bind_password') { should_not be_nil }\n            its ('user_search.base_dn') { should_not be_nil }\n            its ('user_search.attribute') { should_not be_nil }\n            its ('group_search.base_dn') { should_not be_nil }\n            its ('files.role_mapping') { should_not be_nil }\n          end if node.authc_realm[auth_method].type.eql?('ldap')\n\n          describe \"PKI Settings for Node: #{node.name}\" do\n            subject { node.authc_realm[auth_method] }\n            its ('order') { should_not be_nil }\n            its ('username_pattern') { should_not be_nil }\n          end if node.authc_realm[auth_method].type.eql?('pki')\n        end\n      end\n    end unless es_handle.nodes.nil?\n\n  rescue Exception => msg\n    describe \"Exception: #{msg}\" do\n      it { should be_nil}\n    end\n  end\nend",
          "source_location": {
            "line": 36,
            "ref": "../elasticsearch-inspec/controls/ad+ldap+pki/V-26921.rb"
          },
          "results": [
            {
              "status": "passed",
              "code_desc": "Authentication methods includes AD, LDAP or PKI for Node: package-centos-72 should equal true",
              "run_time": 0.004258,
              "start_time": "2018-02-11 14:26:57 -0500"
            },
            {
              "status": "passed",
              "code_desc": "PKI Settings for Node: package-centos-72 order should not be nil",
              "run_time": 0.000062,
              "start_time": "2018-02-11 14:26:57 -0500"
            },
            {
              "status": "passed",
              "code_desc": "PKI Settings for Node: package-centos-72 username_pattern should not be nil",
              "run_time": 0.000103,
              "start_time": "2018-02-11 14:26:57 -0500"
            }
          ]
        },
        {
          "id": "V-30576",
          "title": "The application must notify appropriate individuals when accounts are\nmodified.",
          "desc": "Configure the centralized authentication service to enforce\norganizational policies such as password strength, lockout, expiration,\nnotification, and screen obfuscation.",
          "impact": 0.5,
          "refs": [],
          "tags": {
            "nist": [
              "AC-2 (4)",
              "Rev_4"
            ],
            "severity": "medium",
            "rid": "SV-40310r1_rule",
            "gtitle": "SRG-APP-000292",
            "cci": "CCI-001684",
            "check": "Guidance in Appendix B - System accounts cannot be disabled and\nelasticsearch does not enforce password complexity rules.\n\nElasticsearch supports LDAP, Active Directory, and PKI.\n\nIf the external authentication is Active Directory; verify the following\nsettings.\n\n$ cat config/elasticsearch.yml | grep -A 6 -B 6 'type: \\?active_directory'\n\n\n xpack:\n  security:\n    authc:\n      realms:\n        active_directory:\n          type: active_directory\n          order: 0\n          domain_name: ad.example.com\n          url: ldaps://ad.example.com:636\n          unmapped_groups_as_roles: true | false\n\nIf these settings are not correct or missing, this is a finding.\n\nIf the external authentication is LDAP; verify the following settings.\n\n$ cat config/elasticsearch.yml | grep -A 16 -B 6 'type: \\?ldap'\n\nxpack:\n  security:\n    authc:\n      realms:\n        ldap1:\n          type: ldap\n          order: 0\n          url: 'ldaps://ldap.example.com:636'\n          bind_dn: 'cn=ldapuser, ou=users, o=services, dc=example, dc=com'\n          bind_password: changeme\n          user_search:\n            base_dn: 'dc=example,dc=com'\n            attribute: cn\n          group_search:\n            base_dn: 'dc=example,dc=com'\n          files:\n            role_mapping: 'CONFIG_DIR/x-pack/role_mapping.yml\n\nIf these settings are not correct or missing, this is a finding.\n\nIf the external authentication is PKI; verify the following settings.\n\n$ cat config/elasticsearch.yml | grep -A 6 -B 6 'type: \\?pki'\n\n xpack:\n  security:\n    authc:\n      realms:\n        pki1:\n          type: pki\n          username_pattern: 'EMAILADDRESS=(.*?)(?:,|$)'\n\nIf these settings are not correct or missing, this is a finding.\n\n",
            "fix": "Configure elasticsearch realms settings to point to\norganizational supported authentication mechanism\n\nSee the official documentation for the instructions on realm configuration:\nhttps://www.elastic.co/guide/en/x-pack/current/_how_authentication_works.html"
          },
          "code": "control \"V-30576\" do\n  title \"The application must notify appropriate individuals when accounts are\nmodified.\"\n  desc  \"Configure the centralized authentication service to enforce\norganizational policies such as password strength, lockout, expiration,\nnotification, and screen obfuscation.\"\n  impact 0.5\n  tag \"nist\": [\"AC-2 (4)\", \"Rev_4\"]\n  tag \"severity\": \"medium\"\n  tag \"rid\": \"SV-40310r1_rule\"\n  tag \"gtitle\": \"SRG-APP-000292\"\n  tag \"cci\": \"CCI-001684\"\n  tag \"check\": \"Guidance in Appendix B - System accounts cannot be disabled and\nelasticsearch does not enforce password complexity rules.\n\nElasticsearch supports LDAP, Active Directory, and PKI.\n\nIf the external authentication is Active Directory; verify the following\nsettings.\n\n$ cat config/elasticsearch.yml | grep -A 6 -B 6 'type: \\\\?active_directory'\n\n\n xpack:\n  security:\n    authc:\n      realms:\n        active_directory:\n          type: active_directory\n          order: 0\n          domain_name: ad.example.com\n          url: ldaps://ad.example.com:636\n          unmapped_groups_as_roles: true | false\n\nIf these settings are not correct or missing, this is a finding.\n\nIf the external authentication is LDAP; verify the following settings.\n\n$ cat config/elasticsearch.yml | grep -A 16 -B 6 'type: \\\\?ldap'\n\nxpack:\n  security:\n    authc:\n      realms:\n        ldap1:\n          type: ldap\n          order: 0\n          url: 'ldaps://ldap.example.com:636'\n          bind_dn: 'cn=ldapuser, ou=users, o=services, dc=example, dc=com'\n          bind_password: changeme\n          user_search:\n            base_dn: 'dc=example,dc=com'\n            attribute: cn\n          group_search:\n            base_dn: 'dc=example,dc=com'\n          files:\n            role_mapping: 'CONFIG_DIR/x-pack/role_mapping.yml\n\nIf these settings are not correct or missing, this is a finding.\n\nIf the external authentication is PKI; verify the following settings.\n\n$ cat config/elasticsearch.yml | grep -A 6 -B 6 'type: \\\\?pki'\n\n xpack:\n  security:\n    authc:\n      realms:\n        pki1:\n          type: pki\n          username_pattern: 'EMAILADDRESS=(.*?)(?:,|$)'\n\nIf these settings are not correct or missing, this is a finding.\n\n\"\n  tag \"fix\": \"Configure elasticsearch realms settings to point to\norganizational supported authentication mechanism\n\nSee the official documentation for the instructions on realm configuration:\nhttps://www.elastic.co/guide/en/x-pack/current/_how_authentication_works.html\"\n\n  begin\n\n    es_handle = es_helper(url:\"https://#{ELASTIC_IP}:#{ELASTIC_PORT}\",\n                    username: ES_ADMIN,\n                    password: ES_PASS,\n                    ssl_verify: SSL_VERIFY )\n\n    describe \"No nodes found\" do\n      subject { es_handle.nodes.nil? }\n      it { should_not be_truthy }\n    end if es_handle.nodes.nil?\n\n\n    es_handle.nodes.each do |node|\n      describe \"Authentication methods includes AD, LDAP or PKI for Node: #{node.name}\" do\n        subject { node.authc_method.any? { |x| ['pki','active_directory','ldap'].include?(x) } }\n        it{ should be true }\n      end\n    end unless es_handle.nodes.nil?\n\n    es_handle.nodes.each do |node|\n      describe.one do\n        node.authc_realm.keys.each do |auth_method|\n          describe \"Active Directory Settings for Node: #{node.name}\" do\n            subject { es_handle.settings.first.xpack.security.authc.realms[auth_method] }\n            its ('order') { should_not be_nil }\n            its ('domain_name') { should_not be_nil }\n            its ('url') { should_not be_nil }\n            its ('unmapped_groups_as_roles') { should_not be_nil }\n          end if node.authc_realm[auth_method].type.eql?('active_directory')\n\n          describe \"LDAP Settings for Node: #{node.name}\" do\n            subject { es_handle.settings.first.xpack.security.authc.realms[auth_method] }\n            its ('order') { should_not be_nil }\n            its ('url') { should_not be_nil }\n            its ('bind_dn') { should_not be_nil }\n            its ('bind_password') { should_not be_nil }\n            its ('user_search.base_dn') { should_not be_nil }\n            its ('user_search.attribute') { should_not be_nil }\n            its ('group_search.base_dn') { should_not be_nil }\n            its ('files.role_mapping') { should_not be_nil }\n          end if node.authc_realm[auth_method].type.eql?('ldap')\n\n          describe \"PKI Settings for Node: #{node.name}\" do\n            subject { node.authc_realm[auth_method] }\n            its ('order') { should_not be_nil }\n            its ('username_pattern') { should_not be_nil }\n          end if node.authc_realm[auth_method].type.eql?('pki')\n        end\n      end\n    end unless es_handle.nodes.nil?\n\n  rescue Exception => msg\n    describe \"Exception: #{msg}\" do\n      it { should be_nil}\n    end\n  end\nend",
          "source_location": {
            "line": 36,
            "ref": "../elasticsearch-inspec/controls/ad+ldap+pki/V-30576.rb"
          },
          "results": [
            {
              "status": "passed",
              "code_desc": "Authentication methods includes AD, LDAP or PKI for Node: package-centos-72 should equal true",
              "run_time": 0.000063,
              "start_time": "2018-02-11 14:26:57 -0500"
            },
            {
              "status": "passed",
              "code_desc": "PKI Settings for Node: package-centos-72 order should not be nil",
              "run_time": 0.000056,
              "start_time": "2018-02-11 14:26:57 -0500"
            },
            {
              "status": "passed",
              "code_desc": "PKI Settings for Node: package-centos-72 username_pattern should not be nil",
              "run_time": 0.00005,
              "start_time": "2018-02-11 14:26:57 -0500"
            }
          ]
        },
        {
          "id": "V-26748",
          "title": "Applications must enforce non-discretionary access control policies\nover users and resources where the policy rule set for each policy specifies:\naccess control information (i.e., attributes) employed by the policy rule set\n(e.g., position, nationality, age, project, time of day).",
          "desc": "Configure the centralized authentication service to enforce\norganizational policies such as password strength, lockout, expiration,\nnotification, and screen obfuscation.",
          "impact": 0.5,
          "refs": [],
          "tags": {
            "nist": [
              "AC-3 (3) (a)",
              "Rev_3"
            ],
            "severity": "medium",
            "rid": "SV-33996r1_rule",
            "gtitle": "SRG-APP-000035",
            "cci": "CCI-000022",
            "check": "Guidance in Appendix B - System accounts cannot be disabled and\nelasticsearch does not enforce password complexity rules.\n\nElasticsearch supports LDAP, Active Directory, and PKI.\n\nIf the external authentication is Active Directory; verify the following\nsettings.\n\n$ cat config/elasticsearch.yml | grep -A 6 -B 6 'type: \\?active_directory'\n\n\n xpack:\n  security:\n    authc:\n      realms:\n        active_directory:\n          type: active_directory\n          order: 0\n          domain_name: ad.example.com\n          url: ldaps://ad.example.com:636\n          unmapped_groups_as_roles: true | false\n\nIf these settings are not correct or missing, this is a finding.\n\nIf the external authentication is LDAP; verify the following settings.\n\n$ cat config/elasticsearch.yml | grep -A 16 -B 6 'type: \\?ldap'\n\nxpack:\n  security:\n    authc:\n      realms:\n        ldap1:\n          type: ldap\n          order: 0\n          url: 'ldaps://ldap.example.com:636'\n          bind_dn: 'cn=ldapuser, ou=users, o=services, dc=example, dc=com'\n          bind_password: changeme\n          user_search:\n            base_dn: 'dc=example,dc=com'\n            attribute: cn\n          group_search:\n            base_dn: 'dc=example,dc=com'\n          files:\n            role_mapping: 'CONFIG_DIR/x-pack/role_mapping.yml\n\nIf these settings are not correct or missing, this is a finding.\n\nIf the external authentication is PKI; verify the following settings.\n\n$ cat config/elasticsearch.yml | grep -A 6 -B 6 'type: \\?pki'\n\n xpack:\n  security:\n    authc:\n      realms:\n        pki1:\n          type: pki\n          username_pattern: 'EMAILADDRESS=(.*?)(?:,|$)'\n\nIf these settings are not correct or missing, this is a finding.\n\n",
            "fix": "Configure elasticsearch realms settings to point to\norganizational supported authentication mechanism\n\nSee the official documentation for the instructions on realm configuration:\nhttps://www.elastic.co/guide/en/x-pack/current/_how_authentication_works.html"
          },
          "code": "control \"V-26748\" do\n  title \"Applications must enforce non-discretionary access control policies\nover users and resources where the policy rule set for each policy specifies:\naccess control information (i.e., attributes) employed by the policy rule set\n(e.g., position, nationality, age, project, time of day).\"\n  desc  \"Configure the centralized authentication service to enforce\norganizational policies such as password strength, lockout, expiration,\nnotification, and screen obfuscation.\"\n  impact 0.5\n  tag \"nist\": [\"AC-3 (3) (a)\", \"Rev_3\"]\n  tag \"severity\": \"medium\"\n  tag \"rid\": \"SV-33996r1_rule\"\n  tag \"gtitle\": \"SRG-APP-000035\"\n  tag \"cci\": \"CCI-000022\"\n  tag \"check\": \"Guidance in Appendix B - System accounts cannot be disabled and\nelasticsearch does not enforce password complexity rules.\n\nElasticsearch supports LDAP, Active Directory, and PKI.\n\nIf the external authentication is Active Directory; verify the following\nsettings.\n\n$ cat config/elasticsearch.yml | grep -A 6 -B 6 'type: \\\\?active_directory'\n\n\n xpack:\n  security:\n    authc:\n      realms:\n        active_directory:\n          type: active_directory\n          order: 0\n          domain_name: ad.example.com\n          url: ldaps://ad.example.com:636\n          unmapped_groups_as_roles: true | false\n\nIf these settings are not correct or missing, this is a finding.\n\nIf the external authentication is LDAP; verify the following settings.\n\n$ cat config/elasticsearch.yml | grep -A 16 -B 6 'type: \\\\?ldap'\n\nxpack:\n  security:\n    authc:\n      realms:\n        ldap1:\n          type: ldap\n          order: 0\n          url: 'ldaps://ldap.example.com:636'\n          bind_dn: 'cn=ldapuser, ou=users, o=services, dc=example, dc=com'\n          bind_password: changeme\n          user_search:\n            base_dn: 'dc=example,dc=com'\n            attribute: cn\n          group_search:\n            base_dn: 'dc=example,dc=com'\n          files:\n            role_mapping: 'CONFIG_DIR/x-pack/role_mapping.yml\n\nIf these settings are not correct or missing, this is a finding.\n\nIf the external authentication is PKI; verify the following settings.\n\n$ cat config/elasticsearch.yml | grep -A 6 -B 6 'type: \\\\?pki'\n\n xpack:\n  security:\n    authc:\n      realms:\n        pki1:\n          type: pki\n          username_pattern: 'EMAILADDRESS=(.*?)(?:,|$)'\n\nIf these settings are not correct or missing, this is a finding.\n\n\"\n  tag \"fix\": \"Configure elasticsearch realms settings to point to\norganizational supported authentication mechanism\n\nSee the official documentation for the instructions on realm configuration:\nhttps://www.elastic.co/guide/en/x-pack/current/_how_authentication_works.html\"\n\n\n  begin\n\n    es_handle = es_helper(url:\"https://#{ELASTIC_IP}:#{ELASTIC_PORT}\",\n                    username: ES_ADMIN,\n                    password: ES_PASS,\n                    ssl_verify: SSL_VERIFY )\n\n    describe \"No nodes found\" do\n      subject { es_handle.nodes.nil? }\n      it { should_not be_truthy }\n    end if es_handle.nodes.nil?\n\n\n    es_handle.nodes.each do |node|\n      describe \"Authentication methods includes AD, LDAP or PKI for Node: #{node.name}\" do\n        subject { node.authc_method.any? { |x| ['pki','active_directory','ldap'].include?(x) } }\n        it{ should be true }\n      end\n    end unless es_handle.nodes.nil?\n\n    es_handle.nodes.each do |node|\n      describe.one do\n        node.authc_realm.keys.each do |auth_method|\n          describe \"Active Directory Settings for Node: #{node.name}\" do\n            subject { es_handle.settings.first.xpack.security.authc.realms[auth_method] }\n            its ('order') { should_not be_nil }\n            its ('domain_name') { should_not be_nil }\n            its ('url') { should_not be_nil }\n            its ('unmapped_groups_as_roles') { should_not be_nil }\n          end if node.authc_realm[auth_method].type.eql?('active_directory')\n\n          describe \"LDAP Settings for Node: #{node.name}\" do\n            subject { es_handle.settings.first.xpack.security.authc.realms[auth_method] }\n            its ('order') { should_not be_nil }\n            its ('url') { should_not be_nil }\n            its ('bind_dn') { should_not be_nil }\n            its ('bind_password') { should_not be_nil }\n            its ('user_search.base_dn') { should_not be_nil }\n            its ('user_search.attribute') { should_not be_nil }\n            its ('group_search.base_dn') { should_not be_nil }\n            its ('files.role_mapping') { should_not be_nil }\n          end if node.authc_realm[auth_method].type.eql?('ldap')\n\n          describe \"PKI Settings for Node: #{node.name}\" do\n            subject { node.authc_realm[auth_method] }\n            its ('order') { should_not be_nil }\n            its ('username_pattern') { should_not be_nil }\n          end if node.authc_realm[auth_method].type.eql?('pki')\n        end\n      end\n    end unless es_handle.nodes.nil?\n\n  rescue Exception => msg\n    describe \"Exception: #{msg}\" do\n      it { should be_nil}\n    end\n  end\nend\n",
          "source_location": {
            "line": 36,
            "ref": "../elasticsearch-inspec/controls/ad+ldap+pki/V-26748.rb"
          },
          "results": [
            {
              "status": "passed",
              "code_desc": "Authentication methods includes AD, LDAP or PKI for Node: package-centos-72 should equal true",
              "run_time": 0.000103,
              "start_time": "2018-02-11 14:26:57 -0500"
            },
            {
              "status": "passed",
              "code_desc": "PKI Settings for Node: package-centos-72 order should not be nil",
              "run_time": 0.000054,
              "start_time": "2018-02-11 14:26:57 -0500"
            },
            {
              "status": "passed",
              "code_desc": "PKI Settings for Node: package-centos-72 username_pattern should not be nil",
              "run_time": 0.000106,
              "start_time": "2018-02-11 14:26:57 -0500"
            }
          ]
        },
        {
          "id": "V-26918",
          "title": "The application must support organizational requirements to enforce\npassword complexity by the number of upper case characters used.",
          "desc": "Configure the centralized authentication service to enforce\norganizational policies such as password strength, lockout, expiration,\nnotification, and screen obfuscation.",
          "impact": 0.5,
          "refs": [],
          "tags": {
            "nist": [
              "IA-5 (1) (a)",
              "Rev_4"
            ],
            "severity": "medium",
            "rid": "SV-34198r1_rule",
            "gtitle": "SRG-APP-000166",
            "cci": "CCI-000192",
            "check": "Guidance in Appendix B - System accounts cannot be disabled and\nelasticsearch does not enforce password complexity rules.\n\nElasticsearch supports LDAP, Active Directory, and PKI.\n\nIf the external authentication is Active Directory; verify the following\nsettings.\n\n$ cat config/elasticsearch.yml | grep -A 6 -B 6 'type: \\?active_directory'\n\n\n xpack:\n  security:\n    authc:\n      realms:\n        active_directory:\n          type: active_directory\n          order: 0\n          domain_name: ad.example.com\n          url: ldaps://ad.example.com:636\n          unmapped_groups_as_roles: true | false\n\nIf these settings are not correct or missing, this is a finding.\n\nIf the external authentication is LDAP; verify the following settings.\n\n$ cat config/elasticsearch.yml | grep -A 16 -B 6 'type: \\?ldap'\n\nxpack:\n  security:\n    authc:\n      realms:\n        ldap1:\n          type: ldap\n          order: 0\n          url: 'ldaps://ldap.example.com:636'\n          bind_dn: 'cn=ldapuser, ou=users, o=services, dc=example, dc=com'\n          bind_password: changeme\n          user_search:\n            base_dn: 'dc=example,dc=com'\n            attribute: cn\n          group_search:\n            base_dn: 'dc=example,dc=com'\n          files:\n            role_mapping: 'CONFIG_DIR/x-pack/role_mapping.yml\n\nIf these settings are not correct or missing, this is a finding.\n\nIf the external authentication is PKI; verify the following settings.\n\n$ cat config/elasticsearch.yml | grep -A 6 -B 6 'type: \\?pki'\n\n xpack:\n  security:\n    authc:\n      realms:\n        pki1:\n          type: pki\n          username_pattern: 'EMAILADDRESS=(.*?)(?:,|$)'\n\nIf these settings are not correct or missing, this is a finding.\n\n",
            "fix": "Configure elasticsearch realms settings to point to\norganizational supported authentication mechanism\n\nSee the official documentation for the instructions on realm configuration:\nhttps://www.elastic.co/guide/en/x-pack/current/_how_authentication_works.html"
          },
          "code": "control \"V-26918\" do\n  title \"The application must support organizational requirements to enforce\npassword complexity by the number of upper case characters used.\"\n  desc  \"Configure the centralized authentication service to enforce\norganizational policies such as password strength, lockout, expiration,\nnotification, and screen obfuscation.\"\n  impact 0.5\n  tag \"nist\": [\"IA-5 (1) (a)\", \"Rev_4\"]\n  tag \"severity\": \"medium\"\n  tag \"rid\": \"SV-34198r1_rule\"\n  tag \"gtitle\": \"SRG-APP-000166\"\n  tag \"cci\": \"CCI-000192\"\n  tag \"check\": \"Guidance in Appendix B - System accounts cannot be disabled and\nelasticsearch does not enforce password complexity rules.\n\nElasticsearch supports LDAP, Active Directory, and PKI.\n\nIf the external authentication is Active Directory; verify the following\nsettings.\n\n$ cat config/elasticsearch.yml | grep -A 6 -B 6 'type: \\\\?active_directory'\n\n\n xpack:\n  security:\n    authc:\n      realms:\n        active_directory:\n          type: active_directory\n          order: 0\n          domain_name: ad.example.com\n          url: ldaps://ad.example.com:636\n          unmapped_groups_as_roles: true | false\n\nIf these settings are not correct or missing, this is a finding.\n\nIf the external authentication is LDAP; verify the following settings.\n\n$ cat config/elasticsearch.yml | grep -A 16 -B 6 'type: \\\\?ldap'\n\nxpack:\n  security:\n    authc:\n      realms:\n        ldap1:\n          type: ldap\n          order: 0\n          url: 'ldaps://ldap.example.com:636'\n          bind_dn: 'cn=ldapuser, ou=users, o=services, dc=example, dc=com'\n          bind_password: changeme\n          user_search:\n            base_dn: 'dc=example,dc=com'\n            attribute: cn\n          group_search:\n            base_dn: 'dc=example,dc=com'\n          files:\n            role_mapping: 'CONFIG_DIR/x-pack/role_mapping.yml\n\nIf these settings are not correct or missing, this is a finding.\n\nIf the external authentication is PKI; verify the following settings.\n\n$ cat config/elasticsearch.yml | grep -A 6 -B 6 'type: \\\\?pki'\n\n xpack:\n  security:\n    authc:\n      realms:\n        pki1:\n          type: pki\n          username_pattern: 'EMAILADDRESS=(.*?)(?:,|$)'\n\nIf these settings are not correct or missing, this is a finding.\n\n\"\n  tag \"fix\": \"Configure elasticsearch realms settings to point to\norganizational supported authentication mechanism\n\nSee the official documentation for the instructions on realm configuration:\nhttps://www.elastic.co/guide/en/x-pack/current/_how_authentication_works.html\"\n\n\n  begin\n\n    es_handle = es_helper(url:\"https://#{ELASTIC_IP}:#{ELASTIC_PORT}\",\n                    username: ES_ADMIN,\n                    password: ES_PASS,\n                    ssl_verify: SSL_VERIFY )\n\n    describe \"No nodes found\" do\n      subject { es_handle.nodes.nil? }\n      it { should_not be_truthy }\n    end if es_handle.nodes.nil?\n\n\n    es_handle.nodes.each do |node|\n      describe \"Authentication methods includes AD, LDAP or PKI for Node: #{node.name}\" do\n        subject { node.authc_method.any? { |x| ['pki','active_directory','ldap'].include?(x) } }\n        it{ should be true }\n      end\n    end unless es_handle.nodes.nil?\n\n    es_handle.nodes.each do |node|\n      describe.one do\n        node.authc_realm.keys.each do |auth_method|\n          describe \"Active Directory Settings for Node: #{node.name}\" do\n            subject { es_handle.settings.first.xpack.security.authc.realms[auth_method] }\n            its ('order') { should_not be_nil }\n            its ('domain_name') { should_not be_nil }\n            its ('url') { should_not be_nil }\n            its ('unmapped_groups_as_roles') { should_not be_nil }\n          end if node.authc_realm[auth_method].type.eql?('active_directory')\n\n          describe \"LDAP Settings for Node: #{node.name}\" do\n            subject { es_handle.settings.first.xpack.security.authc.realms[auth_method] }\n            its ('order') { should_not be_nil }\n            its ('url') { should_not be_nil }\n            its ('bind_dn') { should_not be_nil }\n            its ('bind_password') { should_not be_nil }\n            its ('user_search.base_dn') { should_not be_nil }\n            its ('user_search.attribute') { should_not be_nil }\n            its ('group_search.base_dn') { should_not be_nil }\n            its ('files.role_mapping') { should_not be_nil }\n          end if node.authc_realm[auth_method].type.eql?('ldap')\n\n          describe \"PKI Settings for Node: #{node.name}\" do\n            subject { node.authc_realm[auth_method] }\n            its ('order') { should_not be_nil }\n            its ('username_pattern') { should_not be_nil }\n          end if node.authc_realm[auth_method].type.eql?('pki')\n        end\n      end\n    end unless es_handle.nodes.nil?\n\n  rescue Exception => msg\n    describe \"Exception: #{msg}\" do\n      it { should be_nil}\n    end\n  end\nend\n",
          "source_location": {
            "line": 36,
            "ref": "../elasticsearch-inspec/controls/ad+ldap+pki/V-26918.rb"
          },
          "results": [
            {
              "status": "passed",
              "code_desc": "Authentication methods includes AD, LDAP or PKI for Node: package-centos-72 should equal true",
              "run_time": 0.00006,
              "start_time": "2018-02-11 14:26:57 -0500"
            },
            {
              "status": "passed",
              "code_desc": "PKI Settings for Node: package-centos-72 order should not be nil",
              "run_time": 0.000053,
              "start_time": "2018-02-11 14:26:57 -0500"
            },
            {
              "status": "passed",
              "code_desc": "PKI Settings for Node: package-centos-72 username_pattern should not be nil",
              "run_time": 0.000051,
              "start_time": "2018-02-11 14:26:57 -0500"
            }
          ]
        },
        {
          "id": "V-30574",
          "title": "The information system must automatically terminate emergency accounts\nafter an organizational-defined time period for each type of account.",
          "desc": "Configure the centralized authentication service to enforce\norganizational policies such as password strength, lockout, expiration,\nnotification, and screen obfuscation.",
          "impact": 0.5,
          "refs": [],
          "tags": {
            "nist": [
              "AC-2 (2)",
              "Rev_4"
            ],
            "severity": "medium",
            "rid": "SV-40308r1_rule",
            "gtitle": "SRG-APP-000234",
            "cci": "CCI-001682",
            "check": "Guidance in Appendix B - System accounts cannot be disabled and\nelasticsearch does not enforce password complexity rules.\n\nElasticsearch supports LDAP, Active Directory, and PKI.\n\nIf the external authentication is Active Directory; verify the following\nsettings.\n\n$ cat config/elasticsearch.yml | grep -A 6 -B 6 'type: \\?active_directory'\n\n\n xpack:\n  security:\n    authc:\n      realms:\n        active_directory:\n          type: active_directory\n          order: 0\n          domain_name: ad.example.com\n          url: ldaps://ad.example.com:636\n          unmapped_groups_as_roles: true | false\n\nIf these settings are not correct or missing, this is a finding.\n\nIf the external authentication is LDAP; verify the following settings.\n\n$ cat config/elasticsearch.yml | grep -A 16 -B 6 'type: \\?ldap'\n\nxpack:\n  security:\n    authc:\n      realms:\n        ldap1:\n          type: ldap\n          order: 0\n          url: 'ldaps://ldap.example.com:636'\n          bind_dn: 'cn=ldapuser, ou=users, o=services, dc=example, dc=com'\n          bind_password: changeme\n          user_search:\n            base_dn: 'dc=example,dc=com'\n            attribute: cn\n          group_search:\n            base_dn: 'dc=example,dc=com'\n          files:\n            role_mapping: 'CONFIG_DIR/x-pack/role_mapping.yml\n\nIf these settings are not correct or missing, this is a finding.\n\nIf the external authentication is PKI; verify the following settings.\n\n$ cat config/elasticsearch.yml | grep -A 6 -B 6 'type: \\?pki'\n\n xpack:\n  security:\n    authc:\n      realms:\n        pki1:\n          type: pki\n          username_pattern: 'EMAILADDRESS=(.*?)(?:,|$)'\n\nIf these settings are not correct or missing, this is a finding.\n\n",
            "fix": "Configure elasticsearch realms settings to point to\norganizational supported authentication mechanism\n\nSee the official documentation for the instructions on realm configuration:\nhttps://www.elastic.co/guide/en/x-pack/current/_how_authentication_works.html"
          },
          "code": "control \"V-30574\" do\n  title \"The information system must automatically terminate emergency accounts\nafter an organizational-defined time period for each type of account.\"\n  desc  \"Configure the centralized authentication service to enforce\norganizational policies such as password strength, lockout, expiration,\nnotification, and screen obfuscation.\"\n  impact 0.5\n  tag \"nist\": [\"AC-2 (2)\", \"Rev_4\"]\n  tag \"severity\": \"medium\"\n  tag \"rid\": \"SV-40308r1_rule\"\n  tag \"gtitle\": \"SRG-APP-000234\"\n  tag \"cci\": \"CCI-001682\"\n  tag \"check\": \"Guidance in Appendix B - System accounts cannot be disabled and\nelasticsearch does not enforce password complexity rules.\n\nElasticsearch supports LDAP, Active Directory, and PKI.\n\nIf the external authentication is Active Directory; verify the following\nsettings.\n\n$ cat config/elasticsearch.yml | grep -A 6 -B 6 'type: \\\\?active_directory'\n\n\n xpack:\n  security:\n    authc:\n      realms:\n        active_directory:\n          type: active_directory\n          order: 0\n          domain_name: ad.example.com\n          url: ldaps://ad.example.com:636\n          unmapped_groups_as_roles: true | false\n\nIf these settings are not correct or missing, this is a finding.\n\nIf the external authentication is LDAP; verify the following settings.\n\n$ cat config/elasticsearch.yml | grep -A 16 -B 6 'type: \\\\?ldap'\n\nxpack:\n  security:\n    authc:\n      realms:\n        ldap1:\n          type: ldap\n          order: 0\n          url: 'ldaps://ldap.example.com:636'\n          bind_dn: 'cn=ldapuser, ou=users, o=services, dc=example, dc=com'\n          bind_password: changeme\n          user_search:\n            base_dn: 'dc=example,dc=com'\n            attribute: cn\n          group_search:\n            base_dn: 'dc=example,dc=com'\n          files:\n            role_mapping: 'CONFIG_DIR/x-pack/role_mapping.yml\n\nIf these settings are not correct or missing, this is a finding.\n\nIf the external authentication is PKI; verify the following settings.\n\n$ cat config/elasticsearch.yml | grep -A 6 -B 6 'type: \\\\?pki'\n\n xpack:\n  security:\n    authc:\n      realms:\n        pki1:\n          type: pki\n          username_pattern: 'EMAILADDRESS=(.*?)(?:,|$)'\n\nIf these settings are not correct or missing, this is a finding.\n\n\"\n  tag \"fix\": \"Configure elasticsearch realms settings to point to\norganizational supported authentication mechanism\n\nSee the official documentation for the instructions on realm configuration:\nhttps://www.elastic.co/guide/en/x-pack/current/_how_authentication_works.html\"\n\n  begin\n\n    es_handle = es_helper(url:\"https://#{ELASTIC_IP}:#{ELASTIC_PORT}\",\n                    username: ES_ADMIN,\n                    password: ES_PASS,\n                    ssl_verify: SSL_VERIFY )\n\n    describe \"No nodes found\" do\n      subject { es_handle.nodes.nil? }\n      it { should_not be_truthy }\n    end if es_handle.nodes.nil?\n\n\n    es_handle.nodes.each do |node|\n      describe \"Authentication methods includes AD, LDAP or PKI for Node: #{node.name}\" do\n        subject { node.authc_method.any? { |x| ['pki','active_directory','ldap'].include?(x) } }\n        it{ should be true }\n      end\n    end unless es_handle.nodes.nil?\n\n    es_handle.nodes.each do |node|\n      describe.one do\n        node.authc_realm.keys.each do |auth_method|\n          describe \"Active Directory Settings for Node: #{node.name}\" do\n            subject { es_handle.settings.first.xpack.security.authc.realms[auth_method] }\n            its ('order') { should_not be_nil }\n            its ('domain_name') { should_not be_nil }\n            its ('url') { should_not be_nil }\n            its ('unmapped_groups_as_roles') { should_not be_nil }\n          end if node.authc_realm[auth_method].type.eql?('active_directory')\n\n          describe \"LDAP Settings for Node: #{node.name}\" do\n            subject { es_handle.settings.first.xpack.security.authc.realms[auth_method] }\n            its ('order') { should_not be_nil }\n            its ('url') { should_not be_nil }\n            its ('bind_dn') { should_not be_nil }\n            its ('bind_password') { should_not be_nil }\n            its ('user_search.base_dn') { should_not be_nil }\n            its ('user_search.attribute') { should_not be_nil }\n            its ('group_search.base_dn') { should_not be_nil }\n            its ('files.role_mapping') { should_not be_nil }\n          end if node.authc_realm[auth_method].type.eql?('ldap')\n\n          describe \"PKI Settings for Node: #{node.name}\" do\n            subject { node.authc_realm[auth_method] }\n            its ('order') { should_not be_nil }\n            its ('username_pattern') { should_not be_nil }\n          end if node.authc_realm[auth_method].type.eql?('pki')\n        end\n      end\n    end unless es_handle.nodes.nil?\n\n  rescue Exception => msg\n    describe \"Exception: #{msg}\" do\n      it { should be_nil}\n    end\n  end\nend",
          "source_location": {
            "line": 36,
            "ref": "../elasticsearch-inspec/controls/ad+ldap+pki/V-30574.rb"
          },
          "results": [
            {
              "status": "passed",
              "code_desc": "Authentication methods includes AD, LDAP or PKI for Node: package-centos-72 should equal true",
              "run_time": 0.000107,
              "start_time": "2018-02-11 14:26:57 -0500"
            },
            {
              "status": "passed",
              "code_desc": "PKI Settings for Node: package-centos-72 order should not be nil",
              "run_time": 0.000054,
              "start_time": "2018-02-11 14:26:57 -0500"
            },
            {
              "status": "passed",
              "code_desc": "PKI Settings for Node: package-centos-72 username_pattern should not be nil",
              "run_time": 0.000049,
              "start_time": "2018-02-11 14:26:57 -0500"
            }
          ]
        },
        {
          "id": "V-26699",
          "title": "Applications must provide automated mechanisms for supporting user\naccount management. The  automated mechanisms may reside within the application\nitself or may be offered by the operating system or other infrastructure\nproviding automated account management capabilities.",
          "desc": "Configure the centralized authentication service to enforce\norganizational policies such as password strength, lockout, expiration,\nnotification, and screen obfuscation.",
          "impact": 0.5,
          "refs": [],
          "tags": {
            "nist": [
              "AC-2 (1)",
              "Rev_4"
            ],
            "severity": "medium",
            "rid": "SV-33942r1_rule",
            "gtitle": "SRG-APP-000023",
            "cci": "CCI-000015",
            "check": "Guidance in Appendix B - System accounts cannot be disabled and\nelasticsearch does not enforce password complexity rules.\n\nElasticsearch supports LDAP, Active Directory, and PKI.\n\nIf the external authentication is Active Directory; verify the following\nsettings.\n\n$ cat config/elasticsearch.yml | grep -A 6 -B 6 'type: \\?active_directory'\n\n\n xpack:\n  security:\n    authc:\n      realms:\n        active_directory:\n          type: active_directory\n          order: 0\n          domain_name: ad.example.com\n          url: ldaps://ad.example.com:636\n          unmapped_groups_as_roles: true | false\n\nIf these settings are not correct or missing, this is a finding.\n\nIf the external authentication is LDAP; verify the following settings.\n\n$ cat config/elasticsearch.yml | grep -A 16 -B 6 'type: \\?ldap'\n\nxpack:\n  security:\n    authc:\n      realms:\n        ldap1:\n          type: ldap\n          order: 0\n          url: 'ldaps://ldap.example.com:636'\n          bind_dn: 'cn=ldapuser, ou=users, o=services, dc=example, dc=com'\n          bind_password: changeme\n          user_search:\n            base_dn: 'dc=example,dc=com'\n            attribute: cn\n          group_search:\n            base_dn: 'dc=example,dc=com'\n          files:\n            role_mapping: 'CONFIG_DIR/x-pack/role_mapping.yml\n\nIf these settings are not correct or missing, this is a finding.\n\nIf the external authentication is PKI; verify the following settings.\n\n$ cat config/elasticsearch.yml | grep -A 6 -B 6 'type: \\?pki'\n\n xpack:\n  security:\n    authc:\n      realms:\n        pki1:\n          type: pki\n          username_pattern: 'EMAILADDRESS=(.*?)(?:,|$)'\n\nIf these settings are not correct or missing, this is a finding.\n\n",
            "fix": "Configure elasticsearch realms settings to point to\norganizational supported authentication mechanism\n\nSee the official documentation for the instructions on realm configuration:\nhttps://www.elastic.co/guide/en/x-pack/current/_how_authentication_works.html"
          },
          "code": "control \"V-26699\" do\n  title \"Applications must provide automated mechanisms for supporting user\naccount management. The  automated mechanisms may reside within the application\nitself or may be offered by the operating system or other infrastructure\nproviding automated account management capabilities.\"\n  desc  \"Configure the centralized authentication service to enforce\norganizational policies such as password strength, lockout, expiration,\nnotification, and screen obfuscation.\"\n  impact 0.5\n  tag \"nist\": [\"AC-2 (1)\", \"Rev_4\"]\n  tag \"severity\": \"medium\"\n  tag \"rid\": \"SV-33942r1_rule\"\n  tag \"gtitle\": \"SRG-APP-000023\"\n  tag \"cci\": \"CCI-000015\"\n  tag \"check\": \"Guidance in Appendix B - System accounts cannot be disabled and\nelasticsearch does not enforce password complexity rules.\n\nElasticsearch supports LDAP, Active Directory, and PKI.\n\nIf the external authentication is Active Directory; verify the following\nsettings.\n\n$ cat config/elasticsearch.yml | grep -A 6 -B 6 'type: \\\\?active_directory'\n\n\n xpack:\n  security:\n    authc:\n      realms:\n        active_directory:\n          type: active_directory\n          order: 0\n          domain_name: ad.example.com\n          url: ldaps://ad.example.com:636\n          unmapped_groups_as_roles: true | false\n\nIf these settings are not correct or missing, this is a finding.\n\nIf the external authentication is LDAP; verify the following settings.\n\n$ cat config/elasticsearch.yml | grep -A 16 -B 6 'type: \\\\?ldap'\n\nxpack:\n  security:\n    authc:\n      realms:\n        ldap1:\n          type: ldap\n          order: 0\n          url: 'ldaps://ldap.example.com:636'\n          bind_dn: 'cn=ldapuser, ou=users, o=services, dc=example, dc=com'\n          bind_password: changeme\n          user_search:\n            base_dn: 'dc=example,dc=com'\n            attribute: cn\n          group_search:\n            base_dn: 'dc=example,dc=com'\n          files:\n            role_mapping: 'CONFIG_DIR/x-pack/role_mapping.yml\n\nIf these settings are not correct or missing, this is a finding.\n\nIf the external authentication is PKI; verify the following settings.\n\n$ cat config/elasticsearch.yml | grep -A 6 -B 6 'type: \\\\?pki'\n\n xpack:\n  security:\n    authc:\n      realms:\n        pki1:\n          type: pki\n          username_pattern: 'EMAILADDRESS=(.*?)(?:,|$)'\n\nIf these settings are not correct or missing, this is a finding.\n\n\"\n  tag \"fix\": \"Configure elasticsearch realms settings to point to\norganizational supported authentication mechanism\n\nSee the official documentation for the instructions on realm configuration:\nhttps://www.elastic.co/guide/en/x-pack/current/_how_authentication_works.html\"\n\n  begin\n\n    es_handle = es_helper(url:\"https://#{ELASTIC_IP}:#{ELASTIC_PORT}\",\n                    username: ES_ADMIN,\n                    password: ES_PASS,\n                    ssl_verify: SSL_VERIFY )\n\n    describe \"No nodes found\" do\n      subject { es_handle.nodes.nil? }\n      it { should_not be_truthy }\n    end if es_handle.nodes.nil?\n\n\n    es_handle.nodes.each do |node|\n      describe \"Authentication methods includes AD, LDAP or PKI for Node: #{node.name}\" do\n        subject { node.authc_method.any? { |x| ['pki','active_directory','ldap'].include?(x) } }\n        it{ should be true }\n      end\n    end unless es_handle.nodes.nil?\n\n    es_handle.nodes.each do |node|\n      describe.one do\n        node.authc_realm.keys.each do |auth_method|\n          describe \"Active Directory Settings for Node: #{node.name}\" do\n            subject { es_handle.settings.first.xpack.security.authc.realms[auth_method] }\n            its ('order') { should_not be_nil }\n            its ('domain_name') { should_not be_nil }\n            its ('url') { should_not be_nil }\n            its ('unmapped_groups_as_roles') { should_not be_nil }\n          end if node.authc_realm[auth_method].type.eql?('active_directory')\n\n          describe \"LDAP Settings for Node: #{node.name}\" do\n            subject { es_handle.settings.first.xpack.security.authc.realms[auth_method] }\n            its ('order') { should_not be_nil }\n            its ('url') { should_not be_nil }\n            its ('bind_dn') { should_not be_nil }\n            its ('bind_password') { should_not be_nil }\n            its ('user_search.base_dn') { should_not be_nil }\n            its ('user_search.attribute') { should_not be_nil }\n            its ('group_search.base_dn') { should_not be_nil }\n            its ('files.role_mapping') { should_not be_nil }\n          end if node.authc_realm[auth_method].type.eql?('ldap')\n\n          describe \"PKI Settings for Node: #{node.name}\" do\n            subject { node.authc_realm[auth_method] }\n            its ('order') { should_not be_nil }\n            its ('username_pattern') { should_not be_nil }\n          end if node.authc_realm[auth_method].type.eql?('pki')\n        end\n      end\n    end unless es_handle.nodes.nil?\n\n  rescue Exception => msg\n    describe \"Exception: #{msg}\" do\n      it { should be_nil}\n    end\n  end\nend\n",
          "source_location": {
            "line": 35,
            "ref": "../elasticsearch-inspec/controls/ad+ldap+pki/V-26699.rb"
          },
          "results": [
            {
              "status": "passed",
              "code_desc": "Authentication methods includes AD, LDAP or PKI for Node: package-centos-72 should equal true",
              "run_time": 0.000073,
              "start_time": "2018-02-11 14:26:57 -0500"
            },
            {
              "status": "passed",
              "code_desc": "PKI Settings for Node: package-centos-72 order should not be nil",
              "run_time": 0.000053,
              "start_time": "2018-02-11 14:26:57 -0500"
            },
            {
              "status": "passed",
              "code_desc": "PKI Settings for Node: package-centos-72 username_pattern should not be nil",
              "run_time": 0.000051,
              "start_time": "2018-02-11 14:26:57 -0500"
            }
          ]
        },
        {
          "id": "V-30583",
          "title": "The application must notify appropriate individuals when accounts are\nterminated.",
          "desc": "Configure the Elasticsearch cluster to use a centralized\nauthentication and authorization service such as Active Directory or LDAP in\norder to comply with organizational defined management policies.",
          "impact": 0.5,
          "refs": [],
          "tags": {
            "nist": [
              "AC-2 (4)",
              "Rev_4"
            ],
            "severity": "medium",
            "rid": "SV-40323r1_rule",
            "gtitle": "SRG-APP-000294",
            "cci": "CCI-001686",
            "check": "Guidance in Appendix B - System accounts cannot be disabled and\nelasticsearch does not enforce password complexity rules.\n\nElasticsearch supports LDAP, Active Directory, and PKI.\n\nIf the external authentication is Active Directory; verify the following\nsettings.\n\n$ cat config/elasticsearch.yml | grep -A 6 -B 6 'type: \\?active_directory'\n\n\n xpack:\n  security:\n    authc:\n      realms:\n        active_directory:\n          type: active_directory\n          order: 0\n          domain_name: ad.example.com\n          url: ldaps://ad.example.com:636\n          unmapped_groups_as_roles: true | false\n\nIf these settings are not correct or missing, this is a finding.\n\nIf the external authentication is LDAP; verify the following settings.\n\n$ cat config/elasticsearch.yml | grep -A 16 -B 6 'type: \\?ldap'\n\nxpack:\n  security:\n    authc:\n      realms:\n        ldap1:\n          type: ldap\n          order: 0\n          url: 'ldaps://ldap.example.com:636'\n          bind_dn: 'cn=ldapuser, ou=users, o=services, dc=example, dc=com'\n          bind_password: changeme\n          user_search:\n            base_dn: 'dc=example,dc=com'\n            attribute: cn\n          group_search:\n            base_dn: 'dc=example,dc=com'\n          files:\n            role_mapping: 'CONFIG_DIR/x-pack/role_mapping.yml\n\nIf these settings are not correct or missing, this is a finding.\n\nIf the external authentication is PKI; verify the following settings.\n\n$ cat config/elasticsearch.yml | grep -A 6 -B 6 'type: \\?pki'\n\n xpack:\n  security:\n    authc:\n      realms:\n        pki1:\n          type: pki\n          username_pattern: 'EMAILADDRESS=(.*?)(?:,|$)'\n\nIf these settings are not correct or missing, this is a finding.\n\n",
            "fix": "Configure elasticsearch realms settings to point to\norganizational supported authentication mechanism\n\nSee the official documentation for the instructions on realm configuration:\nhttps://www.elastic.co/guide/en/x-pack/current/_how_authentication_works.html"
          },
          "code": "control \"V-30583\" do\n  title \"The application must notify appropriate individuals when accounts are\nterminated.\"\n  desc  \"Configure the Elasticsearch cluster to use a centralized\nauthentication and authorization service such as Active Directory or LDAP in\norder to comply with organizational defined management policies.\"\n  impact 0.5\n  tag \"nist\": [\"AC-2 (4)\", \"Rev_4\"]\n  tag \"severity\": \"medium\"\n  tag \"rid\": \"SV-40323r1_rule\"\n  tag \"gtitle\": \"SRG-APP-000294\"\n  tag \"cci\": \"CCI-001686\"\n  tag \"check\": \"Guidance in Appendix B - System accounts cannot be disabled and\nelasticsearch does not enforce password complexity rules.\n\nElasticsearch supports LDAP, Active Directory, and PKI.\n\nIf the external authentication is Active Directory; verify the following\nsettings.\n\n$ cat config/elasticsearch.yml | grep -A 6 -B 6 'type: \\\\?active_directory'\n\n\n xpack:\n  security:\n    authc:\n      realms:\n        active_directory:\n          type: active_directory\n          order: 0\n          domain_name: ad.example.com\n          url: ldaps://ad.example.com:636\n          unmapped_groups_as_roles: true | false\n\nIf these settings are not correct or missing, this is a finding.\n\nIf the external authentication is LDAP; verify the following settings.\n\n$ cat config/elasticsearch.yml | grep -A 16 -B 6 'type: \\\\?ldap'\n\nxpack:\n  security:\n    authc:\n      realms:\n        ldap1:\n          type: ldap\n          order: 0\n          url: 'ldaps://ldap.example.com:636'\n          bind_dn: 'cn=ldapuser, ou=users, o=services, dc=example, dc=com'\n          bind_password: changeme\n          user_search:\n            base_dn: 'dc=example,dc=com'\n            attribute: cn\n          group_search:\n            base_dn: 'dc=example,dc=com'\n          files:\n            role_mapping: 'CONFIG_DIR/x-pack/role_mapping.yml\n\nIf these settings are not correct or missing, this is a finding.\n\nIf the external authentication is PKI; verify the following settings.\n\n$ cat config/elasticsearch.yml | grep -A 6 -B 6 'type: \\\\?pki'\n\n xpack:\n  security:\n    authc:\n      realms:\n        pki1:\n          type: pki\n          username_pattern: 'EMAILADDRESS=(.*?)(?:,|$)'\n\nIf these settings are not correct or missing, this is a finding.\n\n\"\n  tag \"fix\": \"Configure elasticsearch realms settings to point to\norganizational supported authentication mechanism\n\nSee the official documentation for the instructions on realm configuration:\nhttps://www.elastic.co/guide/en/x-pack/current/_how_authentication_works.html\"\n\n  begin\n\n    es_handle = es_helper(url:\"https://#{ELASTIC_IP}:#{ELASTIC_PORT}\",\n                    username: ES_ADMIN,\n                    password: ES_PASS,\n                    ssl_verify: SSL_VERIFY )\n\n    describe \"No nodes found\" do\n      subject { es_handle.nodes.nil? }\n      it { should_not be_truthy }\n    end if es_handle.nodes.nil?\n\n\n    es_handle.nodes.each do |node|\n      describe \"Authentication methods includes AD, LDAP or PKI for Node: #{node.name}\" do\n        subject { node.authc_method.any? { |x| ['pki','active_directory','ldap'].include?(x) } }\n        it{ should be true }\n      end\n    end unless es_handle.nodes.nil?\n\n    es_handle.nodes.each do |node|\n      describe.one do\n        node.authc_realm.keys.each do |auth_method|\n          describe \"Active Directory Settings for Node: #{node.name}\" do\n            subject { es_handle.settings.first.xpack.security.authc.realms[auth_method] }\n            its ('order') { should_not be_nil }\n            its ('domain_name') { should_not be_nil }\n            its ('url') { should_not be_nil }\n            its ('unmapped_groups_as_roles') { should_not be_nil }\n          end if node.authc_realm[auth_method].type.eql?('active_directory')\n\n          describe \"LDAP Settings for Node: #{node.name}\" do\n            subject { es_handle.settings.first.xpack.security.authc.realms[auth_method] }\n            its ('order') { should_not be_nil }\n            its ('url') { should_not be_nil }\n            its ('bind_dn') { should_not be_nil }\n            its ('bind_password') { should_not be_nil }\n            its ('user_search.base_dn') { should_not be_nil }\n            its ('user_search.attribute') { should_not be_nil }\n            its ('group_search.base_dn') { should_not be_nil }\n            its ('files.role_mapping') { should_not be_nil }\n          end if node.authc_realm[auth_method].type.eql?('ldap')\n\n          describe \"PKI Settings for Node: #{node.name}\" do\n            subject { node.authc_realm[auth_method] }\n            its ('order') { should_not be_nil }\n            its ('username_pattern') { should_not be_nil }\n          end if node.authc_realm[auth_method].type.eql?('pki')\n        end\n      end\n    end unless es_handle.nodes.nil?\n\n  rescue Exception => msg\n    describe \"Exception: #{msg}\" do\n      it { should be_nil}\n    end\n  end\nend",
          "source_location": {
            "line": 36,
            "ref": "../elasticsearch-inspec/controls/ad+ldap+pki/V-30583.rb"
          },
          "results": [
            {
              "status": "passed",
              "code_desc": "Authentication methods includes AD, LDAP or PKI for Node: package-centos-72 should equal true",
              "run_time": 0.00006,
              "start_time": "2018-02-11 14:26:57 -0500"
            },
            {
              "status": "passed",
              "code_desc": "PKI Settings for Node: package-centos-72 order should not be nil",
              "run_time": 0.000054,
              "start_time": "2018-02-11 14:26:57 -0500"
            },
            {
              "status": "passed",
              "code_desc": "PKI Settings for Node: package-centos-72 username_pattern should not be nil",
              "run_time": 0.000049,
              "start_time": "2018-02-11 14:26:57 -0500"
            }
          ]
        },
        {
          "id": "V-26879",
          "title": "Applications upon successful logon, must display to the user the date\nand time of the last logon (access).",
          "desc": "Configure the centralized authentication service to enforce\norganizational policies such as password strength, lockout, expiration,\nnotification, and screen obfuscation.",
          "impact": 0.5,
          "refs": [],
          "tags": {
            "nist": [
              "AC-9",
              "Rev_4"
            ],
            "severity": "medium",
            "rid": "SV-34159r1_rule",
            "gtitle": "SRG-APP-000075",
            "cci": "CCI-000052",
            "check": "Guidance in Appendix B - System accounts cannot be disabled and\nelasticsearch does not enforce password complexity rules.\n\nElasticsearch supports LDAP, Active Directory, and PKI.\n\nIf the external authentication is Active Directory; verify the following\nsettings.\n\n$ cat config/elasticsearch.yml | grep -A 6 -B 6 'type: \\?active_directory'\n\n\n xpack:\n  security:\n    authc:\n      realms:\n        active_directory:\n          type: active_directory\n          order: 0\n          domain_name: ad.example.com\n          url: ldaps://ad.example.com:636\n          unmapped_groups_as_roles: true | false\n\nIf these settings are not correct or missing, this is a finding.\n\nIf the external authentication is LDAP; verify the following settings.\n\n$ cat config/elasticsearch.yml | grep -A 16 -B 6 'type: \\?ldap'\n\nxpack:\n  security:\n    authc:\n      realms:\n        ldap1:\n          type: ldap\n          order: 0\n          url: 'ldaps://ldap.example.com:636'\n          bind_dn: 'cn=ldapuser, ou=users, o=services, dc=example, dc=com'\n          bind_password: changeme\n          user_search:\n            base_dn: 'dc=example,dc=com'\n            attribute: cn\n          group_search:\n            base_dn: 'dc=example,dc=com'\n          files:\n            role_mapping: 'CONFIG_DIR/x-pack/role_mapping.yml\n\nIf these settings are not correct or missing, this is a finding.\n\nIf the external authentication is PKI; verify the following settings.\n\n$ cat config/elasticsearch.yml | grep -A 6 -B 6 'type: \\?pki'\n\n xpack:\n  security:\n    authc:\n      realms:\n        pki1:\n          type: pki\n          username_pattern: 'EMAILADDRESS=(.*?)(?:,|$)'\n\nIf these settings are not correct or missing, this is a finding.\n\n",
            "fix": "Configure elasticsearch realms settings to point to\norganizational supported authentication mechanism\n\nSee the official documentation for the instructions on realm configuration:\nhttps://www.elastic.co/guide/en/x-pack/current/_how_authentication_works.html"
          },
          "code": "control \"V-26879\" do\n  title \"Applications upon successful logon, must display to the user the date\nand time of the last logon (access).\"\n  desc  \"Configure the centralized authentication service to enforce\norganizational policies such as password strength, lockout, expiration,\nnotification, and screen obfuscation.\"\n  impact 0.5\n  tag \"nist\": [\"AC-9\", \"Rev_4\"]\n  tag \"severity\": \"medium\"\n  tag \"rid\": \"SV-34159r1_rule\"\n  tag \"gtitle\": \"SRG-APP-000075\"\n  tag \"cci\": \"CCI-000052\"\n  tag \"check\": \"Guidance in Appendix B - System accounts cannot be disabled and\nelasticsearch does not enforce password complexity rules.\n\nElasticsearch supports LDAP, Active Directory, and PKI.\n\nIf the external authentication is Active Directory; verify the following\nsettings.\n\n$ cat config/elasticsearch.yml | grep -A 6 -B 6 'type: \\\\?active_directory'\n\n\n xpack:\n  security:\n    authc:\n      realms:\n        active_directory:\n          type: active_directory\n          order: 0\n          domain_name: ad.example.com\n          url: ldaps://ad.example.com:636\n          unmapped_groups_as_roles: true | false\n\nIf these settings are not correct or missing, this is a finding.\n\nIf the external authentication is LDAP; verify the following settings.\n\n$ cat config/elasticsearch.yml | grep -A 16 -B 6 'type: \\\\?ldap'\n\nxpack:\n  security:\n    authc:\n      realms:\n        ldap1:\n          type: ldap\n          order: 0\n          url: 'ldaps://ldap.example.com:636'\n          bind_dn: 'cn=ldapuser, ou=users, o=services, dc=example, dc=com'\n          bind_password: changeme\n          user_search:\n            base_dn: 'dc=example,dc=com'\n            attribute: cn\n          group_search:\n            base_dn: 'dc=example,dc=com'\n          files:\n            role_mapping: 'CONFIG_DIR/x-pack/role_mapping.yml\n\nIf these settings are not correct or missing, this is a finding.\n\nIf the external authentication is PKI; verify the following settings.\n\n$ cat config/elasticsearch.yml | grep -A 6 -B 6 'type: \\\\?pki'\n\n xpack:\n  security:\n    authc:\n      realms:\n        pki1:\n          type: pki\n          username_pattern: 'EMAILADDRESS=(.*?)(?:,|$)'\n\nIf these settings are not correct or missing, this is a finding.\n\n\"\n  tag \"fix\": \"Configure elasticsearch realms settings to point to\norganizational supported authentication mechanism\n\nSee the official documentation for the instructions on realm configuration:\nhttps://www.elastic.co/guide/en/x-pack/current/_how_authentication_works.html\"\n\n\n  begin\n\n    es_handle = es_helper(url:\"https://#{ELASTIC_IP}:#{ELASTIC_PORT}\",\n                    username: ES_ADMIN,\n                    password: ES_PASS,\n                    ssl_verify: SSL_VERIFY )\n\n    describe \"No nodes found\" do\n      subject { es_handle.nodes.nil? }\n      it { should_not be_truthy }\n    end if es_handle.nodes.nil?\n\n\n    es_handle.nodes.each do |node|\n      describe \"Authentication methods includes AD, LDAP or PKI for Node: #{node.name}\" do\n        subject { node.authc_method.any? { |x| ['pki','active_directory','ldap'].include?(x) } }\n        it{ should be true }\n      end\n    end unless es_handle.nodes.nil?\n\n    es_handle.nodes.each do |node|\n      describe.one do\n        node.authc_realm.keys.each do |auth_method|\n          describe \"Active Directory Settings for Node: #{node.name}\" do\n            subject { es_handle.settings.first.xpack.security.authc.realms[auth_method] }\n            its ('order') { should_not be_nil }\n            its ('domain_name') { should_not be_nil }\n            its ('url') { should_not be_nil }\n            its ('unmapped_groups_as_roles') { should_not be_nil }\n          end if node.authc_realm[auth_method].type.eql?('active_directory')\n\n          describe \"LDAP Settings for Node: #{node.name}\" do\n            subject { es_handle.settings.first.xpack.security.authc.realms[auth_method] }\n            its ('order') { should_not be_nil }\n            its ('url') { should_not be_nil }\n            its ('bind_dn') { should_not be_nil }\n            its ('bind_password') { should_not be_nil }\n            its ('user_search.base_dn') { should_not be_nil }\n            its ('user_search.attribute') { should_not be_nil }\n            its ('group_search.base_dn') { should_not be_nil }\n            its ('files.role_mapping') { should_not be_nil }\n          end if node.authc_realm[auth_method].type.eql?('ldap')\n\n          describe \"PKI Settings for Node: #{node.name}\" do\n            subject { node.authc_realm[auth_method] }\n            its ('order') { should_not be_nil }\n            its ('username_pattern') { should_not be_nil }\n          end if node.authc_realm[auth_method].type.eql?('pki')\n        end\n      end\n    end unless es_handle.nodes.nil?\n\n  rescue Exception => msg\n    describe \"Exception: #{msg}\" do\n      it { should be_nil}\n    end\n  end\nend\n",
          "source_location": {
            "line": 35,
            "ref": "../elasticsearch-inspec/controls/ad+ldap+pki/V-26879.rb"
          },
          "results": [
            {
              "status": "passed",
              "code_desc": "Authentication methods includes AD, LDAP or PKI for Node: package-centos-72 should equal true",
              "run_time": 0.000061,
              "start_time": "2018-02-11 14:26:57 -0500"
            },
            {
              "status": "passed",
              "code_desc": "PKI Settings for Node: package-centos-72 order should not be nil",
              "run_time": 0.000051,
              "start_time": "2018-02-11 14:26:57 -0500"
            },
            {
              "status": "passed",
              "code_desc": "PKI Settings for Node: package-centos-72 username_pattern should not be nil",
              "run_time": 0.000051,
              "start_time": "2018-02-11 14:26:57 -0500"
            }
          ]
        },
        {
          "id": "V-30582",
          "title": "The application must notify appropriate individuals when account\ndisabling actions are taken.",
          "desc": "Configure the Elasticsearch cluster to use a centralized\nauthentication and authorization service such as Active Directory or LDAP in\norder to comply with organizational defined management policies.",
          "impact": 0.5,
          "refs": [],
          "tags": {
            "nist": [
              "AC-2 (4)",
              "Rev_4"
            ],
            "severity": "medium",
            "rid": "SV-40322r1_rule",
            "gtitle": "SRG-APP-000293",
            "cci": "CCI-001685",
            "check": "Guidance in Appendix B - System accounts cannot be disabled and\nelasticsearch does not enforce password complexity rules.\n\nElasticsearch supports LDAP, Active Directory, and PKI.\n\nIf the external authentication is Active Directory; verify the following\nsettings.\n\n$ cat config/elasticsearch.yml | grep -A 6 -B 6 'type: \\?active_directory'\n\n\n xpack:\n  security:\n    authc:\n      realms:\n        active_directory:\n          type: active_directory\n          order: 0\n          domain_name: ad.example.com\n          url: ldaps://ad.example.com:636\n          unmapped_groups_as_roles: true | false\n\nIf these settings are not correct or missing, this is a finding.\n\nIf the external authentication is LDAP; verify the following settings.\n\n$ cat config/elasticsearch.yml | grep -A 16 -B 6 'type: \\?ldap'\n\nxpack:\n  security:\n    authc:\n      realms:\n        ldap1:\n          type: ldap\n          order: 0\n          url: 'ldaps://ldap.example.com:636'\n          bind_dn: 'cn=ldapuser, ou=users, o=services, dc=example, dc=com'\n          bind_password: changeme\n          user_search:\n            base_dn: 'dc=example,dc=com'\n            attribute: cn\n          group_search:\n            base_dn: 'dc=example,dc=com'\n          files:\n            role_mapping: 'CONFIG_DIR/x-pack/role_mapping.yml\n\nIf these settings are not correct or missing, this is a finding.\n\nIf the external authentication is PKI; verify the following settings.\n\n$ cat config/elasticsearch.yml | grep -A 6 -B 6 'type: \\?pki'\n\n xpack:\n  security:\n    authc:\n      realms:\n        pki1:\n          type: pki\n          username_pattern: 'EMAILADDRESS=(.*?)(?:,|$)'\n\nIf these settings are not correct or missing, this is a finding.\n\n",
            "fix": "Configure elasticsearch realms settings to point to\norganizational supported authentication mechanism\n\nSee the official documentation for the instructions on realm configuration:\nhttps://www.elastic.co/guide/en/x-pack/current/_how_authentication_works.html"
          },
          "code": "control \"V-30582\" do\n  title \"The application must notify appropriate individuals when account\ndisabling actions are taken.\"\n  desc  \"Configure the Elasticsearch cluster to use a centralized\nauthentication and authorization service such as Active Directory or LDAP in\norder to comply with organizational defined management policies.\"\n  impact 0.5\n  tag \"nist\": [\"AC-2 (4)\", \"Rev_4\"]\n  tag \"severity\": \"medium\"\n  tag \"rid\": \"SV-40322r1_rule\"\n  tag \"gtitle\": \"SRG-APP-000293\"\n  tag \"cci\": \"CCI-001685\"\n  tag \"check\": \"Guidance in Appendix B - System accounts cannot be disabled and\nelasticsearch does not enforce password complexity rules.\n\nElasticsearch supports LDAP, Active Directory, and PKI.\n\nIf the external authentication is Active Directory; verify the following\nsettings.\n\n$ cat config/elasticsearch.yml | grep -A 6 -B 6 'type: \\\\?active_directory'\n\n\n xpack:\n  security:\n    authc:\n      realms:\n        active_directory:\n          type: active_directory\n          order: 0\n          domain_name: ad.example.com\n          url: ldaps://ad.example.com:636\n          unmapped_groups_as_roles: true | false\n\nIf these settings are not correct or missing, this is a finding.\n\nIf the external authentication is LDAP; verify the following settings.\n\n$ cat config/elasticsearch.yml | grep -A 16 -B 6 'type: \\\\?ldap'\n\nxpack:\n  security:\n    authc:\n      realms:\n        ldap1:\n          type: ldap\n          order: 0\n          url: 'ldaps://ldap.example.com:636'\n          bind_dn: 'cn=ldapuser, ou=users, o=services, dc=example, dc=com'\n          bind_password: changeme\n          user_search:\n            base_dn: 'dc=example,dc=com'\n            attribute: cn\n          group_search:\n            base_dn: 'dc=example,dc=com'\n          files:\n            role_mapping: 'CONFIG_DIR/x-pack/role_mapping.yml\n\nIf these settings are not correct or missing, this is a finding.\n\nIf the external authentication is PKI; verify the following settings.\n\n$ cat config/elasticsearch.yml | grep -A 6 -B 6 'type: \\\\?pki'\n\n xpack:\n  security:\n    authc:\n      realms:\n        pki1:\n          type: pki\n          username_pattern: 'EMAILADDRESS=(.*?)(?:,|$)'\n\nIf these settings are not correct or missing, this is a finding.\n\n\"\n  tag \"fix\": \"Configure elasticsearch realms settings to point to\norganizational supported authentication mechanism\n\nSee the official documentation for the instructions on realm configuration:\nhttps://www.elastic.co/guide/en/x-pack/current/_how_authentication_works.html\"\n\n  begin\n\n    es_handle = es_helper(url:\"https://#{ELASTIC_IP}:#{ELASTIC_PORT}\",\n                    username: ES_ADMIN,\n                    password: ES_PASS,\n                    ssl_verify: SSL_VERIFY )\n\n    describe \"No nodes found\" do\n      subject { es_handle.nodes.nil? }\n      it { should_not be_truthy }\n    end if es_handle.nodes.nil?\n\n\n    es_handle.nodes.each do |node|\n      describe \"Authentication methods includes AD, LDAP or PKI for Node: #{node.name}\" do\n        subject { node.authc_method.any? { |x| ['pki','active_directory','ldap'].include?(x) } }\n        it{ should be true }\n      end\n    end unless es_handle.nodes.nil?\n\n    es_handle.nodes.each do |node|\n      describe.one do\n        node.authc_realm.keys.each do |auth_method|\n          describe \"Active Directory Settings for Node: #{node.name}\" do\n            subject { es_handle.settings.first.xpack.security.authc.realms[auth_method] }\n            its ('order') { should_not be_nil }\n            its ('domain_name') { should_not be_nil }\n            its ('url') { should_not be_nil }\n            its ('unmapped_groups_as_roles') { should_not be_nil }\n          end if node.authc_realm[auth_method].type.eql?('active_directory')\n\n          describe \"LDAP Settings for Node: #{node.name}\" do\n            subject { es_handle.settings.first.xpack.security.authc.realms[auth_method] }\n            its ('order') { should_not be_nil }\n            its ('url') { should_not be_nil }\n            its ('bind_dn') { should_not be_nil }\n            its ('bind_password') { should_not be_nil }\n            its ('user_search.base_dn') { should_not be_nil }\n            its ('user_search.attribute') { should_not be_nil }\n            its ('group_search.base_dn') { should_not be_nil }\n            its ('files.role_mapping') { should_not be_nil }\n          end if node.authc_realm[auth_method].type.eql?('ldap')\n\n          describe \"PKI Settings for Node: #{node.name}\" do\n            subject { node.authc_realm[auth_method] }\n            its ('order') { should_not be_nil }\n            its ('username_pattern') { should_not be_nil }\n          end if node.authc_realm[auth_method].type.eql?('pki')\n        end\n      end\n    end unless es_handle.nodes.nil?\n\n  rescue Exception => msg\n    describe \"Exception: #{msg}\" do\n      it { should be_nil}\n    end\n  end\nend",
          "source_location": {
            "line": 35,
            "ref": "../elasticsearch-inspec/controls/ad+ldap+pki/V-30582.rb"
          },
          "results": [
            {
              "status": "passed",
              "code_desc": "Authentication methods includes AD, LDAP or PKI for Node: package-centos-72 should equal true",
              "run_time": 0.000059,
              "start_time": "2018-02-11 14:26:57 -0500"
            },
            {
              "status": "passed",
              "code_desc": "PKI Settings for Node: package-centos-72 order should not be nil",
              "run_time": 0.000054,
              "start_time": "2018-02-11 14:26:57 -0500"
            },
            {
              "status": "passed",
              "code_desc": "PKI Settings for Node: package-centos-72 username_pattern should not be nil",
              "run_time": 0.000049,
              "start_time": "2018-02-11 14:26:57 -0500"
            }
          ]
        },
        {
          "id": "V-26919",
          "title": "The application must support organizational requirements to enforce\npassword complexity by the number of lower case characters used.",
          "desc": "Configure the centralized authentication service to enforce\norganizational policies such as password strength, lockout, expiration,\nnotification, and screen obfuscation.",
          "impact": 0.5,
          "refs": [],
          "tags": {
            "nist": [
              "IA-5 (1) (a)",
              "Rev_4"
            ],
            "severity": "medium",
            "rid": "SV-34199r1_rule",
            "gtitle": "SRG-APP-000167",
            "cci": "CCI-000193",
            "check": "Guidance in Appendix B - System accounts cannot be disabled and\nelasticsearch does not enforce password complexity rules.\n\nElasticsearch supports LDAP, Active Directory, and PKI.\n\nIf the external authentication is Active Directory; verify the following\nsettings.\n\n$ cat config/elasticsearch.yml | grep -A 6 -B 6 'type: \\?active_directory'\n\n\n xpack:\n  security:\n    authc:\n      realms:\n        active_directory:\n          type: active_directory\n          order: 0\n          domain_name: ad.example.com\n          url: ldaps://ad.example.com:636\n          unmapped_groups_as_roles: true | false\n\nIf these settings are not correct or missing, this is a finding.\n\nIf the external authentication is LDAP; verify the following settings.\n\n$ cat config/elasticsearch.yml | grep -A 16 -B 6 'type: \\?ldap'\n\nxpack:\n  security:\n    authc:\n      realms:\n        ldap1:\n          type: ldap\n          order: 0\n          url: 'ldaps://ldap.example.com:636'\n          bind_dn: 'cn=ldapuser, ou=users, o=services, dc=example, dc=com'\n          bind_password: changeme\n          user_search:\n            base_dn: 'dc=example,dc=com'\n            attribute: cn\n          group_search:\n            base_dn: 'dc=example,dc=com'\n          files:\n            role_mapping: 'CONFIG_DIR/x-pack/role_mapping.yml\n\nIf these settings are not correct or missing, this is a finding.\n\nIf the external authentication is PKI; verify the following settings.\n\n$ cat config/elasticsearch.yml | grep -A 6 -B 6 'type: \\?pki'\n\n xpack:\n  security:\n    authc:\n      realms:\n        pki1:\n          type: pki\n          username_pattern: 'EMAILADDRESS=(.*?)(?:,|$)'\n\nIf these settings are not correct or missing, this is a finding.\n\n",
            "fix": "Configure elasticsearch realms settings to point to\norganizational supported authentication mechanism\n\nSee the official documentation for the instructions on realm configuration:\nhttps://www.elastic.co/guide/en/x-pack/current/_how_authentication_works.html"
          },
          "code": "control \"V-26919\" do\n  title \"The application must support organizational requirements to enforce\npassword complexity by the number of lower case characters used.\"\n  desc  \"Configure the centralized authentication service to enforce\norganizational policies such as password strength, lockout, expiration,\nnotification, and screen obfuscation.\"\n  impact 0.5\n  tag \"nist\": [\"IA-5 (1) (a)\", \"Rev_4\"]\n  tag \"severity\": \"medium\"\n  tag \"rid\": \"SV-34199r1_rule\"\n  tag \"gtitle\": \"SRG-APP-000167\"\n  tag \"cci\": \"CCI-000193\"\n  tag \"check\": \"Guidance in Appendix B - System accounts cannot be disabled and\nelasticsearch does not enforce password complexity rules.\n\nElasticsearch supports LDAP, Active Directory, and PKI.\n\nIf the external authentication is Active Directory; verify the following\nsettings.\n\n$ cat config/elasticsearch.yml | grep -A 6 -B 6 'type: \\\\?active_directory'\n\n\n xpack:\n  security:\n    authc:\n      realms:\n        active_directory:\n          type: active_directory\n          order: 0\n          domain_name: ad.example.com\n          url: ldaps://ad.example.com:636\n          unmapped_groups_as_roles: true | false\n\nIf these settings are not correct or missing, this is a finding.\n\nIf the external authentication is LDAP; verify the following settings.\n\n$ cat config/elasticsearch.yml | grep -A 16 -B 6 'type: \\\\?ldap'\n\nxpack:\n  security:\n    authc:\n      realms:\n        ldap1:\n          type: ldap\n          order: 0\n          url: 'ldaps://ldap.example.com:636'\n          bind_dn: 'cn=ldapuser, ou=users, o=services, dc=example, dc=com'\n          bind_password: changeme\n          user_search:\n            base_dn: 'dc=example,dc=com'\n            attribute: cn\n          group_search:\n            base_dn: 'dc=example,dc=com'\n          files:\n            role_mapping: 'CONFIG_DIR/x-pack/role_mapping.yml\n\nIf these settings are not correct or missing, this is a finding.\n\nIf the external authentication is PKI; verify the following settings.\n\n$ cat config/elasticsearch.yml | grep -A 6 -B 6 'type: \\\\?pki'\n\n xpack:\n  security:\n    authc:\n      realms:\n        pki1:\n          type: pki\n          username_pattern: 'EMAILADDRESS=(.*?)(?:,|$)'\n\nIf these settings are not correct or missing, this is a finding.\n\n\"\n  tag \"fix\": \"Configure elasticsearch realms settings to point to\norganizational supported authentication mechanism\n\nSee the official documentation for the instructions on realm configuration:\nhttps://www.elastic.co/guide/en/x-pack/current/_how_authentication_works.html\"\n\n  begin\n\n    es_handle = es_helper(url:\"https://#{ELASTIC_IP}:#{ELASTIC_PORT}\",\n                    username: ES_ADMIN,\n                    password: ES_PASS,\n                    ssl_verify: SSL_VERIFY )\n\n    describe \"No nodes found\" do\n      subject { es_handle.nodes.nil? }\n      it { should_not be_truthy }\n    end if es_handle.nodes.nil?\n\n\n    es_handle.nodes.each do |node|\n      describe \"Authentication methods includes AD, LDAP or PKI for Node: #{node.name}\" do\n        subject { node.authc_method.any? { |x| ['pki','active_directory','ldap'].include?(x) } }\n        it{ should be true }\n      end\n    end unless es_handle.nodes.nil?\n\n    es_handle.nodes.each do |node|\n      describe.one do\n        node.authc_realm.keys.each do |auth_method|\n          describe \"Active Directory Settings for Node: #{node.name}\" do\n            subject { es_handle.settings.first.xpack.security.authc.realms[auth_method] }\n            its ('order') { should_not be_nil }\n            its ('domain_name') { should_not be_nil }\n            its ('url') { should_not be_nil }\n            its ('unmapped_groups_as_roles') { should_not be_nil }\n          end if node.authc_realm[auth_method].type.eql?('active_directory')\n\n          describe \"LDAP Settings for Node: #{node.name}\" do\n            subject { es_handle.settings.first.xpack.security.authc.realms[auth_method] }\n            its ('order') { should_not be_nil }\n            its ('url') { should_not be_nil }\n            its ('bind_dn') { should_not be_nil }\n            its ('bind_password') { should_not be_nil }\n            its ('user_search.base_dn') { should_not be_nil }\n            its ('user_search.attribute') { should_not be_nil }\n            its ('group_search.base_dn') { should_not be_nil }\n            its ('files.role_mapping') { should_not be_nil }\n          end if node.authc_realm[auth_method].type.eql?('ldap')\n\n          describe \"PKI Settings for Node: #{node.name}\" do\n            subject { node.authc_realm[auth_method] }\n            its ('order') { should_not be_nil }\n            its ('username_pattern') { should_not be_nil }\n          end if node.authc_realm[auth_method].type.eql?('pki')\n        end\n      end\n    end unless es_handle.nodes.nil?\n\n  rescue Exception => msg\n    describe \"Exception: #{msg}\" do\n      it { should be_nil}\n    end\n  end\nend",
          "source_location": {
            "line": 36,
            "ref": "../elasticsearch-inspec/controls/ad+ldap+pki/V-26919.rb"
          },
          "results": [
            {
              "status": "passed",
              "code_desc": "Authentication methods includes AD, LDAP or PKI for Node: package-centos-72 should equal true",
              "run_time": 0.00006,
              "start_time": "2018-02-11 14:26:57 -0500"
            },
            {
              "status": "passed",
              "code_desc": "PKI Settings for Node: package-centos-72 order should not be nil",
              "run_time": 0.000052,
              "start_time": "2018-02-11 14:26:57 -0500"
            },
            {
              "status": "passed",
              "code_desc": "PKI Settings for Node: package-centos-72 username_pattern should not be nil",
              "run_time": 0.000049,
              "start_time": "2018-02-11 14:26:57 -0500"
            }
          ]
        },
        {
          "id": "V-26909",
          "title": "Applications required to identify devices must uniquely identify and\nauthenticate an organizational-defined list of specific and/or types of devices\nbefore establishing a connection.",
          "desc": "Configure the Elasticsearch cluster to use a centralized\nauthentication and authorization service such as Active Directory or LDAP in\norder to comply with organizational defined management policies.",
          "impact": 0.5,
          "refs": [],
          "tags": {
            "nist": [
              "IA-3",
              "Rev_4"
            ],
            "severity": "medium",
            "rid": "SV-34189r1_rule",
            "gtitle": "SRG-APP-000158",
            "cci": "CCI-000778",
            "check": "Guidance in Appendix B - System accounts cannot be disabled and\nelasticsearch does not enforce password complexity rules.\n\nElasticsearch supports LDAP, Active Directory, and PKI.\n\nIf the external authentication is Active Directory; verify the following\nsettings.\n\n$ cat config/elasticsearch.yml | grep -A 6 -B 6 'type: \\?active_directory'\n\n\n xpack:\n  security:\n    authc:\n      realms:\n        active_directory:\n          type: active_directory\n          order: 0\n          domain_name: ad.example.com\n          url: ldaps://ad.example.com:636\n          unmapped_groups_as_roles: true | false\n\nIf these settings are not correct or missing, this is a finding.\n\nIf the external authentication is LDAP; verify the following settings.\n\n$ cat config/elasticsearch.yml | grep -A 16 -B 6 'type: \\?ldap'\n\nxpack:\n  security:\n    authc:\n      realms:\n        ldap1:\n          type: ldap\n          order: 0\n          url: 'ldaps://ldap.example.com:636'\n          bind_dn: 'cn=ldapuser, ou=users, o=services, dc=example, dc=com'\n          bind_password: changeme\n          user_search:\n            base_dn: 'dc=example,dc=com'\n            attribute: cn\n          group_search:\n            base_dn: 'dc=example,dc=com'\n          files:\n            role_mapping: 'CONFIG_DIR/x-pack/role_mapping.yml\n\nIf these settings are not correct or missing, this is a finding.\n\nIf the external authentication is PKI; verify the following settings.\n\n$ cat config/elasticsearch.yml | grep -A 6 -B 6 'type: \\?pki'\n\n xpack:\n  security:\n    authc:\n      realms:\n        pki1:\n          type: pki\n          username_pattern: 'EMAILADDRESS=(.*?)(?:,|$)'\n\nIf these settings are not correct or missing, this is a finding.\n\n",
            "fix": "Configure elasticsearch realms settings to point to\norganizational supported authentication mechanism\n\nSee the official documentation for the instructions on realm configuration:\nhttps://www.elastic.co/guide/en/x-pack/current/_how_authentication_works.html"
          },
          "code": "control \"V-26909\" do\n  title \"Applications required to identify devices must uniquely identify and\nauthenticate an organizational-defined list of specific and/or types of devices\nbefore establishing a connection.\"\n  desc  \"Configure the Elasticsearch cluster to use a centralized\nauthentication and authorization service such as Active Directory or LDAP in\norder to comply with organizational defined management policies.\"\n  impact 0.5\n  tag \"nist\": [\"IA-3\", \"Rev_4\"]\n  tag \"severity\": \"medium\"\n  tag \"rid\": \"SV-34189r1_rule\"\n  tag \"gtitle\": \"SRG-APP-000158\"\n  tag \"cci\": \"CCI-000778\"\n  tag \"check\": \"Guidance in Appendix B - System accounts cannot be disabled and\nelasticsearch does not enforce password complexity rules.\n\nElasticsearch supports LDAP, Active Directory, and PKI.\n\nIf the external authentication is Active Directory; verify the following\nsettings.\n\n$ cat config/elasticsearch.yml | grep -A 6 -B 6 'type: \\\\?active_directory'\n\n\n xpack:\n  security:\n    authc:\n      realms:\n        active_directory:\n          type: active_directory\n          order: 0\n          domain_name: ad.example.com\n          url: ldaps://ad.example.com:636\n          unmapped_groups_as_roles: true | false\n\nIf these settings are not correct or missing, this is a finding.\n\nIf the external authentication is LDAP; verify the following settings.\n\n$ cat config/elasticsearch.yml | grep -A 16 -B 6 'type: \\\\?ldap'\n\nxpack:\n  security:\n    authc:\n      realms:\n        ldap1:\n          type: ldap\n          order: 0\n          url: 'ldaps://ldap.example.com:636'\n          bind_dn: 'cn=ldapuser, ou=users, o=services, dc=example, dc=com'\n          bind_password: changeme\n          user_search:\n            base_dn: 'dc=example,dc=com'\n            attribute: cn\n          group_search:\n            base_dn: 'dc=example,dc=com'\n          files:\n            role_mapping: 'CONFIG_DIR/x-pack/role_mapping.yml\n\nIf these settings are not correct or missing, this is a finding.\n\nIf the external authentication is PKI; verify the following settings.\n\n$ cat config/elasticsearch.yml | grep -A 6 -B 6 'type: \\\\?pki'\n\n xpack:\n  security:\n    authc:\n      realms:\n        pki1:\n          type: pki\n          username_pattern: 'EMAILADDRESS=(.*?)(?:,|$)'\n\nIf these settings are not correct or missing, this is a finding.\n\n\"\n  tag \"fix\": \"Configure elasticsearch realms settings to point to\norganizational supported authentication mechanism\n\nSee the official documentation for the instructions on realm configuration:\nhttps://www.elastic.co/guide/en/x-pack/current/_how_authentication_works.html\"\n\n\n  begin\n\n    es_handle = es_helper(url:\"https://#{ELASTIC_IP}:#{ELASTIC_PORT}\",\n                    username: ES_ADMIN,\n                    password: ES_PASS,\n                    ssl_verify: SSL_VERIFY )\n\n    describe \"No nodes found\" do\n      subject { es_handle.nodes.nil? }\n      it { should_not be_truthy }\n    end if es_handle.nodes.nil?\n\n\n    es_handle.nodes.each do |node|\n      describe \"Authentication methods includes AD, LDAP or PKI for Node: #{node.name}\" do\n        subject { node.authc_method.any? { |x| ['pki','active_directory','ldap'].include?(x) } }\n        it{ should be true }\n      end\n    end unless es_handle.nodes.nil?\n\n    es_handle.nodes.each do |node|\n      describe.one do\n        node.authc_realm.keys.each do |auth_method|\n          describe \"Active Directory Settings for Node: #{node.name}\" do\n            subject { es_handle.settings.first.xpack.security.authc.realms[auth_method] }\n            its ('order') { should_not be_nil }\n            its ('domain_name') { should_not be_nil }\n            its ('url') { should_not be_nil }\n            its ('unmapped_groups_as_roles') { should_not be_nil }\n          end if node.authc_realm[auth_method].type.eql?('active_directory')\n\n          describe \"LDAP Settings for Node: #{node.name}\" do\n            subject { es_handle.settings.first.xpack.security.authc.realms[auth_method] }\n            its ('order') { should_not be_nil }\n            its ('url') { should_not be_nil }\n            its ('bind_dn') { should_not be_nil }\n            its ('bind_password') { should_not be_nil }\n            its ('user_search.base_dn') { should_not be_nil }\n            its ('user_search.attribute') { should_not be_nil }\n            its ('group_search.base_dn') { should_not be_nil }\n            its ('files.role_mapping') { should_not be_nil }\n          end if node.authc_realm[auth_method].type.eql?('ldap')\n\n          describe \"PKI Settings for Node: #{node.name}\" do\n            subject { node.authc_realm[auth_method] }\n            its ('order') { should_not be_nil }\n            its ('username_pattern') { should_not be_nil }\n          end if node.authc_realm[auth_method].type.eql?('pki')\n        end\n      end\n    end unless es_handle.nodes.nil?\n\n  rescue Exception => msg\n    describe \"Exception: #{msg}\" do\n      it { should be_nil}\n    end\n  end\nend\n",
          "source_location": {
            "line": 36,
            "ref": "../elasticsearch-inspec/controls/ad+ldap+pki/V-26909.rb"
          },
          "results": [
            {
              "status": "passed",
              "code_desc": "Authentication methods includes AD, LDAP or PKI for Node: package-centos-72 should equal true",
              "run_time": 0.000059,
              "start_time": "2018-02-11 14:26:57 -0500"
            },
            {
              "status": "passed",
              "code_desc": "PKI Settings for Node: package-centos-72 order should not be nil",
              "run_time": 0.000053,
              "start_time": "2018-02-11 14:26:57 -0500"
            },
            {
              "status": "passed",
              "code_desc": "PKI Settings for Node: package-centos-72 username_pattern should not be nil",
              "run_time": 0.000048,
              "start_time": "2018-02-11 14:26:57 -0500"
            }
          ]
        },
        {
          "id": "V-30575",
          "title": "The application must notify appropriate individuals when accounts are\ncreated.",
          "desc": "Configure the centralized authentication service to enforce\norganizational policies such as password strength, lockout, expiration,\nnotification, and screen obfuscation.",
          "impact": 0.5,
          "refs": [],
          "tags": {
            "nist": [
              "AC-2 (4)",
              "Rev_4"
            ],
            "severity": "medium",
            "rid": "SV-40309r1_rule",
            "gtitle": "SRG-APP-000291",
            "cci": "CCI-001683",
            "check": "Guidance in Appendix B - System accounts cannot be disabled and\nelasticsearch does not enforce password complexity rules.\n\nElasticsearch supports LDAP, Active Directory, and PKI.\n\nIf the external authentication is Active Directory; verify the following\nsettings.\n\n$ cat config/elasticsearch.yml | grep -A 6 -B 6 'type: \\?active_directory'\n\n\n xpack:\n  security:\n    authc:\n      realms:\n        active_directory:\n          type: active_directory\n          order: 0\n          domain_name: ad.example.com\n          url: ldaps://ad.example.com:636\n          unmapped_groups_as_roles: true | false\n\nIf these settings are not correct or missing, this is a finding.\n\nIf the external authentication is LDAP; verify the following settings.\n\n$ cat config/elasticsearch.yml | grep -A 16 -B 6 'type: \\?ldap'\n\nxpack:\n  security:\n    authc:\n      realms:\n        ldap1:\n          type: ldap\n          order: 0\n          url: 'ldaps://ldap.example.com:636'\n          bind_dn: 'cn=ldapuser, ou=users, o=services, dc=example, dc=com'\n          bind_password: changeme\n          user_search:\n            base_dn: 'dc=example,dc=com'\n            attribute: cn\n          group_search:\n            base_dn: 'dc=example,dc=com'\n          files:\n            role_mapping: 'CONFIG_DIR/x-pack/role_mapping.yml\n\nIf these settings are not correct or missing, this is a finding.\n\nIf the external authentication is PKI; verify the following settings.\n\n$ cat config/elasticsearch.yml | grep -A 6 -B 6 'type: \\?pki'\n\n xpack:\n  security:\n    authc:\n      realms:\n        pki1:\n          type: pki\n          username_pattern: 'EMAILADDRESS=(.*?)(?:,|$)'\n\nIf these settings are not correct or missing, this is a finding.\n\n",
            "fix": "Configure elasticsearch realms settings to point to\norganizational supported authentication mechanism\n\nSee the official documentation for the instructions on realm configuration:\nhttps://www.elastic.co/guide/en/x-pack/current/_how_authentication_works.html"
          },
          "code": "control \"V-30575\" do\n  title \"The application must notify appropriate individuals when accounts are\ncreated.\"\n  desc  \"Configure the centralized authentication service to enforce\norganizational policies such as password strength, lockout, expiration,\nnotification, and screen obfuscation.\"\n  impact 0.5\n  tag \"nist\": [\"AC-2 (4)\", \"Rev_4\"]\n  tag \"severity\": \"medium\"\n  tag \"rid\": \"SV-40309r1_rule\"\n  tag \"gtitle\": \"SRG-APP-000291\"\n  tag \"cci\": \"CCI-001683\"\n  tag \"check\": \"Guidance in Appendix B - System accounts cannot be disabled and\nelasticsearch does not enforce password complexity rules.\n\nElasticsearch supports LDAP, Active Directory, and PKI.\n\nIf the external authentication is Active Directory; verify the following\nsettings.\n\n$ cat config/elasticsearch.yml | grep -A 6 -B 6 'type: \\\\?active_directory'\n\n\n xpack:\n  security:\n    authc:\n      realms:\n        active_directory:\n          type: active_directory\n          order: 0\n          domain_name: ad.example.com\n          url: ldaps://ad.example.com:636\n          unmapped_groups_as_roles: true | false\n\nIf these settings are not correct or missing, this is a finding.\n\nIf the external authentication is LDAP; verify the following settings.\n\n$ cat config/elasticsearch.yml | grep -A 16 -B 6 'type: \\\\?ldap'\n\nxpack:\n  security:\n    authc:\n      realms:\n        ldap1:\n          type: ldap\n          order: 0\n          url: 'ldaps://ldap.example.com:636'\n          bind_dn: 'cn=ldapuser, ou=users, o=services, dc=example, dc=com'\n          bind_password: changeme\n          user_search:\n            base_dn: 'dc=example,dc=com'\n            attribute: cn\n          group_search:\n            base_dn: 'dc=example,dc=com'\n          files:\n            role_mapping: 'CONFIG_DIR/x-pack/role_mapping.yml\n\nIf these settings are not correct or missing, this is a finding.\n\nIf the external authentication is PKI; verify the following settings.\n\n$ cat config/elasticsearch.yml | grep -A 6 -B 6 'type: \\\\?pki'\n\n xpack:\n  security:\n    authc:\n      realms:\n        pki1:\n          type: pki\n          username_pattern: 'EMAILADDRESS=(.*?)(?:,|$)'\n\nIf these settings are not correct or missing, this is a finding.\n\n\"\n  tag \"fix\": \"Configure elasticsearch realms settings to point to\norganizational supported authentication mechanism\n\nSee the official documentation for the instructions on realm configuration:\nhttps://www.elastic.co/guide/en/x-pack/current/_how_authentication_works.html\"\n\n  begin\n\n    es_handle = es_helper(url:\"https://#{ELASTIC_IP}:#{ELASTIC_PORT}\",\n                    username: ES_ADMIN,\n                    password: ES_PASS,\n                    ssl_verify: SSL_VERIFY )\n\n    describe \"No nodes found\" do\n      subject { es_handle.nodes.nil? }\n      it { should_not be_truthy }\n    end if es_handle.nodes.nil?\n\n\n    es_handle.nodes.each do |node|\n      describe \"Authentication methods includes AD, LDAP or PKI for Node: #{node.name}\" do\n        subject { node.authc_method.any? { |x| ['pki','active_directory','ldap'].include?(x) } }\n        it{ should be true }\n      end\n    end unless es_handle.nodes.nil?\n\n    es_handle.nodes.each do |node|\n      describe.one do\n        node.authc_realm.keys.each do |auth_method|\n          describe \"Active Directory Settings for Node: #{node.name}\" do\n            subject { es_handle.settings.first.xpack.security.authc.realms[auth_method] }\n            its ('order') { should_not be_nil }\n            its ('domain_name') { should_not be_nil }\n            its ('url') { should_not be_nil }\n            its ('unmapped_groups_as_roles') { should_not be_nil }\n          end if node.authc_realm[auth_method].type.eql?('active_directory')\n\n          describe \"LDAP Settings for Node: #{node.name}\" do\n            subject { es_handle.settings.first.xpack.security.authc.realms[auth_method] }\n            its ('order') { should_not be_nil }\n            its ('url') { should_not be_nil }\n            its ('bind_dn') { should_not be_nil }\n            its ('bind_password') { should_not be_nil }\n            its ('user_search.base_dn') { should_not be_nil }\n            its ('user_search.attribute') { should_not be_nil }\n            its ('group_search.base_dn') { should_not be_nil }\n            its ('files.role_mapping') { should_not be_nil }\n          end if node.authc_realm[auth_method].type.eql?('ldap')\n\n          describe \"PKI Settings for Node: #{node.name}\" do\n            subject { node.authc_realm[auth_method] }\n            its ('order') { should_not be_nil }\n            its ('username_pattern') { should_not be_nil }\n          end if node.authc_realm[auth_method].type.eql?('pki')\n        end\n      end\n    end unless es_handle.nodes.nil?\n\n  rescue Exception => msg\n    describe \"Exception: #{msg}\" do\n      it { should be_nil}\n    end\n  end\nend\n",
          "source_location": {
            "line": 36,
            "ref": "../elasticsearch-inspec/controls/ad+ldap+pki/V-30575.rb"
          },
          "results": [
            {
              "status": "passed",
              "code_desc": "Authentication methods includes AD, LDAP or PKI for Node: package-centos-72 should equal true",
              "run_time": 0.000062,
              "start_time": "2018-02-11 14:26:57 -0500"
            },
            {
              "status": "passed",
              "code_desc": "PKI Settings for Node: package-centos-72 order should not be nil",
              "run_time": 0.000053,
              "start_time": "2018-02-11 14:26:57 -0500"
            },
            {
              "status": "passed",
              "code_desc": "PKI Settings for Node: package-centos-72 username_pattern should not be nil",
              "run_time": 0.000092,
              "start_time": "2018-02-11 14:26:57 -0500"
            }
          ]
        },
        {
          "id": "V-26926",
          "title": "Applications must enforce password maximum lifetime restrictions.",
          "desc": "Configure the centralized authentication service to enforce\norganizational policies such as password strength, lockout, expiration,\nnotification, and screen obfuscation.",
          "impact": 0.5,
          "refs": [],
          "tags": {
            "nist": [
              "IA-5 (1) (d)",
              "Rev_4"
            ],
            "severity": "medium",
            "rid": "SV-34206r1_rule",
            "gtitle": "SRG-APP-000174",
            "cci": "CCI-000199",
            "check": "Guidance in Appendix B - System accounts cannot be disabled and\nelasticsearch does not enforce password complexity rules.\n\nElasticsearch supports LDAP, Active Directory, and PKI.\n\nIf the external authentication is Active Directory; verify the following\nsettings.\n\n$ cat config/elasticsearch.yml | grep -A 6 -B 6 'type: \\?active_directory'\n\n\n xpack:\n  security:\n    authc:\n      realms:\n        active_directory:\n          type: active_directory\n          order: 0\n          domain_name: ad.example.com\n          url: ldaps://ad.example.com:636\n          unmapped_groups_as_roles: true | false\n\nIf these settings are not correct or missing, this is a finding.\n\nIf the external authentication is LDAP; verify the following settings.\n\n$ cat config/elasticsearch.yml | grep -A 16 -B 6 'type: \\?ldap'\n\nxpack:\n  security:\n    authc:\n      realms:\n        ldap1:\n          type: ldap\n          order: 0\n          url: 'ldaps://ldap.example.com:636'\n          bind_dn: 'cn=ldapuser, ou=users, o=services, dc=example, dc=com'\n          bind_password: changeme\n          user_search:\n            base_dn: 'dc=example,dc=com'\n            attribute: cn\n          group_search:\n            base_dn: 'dc=example,dc=com'\n          files:\n            role_mapping: 'CONFIG_DIR/x-pack/role_mapping.yml\n\nIf these settings are not correct or missing, this is a finding.\n\nIf the external authentication is PKI; verify the following settings.\n\n$ cat config/elasticsearch.yml | grep -A 6 -B 6 'type: \\?pki'\n\n xpack:\n  security:\n    authc:\n      realms:\n        pki1:\n          type: pki\n          username_pattern: 'EMAILADDRESS=(.*?)(?:,|$)'\n\nIf these settings are not correct or missing, this is a finding.\n\n",
            "fix": "Configure elasticsearch realms settings to point to\norganizational supported authentication mechanism\n\nSee the official documentation for the instructions on realm configuration:\nhttps://www.elastic.co/guide/en/x-pack/current/_how_authentication_works.html"
          },
          "code": "control \"V-26926\" do\n  title \"Applications must enforce password maximum lifetime restrictions.\"\n  desc  \"Configure the centralized authentication service to enforce\norganizational policies such as password strength, lockout, expiration,\nnotification, and screen obfuscation.\"\n  impact 0.5\n  tag \"nist\": [\"IA-5 (1) (d)\", \"Rev_4\"]\n  tag \"severity\": \"medium\"\n  tag \"rid\": \"SV-34206r1_rule\"\n  tag \"gtitle\": \"SRG-APP-000174\"\n  tag \"cci\": \"CCI-000199\"\n  tag \"check\": \"Guidance in Appendix B - System accounts cannot be disabled and\nelasticsearch does not enforce password complexity rules.\n\nElasticsearch supports LDAP, Active Directory, and PKI.\n\nIf the external authentication is Active Directory; verify the following\nsettings.\n\n$ cat config/elasticsearch.yml | grep -A 6 -B 6 'type: \\\\?active_directory'\n\n\n xpack:\n  security:\n    authc:\n      realms:\n        active_directory:\n          type: active_directory\n          order: 0\n          domain_name: ad.example.com\n          url: ldaps://ad.example.com:636\n          unmapped_groups_as_roles: true | false\n\nIf these settings are not correct or missing, this is a finding.\n\nIf the external authentication is LDAP; verify the following settings.\n\n$ cat config/elasticsearch.yml | grep -A 16 -B 6 'type: \\\\?ldap'\n\nxpack:\n  security:\n    authc:\n      realms:\n        ldap1:\n          type: ldap\n          order: 0\n          url: 'ldaps://ldap.example.com:636'\n          bind_dn: 'cn=ldapuser, ou=users, o=services, dc=example, dc=com'\n          bind_password: changeme\n          user_search:\n            base_dn: 'dc=example,dc=com'\n            attribute: cn\n          group_search:\n            base_dn: 'dc=example,dc=com'\n          files:\n            role_mapping: 'CONFIG_DIR/x-pack/role_mapping.yml\n\nIf these settings are not correct or missing, this is a finding.\n\nIf the external authentication is PKI; verify the following settings.\n\n$ cat config/elasticsearch.yml | grep -A 6 -B 6 'type: \\\\?pki'\n\n xpack:\n  security:\n    authc:\n      realms:\n        pki1:\n          type: pki\n          username_pattern: 'EMAILADDRESS=(.*?)(?:,|$)'\n\nIf these settings are not correct or missing, this is a finding.\n\n\"\n  tag \"fix\": \"Configure elasticsearch realms settings to point to\norganizational supported authentication mechanism\n\nSee the official documentation for the instructions on realm configuration:\nhttps://www.elastic.co/guide/en/x-pack/current/_how_authentication_works.html\"\n\n  begin\n\n    es_handle = es_helper(url:\"https://#{ELASTIC_IP}:#{ELASTIC_PORT}\",\n                    username: ES_ADMIN,\n                    password: ES_PASS,\n                    ssl_verify: SSL_VERIFY )\n\n    describe \"No nodes found\" do\n      subject { es_handle.nodes.nil? }\n      it { should_not be_truthy }\n    end if es_handle.nodes.nil?\n\n\n    es_handle.nodes.each do |node|\n      describe \"Authentication methods includes AD, LDAP or PKI for Node: #{node.name}\" do\n        subject { node.authc_method.any? { |x| ['pki','active_directory','ldap'].include?(x) } }\n        it{ should be true }\n      end\n    end unless es_handle.nodes.nil?\n\n    es_handle.nodes.each do |node|\n      describe.one do\n        node.authc_realm.keys.each do |auth_method|\n          describe \"Active Directory Settings for Node: #{node.name}\" do\n            subject { es_handle.settings.first.xpack.security.authc.realms[auth_method] }\n            its ('order') { should_not be_nil }\n            its ('domain_name') { should_not be_nil }\n            its ('url') { should_not be_nil }\n            its ('unmapped_groups_as_roles') { should_not be_nil }\n          end if node.authc_realm[auth_method].type.eql?('active_directory')\n\n          describe \"LDAP Settings for Node: #{node.name}\" do\n            subject { es_handle.settings.first.xpack.security.authc.realms[auth_method] }\n            its ('order') { should_not be_nil }\n            its ('url') { should_not be_nil }\n            its ('bind_dn') { should_not be_nil }\n            its ('bind_password') { should_not be_nil }\n            its ('user_search.base_dn') { should_not be_nil }\n            its ('user_search.attribute') { should_not be_nil }\n            its ('group_search.base_dn') { should_not be_nil }\n            its ('files.role_mapping') { should_not be_nil }\n          end if node.authc_realm[auth_method].type.eql?('ldap')\n\n          describe \"PKI Settings for Node: #{node.name}\" do\n            subject { node.authc_realm[auth_method] }\n            its ('order') { should_not be_nil }\n            its ('username_pattern') { should_not be_nil }\n          end if node.authc_realm[auth_method].type.eql?('pki')\n        end\n      end\n    end unless es_handle.nodes.nil?\n\n  rescue Exception => msg\n    describe \"Exception: #{msg}\" do\n      it { should be_nil}\n    end\n  end\nend",
          "source_location": {
            "line": 36,
            "ref": "../elasticsearch-inspec/controls/ad+ldap+pki/V-26926.rb"
          },
          "results": [
            {
              "status": "passed",
              "code_desc": "Authentication methods includes AD, LDAP or PKI for Node: package-centos-72 should equal true",
              "run_time": 0.000059,
              "start_time": "2018-02-11 14:26:57 -0500"
            },
            {
              "status": "passed",
              "code_desc": "PKI Settings for Node: package-centos-72 order should not be nil",
              "run_time": 0.000053,
              "start_time": "2018-02-11 14:26:57 -0500"
            },
            {
              "status": "passed",
              "code_desc": "PKI Settings for Node: package-centos-72 username_pattern should not be nil",
              "run_time": 0.000048,
              "start_time": "2018-02-11 14:26:57 -0500"
            }
          ]
        },
        {
          "id": "V-26827",
          "title": "Application users must utilize a separate, distinct administrative\naccount when accessing application security functions or security-relevant\ninformation. Non-privileged accounts must be utilized when accessing\nnon-administrative application functions. The application must provide this\nfunctionality itself or leverage an existing technology providing this\ncapability.",
          "desc": "Separate the access point and accounts used to administer\nElasticsearch by configuring different user interfaces and issuing separate\nadministrative accounts for the use of administrators taking administrative\nactions. Prevent Administrative interfaces and accounts should not be used for\nnon-administrative actions by using X-Pack's RBAC to enforce separation of\nduties. Audit and alert on the actions of administrator accounts to assure they\nare not being used for non-administrative action.",
          "impact": 0.5,
          "refs": [],
          "tags": {
            "nist": [
              "AC-6 (2)",
              "Rev_3"
            ],
            "severity": "medium",
            "rid": "SV-34077r1_rule",
            "gtitle": "SRG-APP-000063",
            "cci": "CCI-000040",
            "check": "Guidance in Appendix B - System accounts cannot be disabled and\nelasticsearch does not enforce password complexity rules.\n\nFor all other accounts, admin and non-administrative should be handled\nexternally by LDAP, Active Directory, and PKI.\n\nIf the external authentication is Active Directory; verify the following\nsettings.\n\n$ cat config/elasticsearch.yml | grep -A 6 -B 6 'type: \\?active_directory'\n\n\n xpack:\n  security:\n    authc:\n      realms:\n        active_directory:\n          type: active_directory\n          order: 0\n          domain_name: ad.example.com\n          url: ldaps://ad.example.com:636\n          unmapped_groups_as_roles: true | false\n\nIf these settings are not correct or missing, this is a finding.\n\nIf the external authentication is LDAP; verify the following settings.\n\n$ cat config/elasticsearch.yml | grep -A 16 -B 6 'type: \\?ldap'\n\nxpack:\n  security:\n    authc:\n      realms:\n        ldap1:\n          type: ldap\n          order: 0\n          url: 'ldaps://ldap.example.com:636'\n          bind_dn: 'cn=ldapuser, ou=users, o=services, dc=example, dc=com'\n          bind_password: changeme\n          user_search:\n            base_dn: 'dc=example,dc=com'\n            attribute: cn\n          group_search:\n            base_dn: 'dc=example,dc=com'\n          files:\n            role_mapping: 'CONFIG_DIR/x-pack/role_mapping.yml\n\nIf these settings are not correct or missing, this is a finding.\n\nIf the external authentication is PKI; verify the following settings.\n\n$ cat config/elasticsearch.yml | grep -A 6 -B 6 'type: \\?pki'\n\n xpack:\n  security:\n    authc:\n      realms:\n        pki1:\n          type: pki\n          username_pattern: 'EMAILADDRESS=(.*?)(?:,|$)'\n\nIf these settings are not correct or missing, this is a finding.\n\n",
            "fix": "Configure elasticsearch realms settings to point to\norganizational supported authentication mechanism\n\nSee the official documentation for the instructions on realm configuration:\nhttps://www.elastic.co/guide/en/x-pack/current/_how_authentication_works.html"
          },
          "code": "control \"V-26827\" do\n  title \"Application users must utilize a separate, distinct administrative\naccount when accessing application security functions or security-relevant\ninformation. Non-privileged accounts must be utilized when accessing\nnon-administrative application functions. The application must provide this\nfunctionality itself or leverage an existing technology providing this\ncapability.\"\n  desc  \"Separate the access point and accounts used to administer\nElasticsearch by configuring different user interfaces and issuing separate\nadministrative accounts for the use of administrators taking administrative\nactions. Prevent Administrative interfaces and accounts should not be used for\nnon-administrative actions by using X-Pack's RBAC to enforce separation of\nduties. Audit and alert on the actions of administrator accounts to assure they\nare not being used for non-administrative action.\"\n  impact 0.5\n  tag \"nist\": [\"AC-6 (2)\", \"Rev_3\"]\n  tag \"severity\": \"medium\"\n  tag \"rid\": \"SV-34077r1_rule\"\n  tag \"gtitle\": \"SRG-APP-000063\"\n  tag \"cci\": \"CCI-000040\"\n  tag \"check\": \"Guidance in Appendix B - System accounts cannot be disabled and\nelasticsearch does not enforce password complexity rules.\n\nFor all other accounts, admin and non-administrative should be handled\nexternally by LDAP, Active Directory, and PKI.\n\nIf the external authentication is Active Directory; verify the following\nsettings.\n\n$ cat config/elasticsearch.yml | grep -A 6 -B 6 'type: \\\\?active_directory'\n\n\n xpack:\n  security:\n    authc:\n      realms:\n        active_directory:\n          type: active_directory\n          order: 0\n          domain_name: ad.example.com\n          url: ldaps://ad.example.com:636\n          unmapped_groups_as_roles: true | false\n\nIf these settings are not correct or missing, this is a finding.\n\nIf the external authentication is LDAP; verify the following settings.\n\n$ cat config/elasticsearch.yml | grep -A 16 -B 6 'type: \\\\?ldap'\n\nxpack:\n  security:\n    authc:\n      realms:\n        ldap1:\n          type: ldap\n          order: 0\n          url: 'ldaps://ldap.example.com:636'\n          bind_dn: 'cn=ldapuser, ou=users, o=services, dc=example, dc=com'\n          bind_password: changeme\n          user_search:\n            base_dn: 'dc=example,dc=com'\n            attribute: cn\n          group_search:\n            base_dn: 'dc=example,dc=com'\n          files:\n            role_mapping: 'CONFIG_DIR/x-pack/role_mapping.yml\n\nIf these settings are not correct or missing, this is a finding.\n\nIf the external authentication is PKI; verify the following settings.\n\n$ cat config/elasticsearch.yml | grep -A 6 -B 6 'type: \\\\?pki'\n\n xpack:\n  security:\n    authc:\n      realms:\n        pki1:\n          type: pki\n          username_pattern: 'EMAILADDRESS=(.*?)(?:,|$)'\n\nIf these settings are not correct or missing, this is a finding.\n\n\"\n  tag \"fix\": \"Configure elasticsearch realms settings to point to\norganizational supported authentication mechanism\n\nSee the official documentation for the instructions on realm configuration:\nhttps://www.elastic.co/guide/en/x-pack/current/_how_authentication_works.html\"\n\n\n  begin\n\n    es_handle = es_helper(url:\"https://#{ELASTIC_IP}:#{ELASTIC_PORT}\",\n                    username: ES_ADMIN,\n                    password: ES_PASS,\n                    ssl_verify: SSL_VERIFY )\n\n    describe \"No nodes found\" do\n      subject { es_handle.nodes.nil? }\n      it { should_not be_truthy }\n    end if es_handle.nodes.nil?\n\n\n    es_handle.nodes.each do |node|\n      describe \"Authentication methods includes AD, LDAP or PKI for Node: #{node.name}\" do\n        subject { node.authc_method.any? { |x| ['pki','active_directory','ldap'].include?(x) } }\n        it{ should be true }\n      end\n    end unless es_handle.nodes.nil?\n\n    es_handle.nodes.each do |node|\n      describe.one do\n        node.authc_realm.keys.each do |auth_method|\n          describe \"Active Directory Settings for Node: #{node.name}\" do\n            subject { es_handle.settings.first.xpack.security.authc.realms[auth_method] }\n            its ('order') { should_not be_nil }\n            its ('domain_name') { should_not be_nil }\n            its ('url') { should_not be_nil }\n            its ('unmapped_groups_as_roles') { should_not be_nil }\n          end if node.authc_realm[auth_method].type.eql?('active_directory')\n\n          describe \"LDAP Settings for Node: #{node.name}\" do\n            subject { es_handle.settings.first.xpack.security.authc.realms[auth_method] }\n            its ('order') { should_not be_nil }\n            its ('url') { should_not be_nil }\n            its ('bind_dn') { should_not be_nil }\n            its ('bind_password') { should_not be_nil }\n            its ('user_search.base_dn') { should_not be_nil }\n            its ('user_search.attribute') { should_not be_nil }\n            its ('group_search.base_dn') { should_not be_nil }\n            its ('files.role_mapping') { should_not be_nil }\n          end if node.authc_realm[auth_method].type.eql?('ldap')\n\n          describe \"PKI Settings for Node: #{node.name}\" do\n            subject { node.authc_realm[auth_method] }\n            its ('order') { should_not be_nil }\n            its ('username_pattern') { should_not be_nil }\n          end if node.authc_realm[auth_method].type.eql?('pki')\n        end\n      end\n    end unless es_handle.nodes.nil?\n\n  rescue Exception => msg\n    describe \"Exception: #{msg}\" do\n      it { should be_nil}\n    end\n  end\nend",
          "source_location": {
            "line": 35,
            "ref": "../elasticsearch-inspec/controls/ad+ldap+pki/V-26827.rb"
          },
          "results": [
            {
              "status": "passed",
              "code_desc": "Authentication methods includes AD, LDAP or PKI for Node: package-centos-72 should equal true",
              "run_time": 0.000062,
              "start_time": "2018-02-11 14:26:57 -0500"
            },
            {
              "status": "passed",
              "code_desc": "PKI Settings for Node: package-centos-72 order should not be nil",
              "run_time": 0.000052,
              "start_time": "2018-02-11 14:26:57 -0500"
            },
            {
              "status": "passed",
              "code_desc": "PKI Settings for Node: package-centos-72 username_pattern should not be nil",
              "run_time": 0.000102,
              "start_time": "2018-02-11 14:26:57 -0500"
            }
          ]
        },
        {
          "id": "V-26916",
          "title": "The application must support organizational requirements to prohibit\npassword reuse for the organizational-defined number of generations.",
          "desc": "Configure the centralized authentication service to enforce\norganizational policies such as password strength, lockout, expiration,\nnotification, and screen obfuscation.",
          "impact": 0.5,
          "refs": [],
          "tags": {
            "nist": [
              "IA-5 (1) (e)",
              "Rev_4"
            ],
            "severity": "medium",
            "rid": "SV-34196r1_rule",
            "gtitle": "SRG-APP-000165",
            "cci": "CCI-000200",
            "check": "Guidance in Appendix B - System accounts cannot be disabled and\nelasticsearch does not enforce password complexity rules.\n\nElasticsearch supports LDAP, Active Directory, and PKI.\n\nIf the external authentication is Active Directory; verify the following\nsettings.\n\n$ cat config/elasticsearch.yml | grep -A 6 -B 6 'type: \\?active_directory'\n\n\n xpack:\n  security:\n    authc:\n      realms:\n        active_directory:\n          type: active_directory\n          order: 0\n          domain_name: ad.example.com\n          url: ldaps://ad.example.com:636\n          unmapped_groups_as_roles: true | false\n\nIf these settings are not correct or missing, this is a finding.\n\nIf the external authentication is LDAP; verify the following settings.\n\n$ cat config/elasticsearch.yml | grep -A 16 -B 6 'type: \\?ldap'\n\nxpack:\n  security:\n    authc:\n      realms:\n        ldap1:\n          type: ldap\n          order: 0\n          url: 'ldaps://ldap.example.com:636'\n          bind_dn: 'cn=ldapuser, ou=users, o=services, dc=example, dc=com'\n          bind_password: changeme\n          user_search:\n            base_dn: 'dc=example,dc=com'\n            attribute: cn\n          group_search:\n            base_dn: 'dc=example,dc=com'\n          files:\n            role_mapping: 'CONFIG_DIR/x-pack/role_mapping.yml\n\nIf these settings are not correct or missing, this is a finding.\n\nIf the external authentication is PKI; verify the following settings.\n\n$ cat config/elasticsearch.yml | grep -A 6 -B 6 'type: \\?pki'\n\n xpack:\n  security:\n    authc:\n      realms:\n        pki1:\n          type: pki\n          username_pattern: 'EMAILADDRESS=(.*?)(?:,|$)'\n\nIf these settings are not correct or missing, this is a finding.\n\n",
            "fix": "Configure elasticsearch realms settings to point to\norganizational supported authentication mechanism\n\nSee the official documentation for the instructions on realm configuration:\nhttps://www.elastic.co/guide/en/x-pack/current/_how_authentication_works.html"
          },
          "code": "control \"V-26916\" do\n  title \"The application must support organizational requirements to prohibit\npassword reuse for the organizational-defined number of generations.\"\n  desc  \"Configure the centralized authentication service to enforce\norganizational policies such as password strength, lockout, expiration,\nnotification, and screen obfuscation.\"\n  impact 0.5\n  tag \"nist\": [\"IA-5 (1) (e)\", \"Rev_4\"]\n  tag \"severity\": \"medium\"\n  tag \"rid\": \"SV-34196r1_rule\"\n  tag \"gtitle\": \"SRG-APP-000165\"\n  tag \"cci\": \"CCI-000200\"\n  tag \"check\": \"Guidance in Appendix B - System accounts cannot be disabled and\nelasticsearch does not enforce password complexity rules.\n\nElasticsearch supports LDAP, Active Directory, and PKI.\n\nIf the external authentication is Active Directory; verify the following\nsettings.\n\n$ cat config/elasticsearch.yml | grep -A 6 -B 6 'type: \\\\?active_directory'\n\n\n xpack:\n  security:\n    authc:\n      realms:\n        active_directory:\n          type: active_directory\n          order: 0\n          domain_name: ad.example.com\n          url: ldaps://ad.example.com:636\n          unmapped_groups_as_roles: true | false\n\nIf these settings are not correct or missing, this is a finding.\n\nIf the external authentication is LDAP; verify the following settings.\n\n$ cat config/elasticsearch.yml | grep -A 16 -B 6 'type: \\\\?ldap'\n\nxpack:\n  security:\n    authc:\n      realms:\n        ldap1:\n          type: ldap\n          order: 0\n          url: 'ldaps://ldap.example.com:636'\n          bind_dn: 'cn=ldapuser, ou=users, o=services, dc=example, dc=com'\n          bind_password: changeme\n          user_search:\n            base_dn: 'dc=example,dc=com'\n            attribute: cn\n          group_search:\n            base_dn: 'dc=example,dc=com'\n          files:\n            role_mapping: 'CONFIG_DIR/x-pack/role_mapping.yml\n\nIf these settings are not correct or missing, this is a finding.\n\nIf the external authentication is PKI; verify the following settings.\n\n$ cat config/elasticsearch.yml | grep -A 6 -B 6 'type: \\\\?pki'\n\n xpack:\n  security:\n    authc:\n      realms:\n        pki1:\n          type: pki\n          username_pattern: 'EMAILADDRESS=(.*?)(?:,|$)'\n\nIf these settings are not correct or missing, this is a finding.\n\n\"\n  tag \"fix\": \"Configure elasticsearch realms settings to point to\norganizational supported authentication mechanism\n\nSee the official documentation for the instructions on realm configuration:\nhttps://www.elastic.co/guide/en/x-pack/current/_how_authentication_works.html\"\n\n\n  begin\n\n    es_handle = es_helper(url:\"https://#{ELASTIC_IP}:#{ELASTIC_PORT}\",\n                    username: ES_ADMIN,\n                    password: ES_PASS,\n                    ssl_verify: SSL_VERIFY )\n\n    describe \"No nodes found\" do\n      subject { es_handle.nodes.nil? }\n      it { should_not be_truthy }\n    end if es_handle.nodes.nil?\n\n\n    es_handle.nodes.each do |node|\n      describe \"Authentication methods includes AD, LDAP or PKI for Node: #{node.name}\" do\n        subject { node.authc_method.any? { |x| ['pki','active_directory','ldap'].include?(x) } }\n        it{ should be true }\n      end\n    end unless es_handle.nodes.nil?\n\n    es_handle.nodes.each do |node|\n      describe.one do\n        node.authc_realm.keys.each do |auth_method|\n          describe \"Active Directory Settings for Node: #{node.name}\" do\n            subject { es_handle.settings.first.xpack.security.authc.realms[auth_method] }\n            its ('order') { should_not be_nil }\n            its ('domain_name') { should_not be_nil }\n            its ('url') { should_not be_nil }\n            its ('unmapped_groups_as_roles') { should_not be_nil }\n          end if node.authc_realm[auth_method].type.eql?('active_directory')\n\n          describe \"LDAP Settings for Node: #{node.name}\" do\n            subject { es_handle.settings.first.xpack.security.authc.realms[auth_method] }\n            its ('order') { should_not be_nil }\n            its ('url') { should_not be_nil }\n            its ('bind_dn') { should_not be_nil }\n            its ('bind_password') { should_not be_nil }\n            its ('user_search.base_dn') { should_not be_nil }\n            its ('user_search.attribute') { should_not be_nil }\n            its ('group_search.base_dn') { should_not be_nil }\n            its ('files.role_mapping') { should_not be_nil }\n          end if node.authc_realm[auth_method].type.eql?('ldap')\n\n          describe \"PKI Settings for Node: #{node.name}\" do\n            subject { node.authc_realm[auth_method] }\n            its ('order') { should_not be_nil }\n            its ('username_pattern') { should_not be_nil }\n          end if node.authc_realm[auth_method].type.eql?('pki')\n        end\n      end\n    end unless es_handle.nodes.nil?\n\n  rescue Exception => msg\n    describe \"Exception: #{msg}\" do\n      it { should be_nil}\n    end\n  end\nend",
          "source_location": {
            "line": 35,
            "ref": "../elasticsearch-inspec/controls/ad+ldap+pki/V-26916.rb"
          },
          "results": [
            {
              "status": "passed",
              "code_desc": "Authentication methods includes AD, LDAP or PKI for Node: package-centos-72 should equal true",
              "run_time": 0.000058,
              "start_time": "2018-02-11 14:26:57 -0500"
            },
            {
              "status": "passed",
              "code_desc": "PKI Settings for Node: package-centos-72 order should not be nil",
              "run_time": 0.00009,
              "start_time": "2018-02-11 14:26:57 -0500"
            },
            {
              "status": "passed",
              "code_desc": "PKI Settings for Node: package-centos-72 username_pattern should not be nil",
              "run_time": 0.000049,
              "start_time": "2018-02-11 14:26:57 -0500"
            }
          ]
        },
        {
          "id": "V-26856",
          "title": "Applications, when the maximum number of unsuccessful attempts are\nexceeded, must automatically lock the account/node for an\norganizational-defined time period or lock the account/node until released by\nan administrator IAW organizational policy. ",
          "desc": "Configure the centralized authentication service to enforce\norganizational policies such as password strength, lockout, expiration,\nnotification, and screen obfuscation.",
          "impact": 0.5,
          "refs": [],
          "tags": {
            "nist": [
              "AC-7 b",
              "Rev_3"
            ],
            "severity": "medium",
            "rid": "SV-34136r1_rule",
            "gtitle": "SRG-APP-000067",
            "cci": "CCI-000047",
            "check": "Guidance in Appendix B - System accounts cannot be disabled and\nelasticsearch does not enforce password complexity rules.\n\nElasticsearch supports LDAP, Active Directory, and PKI.\n\nIf the external authentication is Active Directory; verify the following\nsettings.\n\n$ cat config/elasticsearch.yml | grep -A 6 -B 6 'type: \\?active_directory'\n\n\n xpack:\n  security:\n    authc:\n      realms:\n        active_directory:\n          type: active_directory\n          order: 0\n          domain_name: ad.example.com\n          url: ldaps://ad.example.com:636\n          unmapped_groups_as_roles: true | false\n\nIf these settings are not correct or missing, this is a finding.\n\nIf the external authentication is LDAP; verify the following settings.\n\n$ cat config/elasticsearch.yml | grep -A 16 -B 6 'type: \\?ldap'\n\nxpack:\n  security:\n    authc:\n      realms:\n        ldap1:\n          type: ldap\n          order: 0\n          url: 'ldaps://ldap.example.com:636'\n          bind_dn: 'cn=ldapuser, ou=users, o=services, dc=example, dc=com'\n          bind_password: changeme\n          user_search:\n            base_dn: 'dc=example,dc=com'\n            attribute: cn\n          group_search:\n            base_dn: 'dc=example,dc=com'\n          files:\n            role_mapping: 'CONFIG_DIR/x-pack/role_mapping.yml\n\nIf these settings are not correct or missing, this is a finding.\n\nIf the external authentication is PKI; verify the following settings.\n\n$ cat config/elasticsearch.yml | grep -A 6 -B 6 'type: \\?pki'\n\n xpack:\n  security:\n    authc:\n      realms:\n        pki1:\n          type: pki\n          username_pattern: 'EMAILADDRESS=(.*?)(?:,|$)'\n\nIf these settings are not correct or missing, this is a finding.\n\n",
            "fix": "Configure elasticsearch realms settings to point to\norganizational supported authentication mechanism\n\nSee the official documentation for the instructions on realm configuration:\nhttps://www.elastic.co/guide/en/x-pack/current/_how_authentication_works.html"
          },
          "code": "control \"V-26856\" do\n  title \"Applications, when the maximum number of unsuccessful attempts are\nexceeded, must automatically lock the account/node for an\norganizational-defined time period or lock the account/node until released by\nan administrator IAW organizational policy. \"\n  desc  \"Configure the centralized authentication service to enforce\norganizational policies such as password strength, lockout, expiration,\nnotification, and screen obfuscation.\"\n  impact 0.5\n  tag \"nist\": [\"AC-7 b\", \"Rev_3\"]\n  tag \"severity\": \"medium\"\n  tag \"rid\": \"SV-34136r1_rule\"\n  tag \"gtitle\": \"SRG-APP-000067\"\n  tag \"cci\": \"CCI-000047\"\n  tag \"check\": \"Guidance in Appendix B - System accounts cannot be disabled and\nelasticsearch does not enforce password complexity rules.\n\nElasticsearch supports LDAP, Active Directory, and PKI.\n\nIf the external authentication is Active Directory; verify the following\nsettings.\n\n$ cat config/elasticsearch.yml | grep -A 6 -B 6 'type: \\\\?active_directory'\n\n\n xpack:\n  security:\n    authc:\n      realms:\n        active_directory:\n          type: active_directory\n          order: 0\n          domain_name: ad.example.com\n          url: ldaps://ad.example.com:636\n          unmapped_groups_as_roles: true | false\n\nIf these settings are not correct or missing, this is a finding.\n\nIf the external authentication is LDAP; verify the following settings.\n\n$ cat config/elasticsearch.yml | grep -A 16 -B 6 'type: \\\\?ldap'\n\nxpack:\n  security:\n    authc:\n      realms:\n        ldap1:\n          type: ldap\n          order: 0\n          url: 'ldaps://ldap.example.com:636'\n          bind_dn: 'cn=ldapuser, ou=users, o=services, dc=example, dc=com'\n          bind_password: changeme\n          user_search:\n            base_dn: 'dc=example,dc=com'\n            attribute: cn\n          group_search:\n            base_dn: 'dc=example,dc=com'\n          files:\n            role_mapping: 'CONFIG_DIR/x-pack/role_mapping.yml\n\nIf these settings are not correct or missing, this is a finding.\n\nIf the external authentication is PKI; verify the following settings.\n\n$ cat config/elasticsearch.yml | grep -A 6 -B 6 'type: \\\\?pki'\n\n xpack:\n  security:\n    authc:\n      realms:\n        pki1:\n          type: pki\n          username_pattern: 'EMAILADDRESS=(.*?)(?:,|$)'\n\nIf these settings are not correct or missing, this is a finding.\n\n\"\n  tag \"fix\": \"Configure elasticsearch realms settings to point to\norganizational supported authentication mechanism\n\nSee the official documentation for the instructions on realm configuration:\nhttps://www.elastic.co/guide/en/x-pack/current/_how_authentication_works.html\"\n\n\n  begin\n\n    es_handle = es_helper(url:\"https://#{ELASTIC_IP}:#{ELASTIC_PORT}\",\n                    username: ES_ADMIN,\n                    password: ES_PASS,\n                    ssl_verify: SSL_VERIFY )\n\n    describe \"No nodes found\" do\n      subject { es_handle.nodes.nil? }\n      it { should_not be_truthy }\n    end if es_handle.nodes.nil?\n\n\n    es_handle.nodes.each do |node|\n      describe \"Authentication methods includes AD, LDAP or PKI for Node: #{node.name}\" do\n        subject { node.authc_method.any? { |x| ['pki','active_directory','ldap'].include?(x) } }\n        it{ should be true }\n      end\n    end unless es_handle.nodes.nil?\n\n    es_handle.nodes.each do |node|\n      describe.one do\n        node.authc_realm.keys.each do |auth_method|\n          describe \"Active Directory Settings for Node: #{node.name}\" do\n            subject { es_handle.settings.first.xpack.security.authc.realms[auth_method] }\n            its ('order') { should_not be_nil }\n            its ('domain_name') { should_not be_nil }\n            its ('url') { should_not be_nil }\n            its ('unmapped_groups_as_roles') { should_not be_nil }\n          end if node.authc_realm[auth_method].type.eql?('active_directory')\n\n          describe \"LDAP Settings for Node: #{node.name}\" do\n            subject { es_handle.settings.first.xpack.security.authc.realms[auth_method] }\n            its ('order') { should_not be_nil }\n            its ('url') { should_not be_nil }\n            its ('bind_dn') { should_not be_nil }\n            its ('bind_password') { should_not be_nil }\n            its ('user_search.base_dn') { should_not be_nil }\n            its ('user_search.attribute') { should_not be_nil }\n            its ('group_search.base_dn') { should_not be_nil }\n            its ('files.role_mapping') { should_not be_nil }\n          end if node.authc_realm[auth_method].type.eql?('ldap')\n\n          describe \"PKI Settings for Node: #{node.name}\" do\n            subject { node.authc_realm[auth_method] }\n            its ('order') { should_not be_nil }\n            its ('username_pattern') { should_not be_nil }\n          end if node.authc_realm[auth_method].type.eql?('pki')\n        end\n      end\n    end unless es_handle.nodes.nil?\n\n  rescue Exception => msg\n    describe \"Exception: #{msg}\" do\n      it { should be_nil}\n    end\n  end\nend\n",
          "source_location": {
            "line": 36,
            "ref": "../elasticsearch-inspec/controls/ad+ldap+pki/V-26856.rb"
          },
          "results": [
            {
              "status": "passed",
              "code_desc": "Authentication methods includes AD, LDAP or PKI for Node: package-centos-72 should equal true",
              "run_time": 0.000062,
              "start_time": "2018-02-11 14:26:57 -0500"
            },
            {
              "status": "passed",
              "code_desc": "PKI Settings for Node: package-centos-72 order should not be nil",
              "run_time": 0.000052,
              "start_time": "2018-02-11 14:26:57 -0500"
            },
            {
              "status": "passed",
              "code_desc": "PKI Settings for Node: package-centos-72 username_pattern should not be nil",
              "run_time": 0.000051,
              "start_time": "2018-02-11 14:26:57 -0500"
            }
          ]
        },
        {
          "id": "V-26922",
          "title": "The application must support organizational requirements to enforce\nthe number of characters that get changed when passwords are changed.",
          "desc": "Configure the centralized authentication service to enforce\norganizational policies such as password strength, lockout, expiration,\nnotification, and screen obfuscation.",
          "impact": 0.5,
          "refs": [],
          "tags": {
            "nist": [
              "IA-5 (1) (b)",
              "Rev_4"
            ],
            "severity": "medium",
            "rid": "SV-34202r1_rule",
            "gtitle": "SRG-APP-000170",
            "cci": "CCI-000195",
            "check": "Guidance in Appendix B - System accounts cannot be disabled and\nelasticsearch does not enforce password complexity rules.\n\nElasticsearch supports LDAP, Active Directory, and PKI.\n\nIf the external authentication is Active Directory; verify the following\nsettings.\n\n$ cat config/elasticsearch.yml | grep -A 6 -B 6 'type: \\?active_directory'\n\n\n xpack:\n  security:\n    authc:\n      realms:\n        active_directory:\n          type: active_directory\n          order: 0\n          domain_name: ad.example.com\n          url: ldaps://ad.example.com:636\n          unmapped_groups_as_roles: true | false\n\nIf these settings are not correct or missing, this is a finding.\n\nIf the external authentication is LDAP; verify the following settings.\n\n$ cat config/elasticsearch.yml | grep -A 16 -B 6 'type: \\?ldap'\n\nxpack:\n  security:\n    authc:\n      realms:\n        ldap1:\n          type: ldap\n          order: 0\n          url: 'ldaps://ldap.example.com:636'\n          bind_dn: 'cn=ldapuser, ou=users, o=services, dc=example, dc=com'\n          bind_password: changeme\n          user_search:\n            base_dn: 'dc=example,dc=com'\n            attribute: cn\n          group_search:\n            base_dn: 'dc=example,dc=com'\n          files:\n            role_mapping: 'CONFIG_DIR/x-pack/role_mapping.yml\n\nIf these settings are not correct or missing, this is a finding.\n\nIf the external authentication is PKI; verify the following settings.\n\n$ cat config/elasticsearch.yml | grep -A 6 -B 6 'type: \\?pki'\n\n xpack:\n  security:\n    authc:\n      realms:\n        pki1:\n          type: pki\n          username_pattern: 'EMAILADDRESS=(.*?)(?:,|$)'\n\nIf these settings are not correct or missing, this is a finding.\n\n",
            "fix": "Configure elasticsearch realms settings to point to\norganizational supported authentication mechanism\n\nSee the official documentation for the instructions on realm configuration:\nhttps://www.elastic.co/guide/en/x-pack/current/_how_authentication_works.html"
          },
          "code": "control \"V-26922\" do\n  title \"The application must support organizational requirements to enforce\nthe number of characters that get changed when passwords are changed.\"\n  desc  \"Configure the centralized authentication service to enforce\norganizational policies such as password strength, lockout, expiration,\nnotification, and screen obfuscation.\"\n  impact 0.5\n  tag \"nist\": [\"IA-5 (1) (b)\", \"Rev_4\"]\n  tag \"severity\": \"medium\"\n  tag \"rid\": \"SV-34202r1_rule\"\n  tag \"gtitle\": \"SRG-APP-000170\"\n  tag \"cci\": \"CCI-000195\"\n  tag \"check\": \"Guidance in Appendix B - System accounts cannot be disabled and\nelasticsearch does not enforce password complexity rules.\n\nElasticsearch supports LDAP, Active Directory, and PKI.\n\nIf the external authentication is Active Directory; verify the following\nsettings.\n\n$ cat config/elasticsearch.yml | grep -A 6 -B 6 'type: \\\\?active_directory'\n\n\n xpack:\n  security:\n    authc:\n      realms:\n        active_directory:\n          type: active_directory\n          order: 0\n          domain_name: ad.example.com\n          url: ldaps://ad.example.com:636\n          unmapped_groups_as_roles: true | false\n\nIf these settings are not correct or missing, this is a finding.\n\nIf the external authentication is LDAP; verify the following settings.\n\n$ cat config/elasticsearch.yml | grep -A 16 -B 6 'type: \\\\?ldap'\n\nxpack:\n  security:\n    authc:\n      realms:\n        ldap1:\n          type: ldap\n          order: 0\n          url: 'ldaps://ldap.example.com:636'\n          bind_dn: 'cn=ldapuser, ou=users, o=services, dc=example, dc=com'\n          bind_password: changeme\n          user_search:\n            base_dn: 'dc=example,dc=com'\n            attribute: cn\n          group_search:\n            base_dn: 'dc=example,dc=com'\n          files:\n            role_mapping: 'CONFIG_DIR/x-pack/role_mapping.yml\n\nIf these settings are not correct or missing, this is a finding.\n\nIf the external authentication is PKI; verify the following settings.\n\n$ cat config/elasticsearch.yml | grep -A 6 -B 6 'type: \\\\?pki'\n\n xpack:\n  security:\n    authc:\n      realms:\n        pki1:\n          type: pki\n          username_pattern: 'EMAILADDRESS=(.*?)(?:,|$)'\n\nIf these settings are not correct or missing, this is a finding.\n\n\"\n  tag \"fix\": \"Configure elasticsearch realms settings to point to\norganizational supported authentication mechanism\n\nSee the official documentation for the instructions on realm configuration:\nhttps://www.elastic.co/guide/en/x-pack/current/_how_authentication_works.html\"\n\n  begin\n\n    es_handle = es_helper(url:\"https://#{ELASTIC_IP}:#{ELASTIC_PORT}\",\n                    username: ES_ADMIN,\n                    password: ES_PASS,\n                    ssl_verify: SSL_VERIFY )\n\n    describe \"No nodes found\" do\n      subject { es_handle.nodes.nil? }\n      it { should_not be_truthy }\n    end if es_handle.nodes.nil?\n\n\n    es_handle.nodes.each do |node|\n      describe \"Authentication methods includes AD, LDAP or PKI for Node: #{node.name}\" do\n        subject { node.authc_method.any? { |x| ['pki','active_directory','ldap'].include?(x) } }\n        it{ should be true }\n      end\n    end unless es_handle.nodes.nil?\n\n    es_handle.nodes.each do |node|\n      describe.one do\n        node.authc_realm.keys.each do |auth_method|\n          describe \"Active Directory Settings for Node: #{node.name}\" do\n            subject { es_handle.settings.first.xpack.security.authc.realms[auth_method] }\n            its ('order') { should_not be_nil }\n            its ('domain_name') { should_not be_nil }\n            its ('url') { should_not be_nil }\n            its ('unmapped_groups_as_roles') { should_not be_nil }\n          end if node.authc_realm[auth_method].type.eql?('active_directory')\n\n          describe \"LDAP Settings for Node: #{node.name}\" do\n            subject { es_handle.settings.first.xpack.security.authc.realms[auth_method] }\n            its ('order') { should_not be_nil }\n            its ('url') { should_not be_nil }\n            its ('bind_dn') { should_not be_nil }\n            its ('bind_password') { should_not be_nil }\n            its ('user_search.base_dn') { should_not be_nil }\n            its ('user_search.attribute') { should_not be_nil }\n            its ('group_search.base_dn') { should_not be_nil }\n            its ('files.role_mapping') { should_not be_nil }\n          end if node.authc_realm[auth_method].type.eql?('ldap')\n\n          describe \"PKI Settings for Node: #{node.name}\" do\n            subject { node.authc_realm[auth_method] }\n            its ('order') { should_not be_nil }\n            its ('username_pattern') { should_not be_nil }\n          end if node.authc_realm[auth_method].type.eql?('pki')\n        end\n      end\n    end unless es_handle.nodes.nil?\n\n  rescue Exception => msg\n    describe \"Exception: #{msg}\" do\n      it { should be_nil}\n    end\n  end\nend",
          "source_location": {
            "line": 36,
            "ref": "../elasticsearch-inspec/controls/ad+ldap+pki/V-26922.rb"
          },
          "results": [
            {
              "status": "passed",
              "code_desc": "Authentication methods includes AD, LDAP or PKI for Node: package-centos-72 should equal true",
              "run_time": 0.000059,
              "start_time": "2018-02-11 14:26:57 -0500"
            },
            {
              "status": "passed",
              "code_desc": "PKI Settings for Node: package-centos-72 order should not be nil",
              "run_time": 0.000054,
              "start_time": "2018-02-11 14:26:57 -0500"
            },
            {
              "status": "passed",
              "code_desc": "PKI Settings for Node: package-centos-72 username_pattern should not be nil",
              "run_time": 0.00005,
              "start_time": "2018-02-11 14:26:57 -0500"
            }
          ]
        },
        {
          "id": "V-26881",
          "title": "In order to inform the user of failed login attempts made with the\nusers account, the application upon successful logon/access must display to the\nuser the number of unsuccessful logon/access attempts since the last successful\nlogon/access. ",
          "desc": "Configure the centralized authentication service to enforce\norganizational policies such as password strength, lockout, expiration,\nnotification, and screen obfuscation.",
          "impact": 0.5,
          "refs": [],
          "tags": {
            "nist": [
              "AC-9 (1)",
              "Rev_4"
            ],
            "severity": "medium",
            "rid": "SV-34161r1_rule",
            "gtitle": "SRG-APP-000076",
            "cci": "CCI-000053",
            "check": "Guidance in Appendix B - System accounts cannot be disabled and\nelasticsearch does not enforce password complexity rules.\n\nElasticsearch supports LDAP, Active Directory, and PKI.\n\nIf the external authentication is Active Directory; verify the following\nsettings.\n\n$ cat config/elasticsearch.yml | grep -A 6 -B 6 'type: \\?active_directory'\n\n\n xpack:\n  security:\n    authc:\n      realms:\n        active_directory:\n          type: active_directory\n          order: 0\n          domain_name: ad.example.com\n          url: ldaps://ad.example.com:636\n          unmapped_groups_as_roles: true | false\n\nIf these settings are not correct or missing, this is a finding.\n\nIf the external authentication is LDAP; verify the following settings.\n\n$ cat config/elasticsearch.yml | grep -A 16 -B 6 'type: \\?ldap'\n\nxpack:\n  security:\n    authc:\n      realms:\n        ldap1:\n          type: ldap\n          order: 0\n          url: 'ldaps://ldap.example.com:636'\n          bind_dn: 'cn=ldapuser, ou=users, o=services, dc=example, dc=com'\n          bind_password: changeme\n          user_search:\n            base_dn: 'dc=example,dc=com'\n            attribute: cn\n          group_search:\n            base_dn: 'dc=example,dc=com'\n          files:\n            role_mapping: 'CONFIG_DIR/x-pack/role_mapping.yml\n\nIf these settings are not correct or missing, this is a finding.\n\nIf the external authentication is PKI; verify the following settings.\n\n$ cat config/elasticsearch.yml | grep -A 6 -B 6 'type: \\?pki'\n\n xpack:\n  security:\n    authc:\n      realms:\n        pki1:\n          type: pki\n          username_pattern: 'EMAILADDRESS=(.*?)(?:,|$)'\n\nIf these settings are not correct or missing, this is a finding.\n\n",
            "fix": "Configure elasticsearch realms settings to point to\norganizational supported authentication mechanism\n\nSee the official documentation for the instructions on realm configuration:\nhttps://www.elastic.co/guide/en/x-pack/current/_how_authentication_works.html"
          },
          "code": "control \"V-26881\" do\n  title \"In order to inform the user of failed login attempts made with the\nusers account, the application upon successful logon/access must display to the\nuser the number of unsuccessful logon/access attempts since the last successful\nlogon/access. \"\n  desc  \"Configure the centralized authentication service to enforce\norganizational policies such as password strength, lockout, expiration,\nnotification, and screen obfuscation.\"\n  impact 0.5\n  tag \"nist\": [\"AC-9 (1)\", \"Rev_4\"]\n  tag \"severity\": \"medium\"\n  tag \"rid\": \"SV-34161r1_rule\"\n  tag \"gtitle\": \"SRG-APP-000076\"\n  tag \"cci\": \"CCI-000053\"\n  tag \"check\": \"Guidance in Appendix B - System accounts cannot be disabled and\nelasticsearch does not enforce password complexity rules.\n\nElasticsearch supports LDAP, Active Directory, and PKI.\n\nIf the external authentication is Active Directory; verify the following\nsettings.\n\n$ cat config/elasticsearch.yml | grep -A 6 -B 6 'type: \\\\?active_directory'\n\n\n xpack:\n  security:\n    authc:\n      realms:\n        active_directory:\n          type: active_directory\n          order: 0\n          domain_name: ad.example.com\n          url: ldaps://ad.example.com:636\n          unmapped_groups_as_roles: true | false\n\nIf these settings are not correct or missing, this is a finding.\n\nIf the external authentication is LDAP; verify the following settings.\n\n$ cat config/elasticsearch.yml | grep -A 16 -B 6 'type: \\\\?ldap'\n\nxpack:\n  security:\n    authc:\n      realms:\n        ldap1:\n          type: ldap\n          order: 0\n          url: 'ldaps://ldap.example.com:636'\n          bind_dn: 'cn=ldapuser, ou=users, o=services, dc=example, dc=com'\n          bind_password: changeme\n          user_search:\n            base_dn: 'dc=example,dc=com'\n            attribute: cn\n          group_search:\n            base_dn: 'dc=example,dc=com'\n          files:\n            role_mapping: 'CONFIG_DIR/x-pack/role_mapping.yml\n\nIf these settings are not correct or missing, this is a finding.\n\nIf the external authentication is PKI; verify the following settings.\n\n$ cat config/elasticsearch.yml | grep -A 6 -B 6 'type: \\\\?pki'\n\n xpack:\n  security:\n    authc:\n      realms:\n        pki1:\n          type: pki\n          username_pattern: 'EMAILADDRESS=(.*?)(?:,|$)'\n\nIf these settings are not correct or missing, this is a finding.\n\n\"\n  tag \"fix\": \"Configure elasticsearch realms settings to point to\norganizational supported authentication mechanism\n\nSee the official documentation for the instructions on realm configuration:\nhttps://www.elastic.co/guide/en/x-pack/current/_how_authentication_works.html\"\n\n\n  begin\n\n    es_handle = es_helper(url:\"https://#{ELASTIC_IP}:#{ELASTIC_PORT}\",\n                    username: ES_ADMIN,\n                    password: ES_PASS,\n                    ssl_verify: SSL_VERIFY )\n\n    describe \"No nodes found\" do\n      subject { es_handle.nodes.nil? }\n      it { should_not be_truthy }\n    end if es_handle.nodes.nil?\n\n\n    es_handle.nodes.each do |node|\n      describe \"Authentication methods includes AD, LDAP or PKI for Node: #{node.name}\" do\n        subject { node.authc_method.any? { |x| ['pki','active_directory','ldap'].include?(x) } }\n        it{ should be true }\n      end\n    end unless es_handle.nodes.nil?\n\n    es_handle.nodes.each do |node|\n      describe.one do\n        node.authc_realm.keys.each do |auth_method|\n          describe \"Active Directory Settings for Node: #{node.name}\" do\n            subject { es_handle.settings.first.xpack.security.authc.realms[auth_method] }\n            its ('order') { should_not be_nil }\n            its ('domain_name') { should_not be_nil }\n            its ('url') { should_not be_nil }\n            its ('unmapped_groups_as_roles') { should_not be_nil }\n          end if node.authc_realm[auth_method].type.eql?('active_directory')\n\n          describe \"LDAP Settings for Node: #{node.name}\" do\n            subject { es_handle.settings.first.xpack.security.authc.realms[auth_method] }\n            its ('order') { should_not be_nil }\n            its ('url') { should_not be_nil }\n            its ('bind_dn') { should_not be_nil }\n            its ('bind_password') { should_not be_nil }\n            its ('user_search.base_dn') { should_not be_nil }\n            its ('user_search.attribute') { should_not be_nil }\n            its ('group_search.base_dn') { should_not be_nil }\n            its ('files.role_mapping') { should_not be_nil }\n          end if node.authc_realm[auth_method].type.eql?('ldap')\n\n          describe \"PKI Settings for Node: #{node.name}\" do\n            subject { node.authc_realm[auth_method] }\n            its ('order') { should_not be_nil }\n            its ('username_pattern') { should_not be_nil }\n          end if node.authc_realm[auth_method].type.eql?('pki')\n        end\n      end\n    end unless es_handle.nodes.nil?\n\n  rescue Exception => msg\n    describe \"Exception: #{msg}\" do\n      it { should be_nil}\n    end\n  end\nend",
          "source_location": {
            "line": 35,
            "ref": "../elasticsearch-inspec/controls/ad+ldap+pki/V-26881.rb"
          },
          "results": [
            {
              "status": "passed",
              "code_desc": "Authentication methods includes AD, LDAP or PKI for Node: package-centos-72 should equal true",
              "run_time": 0.000114,
              "start_time": "2018-02-11 14:26:57 -0500"
            },
            {
              "status": "passed",
              "code_desc": "PKI Settings for Node: package-centos-72 order should not be nil",
              "run_time": 0.000053,
              "start_time": "2018-02-11 14:26:57 -0500"
            },
            {
              "status": "passed",
              "code_desc": "PKI Settings for Node: package-centos-72 username_pattern should not be nil",
              "run_time": 0.000088,
              "start_time": "2018-02-11 14:26:57 -0500"
            }
          ]
        },
        {
          "id": "V-26972",
          "title": "The application must uniquely identify and authenticate organizational\nusers (or processes acting on behalf of organizational users).",
          "desc": "Configure the centralized authentication service to enforce\norganizational policies such as password strength, lockout, expiration,\nnotification, and screen obfuscation.",
          "impact": 0.5,
          "refs": [],
          "tags": {
            "nist": [
              "IA-2",
              "Rev_4"
            ],
            "severity": "medium",
            "rid": "SV-34260r1_rule",
            "gtitle": "SRG-APP-000148",
            "cci": "CCI-000764",
            "check": "Guidance in Appendix B - System accounts cannot be disabled and\nelasticsearch does not enforce password complexity rules.\n\nElasticsearch supports LDAP, Active Directory, and PKI.\n\nIf the external authentication is Active Directory; verify the following\nsettings.\n\n$ cat config/elasticsearch.yml | grep -A 6 -B 6 'type: \\?active_directory'\n\n\n xpack:\n  security:\n    authc:\n      realms:\n        active_directory:\n          type: active_directory\n          order: 0\n          domain_name: ad.example.com\n          url: ldaps://ad.example.com:636\n          unmapped_groups_as_roles: true | false\n\nIf these settings are not correct or missing, this is a finding.\n\nIf the external authentication is LDAP; verify the following settings.\n\n$ cat config/elasticsearch.yml | grep -A 16 -B 6 'type: \\?ldap'\n\nxpack:\n  security:\n    authc:\n      realms:\n        ldap1:\n          type: ldap\n          order: 0\n          url: 'ldaps://ldap.example.com:636'\n          bind_dn: 'cn=ldapuser, ou=users, o=services, dc=example, dc=com'\n          bind_password: changeme\n          user_search:\n            base_dn: 'dc=example,dc=com'\n            attribute: cn\n          group_search:\n            base_dn: 'dc=example,dc=com'\n          files:\n            role_mapping: 'CONFIG_DIR/x-pack/role_mapping.yml\n\nIf these settings are not correct or missing, this is a finding.\n\nIf the external authentication is PKI; verify the following settings.\n\n$ cat config/elasticsearch.yml | grep -A 6 -B 6 'type: \\?pki'\n\n xpack:\n  security:\n    authc:\n      realms:\n        pki1:\n          type: pki\n          username_pattern: 'EMAILADDRESS=(.*?)(?:,|$)'\n\nIf these settings are not correct or missing, this is a finding.\n\n",
            "fix": "Configure elasticsearch realms settings to point to\norganizational supported authentication mechanism\n\nSee the official documentation for the instructions on realm configuration:\nhttps://www.elastic.co/guide/en/x-pack/current/_how_authentication_works.html"
          },
          "code": "control \"V-26972\" do\n  title \"The application must uniquely identify and authenticate organizational\nusers (or processes acting on behalf of organizational users).\"\n  desc  \"Configure the centralized authentication service to enforce\norganizational policies such as password strength, lockout, expiration,\nnotification, and screen obfuscation.\"\n  impact 0.5\n  tag \"nist\": [\"IA-2\", \"Rev_4\"]\n  tag \"severity\": \"medium\"\n  tag \"rid\": \"SV-34260r1_rule\"\n  tag \"gtitle\": \"SRG-APP-000148\"\n  tag \"cci\": \"CCI-000764\"\n  tag \"check\": \"Guidance in Appendix B - System accounts cannot be disabled and\nelasticsearch does not enforce password complexity rules.\n\nElasticsearch supports LDAP, Active Directory, and PKI.\n\nIf the external authentication is Active Directory; verify the following\nsettings.\n\n$ cat config/elasticsearch.yml | grep -A 6 -B 6 'type: \\\\?active_directory'\n\n\n xpack:\n  security:\n    authc:\n      realms:\n        active_directory:\n          type: active_directory\n          order: 0\n          domain_name: ad.example.com\n          url: ldaps://ad.example.com:636\n          unmapped_groups_as_roles: true | false\n\nIf these settings are not correct or missing, this is a finding.\n\nIf the external authentication is LDAP; verify the following settings.\n\n$ cat config/elasticsearch.yml | grep -A 16 -B 6 'type: \\\\?ldap'\n\nxpack:\n  security:\n    authc:\n      realms:\n        ldap1:\n          type: ldap\n          order: 0\n          url: 'ldaps://ldap.example.com:636'\n          bind_dn: 'cn=ldapuser, ou=users, o=services, dc=example, dc=com'\n          bind_password: changeme\n          user_search:\n            base_dn: 'dc=example,dc=com'\n            attribute: cn\n          group_search:\n            base_dn: 'dc=example,dc=com'\n          files:\n            role_mapping: 'CONFIG_DIR/x-pack/role_mapping.yml\n\nIf these settings are not correct or missing, this is a finding.\n\nIf the external authentication is PKI; verify the following settings.\n\n$ cat config/elasticsearch.yml | grep -A 6 -B 6 'type: \\\\?pki'\n\n xpack:\n  security:\n    authc:\n      realms:\n        pki1:\n          type: pki\n          username_pattern: 'EMAILADDRESS=(.*?)(?:,|$)'\n\nIf these settings are not correct or missing, this is a finding.\n\n\"\n  tag \"fix\": \"Configure elasticsearch realms settings to point to\norganizational supported authentication mechanism\n\nSee the official documentation for the instructions on realm configuration:\nhttps://www.elastic.co/guide/en/x-pack/current/_how_authentication_works.html\"\n\n  begin\n\n    es_handle = es_helper(url:\"https://#{ELASTIC_IP}:#{ELASTIC_PORT}\",\n                    username: ES_ADMIN,\n                    password: ES_PASS,\n                    ssl_verify: SSL_VERIFY )\n\n    describe \"No nodes found\" do\n      subject { es_handle.nodes.nil? }\n      it { should_not be_truthy }\n    end if es_handle.nodes.nil?\n\n\n    es_handle.nodes.each do |node|\n      describe \"Authentication methods includes AD, LDAP or PKI for Node: #{node.name}\" do\n        subject { node.authc_method.any? { |x| ['pki','active_directory','ldap'].include?(x) } }\n        it{ should be true }\n      end\n    end unless es_handle.nodes.nil?\n\n    es_handle.nodes.each do |node|\n      describe.one do\n        node.authc_realm.keys.each do |auth_method|\n          describe \"Active Directory Settings for Node: #{node.name}\" do\n            subject { es_handle.settings.first.xpack.security.authc.realms[auth_method] }\n            its ('order') { should_not be_nil }\n            its ('domain_name') { should_not be_nil }\n            its ('url') { should_not be_nil }\n            its ('unmapped_groups_as_roles') { should_not be_nil }\n          end if node.authc_realm[auth_method].type.eql?('active_directory')\n\n          describe \"LDAP Settings for Node: #{node.name}\" do\n            subject { es_handle.settings.first.xpack.security.authc.realms[auth_method] }\n            its ('order') { should_not be_nil }\n            its ('url') { should_not be_nil }\n            its ('bind_dn') { should_not be_nil }\n            its ('bind_password') { should_not be_nil }\n            its ('user_search.base_dn') { should_not be_nil }\n            its ('user_search.attribute') { should_not be_nil }\n            its ('group_search.base_dn') { should_not be_nil }\n            its ('files.role_mapping') { should_not be_nil }\n          end if node.authc_realm[auth_method].type.eql?('ldap')\n\n          describe \"PKI Settings for Node: #{node.name}\" do\n            subject { node.authc_realm[auth_method] }\n            its ('order') { should_not be_nil }\n            its ('username_pattern') { should_not be_nil }\n          end if node.authc_realm[auth_method].type.eql?('pki')\n        end\n      end\n    end unless es_handle.nodes.nil?\n\n  rescue Exception => msg\n    describe \"Exception: #{msg}\" do\n      it { should be_nil}\n    end\n  end\nend\n",
          "source_location": {
            "line": 36,
            "ref": "../elasticsearch-inspec/controls/ad+ldap+pki/V-26972.rb"
          },
          "results": [
            {
              "status": "passed",
              "code_desc": "Authentication methods includes AD, LDAP or PKI for Node: package-centos-72 should equal true",
              "run_time": 0.00006,
              "start_time": "2018-02-11 14:26:57 -0500"
            },
            {
              "status": "passed",
              "code_desc": "PKI Settings for Node: package-centos-72 order should not be nil",
              "run_time": 0.000055,
              "start_time": "2018-02-11 14:26:57 -0500"
            },
            {
              "status": "passed",
              "code_desc": "PKI Settings for Node: package-centos-72 username_pattern should not be nil",
              "run_time": 0.000049,
              "start_time": "2018-02-11 14:26:57 -0500"
            }
          ]
        },
        {
          "id": "V-26923",
          "title": "The application must support organizational requirements to enforce\npassword encryption for storage.",
          "desc": "Configure the centralized authentication service to enforce\norganizational policies such as password strength, lockout, expiration,\nnotification, and screen obfuscation.",
          "impact": 0.5,
          "refs": [],
          "tags": {
            "nist": [
              "IA-5 (1) (c)",
              "Rev_4"
            ],
            "severity": "medium",
            "rid": "SV-34203r1_rule",
            "gtitle": "SRG-APP-000171",
            "cci": "CCI-000196",
            "check": "Guidance in Appendix B - System accounts cannot be disabled and\nelasticsearch does not enforce password complexity rules.\n\nElasticsearch supports LDAP, Active Directory, and PKI.\n\nIf the external authentication is Active Directory; verify the following\nsettings.\n\n$ cat config/elasticsearch.yml | grep -A 6 -B 6 'type: \\?active_directory'\n\n\n xpack:\n  security:\n    authc:\n      realms:\n        active_directory:\n          type: active_directory\n          order: 0\n          domain_name: ad.example.com\n          url: ldaps://ad.example.com:636\n          unmapped_groups_as_roles: true | false\n\nIf these settings are not correct or missing, this is a finding.\n\nIf the external authentication is LDAP; verify the following settings.\n\n$ cat config/elasticsearch.yml | grep -A 16 -B 6 'type: \\?ldap'\n\nxpack:\n  security:\n    authc:\n      realms:\n        ldap1:\n          type: ldap\n          order: 0\n          url: 'ldaps://ldap.example.com:636'\n          bind_dn: 'cn=ldapuser, ou=users, o=services, dc=example, dc=com'\n          bind_password: changeme\n          user_search:\n            base_dn: 'dc=example,dc=com'\n            attribute: cn\n          group_search:\n            base_dn: 'dc=example,dc=com'\n          files:\n            role_mapping: 'CONFIG_DIR/x-pack/role_mapping.yml\n\nIf these settings are not correct or missing, this is a finding.\n\nIf the external authentication is PKI; verify the following settings.\n\n$ cat config/elasticsearch.yml | grep -A 6 -B 6 'type: \\?pki'\n\n xpack:\n  security:\n    authc:\n      realms:\n        pki1:\n          type: pki\n          username_pattern: 'EMAILADDRESS=(.*?)(?:,|$)'\n\nIf these settings are not correct or missing, this is a finding.\n\n",
            "fix": "Configure elasticsearch realms settings to point to\norganizational supported authentication mechanism\n\nSee the official documentation for the instructions on realm configuration:\nhttps://www.elastic.co/guide/en/x-pack/current/_how_authentication_works.html"
          },
          "code": "control \"V-26923\" do\n  title \"The application must support organizational requirements to enforce\npassword encryption for storage.\"\n  desc  \"Configure the centralized authentication service to enforce\norganizational policies such as password strength, lockout, expiration,\nnotification, and screen obfuscation.\"\n  impact 0.5\n  tag \"nist\": [\"IA-5 (1) (c)\", \"Rev_4\"]\n  tag \"severity\": \"medium\"\n  tag \"rid\": \"SV-34203r1_rule\"\n  tag \"gtitle\": \"SRG-APP-000171\"\n  tag \"cci\": \"CCI-000196\"\n  tag \"check\": \"Guidance in Appendix B - System accounts cannot be disabled and\nelasticsearch does not enforce password complexity rules.\n\nElasticsearch supports LDAP, Active Directory, and PKI.\n\nIf the external authentication is Active Directory; verify the following\nsettings.\n\n$ cat config/elasticsearch.yml | grep -A 6 -B 6 'type: \\\\?active_directory'\n\n\n xpack:\n  security:\n    authc:\n      realms:\n        active_directory:\n          type: active_directory\n          order: 0\n          domain_name: ad.example.com\n          url: ldaps://ad.example.com:636\n          unmapped_groups_as_roles: true | false\n\nIf these settings are not correct or missing, this is a finding.\n\nIf the external authentication is LDAP; verify the following settings.\n\n$ cat config/elasticsearch.yml | grep -A 16 -B 6 'type: \\\\?ldap'\n\nxpack:\n  security:\n    authc:\n      realms:\n        ldap1:\n          type: ldap\n          order: 0\n          url: 'ldaps://ldap.example.com:636'\n          bind_dn: 'cn=ldapuser, ou=users, o=services, dc=example, dc=com'\n          bind_password: changeme\n          user_search:\n            base_dn: 'dc=example,dc=com'\n            attribute: cn\n          group_search:\n            base_dn: 'dc=example,dc=com'\n          files:\n            role_mapping: 'CONFIG_DIR/x-pack/role_mapping.yml\n\nIf these settings are not correct or missing, this is a finding.\n\nIf the external authentication is PKI; verify the following settings.\n\n$ cat config/elasticsearch.yml | grep -A 6 -B 6 'type: \\\\?pki'\n\n xpack:\n  security:\n    authc:\n      realms:\n        pki1:\n          type: pki\n          username_pattern: 'EMAILADDRESS=(.*?)(?:,|$)'\n\nIf these settings are not correct or missing, this is a finding.\n\n\"\n  tag \"fix\": \"Configure elasticsearch realms settings to point to\norganizational supported authentication mechanism\n\nSee the official documentation for the instructions on realm configuration:\nhttps://www.elastic.co/guide/en/x-pack/current/_how_authentication_works.html\"\n\n  begin\n\n    es_handle = es_helper(url:\"https://#{ELASTIC_IP}:#{ELASTIC_PORT}\",\n                    username: ES_ADMIN,\n                    password: ES_PASS,\n                    ssl_verify: SSL_VERIFY )\n\n    describe \"No nodes found\" do\n      subject { es_handle.nodes.nil? }\n      it { should_not be_truthy }\n    end if es_handle.nodes.nil?\n\n\n    es_handle.nodes.each do |node|\n      describe \"Authentication methods includes AD, LDAP or PKI for Node: #{node.name}\" do\n        subject { node.authc_method.any? { |x| ['pki','active_directory','ldap'].include?(x) } }\n        it{ should be true }\n      end\n    end unless es_handle.nodes.nil?\n\n    es_handle.nodes.each do |node|\n      describe.one do\n        node.authc_realm.keys.each do |auth_method|\n          describe \"Active Directory Settings for Node: #{node.name}\" do\n            subject { es_handle.settings.first.xpack.security.authc.realms[auth_method] }\n            its ('order') { should_not be_nil }\n            its ('domain_name') { should_not be_nil }\n            its ('url') { should_not be_nil }\n            its ('unmapped_groups_as_roles') { should_not be_nil }\n          end if node.authc_realm[auth_method].type.eql?('active_directory')\n\n          describe \"LDAP Settings for Node: #{node.name}\" do\n            subject { es_handle.settings.first.xpack.security.authc.realms[auth_method] }\n            its ('order') { should_not be_nil }\n            its ('url') { should_not be_nil }\n            its ('bind_dn') { should_not be_nil }\n            its ('bind_password') { should_not be_nil }\n            its ('user_search.base_dn') { should_not be_nil }\n            its ('user_search.attribute') { should_not be_nil }\n            its ('group_search.base_dn') { should_not be_nil }\n            its ('files.role_mapping') { should_not be_nil }\n          end if node.authc_realm[auth_method].type.eql?('ldap')\n\n          describe \"PKI Settings for Node: #{node.name}\" do\n            subject { node.authc_realm[auth_method] }\n            its ('order') { should_not be_nil }\n            its ('username_pattern') { should_not be_nil }\n          end if node.authc_realm[auth_method].type.eql?('pki')\n        end\n      end\n    end unless es_handle.nodes.nil?\n\n  rescue Exception => msg\n    describe \"Exception: #{msg}\" do\n      it { should be_nil}\n    end\n  end\nend",
          "source_location": {
            "line": 35,
            "ref": "../elasticsearch-inspec/controls/ad+ldap+pki/V-26923.rb"
          },
          "results": [
            {
              "status": "passed",
              "code_desc": "Authentication methods includes AD, LDAP or PKI for Node: package-centos-72 should equal true",
              "run_time": 0.000062,
              "start_time": "2018-02-11 14:26:57 -0500"
            },
            {
              "status": "passed",
              "code_desc": "PKI Settings for Node: package-centos-72 order should not be nil",
              "run_time": 0.000052,
              "start_time": "2018-02-11 14:26:57 -0500"
            },
            {
              "status": "passed",
              "code_desc": "PKI Settings for Node: package-centos-72 username_pattern should not be nil",
              "run_time": 0.000051,
              "start_time": "2018-02-11 14:26:57 -0500"
            }
          ]
        },
        {
          "id": "V-26701",
          "title": "The application must provide a mechanism to automatically terminate\naccounts designated as temporary or emergency accounts after an\norganizational-defined time period.",
          "desc": "Configure the centralized authentication service to enforce\norganizational policies such as password strength, lockout, expiration,\nnotification, and screen obfuscation.",
          "impact": 0.5,
          "refs": [],
          "tags": {
            "nist": [
              "AC-2 (2)",
              "Rev_4"
            ],
            "severity": "medium",
            "rid": "SV-33944r1_rule",
            "gtitle": "SRG-APP-000024",
            "cci": "CCI-000016",
            "check": "Guidance in Appendix B - System accounts cannot be disabled and\nelasticsearch does not enforce password complexity rules.\n\nElasticsearch supports LDAP, Active Directory, and PKI.\n\nIf the external authentication is Active Directory; verify the following\nsettings.\n\n$ cat config/elasticsearch.yml | grep -A 6 -B 6 'type: \\?active_directory'\n\n\n xpack:\n  security:\n    authc:\n      realms:\n        active_directory:\n          type: active_directory\n          order: 0\n          domain_name: ad.example.com\n          url: ldaps://ad.example.com:636\n          unmapped_groups_as_roles: true | false\n\nIf these settings are not correct or missing, this is a finding.\n\nIf the external authentication is LDAP; verify the following settings.\n\n$ cat config/elasticsearch.yml | grep -A 16 -B 6 'type: \\?ldap'\n\nxpack:\n  security:\n    authc:\n      realms:\n        ldap1:\n          type: ldap\n          order: 0\n          url: 'ldaps://ldap.example.com:636'\n          bind_dn: 'cn=ldapuser, ou=users, o=services, dc=example, dc=com'\n          bind_password: changeme\n          user_search:\n            base_dn: 'dc=example,dc=com'\n            attribute: cn\n          group_search:\n            base_dn: 'dc=example,dc=com'\n          files:\n            role_mapping: 'CONFIG_DIR/x-pack/role_mapping.yml\n\nIf these settings are not correct or missing, this is a finding.\n\nIf the external authentication is PKI; verify the following settings.\n\n$ cat config/elasticsearch.yml | grep -A 6 -B 6 'type: \\?pki'\n\n xpack:\n  security:\n    authc:\n      realms:\n        pki1:\n          type: pki\n          username_pattern: 'EMAILADDRESS=(.*?)(?:,|$)'\n\nIf these settings are not correct or missing, this is a finding.\n\n",
            "fix": "Configure elasticsearch realms settings to point to\norganizational supported authentication mechanism\n\nSee the official documentation for the instructions on realm configuration:\nhttps://www.elastic.co/guide/en/x-pack/current/_how_authentication_works.html"
          },
          "code": "control \"V-26701\" do\n  title \"The application must provide a mechanism to automatically terminate\naccounts designated as temporary or emergency accounts after an\norganizational-defined time period.\"\n  desc  \"Configure the centralized authentication service to enforce\norganizational policies such as password strength, lockout, expiration,\nnotification, and screen obfuscation.\"\n  impact 0.5\n  tag \"nist\": [\"AC-2 (2)\", \"Rev_4\"]\n  tag \"severity\": \"medium\"\n  tag \"rid\": \"SV-33944r1_rule\"\n  tag \"gtitle\": \"SRG-APP-000024\"\n  tag \"cci\": \"CCI-000016\"\n  tag \"check\": \"Guidance in Appendix B - System accounts cannot be disabled and\nelasticsearch does not enforce password complexity rules.\n\nElasticsearch supports LDAP, Active Directory, and PKI.\n\nIf the external authentication is Active Directory; verify the following\nsettings.\n\n$ cat config/elasticsearch.yml | grep -A 6 -B 6 'type: \\\\?active_directory'\n\n\n xpack:\n  security:\n    authc:\n      realms:\n        active_directory:\n          type: active_directory\n          order: 0\n          domain_name: ad.example.com\n          url: ldaps://ad.example.com:636\n          unmapped_groups_as_roles: true | false\n\nIf these settings are not correct or missing, this is a finding.\n\nIf the external authentication is LDAP; verify the following settings.\n\n$ cat config/elasticsearch.yml | grep -A 16 -B 6 'type: \\\\?ldap'\n\nxpack:\n  security:\n    authc:\n      realms:\n        ldap1:\n          type: ldap\n          order: 0\n          url: 'ldaps://ldap.example.com:636'\n          bind_dn: 'cn=ldapuser, ou=users, o=services, dc=example, dc=com'\n          bind_password: changeme\n          user_search:\n            base_dn: 'dc=example,dc=com'\n            attribute: cn\n          group_search:\n            base_dn: 'dc=example,dc=com'\n          files:\n            role_mapping: 'CONFIG_DIR/x-pack/role_mapping.yml\n\nIf these settings are not correct or missing, this is a finding.\n\nIf the external authentication is PKI; verify the following settings.\n\n$ cat config/elasticsearch.yml | grep -A 6 -B 6 'type: \\\\?pki'\n\n xpack:\n  security:\n    authc:\n      realms:\n        pki1:\n          type: pki\n          username_pattern: 'EMAILADDRESS=(.*?)(?:,|$)'\n\nIf these settings are not correct or missing, this is a finding.\n\n\"\n  tag \"fix\": \"Configure elasticsearch realms settings to point to\norganizational supported authentication mechanism\n\nSee the official documentation for the instructions on realm configuration:\nhttps://www.elastic.co/guide/en/x-pack/current/_how_authentication_works.html\"\n\n  begin\n\n    es_handle = es_helper(url:\"https://#{ELASTIC_IP}:#{ELASTIC_PORT}\",\n                    username: ES_ADMIN,\n                    password: ES_PASS,\n                    ssl_verify: SSL_VERIFY )\n\n    describe \"No nodes found\" do\n      subject { es_handle.nodes.nil? }\n      it { should_not be_truthy }\n    end if es_handle.nodes.nil?\n\n\n    es_handle.nodes.each do |node|\n      describe \"Authentication methods includes AD, LDAP or PKI for Node: #{node.name}\" do\n        subject { node.authc_method.any? { |x| ['pki','active_directory','ldap'].include?(x) } }\n        it{ should be true }\n      end\n    end unless es_handle.nodes.nil?\n\n    es_handle.nodes.each do |node|\n      describe.one do\n        node.authc_realm.keys.each do |auth_method|\n          describe \"Active Directory Settings for Node: #{node.name}\" do\n            subject { es_handle.settings.first.xpack.security.authc.realms[auth_method] }\n            its ('order') { should_not be_nil }\n            its ('domain_name') { should_not be_nil }\n            its ('url') { should_not be_nil }\n            its ('unmapped_groups_as_roles') { should_not be_nil }\n          end if node.authc_realm[auth_method].type.eql?('active_directory')\n\n          describe \"LDAP Settings for Node: #{node.name}\" do\n            subject { es_handle.settings.first.xpack.security.authc.realms[auth_method] }\n            its ('order') { should_not be_nil }\n            its ('url') { should_not be_nil }\n            its ('bind_dn') { should_not be_nil }\n            its ('bind_password') { should_not be_nil }\n            its ('user_search.base_dn') { should_not be_nil }\n            its ('user_search.attribute') { should_not be_nil }\n            its ('group_search.base_dn') { should_not be_nil }\n            its ('files.role_mapping') { should_not be_nil }\n          end if node.authc_realm[auth_method].type.eql?('ldap')\n\n          describe \"PKI Settings for Node: #{node.name}\" do\n            subject { node.authc_realm[auth_method] }\n            its ('order') { should_not be_nil }\n            its ('username_pattern') { should_not be_nil }\n          end if node.authc_realm[auth_method].type.eql?('pki')\n        end\n      end\n    end unless es_handle.nodes.nil?\n\n  rescue Exception => msg\n    describe \"Exception: #{msg}\" do\n      it { should be_nil}\n    end\n  end\nend",
          "source_location": {
            "line": 36,
            "ref": "../elasticsearch-inspec/controls/ad+ldap+pki/V-26701.rb"
          },
          "results": [
            {
              "status": "passed",
              "code_desc": "Authentication methods includes AD, LDAP or PKI for Node: package-centos-72 should equal true",
              "run_time": 0.00006,
              "start_time": "2018-02-11 14:26:57 -0500"
            },
            {
              "status": "passed",
              "code_desc": "PKI Settings for Node: package-centos-72 order should not be nil",
              "run_time": 0.000073,
              "start_time": "2018-02-11 14:26:57 -0500"
            },
            {
              "status": "passed",
              "code_desc": "PKI Settings for Node: package-centos-72 username_pattern should not be nil",
              "run_time": 0.000054,
              "start_time": "2018-02-11 14:26:57 -0500"
            }
          ]
        },
        {
          "id": "V-26913",
          "title": "Web services applications establishing identities at run-time for\npreviously unknown entities must dynamically manage identifiers, attributes,\nand associated access authorizations.",
          "desc": "Configure the centralized authentication service to enforce\norganizational policies such as password strength, lockout, expiration,\nnotification, and screen obfuscation.",
          "impact": 0.5,
          "refs": [],
          "tags": {
            "nist": [
              "IA-4 (5)",
              "Rev_3"
            ],
            "severity": "medium",
            "rid": "SV-34193r1_rule",
            "gtitle": "SRG-APP-000162",
            "cci": "CCI-000802",
            "check": "Guidance in Appendix B - System accounts cannot be disabled and\nelasticsearch does not enforce password complexity rules.\n\nElasticsearch supports LDAP, Active Directory, and PKI.\n\nIf the external authentication is Active Directory; verify the following\nsettings.\n\n$ cat config/elasticsearch.yml | grep -A 6 -B 6 'type: \\?active_directory'\n\n\n xpack:\n  security:\n    authc:\n      realms:\n        active_directory:\n          type: active_directory\n          order: 0\n          domain_name: ad.example.com\n          url: ldaps://ad.example.com:636\n          unmapped_groups_as_roles: true | false\n\nIf these settings are not correct or missing, this is a finding.\n\nIf the external authentication is LDAP; verify the following settings.\n\n$ cat config/elasticsearch.yml | grep -A 16 -B 6 'type: \\?ldap'\n\nxpack:\n  security:\n    authc:\n      realms:\n        ldap1:\n          type: ldap\n          order: 0\n          url: 'ldaps://ldap.example.com:636'\n          bind_dn: 'cn=ldapuser, ou=users, o=services, dc=example, dc=com'\n          bind_password: changeme\n          user_search:\n            base_dn: 'dc=example,dc=com'\n            attribute: cn\n          group_search:\n            base_dn: 'dc=example,dc=com'\n          files:\n            role_mapping: 'CONFIG_DIR/x-pack/role_mapping.yml\n\nIf these settings are not correct or missing, this is a finding.\n\nIf the external authentication is PKI; verify the following settings.\n\n$ cat config/elasticsearch.yml | grep -A 6 -B 6 'type: \\?pki'\n\n xpack:\n  security:\n    authc:\n      realms:\n        pki1:\n          type: pki\n          username_pattern: 'EMAILADDRESS=(.*?)(?:,|$)'\n\nIf these settings are not correct or missing, this is a finding.\n\n",
            "fix": "Configure elasticsearch realms settings to point to\norganizational supported authentication mechanism\n\nSee the official documentation for the instructions on realm configuration:\nhttps://www.elastic.co/guide/en/x-pack/current/_how_authentication_works.html"
          },
          "code": "control \"V-26913\" do\n  title \"Web services applications establishing identities at run-time for\npreviously unknown entities must dynamically manage identifiers, attributes,\nand associated access authorizations.\"\n  desc  \"Configure the centralized authentication service to enforce\norganizational policies such as password strength, lockout, expiration,\nnotification, and screen obfuscation.\"\n  impact 0.5\n  tag \"nist\": [\"IA-4 (5)\", \"Rev_3\"]\n  tag \"severity\": \"medium\"\n  tag \"rid\": \"SV-34193r1_rule\"\n  tag \"gtitle\": \"SRG-APP-000162\"\n  tag \"cci\": \"CCI-000802\"\n  tag \"check\": \"Guidance in Appendix B - System accounts cannot be disabled and\nelasticsearch does not enforce password complexity rules.\n\nElasticsearch supports LDAP, Active Directory, and PKI.\n\nIf the external authentication is Active Directory; verify the following\nsettings.\n\n$ cat config/elasticsearch.yml | grep -A 6 -B 6 'type: \\\\?active_directory'\n\n\n xpack:\n  security:\n    authc:\n      realms:\n        active_directory:\n          type: active_directory\n          order: 0\n          domain_name: ad.example.com\n          url: ldaps://ad.example.com:636\n          unmapped_groups_as_roles: true | false\n\nIf these settings are not correct or missing, this is a finding.\n\nIf the external authentication is LDAP; verify the following settings.\n\n$ cat config/elasticsearch.yml | grep -A 16 -B 6 'type: \\\\?ldap'\n\nxpack:\n  security:\n    authc:\n      realms:\n        ldap1:\n          type: ldap\n          order: 0\n          url: 'ldaps://ldap.example.com:636'\n          bind_dn: 'cn=ldapuser, ou=users, o=services, dc=example, dc=com'\n          bind_password: changeme\n          user_search:\n            base_dn: 'dc=example,dc=com'\n            attribute: cn\n          group_search:\n            base_dn: 'dc=example,dc=com'\n          files:\n            role_mapping: 'CONFIG_DIR/x-pack/role_mapping.yml\n\nIf these settings are not correct or missing, this is a finding.\n\nIf the external authentication is PKI; verify the following settings.\n\n$ cat config/elasticsearch.yml | grep -A 6 -B 6 'type: \\\\?pki'\n\n xpack:\n  security:\n    authc:\n      realms:\n        pki1:\n          type: pki\n          username_pattern: 'EMAILADDRESS=(.*?)(?:,|$)'\n\nIf these settings are not correct or missing, this is a finding.\n\n\"\n  tag \"fix\": \"Configure elasticsearch realms settings to point to\norganizational supported authentication mechanism\n\nSee the official documentation for the instructions on realm configuration:\nhttps://www.elastic.co/guide/en/x-pack/current/_how_authentication_works.html\"\n\n\n  begin\n\n    es_handle = es_helper(url:\"https://#{ELASTIC_IP}:#{ELASTIC_PORT}\",\n                    username: ES_ADMIN,\n                    password: ES_PASS,\n                    ssl_verify: SSL_VERIFY )\n\n    describe \"No nodes found\" do\n      subject { es_handle.nodes.nil? }\n      it { should_not be_truthy }\n    end if es_handle.nodes.nil?\n\n\n    es_handle.nodes.each do |node|\n      describe \"Authentication methods includes AD, LDAP or PKI for Node: #{node.name}\" do\n        subject { node.authc_method.any? { |x| ['pki','active_directory','ldap'].include?(x) } }\n        it{ should be true }\n      end\n    end unless es_handle.nodes.nil?\n\n    es_handle.nodes.each do |node|\n      describe.one do\n        node.authc_realm.keys.each do |auth_method|\n          describe \"Active Directory Settings for Node: #{node.name}\" do\n            subject { es_handle.settings.first.xpack.security.authc.realms[auth_method] }\n            its ('order') { should_not be_nil }\n            its ('domain_name') { should_not be_nil }\n            its ('url') { should_not be_nil }\n            its ('unmapped_groups_as_roles') { should_not be_nil }\n          end if node.authc_realm[auth_method].type.eql?('active_directory')\n\n          describe \"LDAP Settings for Node: #{node.name}\" do\n            subject { es_handle.settings.first.xpack.security.authc.realms[auth_method] }\n            its ('order') { should_not be_nil }\n            its ('url') { should_not be_nil }\n            its ('bind_dn') { should_not be_nil }\n            its ('bind_password') { should_not be_nil }\n            its ('user_search.base_dn') { should_not be_nil }\n            its ('user_search.attribute') { should_not be_nil }\n            its ('group_search.base_dn') { should_not be_nil }\n            its ('files.role_mapping') { should_not be_nil }\n          end if node.authc_realm[auth_method].type.eql?('ldap')\n\n          describe \"PKI Settings for Node: #{node.name}\" do\n            subject { node.authc_realm[auth_method] }\n            its ('order') { should_not be_nil }\n            its ('username_pattern') { should_not be_nil }\n          end if node.authc_realm[auth_method].type.eql?('pki')\n        end\n      end\n    end unless es_handle.nodes.nil?\n\n  rescue Exception => msg\n    describe \"Exception: #{msg}\" do\n      it { should be_nil}\n    end\n  end\nend\n",
          "source_location": {
            "line": 36,
            "ref": "../elasticsearch-inspec/controls/ad+ldap+pki/V-26913.rb"
          },
          "results": [
            {
              "status": "passed",
              "code_desc": "Authentication methods includes AD, LDAP or PKI for Node: package-centos-72 should equal true",
              "run_time": 0.000062,
              "start_time": "2018-02-11 14:26:57 -0500"
            },
            {
              "status": "passed",
              "code_desc": "PKI Settings for Node: package-centos-72 order should not be nil",
              "run_time": 0.000053,
              "start_time": "2018-02-11 14:26:57 -0500"
            },
            {
              "status": "passed",
              "code_desc": "PKI Settings for Node: package-centos-72 username_pattern should not be nil",
              "run_time": 0.000051,
              "start_time": "2018-02-11 14:26:57 -0500"
            }
          ]
        },
        {
          "id": "V-26853",
          "title": "Applications must have the capability to limit the number of failed\nlogin attempts based upon an organizational defined number of consecutive\ninvalid attempts occurring within an organizational defined time period.",
          "desc": "Configure the centralized authentication service to enforce\norganizational policies such as password strength, lockout, expiration,\nnotification, and screen obfuscation.",
          "impact": 0.5,
          "refs": [],
          "tags": {
            "nist": [
              "AC-7 a",
              "Rev_4"
            ],
            "severity": "medium",
            "rid": "SV-34133r1_rule",
            "gtitle": "SRG-APP-000065",
            "cci": "CCI-000044",
            "check": "Guidance in Appendix B - System accounts cannot be disabled and\nelasticsearch does not enforce password complexity rules.\n\nElasticsearch supports LDAP, Active Directory, and PKI.\n\nIf the external authentication is Active Directory; verify the following\nsettings.\n\n$ cat config/elasticsearch.yml | grep -A 6 -B 6 'type: \\?active_directory'\n\n\n xpack:\n  security:\n    authc:\n      realms:\n        active_directory:\n          type: active_directory\n          order: 0\n          domain_name: ad.example.com\n          url: ldaps://ad.example.com:636\n          unmapped_groups_as_roles: true | false\n\nIf these settings are not correct or missing, this is a finding.\n\nIf the external authentication is LDAP; verify the following settings.\n\n$ cat config/elasticsearch.yml | grep -A 16 -B 6 'type: \\?ldap'\n\nxpack:\n  security:\n    authc:\n      realms:\n        ldap1:\n          type: ldap\n          order: 0\n          url: 'ldaps://ldap.example.com:636'\n          bind_dn: 'cn=ldapuser, ou=users, o=services, dc=example, dc=com'\n          bind_password: changeme\n          user_search:\n            base_dn: 'dc=example,dc=com'\n            attribute: cn\n          group_search:\n            base_dn: 'dc=example,dc=com'\n          files:\n            role_mapping: 'CONFIG_DIR/x-pack/role_mapping.yml\n\nIf these settings are not correct or missing, this is a finding.\n\nIf the external authentication is PKI; verify the following settings.\n\n$ cat config/elasticsearch.yml | grep -A 6 -B 6 'type: \\?pki'\n\n xpack:\n  security:\n    authc:\n      realms:\n        pki1:\n          type: pki\n          username_pattern: 'EMAILADDRESS=(.*?)(?:,|$)'\n\nIf these settings are not correct or missing, this is a finding.\n\n",
            "fix": "Configure elasticsearch realms settings to point to\norganizational supported authentication mechanism\n\nSee the official documentation for the instructions on realm configuration:\nhttps://www.elastic.co/guide/en/x-pack/current/_how_authentication_works.html"
          },
          "code": "control \"V-26853\" do\n  title \"Applications must have the capability to limit the number of failed\nlogin attempts based upon an organizational defined number of consecutive\ninvalid attempts occurring within an organizational defined time period.\"\n  desc  \"Configure the centralized authentication service to enforce\norganizational policies such as password strength, lockout, expiration,\nnotification, and screen obfuscation.\"\n  impact 0.5\n  tag \"nist\": [\"AC-7 a\", \"Rev_4\"]\n  tag \"severity\": \"medium\"\n  tag \"rid\": \"SV-34133r1_rule\"\n  tag \"gtitle\": \"SRG-APP-000065\"\n  tag \"cci\": \"CCI-000044\"\n  tag \"check\": \"Guidance in Appendix B - System accounts cannot be disabled and\nelasticsearch does not enforce password complexity rules.\n\nElasticsearch supports LDAP, Active Directory, and PKI.\n\nIf the external authentication is Active Directory; verify the following\nsettings.\n\n$ cat config/elasticsearch.yml | grep -A 6 -B 6 'type: \\\\?active_directory'\n\n\n xpack:\n  security:\n    authc:\n      realms:\n        active_directory:\n          type: active_directory\n          order: 0\n          domain_name: ad.example.com\n          url: ldaps://ad.example.com:636\n          unmapped_groups_as_roles: true | false\n\nIf these settings are not correct or missing, this is a finding.\n\nIf the external authentication is LDAP; verify the following settings.\n\n$ cat config/elasticsearch.yml | grep -A 16 -B 6 'type: \\\\?ldap'\n\nxpack:\n  security:\n    authc:\n      realms:\n        ldap1:\n          type: ldap\n          order: 0\n          url: 'ldaps://ldap.example.com:636'\n          bind_dn: 'cn=ldapuser, ou=users, o=services, dc=example, dc=com'\n          bind_password: changeme\n          user_search:\n            base_dn: 'dc=example,dc=com'\n            attribute: cn\n          group_search:\n            base_dn: 'dc=example,dc=com'\n          files:\n            role_mapping: 'CONFIG_DIR/x-pack/role_mapping.yml\n\nIf these settings are not correct or missing, this is a finding.\n\nIf the external authentication is PKI; verify the following settings.\n\n$ cat config/elasticsearch.yml | grep -A 6 -B 6 'type: \\\\?pki'\n\n xpack:\n  security:\n    authc:\n      realms:\n        pki1:\n          type: pki\n          username_pattern: 'EMAILADDRESS=(.*?)(?:,|$)'\n\nIf these settings are not correct or missing, this is a finding.\n\n\"\n  tag \"fix\": \"Configure elasticsearch realms settings to point to\norganizational supported authentication mechanism\n\nSee the official documentation for the instructions on realm configuration:\nhttps://www.elastic.co/guide/en/x-pack/current/_how_authentication_works.html\"\n\n\n  begin\n\n    es_handle = es_helper(url:\"https://#{ELASTIC_IP}:#{ELASTIC_PORT}\",\n                    username: ES_ADMIN,\n                    password: ES_PASS,\n                    ssl_verify: SSL_VERIFY )\n\n    describe \"No nodes found\" do\n      subject { es_handle.nodes.nil? }\n      it { should_not be_truthy }\n    end if es_handle.nodes.nil?\n\n\n    es_handle.nodes.each do |node|\n      describe \"Authentication methods includes AD, LDAP or PKI for Node: #{node.name}\" do\n        subject { node.authc_method.any? { |x| ['pki','active_directory','ldap'].include?(x) } }\n        it{ should be true }\n      end\n    end unless es_handle.nodes.nil?\n\n    es_handle.nodes.each do |node|\n      describe.one do\n        node.authc_realm.keys.each do |auth_method|\n          describe \"Active Directory Settings for Node: #{node.name}\" do\n            subject { es_handle.settings.first.xpack.security.authc.realms[auth_method] }\n            its ('order') { should_not be_nil }\n            its ('domain_name') { should_not be_nil }\n            its ('url') { should_not be_nil }\n            its ('unmapped_groups_as_roles') { should_not be_nil }\n          end if node.authc_realm[auth_method].type.eql?('active_directory')\n\n          describe \"LDAP Settings for Node: #{node.name}\" do\n            subject { es_handle.settings.first.xpack.security.authc.realms[auth_method] }\n            its ('order') { should_not be_nil }\n            its ('url') { should_not be_nil }\n            its ('bind_dn') { should_not be_nil }\n            its ('bind_password') { should_not be_nil }\n            its ('user_search.base_dn') { should_not be_nil }\n            its ('user_search.attribute') { should_not be_nil }\n            its ('group_search.base_dn') { should_not be_nil }\n            its ('files.role_mapping') { should_not be_nil }\n          end if node.authc_realm[auth_method].type.eql?('ldap')\n\n          describe \"PKI Settings for Node: #{node.name}\" do\n            subject { node.authc_realm[auth_method] }\n            its ('order') { should_not be_nil }\n            its ('username_pattern') { should_not be_nil }\n          end if node.authc_realm[auth_method].type.eql?('pki')\n        end\n      end\n    end unless es_handle.nodes.nil?\n\n  rescue Exception => msg\n    describe \"Exception: #{msg}\" do\n      it { should be_nil}\n    end\n  end\nend\n",
          "source_location": {
            "line": 36,
            "ref": "../elasticsearch-inspec/controls/ad+ldap+pki/V-26853.rb"
          },
          "results": [
            {
              "status": "passed",
              "code_desc": "Authentication methods includes AD, LDAP or PKI for Node: package-centos-72 should equal true",
              "run_time": 0.000059,
              "start_time": "2018-02-11 14:26:57 -0500"
            },
            {
              "status": "passed",
              "code_desc": "PKI Settings for Node: package-centos-72 order should not be nil",
              "run_time": 0.000053,
              "start_time": "2018-02-11 14:26:57 -0500"
            },
            {
              "status": "passed",
              "code_desc": "PKI Settings for Node: package-centos-72 username_pattern should not be nil",
              "run_time": 0.000201,
              "start_time": "2018-02-11 14:26:57 -0500"
            }
          ]
        },
        {
          "id": "V-26937",
          "title": "The application must uniquely identify and authenticate\nnon-organizational users (or processes acting on behalf of non-organizational\nusers).",
          "desc": "As appropriate, grant Role Based Access Control for organizational\nusers, non-organizational users, and anonymous users.",
          "impact": 0.5,
          "refs": [],
          "tags": {
            "nist": [
              "IA-8",
              "Rev_4"
            ],
            "severity": "medium",
            "rid": "SV-34217r1_rule",
            "gtitle": "SRG-APP-000180",
            "cci": "CCI-000804",
            "check": "Guidance in Appendix B - System accounts cannot be disabled and\nelasticsearch does not enforce password complexity rules.\n\nElasticsearch supports LDAP, Active Directory, and PKI.\n\nIf the external authentication is Active Directory; verify the following\nsettings.\n\n$ cat config/elasticsearch.yml | grep -A 6 -B 6 'type: \\?active_directory'\n\n\n xpack:\n  security:\n    authc:\n      realms:\n        active_directory:\n          type: active_directory\n          order: 0\n          domain_name: ad.example.com\n          url: ldaps://ad.example.com:636\n          unmapped_groups_as_roles: true | false\n\nIf these settings are not correct or missing, this is a finding.\n\nIf the external authentication is LDAP; verify the following settings.\n\n$ cat config/elasticsearch.yml | grep -A 16 -B 6 'type: \\?ldap'\n\nxpack:\n  security:\n    authc:\n      realms:\n        ldap1:\n          type: ldap\n          order: 0\n          url: 'ldaps://ldap.example.com:636'\n          bind_dn: 'cn=ldapuser, ou=users, o=services, dc=example, dc=com'\n          bind_password: changeme\n          user_search:\n            base_dn: 'dc=example,dc=com'\n            attribute: cn\n          group_search:\n            base_dn: 'dc=example,dc=com'\n          files:\n            role_mapping: 'CONFIG_DIR/x-pack/role_mapping.yml\n\nIf these settings are not correct or missing, this is a finding.\n\nIf the external authentication is PKI; verify the following settings.\n\n$ cat config/elasticsearch.yml | grep -A 6 -B 6 'type: \\?pki'\n\n xpack:\n  security:\n    authc:\n      realms:\n        pki1:\n          type: pki\n          username_pattern: 'EMAILADDRESS=(.*?)(?:,|$)'\n\nIf these settings are not correct or missing, this is a finding.\n\n",
            "fix": "Configure elasticsearch realms settings to point to\norganizational supported authentication mechanism\n\nSee the official documentation for the instructions on realm configuration:\nhttps://www.elastic.co/guide/en/x-pack/current/_how_authentication_works.html"
          },
          "code": "control \"V-26937\" do\n  title \"The application must uniquely identify and authenticate\nnon-organizational users (or processes acting on behalf of non-organizational\nusers).\"\n  desc  \"As appropriate, grant Role Based Access Control for organizational\nusers, non-organizational users, and anonymous users.\"\n  impact 0.5\n  tag \"nist\": [\"IA-8\", \"Rev_4\"]\n  tag \"severity\": \"medium\"\n  tag \"rid\": \"SV-34217r1_rule\"\n  tag \"gtitle\": \"SRG-APP-000180\"\n  tag \"cci\": \"CCI-000804\"\n  tag \"check\": \"Guidance in Appendix B - System accounts cannot be disabled and\nelasticsearch does not enforce password complexity rules.\n\nElasticsearch supports LDAP, Active Directory, and PKI.\n\nIf the external authentication is Active Directory; verify the following\nsettings.\n\n$ cat config/elasticsearch.yml | grep -A 6 -B 6 'type: \\\\?active_directory'\n\n\n xpack:\n  security:\n    authc:\n      realms:\n        active_directory:\n          type: active_directory\n          order: 0\n          domain_name: ad.example.com\n          url: ldaps://ad.example.com:636\n          unmapped_groups_as_roles: true | false\n\nIf these settings are not correct or missing, this is a finding.\n\nIf the external authentication is LDAP; verify the following settings.\n\n$ cat config/elasticsearch.yml | grep -A 16 -B 6 'type: \\\\?ldap'\n\nxpack:\n  security:\n    authc:\n      realms:\n        ldap1:\n          type: ldap\n          order: 0\n          url: 'ldaps://ldap.example.com:636'\n          bind_dn: 'cn=ldapuser, ou=users, o=services, dc=example, dc=com'\n          bind_password: changeme\n          user_search:\n            base_dn: 'dc=example,dc=com'\n            attribute: cn\n          group_search:\n            base_dn: 'dc=example,dc=com'\n          files:\n            role_mapping: 'CONFIG_DIR/x-pack/role_mapping.yml\n\nIf these settings are not correct or missing, this is a finding.\n\nIf the external authentication is PKI; verify the following settings.\n\n$ cat config/elasticsearch.yml | grep -A 6 -B 6 'type: \\\\?pki'\n\n xpack:\n  security:\n    authc:\n      realms:\n        pki1:\n          type: pki\n          username_pattern: 'EMAILADDRESS=(.*?)(?:,|$)'\n\nIf these settings are not correct or missing, this is a finding.\n\n\"\n  tag \"fix\": \"Configure elasticsearch realms settings to point to\norganizational supported authentication mechanism\n\nSee the official documentation for the instructions on realm configuration:\nhttps://www.elastic.co/guide/en/x-pack/current/_how_authentication_works.html\"\n\n  begin\n\n    es_handle = es_helper(url:\"https://#{ELASTIC_IP}:#{ELASTIC_PORT}\",\n                    username: ES_ADMIN,\n                    password: ES_PASS,\n                    ssl_verify: SSL_VERIFY )\n\n    describe \"No nodes found\" do\n      subject { es_handle.nodes.nil? }\n      it { should_not be_truthy }\n    end if es_handle.nodes.nil?\n\n\n    es_handle.nodes.each do |node|\n      describe \"Authentication methods includes AD, LDAP or PKI for Node: #{node.name}\" do\n        subject { node.authc_method.any? { |x| ['pki','active_directory','ldap'].include?(x) } }\n        it{ should be true }\n      end\n    end unless es_handle.nodes.nil?\n\n    es_handle.nodes.each do |node|\n      describe.one do\n        node.authc_realm.keys.each do |auth_method|\n          describe \"Active Directory Settings for Node: #{node.name}\" do\n            subject { es_handle.settings.first.xpack.security.authc.realms[auth_method] }\n            its ('order') { should_not be_nil }\n            its ('domain_name') { should_not be_nil }\n            its ('url') { should_not be_nil }\n            its ('unmapped_groups_as_roles') { should_not be_nil }\n          end if node.authc_realm[auth_method].type.eql?('active_directory')\n\n          describe \"LDAP Settings for Node: #{node.name}\" do\n            subject { es_handle.settings.first.xpack.security.authc.realms[auth_method] }\n            its ('order') { should_not be_nil }\n            its ('url') { should_not be_nil }\n            its ('bind_dn') { should_not be_nil }\n            its ('bind_password') { should_not be_nil }\n            its ('user_search.base_dn') { should_not be_nil }\n            its ('user_search.attribute') { should_not be_nil }\n            its ('group_search.base_dn') { should_not be_nil }\n            its ('files.role_mapping') { should_not be_nil }\n          end if node.authc_realm[auth_method].type.eql?('ldap')\n\n          describe \"PKI Settings for Node: #{node.name}\" do\n            subject { node.authc_realm[auth_method] }\n            its ('order') { should_not be_nil }\n            its ('username_pattern') { should_not be_nil }\n          end if node.authc_realm[auth_method].type.eql?('pki')\n        end\n      end\n    end unless es_handle.nodes.nil?\n\n  rescue Exception => msg\n    describe \"Exception: #{msg}\" do\n      it { should be_nil}\n    end\n  end\nend\n",
          "source_location": {
            "line": 36,
            "ref": "../elasticsearch-inspec/controls/ad+ldap+pki/V-26937.rb"
          },
          "results": [
            {
              "status": "passed",
              "code_desc": "Authentication methods includes AD, LDAP or PKI for Node: package-centos-72 should equal true",
              "run_time": 0.000124,
              "start_time": "2018-02-11 14:26:57 -0500"
            },
            {
              "status": "passed",
              "code_desc": "PKI Settings for Node: package-centos-72 order should not be nil",
              "run_time": 0.000058,
              "start_time": "2018-02-11 14:26:57 -0500"
            },
            {
              "status": "passed",
              "code_desc": "PKI Settings for Node: package-centos-72 username_pattern should not be nil",
              "run_time": 0.000088,
              "start_time": "2018-02-11 14:26:57 -0500"
            }
          ]
        },
        {
          "id": "V-26884",
          "title": "The application must notify the user of the number of unsuccessful\nlogin/access attempts occurring during an organizational-defined time period.",
          "desc": "Configure the centralized authentication service to enforce\norganizational policies such as password strength, lockout, expiration,\nnotification, and screen obfuscation.",
          "impact": 0.5,
          "refs": [],
          "tags": {
            "nist": [
              "AC-9 (2)",
              "Rev_4"
            ],
            "severity": "medium",
            "rid": "SV-34164r1_rule",
            "gtitle": "SRG-APP-000078",
            "cci": "CCI-001392",
            "check": "Guidance in Appendix B - System accounts cannot be disabled and\nelasticsearch does not enforce password complexity rules.\n\nElasticsearch supports LDAP, Active Directory, and PKI.\n\nIf the external authentication is Active Directory; verify the following\nsettings.\n\n$ cat config/elasticsearch.yml | grep -A 6 -B 6 'type: \\?active_directory'\n\n\n xpack:\n  security:\n    authc:\n      realms:\n        active_directory:\n          type: active_directory\n          order: 0\n          domain_name: ad.example.com\n          url: ldaps://ad.example.com:636\n          unmapped_groups_as_roles: true | false\n\nIf these settings are not correct or missing, this is a finding.\n\nIf the external authentication is LDAP; verify the following settings.\n\n$ cat config/elasticsearch.yml | grep -A 16 -B 6 'type: \\?ldap'\n\nxpack:\n  security:\n    authc:\n      realms:\n        ldap1:\n          type: ldap\n          order: 0\n          url: 'ldaps://ldap.example.com:636'\n          bind_dn: 'cn=ldapuser, ou=users, o=services, dc=example, dc=com'\n          bind_password: changeme\n          user_search:\n            base_dn: 'dc=example,dc=com'\n            attribute: cn\n          group_search:\n            base_dn: 'dc=example,dc=com'\n          files:\n            role_mapping: 'CONFIG_DIR/x-pack/role_mapping.yml\n\nIf these settings are not correct or missing, this is a finding.\n\nIf the external authentication is PKI; verify the following settings.\n\n$ cat config/elasticsearch.yml | grep -A 6 -B 6 'type: \\?pki'\n\n xpack:\n  security:\n    authc:\n      realms:\n        pki1:\n          type: pki\n          username_pattern: 'EMAILADDRESS=(.*?)(?:,|$)'\n\nIf these settings are not correct or missing, this is a finding.\n\n",
            "fix": "Configure elasticsearch realms settings to point to\norganizational supported authentication mechanism\n\nSee the official documentation for the instructions on realm configuration:\nhttps://www.elastic.co/guide/en/x-pack/current/_how_authentication_works.html"
          },
          "code": "control \"V-26884\" do\n  title \"The application must notify the user of the number of unsuccessful\nlogin/access attempts occurring during an organizational-defined time period.\"\n  desc  \"Configure the centralized authentication service to enforce\norganizational policies such as password strength, lockout, expiration,\nnotification, and screen obfuscation.\"\n  impact 0.5\n  tag \"nist\": [\"AC-9 (2)\", \"Rev_4\"]\n  tag \"severity\": \"medium\"\n  tag \"rid\": \"SV-34164r1_rule\"\n  tag \"gtitle\": \"SRG-APP-000078\"\n  tag \"cci\": \"CCI-001392\"\n  tag \"check\": \"Guidance in Appendix B - System accounts cannot be disabled and\nelasticsearch does not enforce password complexity rules.\n\nElasticsearch supports LDAP, Active Directory, and PKI.\n\nIf the external authentication is Active Directory; verify the following\nsettings.\n\n$ cat config/elasticsearch.yml | grep -A 6 -B 6 'type: \\\\?active_directory'\n\n\n xpack:\n  security:\n    authc:\n      realms:\n        active_directory:\n          type: active_directory\n          order: 0\n          domain_name: ad.example.com\n          url: ldaps://ad.example.com:636\n          unmapped_groups_as_roles: true | false\n\nIf these settings are not correct or missing, this is a finding.\n\nIf the external authentication is LDAP; verify the following settings.\n\n$ cat config/elasticsearch.yml | grep -A 16 -B 6 'type: \\\\?ldap'\n\nxpack:\n  security:\n    authc:\n      realms:\n        ldap1:\n          type: ldap\n          order: 0\n          url: 'ldaps://ldap.example.com:636'\n          bind_dn: 'cn=ldapuser, ou=users, o=services, dc=example, dc=com'\n          bind_password: changeme\n          user_search:\n            base_dn: 'dc=example,dc=com'\n            attribute: cn\n          group_search:\n            base_dn: 'dc=example,dc=com'\n          files:\n            role_mapping: 'CONFIG_DIR/x-pack/role_mapping.yml\n\nIf these settings are not correct or missing, this is a finding.\n\nIf the external authentication is PKI; verify the following settings.\n\n$ cat config/elasticsearch.yml | grep -A 6 -B 6 'type: \\\\?pki'\n\n xpack:\n  security:\n    authc:\n      realms:\n        pki1:\n          type: pki\n          username_pattern: 'EMAILADDRESS=(.*?)(?:,|$)'\n\nIf these settings are not correct or missing, this is a finding.\n\n\"\n  tag \"fix\": \"Configure elasticsearch realms settings to point to\norganizational supported authentication mechanism\n\nSee the official documentation for the instructions on realm configuration:\nhttps://www.elastic.co/guide/en/x-pack/current/_how_authentication_works.html\"\n\n\n  begin\n\n    es_handle = es_helper(url:\"https://#{ELASTIC_IP}:#{ELASTIC_PORT}\",\n                    username: ES_ADMIN,\n                    password: ES_PASS,\n                    ssl_verify: SSL_VERIFY )\n\n    describe \"No nodes found\" do\n      subject { es_handle.nodes.nil? }\n      it { should_not be_truthy }\n    end if es_handle.nodes.nil?\n\n\n    es_handle.nodes.each do |node|\n      describe \"Authentication methods includes AD, LDAP or PKI for Node: #{node.name}\" do\n        subject { node.authc_method.any? { |x| ['pki','active_directory','ldap'].include?(x) } }\n        it{ should be true }\n      end\n    end unless es_handle.nodes.nil?\n\n    es_handle.nodes.each do |node|\n      describe.one do\n        node.authc_realm.keys.each do |auth_method|\n          describe \"Active Directory Settings for Node: #{node.name}\" do\n            subject { es_handle.settings.first.xpack.security.authc.realms[auth_method] }\n            its ('order') { should_not be_nil }\n            its ('domain_name') { should_not be_nil }\n            its ('url') { should_not be_nil }\n            its ('unmapped_groups_as_roles') { should_not be_nil }\n          end if node.authc_realm[auth_method].type.eql?('active_directory')\n\n          describe \"LDAP Settings for Node: #{node.name}\" do\n            subject { es_handle.settings.first.xpack.security.authc.realms[auth_method] }\n            its ('order') { should_not be_nil }\n            its ('url') { should_not be_nil }\n            its ('bind_dn') { should_not be_nil }\n            its ('bind_password') { should_not be_nil }\n            its ('user_search.base_dn') { should_not be_nil }\n            its ('user_search.attribute') { should_not be_nil }\n            its ('group_search.base_dn') { should_not be_nil }\n            its ('files.role_mapping') { should_not be_nil }\n          end if node.authc_realm[auth_method].type.eql?('ldap')\n\n          describe \"PKI Settings for Node: #{node.name}\" do\n            subject { node.authc_realm[auth_method] }\n            its ('order') { should_not be_nil }\n            its ('username_pattern') { should_not be_nil }\n          end if node.authc_realm[auth_method].type.eql?('pki')\n        end\n      end\n    end unless es_handle.nodes.nil?\n\n  rescue Exception => msg\n    describe \"Exception: #{msg}\" do\n      it { should be_nil}\n    end\n  end\nend\n",
          "source_location": {
            "line": 36,
            "ref": "../elasticsearch-inspec/controls/ad+ldap+pki/V-26884.rb"
          },
          "results": [
            {
              "status": "passed",
              "code_desc": "Authentication methods includes AD, LDAP or PKI for Node: package-centos-72 should equal true",
              "run_time": 0.000062,
              "start_time": "2018-02-11 14:26:57 -0500"
            },
            {
              "status": "passed",
              "code_desc": "PKI Settings for Node: package-centos-72 order should not be nil",
              "run_time": 0.000055,
              "start_time": "2018-02-11 14:26:57 -0500"
            },
            {
              "status": "passed",
              "code_desc": "PKI Settings for Node: package-centos-72 username_pattern should not be nil",
              "run_time": 0.00005,
              "start_time": "2018-02-11 14:26:57 -0500"
            }
          ]
        },
        {
          "id": "V-26735",
          "title": "The application must enforce approved authorizations for logical\naccess to the system in accordance with applicable policy.",
          "desc": "Plan for granting temporary authorizations, with known automated\nexpiration times, to enable users to implement out of the ordinary processes.",
          "impact": 0.5,
          "refs": [],
          "tags": {
            "nist": [
              "AC-3",
              "Rev_4"
            ],
            "severity": "medium",
            "rid": "SV-33983r1_rule",
            "gtitle": "SRG-APP-000033",
            "cci": "CCI-000213",
            "check": "Verify that role-based policies are in place and access\nenforcement mechanisms are in place.\n\nAs the elasticsearch administrator, run the following CURL command:\n\n$ curl -XGET  -H 'Content-Type: application/json' -u <TEST_USER> -p\n<TEST_CREDENTIALS> https://<elasticsearch>:9200/_xpack/security/role\n\nReview the role permissions, if any role is incorrect or provides access to\ncluster configuration outside of administrative roles, this is a finding.\n\nCheck Elasticsearch.yml settings and existing IP filtering rules to verify that\nonly specific IP behind hardware/software 'Managed access control points'\nare listed.\n\nAs the application administrator (usually elasticsearch, check the\nxpack.security.http.filter setting contains IP address(es) of the  'Managed\naccess control points':\n\n$cat elasticsearch.yml | grep 'xpack.security.http.filter', Verify all three\nsettings; xpack.security.http.filter.enabled: true;\nxpack.security.http.filter.allow: 'Managed access control points';\nxpack.security.http.filter.deny: _all\n\nAs an elasticsearch administrator test; verify runtime environment within\n_culster settings are set to '{}' OR Verify all three settings are\nxpack.security.http.filter.enabled: true; xpack.security.http.filter.allow:\n'Managed access control points'; xpack.security.http.filter.deny: _all\n\n$curl -H 'Content-Type: application/json' -u <TEST_USER> -p <TEST_CREDENTIALS>\n -XGET 'http://<elasticsearch>:9200/_cluster/settings'\n\nIf these configuration setting are disabled, or not pointing to the 'Managed\naccess control points', this is a finding. ",
            "fix": "Implement strong access controls to secure application data by\nestablishing role-based policies and access control mechanisms.\n\nTo establish role-based policies; see the official documentation on\nauthorization;\nhttps://www.elastic.co/guide/en/x-pack/current/authorization.html.\n\nNote: The following instructions use the ES_HOME environment variable. See\nsupplementary content APPENDIX-XXX for instructions on configuring ES_HOME.\n\nTo establish an access control mechanism; as the application administrator,\nchange the following setting in elasticsearch.yml:\n\n$ sudo su - elasticsearch\n$ vi $ES_HOME/config/elasticsearch.yml\n\nChange the Managed access control points parameter to the desired addresses,\ni.e.:\n     xpack.security.http.filter.enabled: true\n     xpack.security.http.filter.allow: 'Managed access control points'\n     xpack.security.http.filter.deny: _all\n\nNext, restart the application:\n$ sudo su - elasticsearch\n\n# SYSTEMD SERVER ONLY\n$ systemctl restart elasticsearch"
          },
          "code": "control \"V-26735\" do\n  title \"The application must enforce approved authorizations for logical\naccess to the system in accordance with applicable policy.\"\n  desc  \"Plan for granting temporary authorizations, with known automated\nexpiration times, to enable users to implement out of the ordinary processes.\"\n  impact 0.5\n  tag \"nist\": [\"AC-3\", \"Rev_4\"]\n  tag \"severity\": \"medium\"\n  tag \"rid\": \"SV-33983r1_rule\"\n  tag \"gtitle\": \"SRG-APP-000033\"\n  tag \"cci\": \"CCI-000213\"\n  tag \"check\": \"Verify that role-based policies are in place and access\nenforcement mechanisms are in place.\n\nAs the elasticsearch administrator, run the following CURL command:\n\n$ curl -XGET  -H 'Content-Type: application/json' -u <TEST_USER> -p\n<TEST_CREDENTIALS> https://<elasticsearch>:9200/_xpack/security/role\n\nReview the role permissions, if any role is incorrect or provides access to\ncluster configuration outside of administrative roles, this is a finding.\n\nCheck Elasticsearch.yml settings and existing IP filtering rules to verify that\nonly specific IP behind hardware/software 'Managed access control points'\nare listed.\n\nAs the application administrator (usually elasticsearch, check the\nxpack.security.http.filter setting contains IP address(es) of the  'Managed\naccess control points':\n\n$cat elasticsearch.yml | grep 'xpack.security.http.filter', Verify all three\nsettings; xpack.security.http.filter.enabled: true;\nxpack.security.http.filter.allow: 'Managed access control points';\nxpack.security.http.filter.deny: _all\n\nAs an elasticsearch administrator test; verify runtime environment within\n_culster settings are set to '{}' OR Verify all three settings are\nxpack.security.http.filter.enabled: true; xpack.security.http.filter.allow:\n'Managed access control points'; xpack.security.http.filter.deny: _all\n\n$curl -H 'Content-Type: application/json' -u <TEST_USER> -p <TEST_CREDENTIALS>\n -XGET 'http://<elasticsearch>:9200/_cluster/settings'\n\nIf these configuration setting are disabled, or not pointing to the 'Managed\naccess control points', this is a finding. \"\n  tag \"fix\": \"Implement strong access controls to secure application data by\nestablishing role-based policies and access control mechanisms.\n\nTo establish role-based policies; see the official documentation on\nauthorization;\nhttps://www.elastic.co/guide/en/x-pack/current/authorization.html.\n\nNote: The following instructions use the ES_HOME environment variable. See\nsupplementary content APPENDIX-XXX for instructions on configuring ES_HOME.\n\nTo establish an access control mechanism; as the application administrator,\nchange the following setting in elasticsearch.yml:\n\n$ sudo su - elasticsearch\n$ vi $ES_HOME/config/elasticsearch.yml\n\nChange the Managed access control points parameter to the desired addresses,\ni.e.:\n     xpack.security.http.filter.enabled: true\n     xpack.security.http.filter.allow: 'Managed access control points'\n     xpack.security.http.filter.deny: _all\n\nNext, restart the application:\n$ sudo su - elasticsearch\n\n# SYSTEMD SERVER ONLY\n$ systemctl restart elasticsearch\"\n\n  begin\n\n    es_handle = es_helper(url:\"https://#{ELASTIC_IP}:#{ELASTIC_PORT}\",\n                    username: ES_ADMIN,\n                    password: ES_PASS,\n                    ssl_verify: SSL_VERIFY )\n\n    describe \"No nodes found\" do\n      subject { es_handle.nodes.nil? }\n      it { should_not be_truthy }\n    end if es_handle.nodes.nil?\n\n    describe es_handle do\n      its('superusers') { should be_in DOCUMENTED_SUPER_ROLES}\n    end\n\n    es_handle.nodes.each do |node|\n      describe \"IP filtering rules for Node: #{node.name}\" do\n        subject { node.ip_filter }\n        its('enabled') { should eq 'true' }\n        its('allow')  { should be_in MANAGED_ACCESS_POINTS }\n        its('deny') { should eq '_all' }\n      end\n    end unless es_handle.nodes.nil?\n\n    describe \"IP filtering rules\" do\n      subject { yaml(ELASTICSEARCH_CONF) }\n      its(['xpack.security.http.filter.enabled']) { should eq true }\n      its(['xpack.security.http.filter.allow']) { should be_in MANAGED_ACCESS_POINTS }\n      its(['xpack.security.http.filter.deny']) { should eq '_all' }\n    end\n\n    describe \"Cluster Setting:\" do\n      subject{ es_handle.cluster_settings }\n      its(['persistent']) { should be_empty }\n      its(['transient']) { should be_empty }\n    end\n\n  rescue Exception => msg\n    describe \"Exception: #{msg}\" do\n      it { should be_nil}\n    end\n  end\nend\n",
          "source_location": {
            "line": 71,
            "ref": "../elasticsearch-inspec/controls/role+ip_fil/V-26735.rb"
          },
          "results": [
            {
              "status": "passed",
              "code_desc": "Elasticsearch Cluster https://0.0.0.0:9200 superusers should be in \"superuser\"",
              "run_time": 1.370014,
              "start_time": "2018-02-11 14:26:57 -0500"
            },
            {
              "status": "passed",
              "code_desc": "IP filtering rules for Node: package-centos-72 enabled should eq \"true\"",
              "run_time": 0.000144,
              "start_time": "2018-02-11 14:26:58 -0500"
            },
            {
              "status": "passed",
              "code_desc": "IP filtering rules for Node: package-centos-72 allow should be in \"10.0.2.15\"",
              "run_time": 0.000137,
              "start_time": "2018-02-11 14:26:58 -0500"
            },
            {
              "status": "passed",
              "code_desc": "IP filtering rules for Node: package-centos-72 deny should eq \"_all\"",
              "run_time": 0.000152,
              "start_time": "2018-02-11 14:26:58 -0500"
            },
            {
              "status": "passed",
              "code_desc": "IP filtering rules [\"xpack.security.http.filter.enabled\"] should eq true",
              "run_time": 0.00075,
              "start_time": "2018-02-11 14:26:58 -0500"
            },
            {
              "status": "passed",
              "code_desc": "IP filtering rules [\"xpack.security.http.filter.allow\"] should be in \"10.0.2.15\"",
              "run_time": 0.00079,
              "start_time": "2018-02-11 14:26:58 -0500"
            },
            {
              "status": "passed",
              "code_desc": "IP filtering rules [\"xpack.security.http.filter.deny\"] should eq \"_all\"",
              "run_time": 0.000572,
              "start_time": "2018-02-11 14:26:58 -0500"
            },
            {
              "status": "passed",
              "code_desc": "Cluster Setting: [\"persistent\"] should be empty",
              "run_time": 0.082188,
              "start_time": "2018-02-11 14:26:58 -0500"
            },
            {
              "status": "passed",
              "code_desc": "Cluster Setting: [\"transient\"] should be empty",
              "run_time": 0.086447,
              "start_time": "2018-02-11 14:26:59 -0500"
            }
          ]
        },
        {
          "id": "V-26684",
          "title": "The application must employ automated mechanisms to facilitate the\nmonitoring and control of remote access methods.",
          "desc": "Collect Elasticsearch X-Pack Security audit records from all\nElasticsearch nodes in near-real time to enable audit monitoring.",
          "impact": 0.5,
          "refs": [],
          "tags": {
            "nist": [
              "AC-17 (1)",
              "Rev_4"
            ],
            "severity": "medium",
            "rid": "SV-33904r1_rule",
            "gtitle": "SRG-APP-000016",
            "cci": "CCI-000067",
            "check": "Note: The following instructions use the ES_HOME environment\nvariable. See supplementary content APPENDIX-F for instructions on configuring\nES_HOME.\n\n$ cat config/elasticsearch.yml | grep xpack.security.audit\n\nCheck elasticsearch settings and documentation to determine whether designated\npersonnel are able to select which auditable events are being audited.\n\n\nAs the application administrator (shown here as 'elasticsearch'), verify the\npermissions for ES_HOME:\n\n$ ls -la ${ES_HOME?}\n\nIf anything in ES_HOME is not owned by the application administrator, this is a\nfinding.\n\nNext, as the elasticsearch administrator, run the following CURL command:\n\n\n$ curl -XGET  -H 'Content-Type: application/json' -u <TEST_USER> -p\n<TEST_CREDENTIALS> https://<elasticsearch>:9200/_xpack/security/role\n\nReview the role permissions, if any role is listed as superuser but should not\nhave that access, this is a finding.",
            "fix": "Configure elasticsearch audit settings to audit access methods.\n\nSee the official documentation for the instructions on audit configuration:\nhttps://www.elastic.co/guide/en/x-pack/current/auditing.html"
          },
          "code": "control \"V-26684\" do\n  title \"The application must employ automated mechanisms to facilitate the\nmonitoring and control of remote access methods.\"\n  desc  \"Collect Elasticsearch X-Pack Security audit records from all\nElasticsearch nodes in near-real time to enable audit monitoring.\"\n  impact 0.5\n  tag \"nist\": [\"AC-17 (1)\", \"Rev_4\"]\n  tag \"severity\": \"medium\"\n  tag \"rid\": \"SV-33904r1_rule\"\n  tag \"gtitle\": \"SRG-APP-000016\"\n  tag \"cci\": \"CCI-000067\"\n  tag \"check\": \"Note: The following instructions use the ES_HOME environment\nvariable. See supplementary content APPENDIX-F for instructions on configuring\nES_HOME.\n\n$ cat config/elasticsearch.yml | grep xpack.security.audit\n\nCheck elasticsearch settings and documentation to determine whether designated\npersonnel are able to select which auditable events are being audited.\n\n\nAs the application administrator (shown here as 'elasticsearch'), verify the\npermissions for ES_HOME:\n\n$ ls -la ${ES_HOME?}\n\nIf anything in ES_HOME is not owned by the application administrator, this is a\nfinding.\n\nNext, as the elasticsearch administrator, run the following CURL command:\n\n\n$ curl -XGET  -H 'Content-Type: application/json' -u <TEST_USER> -p\n<TEST_CREDENTIALS> https://<elasticsearch>:9200/_xpack/security/role\n\nReview the role permissions, if any role is listed as superuser but should not\nhave that access, this is a finding.\"\n  tag \"fix\": \"Configure elasticsearch audit settings to audit access methods.\n\nSee the official documentation for the instructions on audit configuration:\nhttps://www.elastic.co/guide/en/x-pack/current/auditing.html\"\n\n  begin\n\n    es_handle = es_helper(url:\"https://#{ELASTIC_IP}:#{ELASTIC_PORT}\",\n                    username: ES_ADMIN,\n                    password: ES_PASS,\n                    ssl_verify: SSL_VERIFY )\n\n    describe \"No nodes found\" do\n      subject { es_handle.nodes.nil? }\n      it { should_not be_truthy }\n    end if es_handle.nodes.nil?\n\n    es_handle.nodes.each do |node|\n      describe \"Audit Settings for Node: #{node.name}\" do\n        subject { node.audit }\n        its('enabled') { should eq 'true' }\n        its('outputs') { should include 'logfile' }\n        its('logfile.events.include') { should match_array ES_INCLUDED_LOGEVENTS }\n        its('logfile.events.exclude') { should match_array ES_EXCLUDED_LOGEVENTS }\n      end\n    end unless es_handle.nodes.nil?\n\n    describe \"Audit Settings from ES_CONF_YML\" do\n      subject { yaml(ELASTICSEARCH_CONF) }\n      its(['xpack.security.audit.enabled']) { should eq true }\n      its(['xpack.security.audit.outputs']) { should include 'logfile' }\n      its(['xpack.security.audit.logfile.events.include']) { should match_array ES_INCLUDED_LOGEVENTS }\n      its(['xpack.security.audit.logfile.events.exclude']) { should match_array ES_EXCLUDED_LOGEVENTS }\n    end\n\n    describe \"ES HOME directory\" do\n      subject { file(ES_HOME) }\n      its('owner') { should eq ES_OWNER }\n      its('group') { should eq ES_GROUP }\n    end\n\n    describe \"ES CONF\" do\n      subject { file(ELASTICSEARCH_CONF) }\n      its('owner') { should eq ES_OWNER }\n      its('group') { should eq ES_GROUP }\n    end\n\n    describe es_handle do\n      its('superusers') { should be_in DOCUMENTED_SUPER_ROLES}\n    end\n    \n  rescue Exception => msg\n    describe \"Exception: #{msg}\" do\n      it { should be_nil}\n    end\n  end\nend\n",
          "source_location": {
            "line": 77,
            "ref": "../elasticsearch-inspec/controls/audit+home+role/V-26684.rb"
          },
          "results": [
            {
              "status": "passed",
              "code_desc": "Audit Settings for Node: package-centos-72 enabled should eq \"true\"",
              "run_time": 0.00012,
              "start_time": "2018-02-11 14:26:59 -0500"
            },
            {
              "status": "passed",
              "code_desc": "Audit Settings for Node: package-centos-72 outputs should include \"logfile\"",
              "run_time": 0.000134,
              "start_time": "2018-02-11 14:26:59 -0500"
            },
            {
              "status": "passed",
              "code_desc": "Audit Settings for Node: package-centos-72 logfile.events.include should contain exactly \"access_denied\", \"anonymous_access_denied\", \"authentication_failed\", \"connection_denied\", \"tampered_request\", \"run_as_denied\", and \"run_as_granted\"",
              "run_time": 0.00014,
              "start_time": "2018-02-11 14:26:59 -0500"
            },
            {
              "status": "passed",
              "code_desc": "Audit Settings for Node: package-centos-72 logfile.events.exclude should contain exactly \"access_granted\"",
              "run_time": 0.000126,
              "start_time": "2018-02-11 14:26:59 -0500"
            },
            {
              "status": "passed",
              "code_desc": "Audit Settings from ES_CONF_YML [\"xpack.security.audit.enabled\"] should eq true",
              "run_time": 0.000633,
              "start_time": "2018-02-11 14:26:59 -0500"
            },
            {
              "status": "passed",
              "code_desc": "Audit Settings from ES_CONF_YML [\"xpack.security.audit.outputs\"] should include \"logfile\"",
              "run_time": 0.000543,
              "start_time": "2018-02-11 14:26:59 -0500"
            },
            {
              "status": "passed",
              "code_desc": "Audit Settings from ES_CONF_YML [\"xpack.security.audit.logfile.events.include\"] should contain exactly \"access_denied\", \"anonymous_access_denied\", \"authentication_failed\", \"connection_denied\", \"tampered_request\", \"run_as_denied\", and \"run_as_granted\"",
              "run_time": 0.000644,
              "start_time": "2018-02-11 14:26:59 -0500"
            },
            {
              "status": "passed",
              "code_desc": "Audit Settings from ES_CONF_YML [\"xpack.security.audit.logfile.events.exclude\"] should contain exactly \"access_granted\"",
              "run_time": 0.000529,
              "start_time": "2018-02-11 14:26:59 -0500"
            },
            {
              "status": "passed",
              "code_desc": "ES HOME directory owner should eq \"elasticsearch\"",
              "run_time": 0.000093,
              "start_time": "2018-02-11 14:26:59 -0500"
            },
            {
              "status": "passed",
              "code_desc": "ES HOME directory group should eq \"elasticsearch\"",
              "run_time": 0.000075,
              "start_time": "2018-02-11 14:26:59 -0500"
            },
            {
              "status": "passed",
              "code_desc": "ES CONF owner should eq \"elasticsearch\"",
              "run_time": 0.000106,
              "start_time": "2018-02-11 14:26:59 -0500"
            },
            {
              "status": "passed",
              "code_desc": "ES CONF group should eq \"elasticsearch\"",
              "run_time": 0.000071,
              "start_time": "2018-02-11 14:26:59 -0500"
            },
            {
              "status": "passed",
              "code_desc": "Elasticsearch Cluster https://0.0.0.0:9200 superusers should be in \"superuser\"",
              "run_time": 1.408194,
              "start_time": "2018-02-11 14:26:59 -0500"
            }
          ]
        },
        {
          "id": "V-26940",
          "title": "The application must support the employment of automated mechanisms\nsupporting the auditing of enforcement actions.",
          "desc": "Utilize perimeter, application, centralized authentication, and\nrepository audit controls to audit the use of systems in real time with\nsufficient context.  X-Pack Security audit controls should be enabled to audit\nthe defaults of all HTTP/S based access to Elasticsearch.  All applications\nshould use HTTP/S  rather than Elasticsearch transport protocol.",
          "impact": 0.5,
          "refs": [],
          "tags": {
            "nist": [
              "CM-5 (1)",
              "Rev_3"
            ],
            "severity": "medium",
            "rid": "SV-34220r1_rule",
            "gtitle": "SRG-APP-000130",
            "cci": "CCI-000347",
            "check": "Note: The following instructions use the ES_HOME environment\nvariable. See supplementary content APPENDIX-F for instructions on configuring\nES_HOME.\n\n$ cat config/elasticsearch.yml | grep xpack.security.audit.outputs\n\n\nCheck elasticsearch settings and documentation to determine whether designated\npersonnel are able to select which auditable events are being audited.\n\n\nAs the application administrator (shown here as 'elasticsearch'), verify the\npermissions for ES_HOME:\n\n$ ls -la ${ES_HOME?}\n\nIf anything in ES_HOME is not owned by the application administrator, this is a\nfinding.\n\nNext, as the elasticsearch administrator, run the following CURL command:\n\n\n$ curl -XGET  -H 'Content-Type: application/json' -u <TEST_USER> -p\n<TEST_CREDENTIALS> https://<elasticsearch>:9200/_xpack/security/role\n\nReview the role permissions, if any role is listed as superuser but should not\nhave that access, this is a finding.",
            "fix": "Configure elasticsearch audit settings to support the auditing of\nenforcement actions.\n\nSee the official documentation for the instructions on audit configuration:\nhttps://www.elastic.co/guide/en/x-pack/current/auditing.html"
          },
          "code": "control \"V-26940\" do\n  title \"The application must support the employment of automated mechanisms\nsupporting the auditing of enforcement actions.\"\n  desc  \"Utilize perimeter, application, centralized authentication, and\nrepository audit controls to audit the use of systems in real time with\nsufficient context.  X-Pack Security audit controls should be enabled to audit\nthe defaults of all HTTP/S based access to Elasticsearch.  All applications\nshould use HTTP/S  rather than Elasticsearch transport protocol.\"\n  impact 0.5\n  tag \"nist\": [\"CM-5 (1)\", \"Rev_3\"]\n  tag \"severity\": \"medium\"\n  tag \"rid\": \"SV-34220r1_rule\"\n  tag \"gtitle\": \"SRG-APP-000130\"\n  tag \"cci\": \"CCI-000347\"\n  tag \"check\": \"Note: The following instructions use the ES_HOME environment\nvariable. See supplementary content APPENDIX-F for instructions on configuring\nES_HOME.\n\n$ cat config/elasticsearch.yml | grep xpack.security.audit.outputs\n\n\nCheck elasticsearch settings and documentation to determine whether designated\npersonnel are able to select which auditable events are being audited.\n\n\nAs the application administrator (shown here as 'elasticsearch'), verify the\npermissions for ES_HOME:\n\n$ ls -la ${ES_HOME?}\n\nIf anything in ES_HOME is not owned by the application administrator, this is a\nfinding.\n\nNext, as the elasticsearch administrator, run the following CURL command:\n\n\n$ curl -XGET  -H 'Content-Type: application/json' -u <TEST_USER> -p\n<TEST_CREDENTIALS> https://<elasticsearch>:9200/_xpack/security/role\n\nReview the role permissions, if any role is listed as superuser but should not\nhave that access, this is a finding.\"\n  tag \"fix\": \"Configure elasticsearch audit settings to support the auditing of\nenforcement actions.\n\nSee the official documentation for the instructions on audit configuration:\nhttps://www.elastic.co/guide/en/x-pack/current/auditing.html\"\n\n  begin\n\n    es_handle = es_helper(url:\"https://#{ELASTIC_IP}:#{ELASTIC_PORT}\",\n                    username: ES_ADMIN,\n                    password: ES_PASS,\n                    ssl_verify: SSL_VERIFY )\n\n    describe \"No nodes found\" do\n      subject { es_handle.nodes.nil? }\n      it { should_not be_truthy }\n    end if es_handle.nodes.nil?\n\n    es_handle.nodes.each do |node|\n      describe \"Audit Settings for Node: #{node.name}\" do\n        subject { node.audit }\n        its('enabled') { should eq 'true' }\n        its('outputs') { should include 'logfile' }\n        its('logfile.events.include') { should match_array ES_INCLUDED_LOGEVENTS }\n        its('logfile.events.exclude') { should match_array ES_EXCLUDED_LOGEVENTS }\n      end\n    end unless es_handle.nodes.nil?\n\n    describe \"Audit Settings from ES_CONF_YML\" do\n      subject { yaml(ELASTICSEARCH_CONF) }\n      its(['xpack.security.audit.enabled']) { should eq true }\n      its(['xpack.security.audit.outputs']) { should include 'logfile' }\n      its(['xpack.security.audit.logfile.events.include']) { should match_array ES_INCLUDED_LOGEVENTS }\n      its(['xpack.security.audit.logfile.events.exclude']) { should match_array ES_EXCLUDED_LOGEVENTS }\n    end\n\n    describe \"ES HOME directory\" do\n      subject { file(ES_HOME) }\n      its('owner') { should eq ES_OWNER }\n      its('group') { should eq ES_GROUP }\n    end\n\n    describe \"ES CONF\" do\n      subject { file(ELASTICSEARCH_CONF) }\n      its('owner') { should eq ES_OWNER }\n      its('group') { should eq ES_GROUP }\n    end\n\n    describe es_handle do\n      its('superusers') { should be_in DOCUMENTED_SUPER_ROLES}\n    end\n    \n  rescue Exception => msg\n    describe \"Exception: #{msg}\" do\n      it { should be_nil}\n    end\n  end\nend",
          "source_location": {
            "line": 77,
            "ref": "../elasticsearch-inspec/controls/audit+home+role/V-26940.rb"
          },
          "results": [
            {
              "status": "passed",
              "code_desc": "Audit Settings for Node: package-centos-72 enabled should eq \"true\"",
              "run_time": 0.000108,
              "start_time": "2018-02-11 14:27:00 -0500"
            },
            {
              "status": "passed",
              "code_desc": "Audit Settings for Node: package-centos-72 outputs should include \"logfile\"",
              "run_time": 0.000159,
              "start_time": "2018-02-11 14:27:00 -0500"
            },
            {
              "status": "passed",
              "code_desc": "Audit Settings for Node: package-centos-72 logfile.events.include should contain exactly \"access_denied\", \"anonymous_access_denied\", \"authentication_failed\", \"connection_denied\", \"tampered_request\", \"run_as_denied\", and \"run_as_granted\"",
              "run_time": 0.000167,
              "start_time": "2018-02-11 14:27:00 -0500"
            },
            {
              "status": "passed",
              "code_desc": "Audit Settings for Node: package-centos-72 logfile.events.exclude should contain exactly \"access_granted\"",
              "run_time": 0.00008,
              "start_time": "2018-02-11 14:27:00 -0500"
            },
            {
              "status": "passed",
              "code_desc": "Audit Settings from ES_CONF_YML [\"xpack.security.audit.enabled\"] should eq true",
              "run_time": 0.000689,
              "start_time": "2018-02-11 14:27:00 -0500"
            },
            {
              "status": "passed",
              "code_desc": "Audit Settings from ES_CONF_YML [\"xpack.security.audit.outputs\"] should include \"logfile\"",
              "run_time": 0.000607,
              "start_time": "2018-02-11 14:27:00 -0500"
            },
            {
              "status": "passed",
              "code_desc": "Audit Settings from ES_CONF_YML [\"xpack.security.audit.logfile.events.include\"] should contain exactly \"access_denied\", \"anonymous_access_denied\", \"authentication_failed\", \"connection_denied\", \"tampered_request\", \"run_as_denied\", and \"run_as_granted\"",
              "run_time": 0.000673,
              "start_time": "2018-02-11 14:27:00 -0500"
            },
            {
              "status": "passed",
              "code_desc": "Audit Settings from ES_CONF_YML [\"xpack.security.audit.logfile.events.exclude\"] should contain exactly \"access_granted\"",
              "run_time": 0.001148,
              "start_time": "2018-02-11 14:27:00 -0500"
            },
            {
              "status": "passed",
              "code_desc": "ES HOME directory owner should eq \"elasticsearch\"",
              "run_time": 0.000165,
              "start_time": "2018-02-11 14:27:00 -0500"
            },
            {
              "status": "passed",
              "code_desc": "ES HOME directory group should eq \"elasticsearch\"",
              "run_time": 0.000121,
              "start_time": "2018-02-11 14:27:00 -0500"
            },
            {
              "status": "passed",
              "code_desc": "ES CONF owner should eq \"elasticsearch\"",
              "run_time": 0.000079,
              "start_time": "2018-02-11 14:27:00 -0500"
            },
            {
              "status": "passed",
              "code_desc": "ES CONF group should eq \"elasticsearch\"",
              "run_time": 0.000088,
              "start_time": "2018-02-11 14:27:00 -0500"
            },
            {
              "status": "passed",
              "code_desc": "Elasticsearch Cluster https://0.0.0.0:9200 superusers should be in \"superuser\"",
              "run_time": 1.242127,
              "start_time": "2018-02-11 14:27:00 -0500"
            }
          ]
        },
        {
          "id": "V-26820",
          "title": "In support of information flow requirements, applications must track\nproblems associated with information transfer.",
          "desc": "Utilize perimeter, application, centralized authentication, and\nrepository audit controls to audit the use of systems in real time with\nsufficient context.  X-Pack Security audit controls should be enabled to audit\nthe defaults of all HTTP/S based access to Elasticsearch.  All applications\nshould use HTTP/S  rather than Elasticsearch transport protocol.",
          "impact": 0.5,
          "refs": [],
          "tags": {
            "nist": [
              "AC-4 (17) c",
              "Rev_3"
            ],
            "severity": "medium",
            "rid": "SV-34070r1_rule",
            "gtitle": "SRG-APP-000061",
            "cci": "CCI-001557",
            "check": "Note: The following instructions use the ES_HOME environment\nvariable. See supplementary content APPENDIX-F for instructions on configuring\nES_HOME.\n\n$ cat config/elasticsearch.yml | grep xpack.security.audit\n\nCheck elasticsearch settings and documentation to determine whether designated\npersonnel are able to select which auditable events are being audited.\n\n\nAs the application administrator (shown here as 'elasticsearch'), verify the\npermissions for ES_HOME:\n\n$ ls -la ${ES_HOME?}\n\nIf anything in ES_HOME is not owned by the application administrator, this is a\nfinding.\n\nNext, as the elasticsearch administrator, run the following CURL command:\n\n\n$ curl -XGET  -H 'Content-Type: application/json' -u <TEST_USER> -p\n<TEST_CREDENTIALS> https://<elasticsearch>:9200/_xpack/security/role\n\nReview the role permissions, if any role is listed as superuser but should not\nhave that access, this is a finding.",
            "fix": "Configure elasticsearch audit settings to audit access methods.\n\nSee the official documentation for the instructions on audit configuration:\nhttps://www.elastic.co/guide/en/x-pack/current/auditing.html"
          },
          "code": "control \"V-26820\" do\n  title \"In support of information flow requirements, applications must track\nproblems associated with information transfer.\"\n  desc  \"Utilize perimeter, application, centralized authentication, and\nrepository audit controls to audit the use of systems in real time with\nsufficient context.  X-Pack Security audit controls should be enabled to audit\nthe defaults of all HTTP/S based access to Elasticsearch.  All applications\nshould use HTTP/S  rather than Elasticsearch transport protocol.\"\n  impact 0.5\n  tag \"nist\": [\"AC-4 (17) c\", \"Rev_3\"]\n  tag \"severity\": \"medium\"\n  tag \"rid\": \"SV-34070r1_rule\"\n  tag \"gtitle\": \"SRG-APP-000061\"\n  tag \"cci\": \"CCI-001557\"\n  tag \"check\": \"Note: The following instructions use the ES_HOME environment\nvariable. See supplementary content APPENDIX-F for instructions on configuring\nES_HOME.\n\n$ cat config/elasticsearch.yml | grep xpack.security.audit\n\nCheck elasticsearch settings and documentation to determine whether designated\npersonnel are able to select which auditable events are being audited.\n\n\nAs the application administrator (shown here as 'elasticsearch'), verify the\npermissions for ES_HOME:\n\n$ ls -la ${ES_HOME?}\n\nIf anything in ES_HOME is not owned by the application administrator, this is a\nfinding.\n\nNext, as the elasticsearch administrator, run the following CURL command:\n\n\n$ curl -XGET  -H 'Content-Type: application/json' -u <TEST_USER> -p\n<TEST_CREDENTIALS> https://<elasticsearch>:9200/_xpack/security/role\n\nReview the role permissions, if any role is listed as superuser but should not\nhave that access, this is a finding.\"\n  tag \"fix\": \"Configure elasticsearch audit settings to audit access methods.\n\nSee the official documentation for the instructions on audit configuration:\nhttps://www.elastic.co/guide/en/x-pack/current/auditing.html\"\n\n  begin\n\n    es_handle = es_helper(url:\"https://#{ELASTIC_IP}:#{ELASTIC_PORT}\",\n                    username: ES_ADMIN,\n                    password: ES_PASS,\n                    ssl_verify: SSL_VERIFY )\n\n    describe \"No nodes found\" do\n      subject { es_handle.nodes.nil? }\n      it { should_not be_truthy }\n    end if es_handle.nodes.nil?\n\n    es_handle.nodes.each do |node|\n      describe \"Audit Settings for Node: #{node.name}\" do\n        subject { node.audit }\n        its('enabled') { should eq 'true' }\n        its('outputs') { should include 'logfile' }\n        its('logfile.events.include') { should match_array ES_INCLUDED_LOGEVENTS }\n        its('logfile.events.exclude') { should match_array ES_EXCLUDED_LOGEVENTS }\n      end\n    end unless es_handle.nodes.nil?\n\n    describe \"Audit Settings from ES_CONF_YML\" do\n      subject { yaml(ELASTICSEARCH_CONF) }\n      its(['xpack.security.audit.enabled']) { should eq true }\n      its(['xpack.security.audit.outputs']) { should include 'logfile' }\n      its(['xpack.security.audit.logfile.events.include']) { should match_array ES_INCLUDED_LOGEVENTS }\n      its(['xpack.security.audit.logfile.events.exclude']) { should match_array ES_EXCLUDED_LOGEVENTS }\n    end\n\n    describe \"ES HOME directory\" do\n      subject { file(ES_HOME) }\n      its('owner') { should eq ES_OWNER }\n      its('group') { should eq ES_GROUP }\n    end\n\n    describe \"ES CONF\" do\n      subject { file(ELASTICSEARCH_CONF) }\n      its('owner') { should eq ES_OWNER }\n      its('group') { should eq ES_GROUP }\n    end\n\n    describe es_handle do\n      its('superusers') { should be_in DOCUMENTED_SUPER_ROLES}\n    end\n    \n  rescue Exception => msg\n    describe \"Exception: #{msg}\" do\n      it { should be_nil}\n    end\n  end\nend",
          "source_location": {
            "line": 77,
            "ref": "../elasticsearch-inspec/controls/audit+home+role/V-26820.rb"
          },
          "results": [
            {
              "status": "passed",
              "code_desc": "Audit Settings for Node: package-centos-72 enabled should eq \"true\"",
              "run_time": 0.000123,
              "start_time": "2018-02-11 14:27:01 -0500"
            },
            {
              "status": "passed",
              "code_desc": "Audit Settings for Node: package-centos-72 outputs should include \"logfile\"",
              "run_time": 0.000105,
              "start_time": "2018-02-11 14:27:01 -0500"
            },
            {
              "status": "passed",
              "code_desc": "Audit Settings for Node: package-centos-72 logfile.events.include should contain exactly \"access_denied\", \"anonymous_access_denied\", \"authentication_failed\", \"connection_denied\", \"tampered_request\", \"run_as_denied\", and \"run_as_granted\"",
              "run_time": 0.000391,
              "start_time": "2018-02-11 14:27:01 -0500"
            },
            {
              "status": "passed",
              "code_desc": "Audit Settings for Node: package-centos-72 logfile.events.exclude should contain exactly \"access_granted\"",
              "run_time": 0.000093,
              "start_time": "2018-02-11 14:27:01 -0500"
            },
            {
              "status": "passed",
              "code_desc": "Audit Settings from ES_CONF_YML [\"xpack.security.audit.enabled\"] should eq true",
              "run_time": 0.000836,
              "start_time": "2018-02-11 14:27:01 -0500"
            },
            {
              "status": "passed",
              "code_desc": "Audit Settings from ES_CONF_YML [\"xpack.security.audit.outputs\"] should include \"logfile\"",
              "run_time": 0.000789,
              "start_time": "2018-02-11 14:27:01 -0500"
            },
            {
              "status": "passed",
              "code_desc": "Audit Settings from ES_CONF_YML [\"xpack.security.audit.logfile.events.include\"] should contain exactly \"access_denied\", \"anonymous_access_denied\", \"authentication_failed\", \"connection_denied\", \"tampered_request\", \"run_as_denied\", and \"run_as_granted\"",
              "run_time": 0.000703,
              "start_time": "2018-02-11 14:27:01 -0500"
            },
            {
              "status": "passed",
              "code_desc": "Audit Settings from ES_CONF_YML [\"xpack.security.audit.logfile.events.exclude\"] should contain exactly \"access_granted\"",
              "run_time": 0.000665,
              "start_time": "2018-02-11 14:27:01 -0500"
            },
            {
              "status": "passed",
              "code_desc": "ES HOME directory owner should eq \"elasticsearch\"",
              "run_time": 0.000089,
              "start_time": "2018-02-11 14:27:01 -0500"
            },
            {
              "status": "passed",
              "code_desc": "ES HOME directory group should eq \"elasticsearch\"",
              "run_time": 0.000271,
              "start_time": "2018-02-11 14:27:01 -0500"
            },
            {
              "status": "passed",
              "code_desc": "ES CONF owner should eq \"elasticsearch\"",
              "run_time": 0.000077,
              "start_time": "2018-02-11 14:27:01 -0500"
            },
            {
              "status": "passed",
              "code_desc": "ES CONF group should eq \"elasticsearch\"",
              "run_time": 0.000261,
              "start_time": "2018-02-11 14:27:01 -0500"
            },
            {
              "status": "passed",
              "code_desc": "Elasticsearch Cluster https://0.0.0.0:9200 superusers should be in \"superuser\"",
              "run_time": 1.350691,
              "start_time": "2018-02-11 14:27:01 -0500"
            }
          ]
        },
        {
          "id": "V-27089",
          "title": "Applications must provide a report generation capability for audit\nreduction data.",
          "desc": "Automate the creation of reports, dashboards, and interactive\nexploration of audit records.",
          "impact": 0.5,
          "refs": [],
          "tags": {
            "nist": [
              "AU-7",
              "Rev_3"
            ],
            "severity": "medium",
            "rid": "SV-34384r1_rule",
            "gtitle": "SRG-APP-000114",
            "cci": "CCI-000157",
            "check": "Note: The following instructions use the ES_HOME environment\nvariable. See supplementary content APPENDIX-F for instructions on configuring\nES_HOME.\n\n$ cat config/elasticsearch.yml | grep xpack.security.audit\n\nCheck elasticsearch settings and documentation to determine whether designated\npersonnel are able to select which auditable events are being audited.\n\n\nAs the application administrator (shown here as 'elasticsearch'), verify the\npermissions for ES_HOME:\n\n$ ls -la ${ES_HOME?}\n\nIf anything in ES_HOME is not owned by the application administrator, this is a\nfinding.\n\nNext, as the elasticsearch administrator, run the following CURL command:\n\n\n$ curl -XGET  -H 'Content-Type: application/json' -u <TEST_USER> -p\n<TEST_CREDENTIALS> https://<elasticsearch>:9200/_xpack/security/role\n\nReview the role permissions, if any role is listed as superuser but should not\nhave that access, this is a finding.",
            "fix": "Configure elasticsearch audit settings based on selectable, event\ncriteria.\n\nSee the official documentation for the instructions on audit configuration:\nhttps://www.elastic.co/guide/en/x-pack/current/auditing.html\n\nAs the system administrator, change the permissions of ES_HOME.\n\n$ sudo chown -R elasticsearch:elasticsearch ${ES_HOME?}\n$ sudo chmod 700 ${ES_HOME?}\n\n"
          },
          "code": "control \"V-27089\" do\n  title \"Applications must provide a report generation capability for audit\nreduction data.\"\n  desc  \"Automate the creation of reports, dashboards, and interactive\nexploration of audit records.\"\n  impact 0.5\n  tag \"nist\": [\"AU-7\", \"Rev_3\"]\n  tag \"severity\": \"medium\"\n  tag \"rid\": \"SV-34384r1_rule\"\n  tag \"gtitle\": \"SRG-APP-000114\"\n  tag \"cci\": \"CCI-000157\"\n  tag \"check\": \"Note: The following instructions use the ES_HOME environment\nvariable. See supplementary content APPENDIX-F for instructions on configuring\nES_HOME.\n\n$ cat config/elasticsearch.yml | grep xpack.security.audit\n\nCheck elasticsearch settings and documentation to determine whether designated\npersonnel are able to select which auditable events are being audited.\n\n\nAs the application administrator (shown here as 'elasticsearch'), verify the\npermissions for ES_HOME:\n\n$ ls -la ${ES_HOME?}\n\nIf anything in ES_HOME is not owned by the application administrator, this is a\nfinding.\n\nNext, as the elasticsearch administrator, run the following CURL command:\n\n\n$ curl -XGET  -H 'Content-Type: application/json' -u <TEST_USER> -p\n<TEST_CREDENTIALS> https://<elasticsearch>:9200/_xpack/security/role\n\nReview the role permissions, if any role is listed as superuser but should not\nhave that access, this is a finding.\"\n  tag \"fix\": \"Configure elasticsearch audit settings based on selectable, event\ncriteria.\n\nSee the official documentation for the instructions on audit configuration:\nhttps://www.elastic.co/guide/en/x-pack/current/auditing.html\n\nAs the system administrator, change the permissions of ES_HOME.\n\n$ sudo chown -R elasticsearch:elasticsearch ${ES_HOME?}\n$ sudo chmod 700 ${ES_HOME?}\n\n\"\n\n  begin\n\n    es_handle = es_helper(url:\"https://#{ELASTIC_IP}:#{ELASTIC_PORT}\",\n                    username: ES_ADMIN,\n                    password: ES_PASS,\n                    ssl_verify: SSL_VERIFY )\n\n    describe \"No nodes found\" do\n      subject { es_handle.nodes.nil? }\n      it { should_not be_truthy }\n    end if es_handle.nodes.nil?\n\n    es_handle.nodes.each do |node|\n      describe \"Audit Settings for Node: #{node.name}\" do\n        subject { node.audit }\n        its('enabled') { should eq 'true' }\n        its('outputs') { should include 'logfile' }\n        its('logfile.events.include') { should match_array ES_INCLUDED_LOGEVENTS }\n        its('logfile.events.exclude') { should match_array ES_EXCLUDED_LOGEVENTS }\n      end\n    end unless es_handle.nodes.nil?\n\n    describe \"Audit Settings from ES_CONF_YML\" do\n      subject { yaml(ELASTICSEARCH_CONF) }\n      its(['xpack.security.audit.enabled']) { should eq true }\n      its(['xpack.security.audit.outputs']) { should include 'logfile' }\n      its(['xpack.security.audit.logfile.events.include']) { should match_array ES_INCLUDED_LOGEVENTS }\n      its(['xpack.security.audit.logfile.events.exclude']) { should match_array ES_EXCLUDED_LOGEVENTS }\n    end\n\n    describe \"ES HOME directory\" do\n      subject { file(ES_HOME) }\n      its('owner') { should eq ES_OWNER }\n      its('group') { should eq ES_GROUP }\n    end\n\n    describe \"ES CONF\" do\n      subject { file(ELASTICSEARCH_CONF) }\n      its('owner') { should eq ES_OWNER }\n      its('group') { should eq ES_GROUP }\n    end\n\n    describe es_handle do\n      its('superusers') { should be_in DOCUMENTED_SUPER_ROLES}\n    end\n    \n  rescue Exception => msg\n    describe \"Exception: #{msg}\" do\n      it { should be_nil}\n    end\n  end\nend",
          "source_location": {
            "line": 77,
            "ref": "../elasticsearch-inspec/controls/audit+home+role/V-27089.rb"
          },
          "results": [
            {
              "status": "passed",
              "code_desc": "Audit Settings for Node: package-centos-72 enabled should eq \"true\"",
              "run_time": 0.000383,
              "start_time": "2018-02-11 14:27:03 -0500"
            },
            {
              "status": "passed",
              "code_desc": "Audit Settings for Node: package-centos-72 outputs should include \"logfile\"",
              "run_time": 0.000097,
              "start_time": "2018-02-11 14:27:03 -0500"
            },
            {
              "status": "passed",
              "code_desc": "Audit Settings for Node: package-centos-72 logfile.events.include should contain exactly \"access_denied\", \"anonymous_access_denied\", \"authentication_failed\", \"connection_denied\", \"tampered_request\", \"run_as_denied\", and \"run_as_granted\"",
              "run_time": 0.00013,
              "start_time": "2018-02-11 14:27:03 -0500"
            },
            {
              "status": "passed",
              "code_desc": "Audit Settings for Node: package-centos-72 logfile.events.exclude should contain exactly \"access_granted\"",
              "run_time": 0.000086,
              "start_time": "2018-02-11 14:27:03 -0500"
            },
            {
              "status": "passed",
              "code_desc": "Audit Settings from ES_CONF_YML [\"xpack.security.audit.enabled\"] should eq true",
              "run_time": 0.00101,
              "start_time": "2018-02-11 14:27:03 -0500"
            },
            {
              "status": "passed",
              "code_desc": "Audit Settings from ES_CONF_YML [\"xpack.security.audit.outputs\"] should include \"logfile\"",
              "run_time": 0.000853,
              "start_time": "2018-02-11 14:27:03 -0500"
            },
            {
              "status": "passed",
              "code_desc": "Audit Settings from ES_CONF_YML [\"xpack.security.audit.logfile.events.include\"] should contain exactly \"access_denied\", \"anonymous_access_denied\", \"authentication_failed\", \"connection_denied\", \"tampered_request\", \"run_as_denied\", and \"run_as_granted\"",
              "run_time": 0.00086,
              "start_time": "2018-02-11 14:27:03 -0500"
            },
            {
              "status": "passed",
              "code_desc": "Audit Settings from ES_CONF_YML [\"xpack.security.audit.logfile.events.exclude\"] should contain exactly \"access_granted\"",
              "run_time": 0.000772,
              "start_time": "2018-02-11 14:27:03 -0500"
            },
            {
              "status": "passed",
              "code_desc": "ES HOME directory owner should eq \"elasticsearch\"",
              "run_time": 0.000098,
              "start_time": "2018-02-11 14:27:03 -0500"
            },
            {
              "status": "passed",
              "code_desc": "ES HOME directory group should eq \"elasticsearch\"",
              "run_time": 0.000076,
              "start_time": "2018-02-11 14:27:03 -0500"
            },
            {
              "status": "passed",
              "code_desc": "ES CONF owner should eq \"elasticsearch\"",
              "run_time": 0.000074,
              "start_time": "2018-02-11 14:27:03 -0500"
            },
            {
              "status": "passed",
              "code_desc": "ES CONF group should eq \"elasticsearch\"",
              "run_time": 0.000078,
              "start_time": "2018-02-11 14:27:03 -0500"
            },
            {
              "status": "passed",
              "code_desc": "Elasticsearch Cluster https://0.0.0.0:9200 superusers should be in \"superuser\"",
              "run_time": 1.569637,
              "start_time": "2018-02-11 14:27:03 -0500"
            }
          ]
        },
        {
          "id": "V-26902",
          "title": "The application must allow designated organizational personnel to\nselect which auditable events are to be audited by specific components of the\nsystem.",
          "desc": "Utilize perimeter, application, centralized authentication, and\nrepository audit controls to audit the use of systems in real time with\nsufficient context.  X-Pack Security audit controls should be enabled to audit\nthe defaults of all HTTP/S based access to Elasticsearch.  All applications\nshould use HTTP/S  rather than Elasticsearch transport protocol.",
          "impact": 0.5,
          "refs": [],
          "tags": {
            "nist": [
              "AU-12 b",
              "Rev_4"
            ],
            "severity": "medium",
            "rid": "SV-34182r1_rule",
            "gtitle": "SRG-APP-000090",
            "cci": "CCI-000171",
            "check": "Note: The following instructions use the ES_HOME environment\nvariable. See supplementary content APPENDIX-F for instructions on configuring\nES_HOME.\n\n$ cat config/elasticsearch.yml | grep xpack.security.audit.outputs\n\n\nCheck elasticsearch settings and documentation to determine whether designated\npersonnel are able to select which auditable events are being audited.\n\n\nAs the application administrator (shown here as 'elasticsearch'), verify the\npermissions for ES_HOME:\n\n$ ls -la ${ES_HOME?}\n\nIf anything in ES_HOME is not owned by the application administrator, this is a\nfinding.\n\nNext, as the elasticsearch administrator, run the following CURL command:\n\n\n$ curl -XGET  -H 'Content-Type: application/json' -u <TEST_USER> -p\n<TEST_CREDENTIALS> https://<elasticsearch>:9200/_xpack/security/role\n\nReview the role permissions, if any role is listed as superuser but should not\nhave that access, this is a finding.",
            "fix": "Configure elasticsearch audit settings to contain sufficient\ninformation to establish where an event occurred.\n\nSee the official documentation for the instructions on audit configuration:\nhttps://www.elastic.co/guide/en/x-pack/current/auditing.html"
          },
          "code": "control \"V-26902\" do\n  title \"The application must allow designated organizational personnel to\nselect which auditable events are to be audited by specific components of the\nsystem.\"\n  desc  \"Utilize perimeter, application, centralized authentication, and\nrepository audit controls to audit the use of systems in real time with\nsufficient context.  X-Pack Security audit controls should be enabled to audit\nthe defaults of all HTTP/S based access to Elasticsearch.  All applications\nshould use HTTP/S  rather than Elasticsearch transport protocol.\"\n  impact 0.5\n  tag \"nist\": [\"AU-12 b\", \"Rev_4\"]\n  tag \"severity\": \"medium\"\n  tag \"rid\": \"SV-34182r1_rule\"\n  tag \"gtitle\": \"SRG-APP-000090\"\n  tag \"cci\": \"CCI-000171\"\n  tag \"check\": \"Note: The following instructions use the ES_HOME environment\nvariable. See supplementary content APPENDIX-F for instructions on configuring\nES_HOME.\n\n$ cat config/elasticsearch.yml | grep xpack.security.audit.outputs\n\n\nCheck elasticsearch settings and documentation to determine whether designated\npersonnel are able to select which auditable events are being audited.\n\n\nAs the application administrator (shown here as 'elasticsearch'), verify the\npermissions for ES_HOME:\n\n$ ls -la ${ES_HOME?}\n\nIf anything in ES_HOME is not owned by the application administrator, this is a\nfinding.\n\nNext, as the elasticsearch administrator, run the following CURL command:\n\n\n$ curl -XGET  -H 'Content-Type: application/json' -u <TEST_USER> -p\n<TEST_CREDENTIALS> https://<elasticsearch>:9200/_xpack/security/role\n\nReview the role permissions, if any role is listed as superuser but should not\nhave that access, this is a finding.\"\n  tag \"fix\": \"Configure elasticsearch audit settings to contain sufficient\ninformation to establish where an event occurred.\n\nSee the official documentation for the instructions on audit configuration:\nhttps://www.elastic.co/guide/en/x-pack/current/auditing.html\"\n\n  begin\n\n    es_handle = es_helper(url:\"https://#{ELASTIC_IP}:#{ELASTIC_PORT}\",\n                    username: ES_ADMIN,\n                    password: ES_PASS,\n                    ssl_verify: SSL_VERIFY )\n\n    describe \"No nodes found\" do\n      subject { es_handle.nodes.nil? }\n      it { should_not be_truthy }\n    end if es_handle.nodes.nil?\n\n    es_handle.nodes.each do |node|\n      describe \"Audit Settings for Node: #{node.name}\" do\n        subject { node.audit }\n        its('enabled') { should eq 'true' }\n        its('outputs') { should include 'logfile' }\n        its('logfile.events.include') { should match_array ES_INCLUDED_LOGEVENTS }\n        its('logfile.events.exclude') { should match_array ES_EXCLUDED_LOGEVENTS }\n      end\n    end unless es_handle.nodes.nil?\n\n    describe \"Audit Settings from ES_CONF_YML\" do\n      subject { yaml(ELASTICSEARCH_CONF) }\n      its(['xpack.security.audit.enabled']) { should eq true }\n      its(['xpack.security.audit.outputs']) { should include 'logfile' }\n      its(['xpack.security.audit.logfile.events.include']) { should match_array ES_INCLUDED_LOGEVENTS }\n      its(['xpack.security.audit.logfile.events.exclude']) { should match_array ES_EXCLUDED_LOGEVENTS }\n    end\n\n    describe \"ES HOME directory\" do\n      subject { file(ES_HOME) }\n      its('owner') { should eq ES_OWNER }\n      its('group') { should eq ES_GROUP }\n    end\n\n    describe \"ES CONF\" do\n      subject { file(ELASTICSEARCH_CONF) }\n      its('owner') { should eq ES_OWNER }\n      its('group') { should eq ES_GROUP }\n    end\n\n    describe es_handle do\n      its('superusers') { should be_in DOCUMENTED_SUPER_ROLES}\n    end\n    \n  rescue Exception => msg\n    describe \"Exception: #{msg}\" do\n      it { should be_nil}\n    end\n  end\nend",
          "source_location": {
            "line": 78,
            "ref": "../elasticsearch-inspec/controls/audit+home+role/V-26902.rb"
          },
          "results": [
            {
              "status": "passed",
              "code_desc": "Audit Settings for Node: package-centos-72 enabled should eq \"true\"",
              "run_time": 0.000187,
              "start_time": "2018-02-11 14:27:04 -0500"
            },
            {
              "status": "passed",
              "code_desc": "Audit Settings for Node: package-centos-72 outputs should include \"logfile\"",
              "run_time": 0.000148,
              "start_time": "2018-02-11 14:27:04 -0500"
            },
            {
              "status": "passed",
              "code_desc": "Audit Settings for Node: package-centos-72 logfile.events.include should contain exactly \"access_denied\", \"anonymous_access_denied\", \"authentication_failed\", \"connection_denied\", \"tampered_request\", \"run_as_denied\", and \"run_as_granted\"",
              "run_time": 0.000449,
              "start_time": "2018-02-11 14:27:04 -0500"
            },
            {
              "status": "passed",
              "code_desc": "Audit Settings for Node: package-centos-72 logfile.events.exclude should contain exactly \"access_granted\"",
              "run_time": 0.000132,
              "start_time": "2018-02-11 14:27:04 -0500"
            },
            {
              "status": "passed",
              "code_desc": "Audit Settings from ES_CONF_YML [\"xpack.security.audit.enabled\"] should eq true",
              "run_time": 0.001141,
              "start_time": "2018-02-11 14:27:04 -0500"
            },
            {
              "status": "passed",
              "code_desc": "Audit Settings from ES_CONF_YML [\"xpack.security.audit.outputs\"] should include \"logfile\"",
              "run_time": 0.000831,
              "start_time": "2018-02-11 14:27:04 -0500"
            },
            {
              "status": "passed",
              "code_desc": "Audit Settings from ES_CONF_YML [\"xpack.security.audit.logfile.events.include\"] should contain exactly \"access_denied\", \"anonymous_access_denied\", \"authentication_failed\", \"connection_denied\", \"tampered_request\", \"run_as_denied\", and \"run_as_granted\"",
              "run_time": 0.00115,
              "start_time": "2018-02-11 14:27:04 -0500"
            },
            {
              "status": "passed",
              "code_desc": "Audit Settings from ES_CONF_YML [\"xpack.security.audit.logfile.events.exclude\"] should contain exactly \"access_granted\"",
              "run_time": 0.000975,
              "start_time": "2018-02-11 14:27:04 -0500"
            },
            {
              "status": "passed",
              "code_desc": "ES HOME directory owner should eq \"elasticsearch\"",
              "run_time": 0.000149,
              "start_time": "2018-02-11 14:27:04 -0500"
            },
            {
              "status": "passed",
              "code_desc": "ES HOME directory group should eq \"elasticsearch\"",
              "run_time": 0.000122,
              "start_time": "2018-02-11 14:27:04 -0500"
            },
            {
              "status": "passed",
              "code_desc": "ES CONF owner should eq \"elasticsearch\"",
              "run_time": 0.000125,
              "start_time": "2018-02-11 14:27:04 -0500"
            },
            {
              "status": "passed",
              "code_desc": "ES CONF group should eq \"elasticsearch\"",
              "run_time": 0.000112,
              "start_time": "2018-02-11 14:27:04 -0500"
            },
            {
              "status": "passed",
              "code_desc": "Elasticsearch Cluster https://0.0.0.0:9200 superusers should be in \"superuser\"",
              "run_time": 1.744104,
              "start_time": "2018-02-11 14:27:04 -0500"
            }
          ]
        },
        {
          "id": "V-26730",
          "title": "The application must automatically audit account disabling actions and\nnotify appropriate individuals.",
          "desc": "Utilize perimeter, application, centralized authentication, and\nrepository audit controls to audit the use of systems in real time with\nsufficient context.  X-Pack Security audit controls should be enabled to audit\nthe defaults of all HTTP/S based access to Elasticsearch.  All applications\nshould use HTTP/S  rather than Elasticsearch transport protocol.",
          "impact": 0.5,
          "refs": [],
          "tags": {
            "nist": [
              "AC-2 (4)",
              "Rev_4"
            ],
            "severity": "medium",
            "rid": "SV-33978r1_rule",
            "gtitle": "SRG-APP-000028",
            "cci": "CCI-001404",
            "check": "Note: The following instructions use the ES_HOME environment\nvariable. See supplementary content APPENDIX-F for instructions on configuring\nES_HOME.\n\n$ cat config/elasticsearch.yml | grep xpack.security.audit.outputs\n\n\nCheck elasticsearch settings and documentation to determine whether designated\npersonnel are able to select which auditable events are being audited.\n\n\nAs the application administrator (shown here as 'elasticsearch'), verify the\npermissions for ES_HOME:\n\n$ ls -la ${ES_HOME?}\n\nIf anything in ES_HOME is not owned by the application administrator, this is a\nfinding.\n\nNext, as the elasticsearch administrator, run the following CURL command:\n\n\n$ curl -XGET  -H 'Content-Type: application/json' -u <TEST_USER> -p\n<TEST_CREDENTIALS> https://<elasticsearch>:9200/_xpack/security/role\n\nReview the role permissions, if any role is listed as superuser but should not\nhave that access, this is a finding.",
            "fix": "Configure elasticsearch audit settings to contain sufficient\ninformation to establish account disabling.\n\nSee the official documentation for the instructions on audit configuration:\nhttps://www.elastic.co/guide/en/x-pack/current/auditing.html"
          },
          "code": "control \"V-26730\" do\n  title \"The application must automatically audit account disabling actions and\nnotify appropriate individuals.\"\n  desc  \"Utilize perimeter, application, centralized authentication, and\nrepository audit controls to audit the use of systems in real time with\nsufficient context.  X-Pack Security audit controls should be enabled to audit\nthe defaults of all HTTP/S based access to Elasticsearch.  All applications\nshould use HTTP/S  rather than Elasticsearch transport protocol.\"\n  impact 0.5\n  tag \"nist\": [\"AC-2 (4)\", \"Rev_4\"]\n  tag \"severity\": \"medium\"\n  tag \"rid\": \"SV-33978r1_rule\"\n  tag \"gtitle\": \"SRG-APP-000028\"\n  tag \"cci\": \"CCI-001404\"\n  tag \"check\": \"Note: The following instructions use the ES_HOME environment\nvariable. See supplementary content APPENDIX-F for instructions on configuring\nES_HOME.\n\n$ cat config/elasticsearch.yml | grep xpack.security.audit.outputs\n\n\nCheck elasticsearch settings and documentation to determine whether designated\npersonnel are able to select which auditable events are being audited.\n\n\nAs the application administrator (shown here as 'elasticsearch'), verify the\npermissions for ES_HOME:\n\n$ ls -la ${ES_HOME?}\n\nIf anything in ES_HOME is not owned by the application administrator, this is a\nfinding.\n\nNext, as the elasticsearch administrator, run the following CURL command:\n\n\n$ curl -XGET  -H 'Content-Type: application/json' -u <TEST_USER> -p\n<TEST_CREDENTIALS> https://<elasticsearch>:9200/_xpack/security/role\n\nReview the role permissions, if any role is listed as superuser but should not\nhave that access, this is a finding.\"\n  tag \"fix\": \"Configure elasticsearch audit settings to contain sufficient\ninformation to establish account disabling.\n\nSee the official documentation for the instructions on audit configuration:\nhttps://www.elastic.co/guide/en/x-pack/current/auditing.html\"\n\n  begin\n\n    es_handle = es_helper(url:\"https://#{ELASTIC_IP}:#{ELASTIC_PORT}\",\n                    username: ES_ADMIN,\n                    password: ES_PASS,\n                    ssl_verify: SSL_VERIFY )\n\n    describe \"No nodes found\" do\n      subject { es_handle.nodes.nil? }\n      it { should_not be_truthy }\n    end if es_handle.nodes.nil?\n\n    es_handle.nodes.each do |node|\n      describe \"Audit Settings for Node: #{node.name}\" do\n        subject { node.audit }\n        its('enabled') { should eq 'true' }\n        its('outputs') { should include 'logfile' }\n        its('logfile.events.include') { should match_array ES_INCLUDED_LOGEVENTS }\n        its('logfile.events.exclude') { should match_array ES_EXCLUDED_LOGEVENTS }\n      end\n    end unless es_handle.nodes.nil?\n\n    describe \"Audit Settings from ES_CONF_YML\" do\n      subject { yaml(ELASTICSEARCH_CONF) }\n      its(['xpack.security.audit.enabled']) { should eq true }\n      its(['xpack.security.audit.outputs']) { should include 'logfile' }\n      its(['xpack.security.audit.logfile.events.include']) { should match_array ES_INCLUDED_LOGEVENTS }\n      its(['xpack.security.audit.logfile.events.exclude']) { should match_array ES_EXCLUDED_LOGEVENTS }\n    end\n\n    describe \"ES HOME directory\" do\n      subject { file(ES_HOME) }\n      its('owner') { should eq ES_OWNER }\n      its('group') { should eq ES_GROUP }\n    end\n\n    describe \"ES CONF\" do\n      subject { file(ELASTICSEARCH_CONF) }\n      its('owner') { should eq ES_OWNER }\n      its('group') { should eq ES_GROUP }\n    end\n\n    describe es_handle do\n      its('superusers') { should be_in DOCUMENTED_SUPER_ROLES}\n    end\n    \n  rescue Exception => msg\n    describe \"Exception: #{msg}\" do\n      it { should be_nil}\n    end\n  end\nend",
          "source_location": {
            "line": 84,
            "ref": "../elasticsearch-inspec/controls/audit+home+role/V-26730.rb"
          },
          "results": [
            {
              "status": "passed",
              "code_desc": "Audit Settings for Node: package-centos-72 enabled should eq \"true\"",
              "run_time": 0.000106,
              "start_time": "2018-02-11 14:27:06 -0500"
            },
            {
              "status": "passed",
              "code_desc": "Audit Settings for Node: package-centos-72 outputs should include \"logfile\"",
              "run_time": 0.000097,
              "start_time": "2018-02-11 14:27:06 -0500"
            },
            {
              "status": "passed",
              "code_desc": "Audit Settings for Node: package-centos-72 logfile.events.include should contain exactly \"access_denied\", \"anonymous_access_denied\", \"authentication_failed\", \"connection_denied\", \"tampered_request\", \"run_as_denied\", and \"run_as_granted\"",
              "run_time": 0.000133,
              "start_time": "2018-02-11 14:27:06 -0500"
            },
            {
              "status": "passed",
              "code_desc": "Audit Settings for Node: package-centos-72 logfile.events.exclude should contain exactly \"access_granted\"",
              "run_time": 0.000078,
              "start_time": "2018-02-11 14:27:06 -0500"
            },
            {
              "status": "passed",
              "code_desc": "Audit Settings from ES_CONF_YML [\"xpack.security.audit.enabled\"] should eq true",
              "run_time": 0.000573,
              "start_time": "2018-02-11 14:27:06 -0500"
            },
            {
              "status": "passed",
              "code_desc": "Audit Settings from ES_CONF_YML [\"xpack.security.audit.outputs\"] should include \"logfile\"",
              "run_time": 0.000708,
              "start_time": "2018-02-11 14:27:06 -0500"
            },
            {
              "status": "passed",
              "code_desc": "Audit Settings from ES_CONF_YML [\"xpack.security.audit.logfile.events.include\"] should contain exactly \"access_denied\", \"anonymous_access_denied\", \"authentication_failed\", \"connection_denied\", \"tampered_request\", \"run_as_denied\", and \"run_as_granted\"",
              "run_time": 0.000719,
              "start_time": "2018-02-11 14:27:06 -0500"
            },
            {
              "status": "passed",
              "code_desc": "Audit Settings from ES_CONF_YML [\"xpack.security.audit.logfile.events.exclude\"] should contain exactly \"access_granted\"",
              "run_time": 0.000482,
              "start_time": "2018-02-11 14:27:06 -0500"
            },
            {
              "status": "passed",
              "code_desc": "ES HOME directory owner should eq \"elasticsearch\"",
              "run_time": 0.00009,
              "start_time": "2018-02-11 14:27:06 -0500"
            },
            {
              "status": "passed",
              "code_desc": "ES HOME directory group should eq \"elasticsearch\"",
              "run_time": 0.00008,
              "start_time": "2018-02-11 14:27:06 -0500"
            },
            {
              "status": "passed",
              "code_desc": "ES CONF owner should eq \"elasticsearch\"",
              "run_time": 0.000077,
              "start_time": "2018-02-11 14:27:06 -0500"
            },
            {
              "status": "passed",
              "code_desc": "ES CONF group should eq \"elasticsearch\"",
              "run_time": 0.000174,
              "start_time": "2018-02-11 14:27:06 -0500"
            },
            {
              "status": "passed",
              "code_desc": "Elasticsearch Cluster https://0.0.0.0:9200 superusers should be in \"superuser\"",
              "run_time": 1.443277,
              "start_time": "2018-02-11 14:27:06 -0500"
            }
          ]
        },
        {
          "id": "V-27145",
          "title": "Applications must provide the capability to automatically process\naudit records for events of interest based upon selectable, event criteria.",
          "desc": "Deploy security analytics to monitor the behavior of system users and\nadministrators. Audit events should be exportable, searchable, filterable, and\nsummarized in real time.",
          "impact": 0.5,
          "refs": [],
          "tags": {
            "nist": [
              "AU-7 (1)",
              "Rev_4"
            ],
            "severity": "medium",
            "rid": "SV-34444r1_rule",
            "gtitle": "SRG-APP-000115",
            "cci": "CCI-000158",
            "check": "Note: The following instructions use the ES_HOME environment\nvariable. See supplementary content APPENDIX-F for instructions on configuring\nES_HOME.\n\n$ cat config/elasticsearch.yml | grep xpack.security.audit\n\nCheck elasticsearch settings and documentation to determine whether designated\npersonnel are able to select which auditable events are being audited.\n\n\nAs the application administrator (shown here as 'elasticsearch'), verify the\npermissions for ES_HOME:\n\n$ ls -la ${ES_HOME?}\n\nIf anything in ES_HOME is not owned by the application administrator, this is a\nfinding.\n\nNext, as the elasticsearch administrator, run the following CURL command:\n\n\n$ curl -XGET  -H 'Content-Type: application/json' -u <TEST_USER> -p\n<TEST_CREDENTIALS> https://<elasticsearch>:9200/_xpack/security/role\n\nReview the role permissions, if any role is listed as superuser but should not\nhave that access, this is a finding.",
            "fix": "Configure elasticsearch audit settings based on selectable, event\ncriteria.\n\nSee the official documentation for the instructions on audit configuration:\nhttps://www.elastic.co/guide/en/x-pack/current/auditing.html"
          },
          "code": "control \"V-27145\" do\n  title \"Applications must provide the capability to automatically process\naudit records for events of interest based upon selectable, event criteria.\"\n  desc  \"Deploy security analytics to monitor the behavior of system users and\nadministrators. Audit events should be exportable, searchable, filterable, and\nsummarized in real time.\"\n  impact 0.5\n  tag \"nist\": [\"AU-7 (1)\", \"Rev_4\"]\n  tag \"severity\": \"medium\"\n  tag \"rid\": \"SV-34444r1_rule\"\n  tag \"gtitle\": \"SRG-APP-000115\"\n  tag \"cci\": \"CCI-000158\"\n  tag \"check\": \"Note: The following instructions use the ES_HOME environment\nvariable. See supplementary content APPENDIX-F for instructions on configuring\nES_HOME.\n\n$ cat config/elasticsearch.yml | grep xpack.security.audit\n\nCheck elasticsearch settings and documentation to determine whether designated\npersonnel are able to select which auditable events are being audited.\n\n\nAs the application administrator (shown here as 'elasticsearch'), verify the\npermissions for ES_HOME:\n\n$ ls -la ${ES_HOME?}\n\nIf anything in ES_HOME is not owned by the application administrator, this is a\nfinding.\n\nNext, as the elasticsearch administrator, run the following CURL command:\n\n\n$ curl -XGET  -H 'Content-Type: application/json' -u <TEST_USER> -p\n<TEST_CREDENTIALS> https://<elasticsearch>:9200/_xpack/security/role\n\nReview the role permissions, if any role is listed as superuser but should not\nhave that access, this is a finding.\"\n  tag \"fix\": \"Configure elasticsearch audit settings based on selectable, event\ncriteria.\n\nSee the official documentation for the instructions on audit configuration:\nhttps://www.elastic.co/guide/en/x-pack/current/auditing.html\"\n\n  begin\n\n    es_handle = es_helper(url:\"https://#{ELASTIC_IP}:#{ELASTIC_PORT}\",\n                    username: ES_ADMIN,\n                    password: ES_PASS,\n                    ssl_verify: SSL_VERIFY )\n\n    describe \"No nodes found\" do\n      subject { es_handle.nodes.nil? }\n      it { should_not be_truthy }\n    end if es_handle.nodes.nil?\n\n    es_handle.nodes.each do |node|\n      describe \"Audit Settings for Node: #{node.name}\" do\n        subject { node.audit }\n        its('enabled') { should eq 'true' }\n        its('outputs') { should include 'logfile' }\n        its('logfile.events.include') { should match_array ES_INCLUDED_LOGEVENTS }\n        its('logfile.events.exclude') { should match_array ES_EXCLUDED_LOGEVENTS }\n      end\n    end unless es_handle.nodes.nil?\n\n    describe \"Audit Settings from ES_CONF_YML\" do\n      subject { yaml(ELASTICSEARCH_CONF) }\n      its(['xpack.security.audit.enabled']) { should eq true }\n      its(['xpack.security.audit.outputs']) { should include 'logfile' }\n      its(['xpack.security.audit.logfile.events.include']) { should match_array ES_INCLUDED_LOGEVENTS }\n      its(['xpack.security.audit.logfile.events.exclude']) { should match_array ES_EXCLUDED_LOGEVENTS }\n    end\n\n    describe \"ES HOME directory\" do\n      subject { file(ES_HOME) }\n      its('owner') { should eq ES_OWNER }\n      its('group') { should eq ES_GROUP }\n    end\n\n    describe \"ES CONF\" do\n      subject { file(ELASTICSEARCH_CONF) }\n      its('owner') { should eq ES_OWNER }\n      its('group') { should eq ES_GROUP }\n    end\n\n    describe es_handle do\n      its('superusers') { should be_in DOCUMENTED_SUPER_ROLES}\n    end\n    \n  rescue Exception => msg\n    describe \"Exception: #{msg}\" do\n      it { should be_nil}\n    end\n  end\nend",
          "source_location": {
            "line": 78,
            "ref": "../elasticsearch-inspec/controls/audit+home+role/V-27145.rb"
          },
          "results": [
            {
              "status": "passed",
              "code_desc": "Audit Settings for Node: package-centos-72 enabled should eq \"true\"",
              "run_time": 0.000142,
              "start_time": "2018-02-11 14:27:07 -0500"
            },
            {
              "status": "passed",
              "code_desc": "Audit Settings for Node: package-centos-72 outputs should include \"logfile\"",
              "run_time": 0.000166,
              "start_time": "2018-02-11 14:27:07 -0500"
            },
            {
              "status": "passed",
              "code_desc": "Audit Settings for Node: package-centos-72 logfile.events.include should contain exactly \"access_denied\", \"anonymous_access_denied\", \"authentication_failed\", \"connection_denied\", \"tampered_request\", \"run_as_denied\", and \"run_as_granted\"",
              "run_time": 0.000146,
              "start_time": "2018-02-11 14:27:07 -0500"
            },
            {
              "status": "passed",
              "code_desc": "Audit Settings for Node: package-centos-72 logfile.events.exclude should contain exactly \"access_granted\"",
              "run_time": 0.000112,
              "start_time": "2018-02-11 14:27:07 -0500"
            },
            {
              "status": "passed",
              "code_desc": "Audit Settings from ES_CONF_YML [\"xpack.security.audit.enabled\"] should eq true",
              "run_time": 0.000824,
              "start_time": "2018-02-11 14:27:07 -0500"
            },
            {
              "status": "passed",
              "code_desc": "Audit Settings from ES_CONF_YML [\"xpack.security.audit.outputs\"] should include \"logfile\"",
              "run_time": 0.000746,
              "start_time": "2018-02-11 14:27:07 -0500"
            },
            {
              "status": "passed",
              "code_desc": "Audit Settings from ES_CONF_YML [\"xpack.security.audit.logfile.events.include\"] should contain exactly \"access_denied\", \"anonymous_access_denied\", \"authentication_failed\", \"connection_denied\", \"tampered_request\", \"run_as_denied\", and \"run_as_granted\"",
              "run_time": 0.000827,
              "start_time": "2018-02-11 14:27:07 -0500"
            },
            {
              "status": "passed",
              "code_desc": "Audit Settings from ES_CONF_YML [\"xpack.security.audit.logfile.events.exclude\"] should contain exactly \"access_granted\"",
              "run_time": 0.000739,
              "start_time": "2018-02-11 14:27:07 -0500"
            },
            {
              "status": "passed",
              "code_desc": "ES HOME directory owner should eq \"elasticsearch\"",
              "run_time": 0.000123,
              "start_time": "2018-02-11 14:27:07 -0500"
            },
            {
              "status": "passed",
              "code_desc": "ES HOME directory group should eq \"elasticsearch\"",
              "run_time": 0.000143,
              "start_time": "2018-02-11 14:27:07 -0500"
            },
            {
              "status": "passed",
              "code_desc": "ES CONF owner should eq \"elasticsearch\"",
              "run_time": 0.000101,
              "start_time": "2018-02-11 14:27:07 -0500"
            },
            {
              "status": "passed",
              "code_desc": "ES CONF group should eq \"elasticsearch\"",
              "run_time": 0.000154,
              "start_time": "2018-02-11 14:27:07 -0500"
            },
            {
              "status": "passed",
              "code_desc": "Elasticsearch Cluster https://0.0.0.0:9200 superusers should be in \"superuser\"",
              "run_time": 1.281706,
              "start_time": "2018-02-11 14:27:07 -0500"
            }
          ]
        },
        {
          "id": "V-26782",
          "title": "Applications providing information flow control must track problems\nassociated with the binding of security attributes to data.",
          "desc": "Utilize perimeter, application, centralized authentication, and\nrepository audit controls to audit the use of systems in real time with\nsufficient context.  X-Pack Security audit controls should be enabled to audit\nthe defaults of all HTTP/S based access to Elasticsearch.  All applications\nshould use HTTP/S  rather than Elasticsearch transport protocol.",
          "impact": 0.5,
          "refs": [],
          "tags": {
            "nist": [
              "AC-4 (17) (c)",
              "Rev_3"
            ],
            "severity": "medium",
            "rid": "SV-34032r1_rule",
            "gtitle": "SRG-APP-000053",
            "cci": "CCI-000224",
            "check": "Note: The following instructions use the ES_HOME environment\nvariable. See supplementary content APPENDIX-F for instructions on configuring\nES_HOME.\n\n$ cat config/elasticsearch.yml | grep xpack.security.audit\n\nCheck elasticsearch settings and documentation to determine whether designated\npersonnel are able to select which auditable events are being audited.\n\n\nAs the application administrator (shown here as 'elasticsearch'), verify the\npermissions for ES_HOME:\n\n$ ls -la ${ES_HOME?}\n\nIf anything in ES_HOME is not owned by the application administrator, this is a\nfinding.\n\nNext, as the elasticsearch administrator, run the following CURL command:\n\n\n$ curl -XGET  -H 'Content-Type: application/json' -u <TEST_USER> -p\n<TEST_CREDENTIALS> https://<elasticsearch>:9200/_xpack/security/role\n\nReview the role permissions, if any role is listed as superuser but should not\nhave that access, this is a finding.",
            "fix": "Configure elasticsearch audit settings to audit access methods.\n\nSee the official documentation for the instructions on audit configuration:\nhttps://www.elastic.co/guide/en/x-pack/current/auditing.html"
          },
          "code": "control \"V-26782\" do\n  title \"Applications providing information flow control must track problems\nassociated with the binding of security attributes to data.\"\n  desc  \"Utilize perimeter, application, centralized authentication, and\nrepository audit controls to audit the use of systems in real time with\nsufficient context.  X-Pack Security audit controls should be enabled to audit\nthe defaults of all HTTP/S based access to Elasticsearch.  All applications\nshould use HTTP/S  rather than Elasticsearch transport protocol.\"\n  impact 0.5\n  tag \"nist\": [\"AC-4 (17) (c)\", \"Rev_3\"]\n  tag \"severity\": \"medium\"\n  tag \"rid\": \"SV-34032r1_rule\"\n  tag \"gtitle\": \"SRG-APP-000053\"\n  tag \"cci\": \"CCI-000224\"\n  tag \"check\": \"Note: The following instructions use the ES_HOME environment\nvariable. See supplementary content APPENDIX-F for instructions on configuring\nES_HOME.\n\n$ cat config/elasticsearch.yml | grep xpack.security.audit\n\nCheck elasticsearch settings and documentation to determine whether designated\npersonnel are able to select which auditable events are being audited.\n\n\nAs the application administrator (shown here as 'elasticsearch'), verify the\npermissions for ES_HOME:\n\n$ ls -la ${ES_HOME?}\n\nIf anything in ES_HOME is not owned by the application administrator, this is a\nfinding.\n\nNext, as the elasticsearch administrator, run the following CURL command:\n\n\n$ curl -XGET  -H 'Content-Type: application/json' -u <TEST_USER> -p\n<TEST_CREDENTIALS> https://<elasticsearch>:9200/_xpack/security/role\n\nReview the role permissions, if any role is listed as superuser but should not\nhave that access, this is a finding.\"\n  tag \"fix\": \"Configure elasticsearch audit settings to audit access methods.\n\nSee the official documentation for the instructions on audit configuration:\nhttps://www.elastic.co/guide/en/x-pack/current/auditing.html\"\n\n  begin\n\n    es_handle = es_helper(url:\"https://#{ELASTIC_IP}:#{ELASTIC_PORT}\",\n                    username: ES_ADMIN,\n                    password: ES_PASS,\n                    ssl_verify: SSL_VERIFY )\n\n    describe \"No nodes found\" do\n      subject { es_handle.nodes.nil? }\n      it { should_not be_truthy }\n    end if es_handle.nodes.nil?\n\n    es_handle.nodes.each do |node|\n      describe \"Audit Settings for Node: #{node.name}\" do\n        subject { node.audit }\n        its('enabled') { should eq 'true' }\n        its('outputs') { should include 'logfile' }\n        its('logfile.events.include') { should match_array ES_INCLUDED_LOGEVENTS }\n        its('logfile.events.exclude') { should match_array ES_EXCLUDED_LOGEVENTS }\n      end\n    end unless es_handle.nodes.nil?\n\n    describe \"Audit Settings from ES_CONF_YML\" do\n      subject { yaml(ELASTICSEARCH_CONF) }\n      its(['xpack.security.audit.enabled']) { should eq true }\n      its(['xpack.security.audit.outputs']) { should include 'logfile' }\n      its(['xpack.security.audit.logfile.events.include']) { should match_array ES_INCLUDED_LOGEVENTS }\n      its(['xpack.security.audit.logfile.events.exclude']) { should match_array ES_EXCLUDED_LOGEVENTS }\n    end\n\n    describe \"ES HOME directory\" do\n      subject { file(ES_HOME) }\n      its('owner') { should eq ES_OWNER }\n      its('group') { should eq ES_GROUP }\n    end\n\n    describe \"ES CONF\" do\n      subject { file(ELASTICSEARCH_CONF) }\n      its('owner') { should eq ES_OWNER }\n      its('group') { should eq ES_GROUP }\n    end\n\n    describe es_handle do\n      its('superusers') { should be_in DOCUMENTED_SUPER_ROLES}\n    end\n    \n  rescue Exception => msg\n    describe \"Exception: #{msg}\" do\n      it { should be_nil}\n    end\n  end\nend\n",
          "source_location": {
            "line": 77,
            "ref": "../elasticsearch-inspec/controls/audit+home+role/V-26782.rb"
          },
          "results": [
            {
              "status": "passed",
              "code_desc": "Audit Settings for Node: package-centos-72 enabled should eq \"true\"",
              "run_time": 0.000107,
              "start_time": "2018-02-11 14:27:09 -0500"
            },
            {
              "status": "passed",
              "code_desc": "Audit Settings for Node: package-centos-72 outputs should include \"logfile\"",
              "run_time": 0.00009,
              "start_time": "2018-02-11 14:27:09 -0500"
            },
            {
              "status": "passed",
              "code_desc": "Audit Settings for Node: package-centos-72 logfile.events.include should contain exactly \"access_denied\", \"anonymous_access_denied\", \"authentication_failed\", \"connection_denied\", \"tampered_request\", \"run_as_denied\", and \"run_as_granted\"",
              "run_time": 0.00013,
              "start_time": "2018-02-11 14:27:09 -0500"
            },
            {
              "status": "passed",
              "code_desc": "Audit Settings for Node: package-centos-72 logfile.events.exclude should contain exactly \"access_granted\"",
              "run_time": 0.000106,
              "start_time": "2018-02-11 14:27:09 -0500"
            },
            {
              "status": "passed",
              "code_desc": "Audit Settings from ES_CONF_YML [\"xpack.security.audit.enabled\"] should eq true",
              "run_time": 0.000547,
              "start_time": "2018-02-11 14:27:09 -0500"
            },
            {
              "status": "passed",
              "code_desc": "Audit Settings from ES_CONF_YML [\"xpack.security.audit.outputs\"] should include \"logfile\"",
              "run_time": 0.000475,
              "start_time": "2018-02-11 14:27:09 -0500"
            },
            {
              "status": "passed",
              "code_desc": "Audit Settings from ES_CONF_YML [\"xpack.security.audit.logfile.events.include\"] should contain exactly \"access_denied\", \"anonymous_access_denied\", \"authentication_failed\", \"connection_denied\", \"tampered_request\", \"run_as_denied\", and \"run_as_granted\"",
              "run_time": 0.000514,
              "start_time": "2018-02-11 14:27:09 -0500"
            },
            {
              "status": "passed",
              "code_desc": "Audit Settings from ES_CONF_YML [\"xpack.security.audit.logfile.events.exclude\"] should contain exactly \"access_granted\"",
              "run_time": 0.000479,
              "start_time": "2018-02-11 14:27:09 -0500"
            },
            {
              "status": "passed",
              "code_desc": "ES HOME directory owner should eq \"elasticsearch\"",
              "run_time": 0.000113,
              "start_time": "2018-02-11 14:27:09 -0500"
            },
            {
              "status": "passed",
              "code_desc": "ES HOME directory group should eq \"elasticsearch\"",
              "run_time": 0.000073,
              "start_time": "2018-02-11 14:27:09 -0500"
            },
            {
              "status": "passed",
              "code_desc": "ES CONF owner should eq \"elasticsearch\"",
              "run_time": 0.000074,
              "start_time": "2018-02-11 14:27:09 -0500"
            },
            {
              "status": "passed",
              "code_desc": "ES CONF group should eq \"elasticsearch\"",
              "run_time": 0.00007,
              "start_time": "2018-02-11 14:27:09 -0500"
            },
            {
              "status": "passed",
              "code_desc": "Elasticsearch Cluster https://0.0.0.0:9200 superusers should be in \"superuser\"",
              "run_time": 1.276001,
              "start_time": "2018-02-11 14:27:09 -0500"
            }
          ]
        },
        {
          "id": "V-26705",
          "title": "Applications must support the requirement to automatically audit\naccount creation.",
          "desc": "Utilize perimeter, application, centralized authentication, and\nrepository audit controls to audit the use of systems in real time with\nsufficient context.  X-Pack Security audit controls should be enabled to audit\nthe defaults of all HTTP/S based access to Elasticsearch.  All applications\nshould use HTTP/S  rather than Elasticsearch transport protocol.",
          "impact": 0.5,
          "refs": [],
          "tags": {
            "nist": [
              "AC-2 (4)",
              "Rev_4"
            ],
            "severity": "medium",
            "rid": "SV-33948r1_rule",
            "gtitle": "SRG-APP-000026",
            "cci": "CCI-000018",
            "check": "Note: The following instructions use the ES_HOME environment\nvariable. See supplementary content APPENDIX-F for instructions on configuring\nES_HOME.\n\n$ cat config/elasticsearch.yml | grep xpack.security.audit.outputs\n\n\nCheck elasticsearch settings and documentation to determine whether designated\npersonnel are able to select which auditable events are being audited.\n\n\nAs the application administrator (shown here as 'elasticsearch'), verify the\npermissions for ES_HOME:\n\n$ ls -la ${ES_HOME?}\n\nIf anything in ES_HOME is not owned by the application administrator, this is a\nfinding.\n\nNext, as the elasticsearch administrator, run the following CURL command:\n\n\n$ curl -XGET  -H 'Content-Type: application/json' -u <TEST_USER> -p\n<TEST_CREDENTIALS> https://<elasticsearch>:9200/_xpack/security/role\n\nReview the role permissions, if any role is listed as superuser but should not\nhave that access, this is a finding.",
            "fix": "Configure elasticsearch audit settings to audit account creation.\n\n\nSee the official documentation for the instructions on audit configuration:\nhttps://www.elastic.co/guide/en/x-pack/current/auditing.html"
          },
          "code": "control \"V-26705\" do\n  title \"Applications must support the requirement to automatically audit\naccount creation.\"\n  desc  \"Utilize perimeter, application, centralized authentication, and\nrepository audit controls to audit the use of systems in real time with\nsufficient context.  X-Pack Security audit controls should be enabled to audit\nthe defaults of all HTTP/S based access to Elasticsearch.  All applications\nshould use HTTP/S  rather than Elasticsearch transport protocol.\"\n  impact 0.5\n  tag \"nist\": [\"AC-2 (4)\", \"Rev_4\"]\n  tag \"severity\": \"medium\"\n  tag \"rid\": \"SV-33948r1_rule\"\n  tag \"gtitle\": \"SRG-APP-000026\"\n  tag \"cci\": \"CCI-000018\"\n  tag \"check\": \"Note: The following instructions use the ES_HOME environment\nvariable. See supplementary content APPENDIX-F for instructions on configuring\nES_HOME.\n\n$ cat config/elasticsearch.yml | grep xpack.security.audit.outputs\n\n\nCheck elasticsearch settings and documentation to determine whether designated\npersonnel are able to select which auditable events are being audited.\n\n\nAs the application administrator (shown here as 'elasticsearch'), verify the\npermissions for ES_HOME:\n\n$ ls -la ${ES_HOME?}\n\nIf anything in ES_HOME is not owned by the application administrator, this is a\nfinding.\n\nNext, as the elasticsearch administrator, run the following CURL command:\n\n\n$ curl -XGET  -H 'Content-Type: application/json' -u <TEST_USER> -p\n<TEST_CREDENTIALS> https://<elasticsearch>:9200/_xpack/security/role\n\nReview the role permissions, if any role is listed as superuser but should not\nhave that access, this is a finding.\"\n  tag \"fix\": \"Configure elasticsearch audit settings to audit account creation.\n\n\nSee the official documentation for the instructions on audit configuration:\nhttps://www.elastic.co/guide/en/x-pack/current/auditing.html\"\n\n  begin\n\n    es_handle = es_helper(url:\"https://#{ELASTIC_IP}:#{ELASTIC_PORT}\",\n                    username: ES_ADMIN,\n                    password: ES_PASS,\n                    ssl_verify: SSL_VERIFY )\n\n    describe \"No nodes found\" do\n      subject { es_handle.nodes.nil? }\n      it { should_not be_truthy }\n    end if es_handle.nodes.nil?\n\n    es_handle.nodes.each do |node|\n      describe \"Audit Settings for Node: #{node.name}\" do\n        subject { node.audit }\n        its('enabled') { should eq 'true' }\n        its('outputs') { should include 'logfile' }\n        its('logfile.events.include') { should match_array ES_INCLUDED_LOGEVENTS }\n        its('logfile.events.exclude') { should match_array ES_EXCLUDED_LOGEVENTS }\n      end\n    end unless es_handle.nodes.nil?\n\n    describe \"Audit Settings from ES_CONF_YML\" do\n      subject { yaml(ELASTICSEARCH_CONF) }\n      its(['xpack.security.audit.enabled']) { should eq true }\n      its(['xpack.security.audit.outputs']) { should include 'logfile' }\n      its(['xpack.security.audit.logfile.events.include']) { should match_array ES_INCLUDED_LOGEVENTS }\n      its(['xpack.security.audit.logfile.events.exclude']) { should match_array ES_EXCLUDED_LOGEVENTS }\n    end\n\n    describe \"ES HOME directory\" do\n      subject { file(ES_HOME) }\n      its('owner') { should eq ES_OWNER }\n      its('group') { should eq ES_GROUP }\n    end\n\n    describe \"ES CONF\" do\n      subject { file(ELASTICSEARCH_CONF) }\n      its('owner') { should eq ES_OWNER }\n      its('group') { should eq ES_GROUP }\n    end\n\n    describe es_handle do\n      its('superusers') { should be_in DOCUMENTED_SUPER_ROLES}\n    end\n    \n  rescue Exception => msg\n    describe \"Exception: #{msg}\" do\n      it { should be_nil}\n    end\n  end\nend",
          "source_location": {
            "line": 77,
            "ref": "../elasticsearch-inspec/controls/audit+home+role/V-26705.rb"
          },
          "results": [
            {
              "status": "passed",
              "code_desc": "Audit Settings for Node: package-centos-72 enabled should eq \"true\"",
              "run_time": 0.000131,
              "start_time": "2018-02-11 14:27:10 -0500"
            },
            {
              "status": "passed",
              "code_desc": "Audit Settings for Node: package-centos-72 outputs should include \"logfile\"",
              "run_time": 0.000159,
              "start_time": "2018-02-11 14:27:10 -0500"
            },
            {
              "status": "passed",
              "code_desc": "Audit Settings for Node: package-centos-72 logfile.events.include should contain exactly \"access_denied\", \"anonymous_access_denied\", \"authentication_failed\", \"connection_denied\", \"tampered_request\", \"run_as_denied\", and \"run_as_granted\"",
              "run_time": 0.000151,
              "start_time": "2018-02-11 14:27:10 -0500"
            },
            {
              "status": "passed",
              "code_desc": "Audit Settings for Node: package-centos-72 logfile.events.exclude should contain exactly \"access_granted\"",
              "run_time": 0.000089,
              "start_time": "2018-02-11 14:27:10 -0500"
            },
            {
              "status": "passed",
              "code_desc": "Audit Settings from ES_CONF_YML [\"xpack.security.audit.enabled\"] should eq true",
              "run_time": 0.00061,
              "start_time": "2018-02-11 14:27:10 -0500"
            },
            {
              "status": "passed",
              "code_desc": "Audit Settings from ES_CONF_YML [\"xpack.security.audit.outputs\"] should include \"logfile\"",
              "run_time": 0.00051,
              "start_time": "2018-02-11 14:27:10 -0500"
            },
            {
              "status": "passed",
              "code_desc": "Audit Settings from ES_CONF_YML [\"xpack.security.audit.logfile.events.include\"] should contain exactly \"access_denied\", \"anonymous_access_denied\", \"authentication_failed\", \"connection_denied\", \"tampered_request\", \"run_as_denied\", and \"run_as_granted\"",
              "run_time": 0.000535,
              "start_time": "2018-02-11 14:27:10 -0500"
            },
            {
              "status": "passed",
              "code_desc": "Audit Settings from ES_CONF_YML [\"xpack.security.audit.logfile.events.exclude\"] should contain exactly \"access_granted\"",
              "run_time": 0.000539,
              "start_time": "2018-02-11 14:27:10 -0500"
            },
            {
              "status": "passed",
              "code_desc": "ES HOME directory owner should eq \"elasticsearch\"",
              "run_time": 0.000095,
              "start_time": "2018-02-11 14:27:10 -0500"
            },
            {
              "status": "passed",
              "code_desc": "ES HOME directory group should eq \"elasticsearch\"",
              "run_time": 0.000078,
              "start_time": "2018-02-11 14:27:10 -0500"
            },
            {
              "status": "passed",
              "code_desc": "ES CONF owner should eq \"elasticsearch\"",
              "run_time": 0.000078,
              "start_time": "2018-02-11 14:27:10 -0500"
            },
            {
              "status": "passed",
              "code_desc": "ES CONF group should eq \"elasticsearch\"",
              "run_time": 0.000099,
              "start_time": "2018-02-11 14:27:10 -0500"
            },
            {
              "status": "passed",
              "code_desc": "Elasticsearch Cluster https://0.0.0.0:9200 superusers should be in \"superuser\"",
              "run_time": 1.286426,
              "start_time": "2018-02-11 14:27:10 -0500"
            }
          ]
        },
        {
          "id": "V-26933",
          "title": "The application must protect the audit records generated as a result\nof remote accesses to privileged accounts and the execution of privileged\nfunctions.",
          "desc": "Utilize perimeter, application, centralized authentication, and\nrepository audit controls to audit the use of systems in real time with\nsufficient context.  X-Pack Security audit controls should be enabled to audit\nthe defaults of all HTTP/S based access to Elasticsearch.  All applications\nshould use HTTP/S  rather than Elasticsearch transport protocol.",
          "impact": 0.5,
          "refs": [],
          "tags": {
            "nist": [
              "AU-9 (4) (b)",
              "Rev_3"
            ],
            "severity": "medium",
            "rid": "SV-34213r1_rule",
            "gtitle": "SRG-APP-000127",
            "cci": "CCI-001352",
            "check": "Note: The following instructions use the ES_HOME environment\nvariable. See supplementary content APPENDIX-F for instructions on configuring\nES_HOME.\n\n$ cat config/elasticsearch.yml | grep xpack.security.audit.outputs\n\n\nCheck elasticsearch settings and documentation to determine whether designated\npersonnel are able to select which auditable events are being audited.\n\n\nAs the application administrator (shown here as 'elasticsearch'), verify the\npermissions for ES_HOME:\n\n$ ls -la ${ES_HOME?}\n\nIf anything in ES_HOME is not owned by the application administrator, this is a\nfinding.\n\nNext, as the elasticsearch administrator, run the following CURL command:\n\n\n$ curl -XGET  -H 'Content-Type: application/json' -u <TEST_USER> -p\n<TEST_CREDENTIALS> https://<elasticsearch>:9200/_xpack/security/role\n\nReview the role permissions, if any role is listed as superuser but should not\nhave that access, this is a finding.",
            "fix": "Configure elasticsearch audit settings to audit account creation.\n\n\nSee the official documentation for the instructions on audit configuration:\nhttps://www.elastic.co/guide/en/x-pack/current/auditing.html"
          },
          "code": "control \"V-26933\" do\n  title \"The application must protect the audit records generated as a result\nof remote accesses to privileged accounts and the execution of privileged\nfunctions.\"\n  desc  \"Utilize perimeter, application, centralized authentication, and\nrepository audit controls to audit the use of systems in real time with\nsufficient context.  X-Pack Security audit controls should be enabled to audit\nthe defaults of all HTTP/S based access to Elasticsearch.  All applications\nshould use HTTP/S  rather than Elasticsearch transport protocol.\"\n  impact 0.5\n  tag \"nist\": [\"AU-9 (4) (b)\", \"Rev_3\"]\n  tag \"severity\": \"medium\"\n  tag \"rid\": \"SV-34213r1_rule\"\n  tag \"gtitle\": \"SRG-APP-000127\"\n  tag \"cci\": \"CCI-001352\"\n  tag \"check\": \"Note: The following instructions use the ES_HOME environment\nvariable. See supplementary content APPENDIX-F for instructions on configuring\nES_HOME.\n\n$ cat config/elasticsearch.yml | grep xpack.security.audit.outputs\n\n\nCheck elasticsearch settings and documentation to determine whether designated\npersonnel are able to select which auditable events are being audited.\n\n\nAs the application administrator (shown here as 'elasticsearch'), verify the\npermissions for ES_HOME:\n\n$ ls -la ${ES_HOME?}\n\nIf anything in ES_HOME is not owned by the application administrator, this is a\nfinding.\n\nNext, as the elasticsearch administrator, run the following CURL command:\n\n\n$ curl -XGET  -H 'Content-Type: application/json' -u <TEST_USER> -p\n<TEST_CREDENTIALS> https://<elasticsearch>:9200/_xpack/security/role\n\nReview the role permissions, if any role is listed as superuser but should not\nhave that access, this is a finding.\"\n  tag \"fix\": \"Configure elasticsearch audit settings to audit account creation.\n\n\nSee the official documentation for the instructions on audit configuration:\nhttps://www.elastic.co/guide/en/x-pack/current/auditing.html\"\n\n  begin\n\n    es_handle = es_helper(url:\"https://#{ELASTIC_IP}:#{ELASTIC_PORT}\",\n                    username: ES_ADMIN,\n                    password: ES_PASS,\n                    ssl_verify: SSL_VERIFY )\n\n    describe \"No nodes found\" do\n      subject { es_handle.nodes.nil? }\n      it { should_not be_truthy }\n    end if es_handle.nodes.nil?\n\n    es_handle.nodes.each do |node|\n      describe \"Audit Settings for Node: #{node.name}\" do\n        subject { node.audit }\n        its('enabled') { should eq 'true' }\n        its('outputs') { should include 'logfile' }\n        its('logfile.events.include') { should match_array ES_INCLUDED_LOGEVENTS }\n        its('logfile.events.exclude') { should match_array ES_EXCLUDED_LOGEVENTS }\n      end\n    end unless es_handle.nodes.nil?\n\n    describe \"Audit Settings from ES_CONF_YML\" do\n      subject { yaml(ELASTICSEARCH_CONF) }\n      its(['xpack.security.audit.enabled']) { should eq true }\n      its(['xpack.security.audit.outputs']) { should include 'logfile' }\n      its(['xpack.security.audit.logfile.events.include']) { should match_array ES_INCLUDED_LOGEVENTS }\n      its(['xpack.security.audit.logfile.events.exclude']) { should match_array ES_EXCLUDED_LOGEVENTS }\n    end\n\n    describe \"ES HOME directory\" do\n      subject { file(ES_HOME) }\n      its('owner') { should eq ES_OWNER }\n      its('group') { should eq ES_GROUP }\n    end\n\n    describe \"ES CONF\" do\n      subject { file(ELASTICSEARCH_CONF) }\n      its('owner') { should eq ES_OWNER }\n      its('group') { should eq ES_GROUP }\n    end\n\n    describe es_handle do\n      its('superusers') { should be_in DOCUMENTED_SUPER_ROLES}\n    end\n    \n  rescue Exception => msg\n    describe \"Exception: #{msg}\" do\n      it { should be_nil}\n    end\n  end\nend",
          "source_location": {
            "line": 78,
            "ref": "../elasticsearch-inspec/controls/audit+home+role/V-26933.rb"
          },
          "results": [
            {
              "status": "passed",
              "code_desc": "Audit Settings for Node: package-centos-72 enabled should eq \"true\"",
              "run_time": 0.000118,
              "start_time": "2018-02-11 14:27:11 -0500"
            },
            {
              "status": "passed",
              "code_desc": "Audit Settings for Node: package-centos-72 outputs should include \"logfile\"",
              "run_time": 0.000106,
              "start_time": "2018-02-11 14:27:11 -0500"
            },
            {
              "status": "passed",
              "code_desc": "Audit Settings for Node: package-centos-72 logfile.events.include should contain exactly \"access_denied\", \"anonymous_access_denied\", \"authentication_failed\", \"connection_denied\", \"tampered_request\", \"run_as_denied\", and \"run_as_granted\"",
              "run_time": 0.000154,
              "start_time": "2018-02-11 14:27:11 -0500"
            },
            {
              "status": "passed",
              "code_desc": "Audit Settings for Node: package-centos-72 logfile.events.exclude should contain exactly \"access_granted\"",
              "run_time": 0.000077,
              "start_time": "2018-02-11 14:27:11 -0500"
            },
            {
              "status": "passed",
              "code_desc": "Audit Settings from ES_CONF_YML [\"xpack.security.audit.enabled\"] should eq true",
              "run_time": 0.00056,
              "start_time": "2018-02-11 14:27:11 -0500"
            },
            {
              "status": "passed",
              "code_desc": "Audit Settings from ES_CONF_YML [\"xpack.security.audit.outputs\"] should include \"logfile\"",
              "run_time": 0.000767,
              "start_time": "2018-02-11 14:27:11 -0500"
            },
            {
              "status": "passed",
              "code_desc": "Audit Settings from ES_CONF_YML [\"xpack.security.audit.logfile.events.include\"] should contain exactly \"access_denied\", \"anonymous_access_denied\", \"authentication_failed\", \"connection_denied\", \"tampered_request\", \"run_as_denied\", and \"run_as_granted\"",
              "run_time": 0.001171,
              "start_time": "2018-02-11 14:27:11 -0500"
            },
            {
              "status": "passed",
              "code_desc": "Audit Settings from ES_CONF_YML [\"xpack.security.audit.logfile.events.exclude\"] should contain exactly \"access_granted\"",
              "run_time": 0.000871,
              "start_time": "2018-02-11 14:27:11 -0500"
            },
            {
              "status": "passed",
              "code_desc": "ES HOME directory owner should eq \"elasticsearch\"",
              "run_time": 0.000141,
              "start_time": "2018-02-11 14:27:11 -0500"
            },
            {
              "status": "passed",
              "code_desc": "ES HOME directory group should eq \"elasticsearch\"",
              "run_time": 0.000078,
              "start_time": "2018-02-11 14:27:11 -0500"
            },
            {
              "status": "passed",
              "code_desc": "ES CONF owner should eq \"elasticsearch\"",
              "run_time": 0.000074,
              "start_time": "2018-02-11 14:27:11 -0500"
            },
            {
              "status": "passed",
              "code_desc": "ES CONF group should eq \"elasticsearch\"",
              "run_time": 0.000098,
              "start_time": "2018-02-11 14:27:11 -0500"
            },
            {
              "status": "passed",
              "code_desc": "Elasticsearch Cluster https://0.0.0.0:9200 superusers should be in \"superuser\"",
              "run_time": 1.595182,
              "start_time": "2018-02-11 14:27:11 -0500"
            }
          ]
        },
        {
          "id": "V-27164",
          "title": "The application must protect audit tools from unauthorized\nmodification.",
          "desc": "Utilize perimeter, application, centralized authentication, and\nrepository audit controls to audit the use of systems in real time with\nsufficient context.  X-Pack Security audit controls should be enabled to audit\nthe defaults of all HTTP/S based access to Elasticsearch.  All applications\nshould use HTTP/S  rather than Elasticsearch transport protocol. Implement OS\nlevel access controls on audit logs. Move audit logs off of elasticsearch\nsystems and into central audit logging solution.",
          "impact": 0.5,
          "refs": [],
          "tags": {
            "nist": [
              "AU-9",
              "Rev_4"
            ],
            "severity": "medium",
            "rid": "SV-34463r1_rule",
            "gtitle": "SRG-APP-000122",
            "cci": "CCI-001494",
            "check": "Note: The following instructions use the ES_HOME environment\nvariable. See supplementary content APPENDIX-F for instructions on configuring\nES_HOME.\n\n$ cat config/elasticsearch.yml | grep xpack.security.audit.outputs\n\n\nCheck elasticsearch settings and documentation to determine whether designated\npersonnel are able to access audit settings.\n\nAs the application administrator (shown here as 'elasticsearch'), verify the\npermissions for ES_HOME:\n\n$ ls -la ${ES_HOME?}\n\nIf anything in ES_HOME is not owned by the application administrator, this is a\nfinding.\n\nNext, as the elasticsearch administrator, run the following CURL command:\n\n\n$ curl -XGET  -H 'Content-Type: application/json' -u <TEST_USER> -p\n<TEST_CREDENTIALS> https://<elasticsearch>:9200/_xpack/security/role\n\nReview the role permissions, if any role is listed as superuser but should not\nhave that access, this is a finding.",
            "fix": "Configure elasticsearch audit settings to be controlled by\nauthorized users.\n\nSee the official documentation for the instructions on audit configuration:\nhttps://www.elastic.co/guide/en/x-pack/current/auditing.html"
          },
          "code": "control \"V-27164\" do\n  title \"The application must protect audit tools from unauthorized\nmodification.\"\n  desc  \"Utilize perimeter, application, centralized authentication, and\nrepository audit controls to audit the use of systems in real time with\nsufficient context.  X-Pack Security audit controls should be enabled to audit\nthe defaults of all HTTP/S based access to Elasticsearch.  All applications\nshould use HTTP/S  rather than Elasticsearch transport protocol. Implement OS\nlevel access controls on audit logs. Move audit logs off of elasticsearch\nsystems and into central audit logging solution.\"\n  impact 0.5\n  tag \"nist\": [\"AU-9\", \"Rev_4\"]\n  tag \"severity\": \"medium\"\n  tag \"rid\": \"SV-34463r1_rule\"\n  tag \"gtitle\": \"SRG-APP-000122\"\n  tag \"cci\": \"CCI-001494\"\n  tag \"check\": \"Note: The following instructions use the ES_HOME environment\nvariable. See supplementary content APPENDIX-F for instructions on configuring\nES_HOME.\n\n$ cat config/elasticsearch.yml | grep xpack.security.audit.outputs\n\n\nCheck elasticsearch settings and documentation to determine whether designated\npersonnel are able to access audit settings.\n\nAs the application administrator (shown here as 'elasticsearch'), verify the\npermissions for ES_HOME:\n\n$ ls -la ${ES_HOME?}\n\nIf anything in ES_HOME is not owned by the application administrator, this is a\nfinding.\n\nNext, as the elasticsearch administrator, run the following CURL command:\n\n\n$ curl -XGET  -H 'Content-Type: application/json' -u <TEST_USER> -p\n<TEST_CREDENTIALS> https://<elasticsearch>:9200/_xpack/security/role\n\nReview the role permissions, if any role is listed as superuser but should not\nhave that access, this is a finding.\"\n  tag \"fix\": \"Configure elasticsearch audit settings to be controlled by\nauthorized users.\n\nSee the official documentation for the instructions on audit configuration:\nhttps://www.elastic.co/guide/en/x-pack/current/auditing.html\"\n\n  begin\n\n    es_handle = es_helper(url:\"https://#{ELASTIC_IP}:#{ELASTIC_PORT}\",\n                    username: ES_ADMIN,\n                    password: ES_PASS,\n                    ssl_verify: SSL_VERIFY )\n\n    describe \"No nodes found\" do\n      subject { es_handle.nodes.nil? }\n      it { should_not be_truthy }\n    end if es_handle.nodes.nil?\n\n    es_handle.nodes.each do |node|\n      describe \"Audit Settings for Node: #{node.name}\" do\n        subject { node.audit }\n        its('enabled') { should eq 'true' }\n        its('outputs') { should include 'logfile' }\n        its('logfile.events.include') { should match_array ES_INCLUDED_LOGEVENTS }\n        its('logfile.events.exclude') { should match_array ES_EXCLUDED_LOGEVENTS }\n      end\n    end unless es_handle.nodes.nil?\n\n    describe \"Audit Settings from ES_CONF_YML\" do\n      subject { yaml(ELASTICSEARCH_CONF) }\n      its(['xpack.security.audit.enabled']) { should eq true }\n      its(['xpack.security.audit.outputs']) { should include 'logfile' }\n      its(['xpack.security.audit.logfile.events.include']) { should match_array ES_INCLUDED_LOGEVENTS }\n      its(['xpack.security.audit.logfile.events.exclude']) { should match_array ES_EXCLUDED_LOGEVENTS }\n    end\n\n    describe \"ES HOME directory\" do\n      subject { file(ES_HOME) }\n      its('owner') { should eq ES_OWNER }\n      its('group') { should eq ES_GROUP }\n    end\n\n    describe \"ES CONF\" do\n      subject { file(ELASTICSEARCH_CONF) }\n      its('owner') { should eq ES_OWNER }\n      its('group') { should eq ES_GROUP }\n    end\n\n    describe es_handle do\n      its('superusers') { should be_in DOCUMENTED_SUPER_ROLES}\n    end\n    \n  rescue Exception => msg\n    describe \"Exception: #{msg}\" do\n      it { should be_nil}\n    end\n  end\nend",
          "source_location": {
            "line": 78,
            "ref": "../elasticsearch-inspec/controls/audit+home+role/V-27164.rb"
          },
          "results": [
            {
              "status": "passed",
              "code_desc": "Audit Settings for Node: package-centos-72 enabled should eq \"true\"",
              "run_time": 0.000103,
              "start_time": "2018-02-11 14:27:13 -0500"
            },
            {
              "status": "passed",
              "code_desc": "Audit Settings for Node: package-centos-72 outputs should include \"logfile\"",
              "run_time": 0.000109,
              "start_time": "2018-02-11 14:27:13 -0500"
            },
            {
              "status": "passed",
              "code_desc": "Audit Settings for Node: package-centos-72 logfile.events.include should contain exactly \"access_denied\", \"anonymous_access_denied\", \"authentication_failed\", \"connection_denied\", \"tampered_request\", \"run_as_denied\", and \"run_as_granted\"",
              "run_time": 0.000146,
              "start_time": "2018-02-11 14:27:13 -0500"
            },
            {
              "status": "passed",
              "code_desc": "Audit Settings for Node: package-centos-72 logfile.events.exclude should contain exactly \"access_granted\"",
              "run_time": 0.000092,
              "start_time": "2018-02-11 14:27:13 -0500"
            },
            {
              "status": "passed",
              "code_desc": "Audit Settings from ES_CONF_YML [\"xpack.security.audit.enabled\"] should eq true",
              "run_time": 0.000588,
              "start_time": "2018-02-11 14:27:13 -0500"
            },
            {
              "status": "passed",
              "code_desc": "Audit Settings from ES_CONF_YML [\"xpack.security.audit.outputs\"] should include \"logfile\"",
              "run_time": 0.000517,
              "start_time": "2018-02-11 14:27:13 -0500"
            },
            {
              "status": "passed",
              "code_desc": "Audit Settings from ES_CONF_YML [\"xpack.security.audit.logfile.events.include\"] should contain exactly \"access_denied\", \"anonymous_access_denied\", \"authentication_failed\", \"connection_denied\", \"tampered_request\", \"run_as_denied\", and \"run_as_granted\"",
              "run_time": 0.000786,
              "start_time": "2018-02-11 14:27:13 -0500"
            },
            {
              "status": "passed",
              "code_desc": "Audit Settings from ES_CONF_YML [\"xpack.security.audit.logfile.events.exclude\"] should contain exactly \"access_granted\"",
              "run_time": 0.000821,
              "start_time": "2018-02-11 14:27:13 -0500"
            },
            {
              "status": "passed",
              "code_desc": "ES HOME directory owner should eq \"elasticsearch\"",
              "run_time": 0.000191,
              "start_time": "2018-02-11 14:27:13 -0500"
            },
            {
              "status": "passed",
              "code_desc": "ES HOME directory group should eq \"elasticsearch\"",
              "run_time": 0.000131,
              "start_time": "2018-02-11 14:27:13 -0500"
            },
            {
              "status": "passed",
              "code_desc": "ES CONF owner should eq \"elasticsearch\"",
              "run_time": 0.000105,
              "start_time": "2018-02-11 14:27:13 -0500"
            },
            {
              "status": "passed",
              "code_desc": "ES CONF group should eq \"elasticsearch\"",
              "run_time": 0.000078,
              "start_time": "2018-02-11 14:27:13 -0500"
            },
            {
              "status": "passed",
              "code_desc": "Elasticsearch Cluster https://0.0.0.0:9200 superusers should be in \"superuser\"",
              "run_time": 1.568589,
              "start_time": "2018-02-11 14:27:13 -0500"
            }
          ]
        },
        {
          "id": "V-26975",
          "title": "The application must use multifactor authentication for network access\nto non-privileged accounts.",
          "desc": "Within X-Pack Security, a Custom Realm can be implemented that\nfulfills multifactor authentication. Multifactor checks can be integrated\nwithin the single custom realm.",
          "impact": 0.5,
          "refs": [],
          "tags": {
            "nist": [
              "IA-2 (2)",
              "Rev_4"
            ],
            "severity": "medium",
            "rid": "SV-34263r1_rule",
            "gtitle": "SRG-APP-000150",
            "cci": "CCI-000766",
            "check": "Guidance in Appendix B - System accounts cannot be disabled and\nelasticsearch does not enforce multifactor authentication.\n\nElasticsearch only supports PKI for multifactor authentication; to ensure PKI\nis enabled, verify the following settings.\n\n$ cat config/elasticsearch.yml | grep -A 6 -B 6 'type: \\?pki'\n\n xpack:\n  security:\n    authc:\n      realms:\n        pki1:\n          type: pki\n          username_pattern: 'EMAILADDRESS=(.*?)(?:,|$)'\n\nIf these settings are not correct or missing, this is a finding.\n\n",
            "fix": "Configure elasticsearch realms settings to point to\norganizational supported authentication mechanism\n\nSee the official documentation for the instructions on realm configuration:\nhttps://www.elastic.co/guide/en/x-pack/current/_how_authentication_works.html"
          },
          "code": "control \"V-26975\" do\n  title \"The application must use multifactor authentication for network access\nto non-privileged accounts.\"\n  desc  \"Within X-Pack Security, a Custom Realm can be implemented that\nfulfills multifactor authentication. Multifactor checks can be integrated\nwithin the single custom realm.\"\n  impact 0.5\n  tag \"nist\": [\"IA-2 (2)\", \"Rev_4\"]\n  tag \"severity\": \"medium\"\n  tag \"rid\": \"SV-34263r1_rule\"\n  tag \"gtitle\": \"SRG-APP-000150\"\n  tag \"cci\": \"CCI-000766\"\n  tag \"check\": \"Guidance in Appendix B - System accounts cannot be disabled and\nelasticsearch does not enforce multifactor authentication.\n\nElasticsearch only supports PKI for multifactor authentication; to ensure PKI\nis enabled, verify the following settings.\n\n$ cat config/elasticsearch.yml | grep -A 6 -B 6 'type: \\\\?pki'\n\n xpack:\n  security:\n    authc:\n      realms:\n        pki1:\n          type: pki\n          username_pattern: 'EMAILADDRESS=(.*?)(?:,|$)'\n\nIf these settings are not correct or missing, this is a finding.\n\n\"\n  tag \"fix\": \"Configure elasticsearch realms settings to point to\norganizational supported authentication mechanism\n\nSee the official documentation for the instructions on realm configuration:\nhttps://www.elastic.co/guide/en/x-pack/current/_how_authentication_works.html\"\n\n  begin\n\n    es_handle = es_helper(url:\"https://#{ELASTIC_IP}:#{ELASTIC_PORT}\",\n                    username: ES_ADMIN,\n                    password: ES_PASS,\n                    ssl_verify: SSL_VERIFY )\n\n    describe \"No nodes found\" do\n      subject { es_handle.nodes.nil? }\n      it { should_not be_truthy }\n    end if es_handle.nodes.nil?\n\n\n    es_handle.nodes.each do |node|\n      describe \"Authentication methods includes PKI for Node: #{node.name}\" do\n        subject { node }\n        its('authc_method') { should include 'pki' }\n      end\n    end unless es_handle.nodes.nil?\n\n    es_handle.nodes.each do |node|\n      describe.one do\n        node.authc_realm.keys.each do |auth_method|\n          describe \"PKI Settings for Node: #{node.name}\" do\n            subject { node.authc_realm[auth_method] }\n            its ('order') { should_not be_nil }\n            its ('username_pattern') { should_not be_nil }\n          end if node.authc_realm[auth_method].type.eql?('pki')\n        end\n      end\n    end unless es_handle.nodes.nil?\n\n  rescue Exception => msg\n    describe \"Exception: #{msg}\" do\n      it { should be_nil}\n    end\n  end\nend\n",
          "source_location": {
            "line": 35,
            "ref": "../elasticsearch-inspec/controls/pki/V-26975.rb"
          },
          "results": [
            {
              "status": "passed",
              "code_desc": "Authentication methods includes PKI for Node: package-centos-72 authc_method should include \"pki\"",
              "run_time": 0.000155,
              "start_time": "2018-02-11 14:27:14 -0500"
            },
            {
              "status": "passed",
              "code_desc": "PKI Settings for Node: package-centos-72 order should not be nil",
              "run_time": 0.000079,
              "start_time": "2018-02-11 14:27:14 -0500"
            },
            {
              "status": "passed",
              "code_desc": "PKI Settings for Node: package-centos-72 username_pattern should not be nil",
              "run_time": 0.000057,
              "start_time": "2018-02-11 14:27:14 -0500"
            }
          ]
        },
        {
          "id": "V-26978",
          "title": "The application must use multifactor authentication for local access\nto non-privileged accounts.",
          "desc": "Within X-Pack Security, a Custom Realm can be implemented that\nfulfills multifactor authentication. Multifactor checks can be integrated\nwithin the single custom realm.",
          "impact": 0.5,
          "refs": [],
          "tags": {
            "nist": [
              "IA-2 (4)",
              "Rev_4"
            ],
            "severity": "medium",
            "rid": "SV-34266r1_rule",
            "gtitle": "SRG-APP-000152",
            "cci": "CCI-000768",
            "check": "Guidance in Appendix B - System accounts cannot be disabled and\nelasticsearch does not enforce multifactor authentication.\n\nElasticsearch only supports PKI for multifactor authentication; to ensure PKI\nis enabled, verify the following settings.\n\n$ cat config/elasticsearch.yml | grep -A 6 -B 6 'type: \\?pki'\n\n xpack:\n  security:\n    authc:\n      realms:\n        pki1:\n          type: pki\n          username_pattern: 'EMAILADDRESS=(.*?)(?:,|$)'\n\nIf these settings are not correct or missing, this is a finding.\n\n",
            "fix": "Configure elasticsearch realms settings to point to\norganizational supported authentication mechanism\n\nSee the official documentation for the instructions on realm configuration:\nhttps://www.elastic.co/guide/en/x-pack/current/_how_authentication_works.html"
          },
          "code": "control \"V-26978\" do\n  title \"The application must use multifactor authentication for local access\nto non-privileged accounts.\"\n  desc  \"Within X-Pack Security, a Custom Realm can be implemented that\nfulfills multifactor authentication. Multifactor checks can be integrated\nwithin the single custom realm.\"\n  impact 0.5\n  tag \"nist\": [\"IA-2 (4)\", \"Rev_4\"]\n  tag \"severity\": \"medium\"\n  tag \"rid\": \"SV-34266r1_rule\"\n  tag \"gtitle\": \"SRG-APP-000152\"\n  tag \"cci\": \"CCI-000768\"\n  tag \"check\": \"Guidance in Appendix B - System accounts cannot be disabled and\nelasticsearch does not enforce multifactor authentication.\n\nElasticsearch only supports PKI for multifactor authentication; to ensure PKI\nis enabled, verify the following settings.\n\n$ cat config/elasticsearch.yml | grep -A 6 -B 6 'type: \\\\?pki'\n\n xpack:\n  security:\n    authc:\n      realms:\n        pki1:\n          type: pki\n          username_pattern: 'EMAILADDRESS=(.*?)(?:,|$)'\n\nIf these settings are not correct or missing, this is a finding.\n\n\"\n  tag \"fix\": \"Configure elasticsearch realms settings to point to\norganizational supported authentication mechanism\n\nSee the official documentation for the instructions on realm configuration:\nhttps://www.elastic.co/guide/en/x-pack/current/_how_authentication_works.html\"\n\n  begin\n\n    es_handle = es_helper(url:\"https://#{ELASTIC_IP}:#{ELASTIC_PORT}\",\n                    username: ES_ADMIN,\n                    password: ES_PASS,\n                    ssl_verify: SSL_VERIFY )\n\n    describe \"No nodes found\" do\n      subject { es_handle.nodes.nil? }\n      it { should_not be_truthy }\n    end if es_handle.nodes.nil?\n\n\n    es_handle.nodes.each do |node|\n      describe \"Authentication methods includes PKI for Node: #{node.name}\" do\n        subject { node }\n        its('authc_method') { should include 'pki' }\n      end\n    end unless es_handle.nodes.nil?\n\n    es_handle.nodes.each do |node|\n      describe.one do\n        node.authc_realm.keys.each do |auth_method|\n          describe \"PKI Settings for Node: #{node.name}\" do\n            subject { node.authc_realm[auth_method] }\n            its ('order') { should_not be_nil }\n            its ('username_pattern') { should_not be_nil }\n          end if node.authc_realm[auth_method].type.eql?('pki')\n        end\n      end\n    end unless es_handle.nodes.nil?\n\n  rescue Exception => msg\n    describe \"Exception: #{msg}\" do\n      it { should be_nil}\n    end\n  end\nend\n",
          "source_location": {
            "line": 36,
            "ref": "../elasticsearch-inspec/controls/pki/V-26978.rb"
          },
          "results": [
            {
              "status": "passed",
              "code_desc": "Authentication methods includes PKI for Node: package-centos-72 authc_method should include \"pki\"",
              "run_time": 0.000084,
              "start_time": "2018-02-11 14:27:14 -0500"
            },
            {
              "status": "passed",
              "code_desc": "PKI Settings for Node: package-centos-72 order should not be nil",
              "run_time": 0.000065,
              "start_time": "2018-02-11 14:27:14 -0500"
            },
            {
              "status": "passed",
              "code_desc": "PKI Settings for Node: package-centos-72 username_pattern should not be nil",
              "run_time": 0.000069,
              "start_time": "2018-02-11 14:27:14 -0500"
            }
          ]
        },
        {
          "id": "V-26977",
          "title": "The application must use multifactor authentication for local access\nto privileged accounts.",
          "desc": "Within X-Pack Security, a Custom Realm can be implemented that\nfulfills multifactor authentication. Multifactor checks can be integrated\nwithin the single custom realm.",
          "impact": 0.5,
          "refs": [],
          "tags": {
            "nist": [
              "IA-2 (3)",
              "Rev_4"
            ],
            "severity": "medium",
            "rid": "SV-34265r1_rule",
            "gtitle": "SRG-APP-000151",
            "cci": "CCI-000767",
            "check": "Guidance in Appendix B - System accounts cannot be disabled and\nelasticsearch does not enforce multifactor authentication.\n\nElasticsearch only supports PKI for multifactor authentication; to ensure PKI\nis enabled, verify the following settings.\n\n$ cat config/elasticsearch.yml | grep -A 6 -B 6 'type: \\?pki'\n\n xpack:\n  security:\n    authc:\n      realms:\n        pki1:\n          type: pki\n          username_pattern: 'EMAILADDRESS=(.*?)(?:,|$)'\n\nIf these settings are not correct or missing, this is a finding.\n\n",
            "fix": "Configure elasticsearch realms settings to point to\norganizational supported authentication mechanism\n\nSee the official documentation for the instructions on realm configuration:\nhttps://www.elastic.co/guide/en/x-pack/current/_how_authentication_works.html"
          },
          "code": "control \"V-26977\" do\n  title \"The application must use multifactor authentication for local access\nto privileged accounts.\"\n  desc  \"Within X-Pack Security, a Custom Realm can be implemented that\nfulfills multifactor authentication. Multifactor checks can be integrated\nwithin the single custom realm.\"\n  impact 0.5\n  tag \"nist\": [\"IA-2 (3)\", \"Rev_4\"]\n  tag \"severity\": \"medium\"\n  tag \"rid\": \"SV-34265r1_rule\"\n  tag \"gtitle\": \"SRG-APP-000151\"\n  tag \"cci\": \"CCI-000767\"\n  tag \"check\": \"Guidance in Appendix B - System accounts cannot be disabled and\nelasticsearch does not enforce multifactor authentication.\n\nElasticsearch only supports PKI for multifactor authentication; to ensure PKI\nis enabled, verify the following settings.\n\n$ cat config/elasticsearch.yml | grep -A 6 -B 6 'type: \\\\?pki'\n\n xpack:\n  security:\n    authc:\n      realms:\n        pki1:\n          type: pki\n          username_pattern: 'EMAILADDRESS=(.*?)(?:,|$)'\n\nIf these settings are not correct or missing, this is a finding.\n\n\"\n  tag \"fix\": \"Configure elasticsearch realms settings to point to\norganizational supported authentication mechanism\n\nSee the official documentation for the instructions on realm configuration:\nhttps://www.elastic.co/guide/en/x-pack/current/_how_authentication_works.html\"\n\n  begin\n\n    es_handle = es_helper(url:\"https://#{ELASTIC_IP}:#{ELASTIC_PORT}\",\n                    username: ES_ADMIN,\n                    password: ES_PASS,\n                    ssl_verify: SSL_VERIFY )\n\n    describe \"No nodes found\" do\n      subject { es_handle.nodes.nil? }\n      it { should_not be_truthy }\n    end if es_handle.nodes.nil?\n\n\n    es_handle.nodes.each do |node|\n      describe \"Authentication methods includes PKI for Node: #{node.name}\" do\n        subject { node }\n        its('authc_method') { should include 'pki' }\n      end\n    end unless es_handle.nodes.nil?\n\n    es_handle.nodes.each do |node|\n      describe.one do\n        node.authc_realm.keys.each do |auth_method|\n          describe \"PKI Settings for Node: #{node.name}\" do\n            subject { node.authc_realm[auth_method] }\n            its ('order') { should_not be_nil }\n            its ('username_pattern') { should_not be_nil }\n          end if node.authc_realm[auth_method].type.eql?('pki')\n        end\n      end\n    end unless es_handle.nodes.nil?\n\n  rescue Exception => msg\n    describe \"Exception: #{msg}\" do\n      it { should be_nil}\n    end\n  end\nend\n",
          "source_location": {
            "line": 35,
            "ref": "../elasticsearch-inspec/controls/pki/V-26977.rb"
          },
          "results": [
            {
              "status": "passed",
              "code_desc": "Authentication methods includes PKI for Node: package-centos-72 authc_method should include \"pki\"",
              "run_time": 0.000098,
              "start_time": "2018-02-11 14:27:14 -0500"
            },
            {
              "status": "passed",
              "code_desc": "PKI Settings for Node: package-centos-72 order should not be nil",
              "run_time": 0.000067,
              "start_time": "2018-02-11 14:27:14 -0500"
            },
            {
              "status": "passed",
              "code_desc": "PKI Settings for Node: package-centos-72 username_pattern should not be nil",
              "run_time": 0.000072,
              "start_time": "2018-02-11 14:27:14 -0500"
            }
          ]
        },
        {
          "id": "V-26980",
          "title": "Applications using multifactor authentication when accessing\nprivileged accounts via the network must provide one of the factors by a device\nthat is separate from the information system gaining access.",
          "desc": "Within X-Pack Security, a Custom Realm can be implemented that\nfulfills multifactor authentication. Multifactor checks can be integrated\nwithin the single custom realm.",
          "impact": 0.5,
          "refs": [],
          "tags": {
            "nist": [
              "IA-2 (6)",
              "Rev_3"
            ],
            "severity": "medium",
            "rid": "SV-34268r1_rule",
            "gtitle": "SRG-APP-000154",
            "cci": "CCI-000771",
            "check": "Guidance in Appendix B - System accounts cannot be disabled and\nelasticsearch does not enforce multifactor authentication.\n\nElasticsearch only supports PKI for multifactor authentication; to ensure PKI\nis enabled, verify the following settings.\n\n$ cat config/elasticsearch.yml | grep -A 6 -B 6 'type: \\?pki'\n\n xpack:\n  security:\n    authc:\n      realms:\n        pki1:\n          type: pki\n          username_pattern: 'EMAILADDRESS=(.*?)(?:,|$)'\n\nIf these settings are not correct or missing, this is a finding.\n\n",
            "fix": "Configure elasticsearch realms settings to point to\norganizational supported authentication mechanism\n\nSee the official documentation for the instructions on realm configuration:\nhttps://www.elastic.co/guide/en/x-pack/current/_how_authentication_works.html"
          },
          "code": "control \"V-26980\" do\n  title \"Applications using multifactor authentication when accessing\nprivileged accounts via the network must provide one of the factors by a device\nthat is separate from the information system gaining access.\"\n  desc  \"Within X-Pack Security, a Custom Realm can be implemented that\nfulfills multifactor authentication. Multifactor checks can be integrated\nwithin the single custom realm.\"\n  impact 0.5\n  tag \"nist\": [\"IA-2 (6)\", \"Rev_3\"]\n  tag \"severity\": \"medium\"\n  tag \"rid\": \"SV-34268r1_rule\"\n  tag \"gtitle\": \"SRG-APP-000154\"\n  tag \"cci\": \"CCI-000771\"\n  tag \"check\": \"Guidance in Appendix B - System accounts cannot be disabled and\nelasticsearch does not enforce multifactor authentication.\n\nElasticsearch only supports PKI for multifactor authentication; to ensure PKI\nis enabled, verify the following settings.\n\n$ cat config/elasticsearch.yml | grep -A 6 -B 6 'type: \\\\?pki'\n\n xpack:\n  security:\n    authc:\n      realms:\n        pki1:\n          type: pki\n          username_pattern: 'EMAILADDRESS=(.*?)(?:,|$)'\n\nIf these settings are not correct or missing, this is a finding.\n\n\"\n  tag \"fix\": \"Configure elasticsearch realms settings to point to\norganizational supported authentication mechanism\n\nSee the official documentation for the instructions on realm configuration:\nhttps://www.elastic.co/guide/en/x-pack/current/_how_authentication_works.html\"\n\n  begin\n\n    es_handle = es_helper(url:\"https://#{ELASTIC_IP}:#{ELASTIC_PORT}\",\n                    username: ES_ADMIN,\n                    password: ES_PASS,\n                    ssl_verify: SSL_VERIFY )\n\n    describe \"No nodes found\" do\n      subject { es_handle.nodes.nil? }\n      it { should_not be_truthy }\n    end if es_handle.nodes.nil?\n\n\n    es_handle.nodes.each do |node|\n      describe \"Authentication methods includes PKI for Node: #{node.name}\" do\n        subject { node }\n        its('authc_method') { should include 'pki' }\n      end\n    end unless es_handle.nodes.nil?\n\n    es_handle.nodes.each do |node|\n      describe.one do\n        node.authc_realm.keys.each do |auth_method|\n          describe \"PKI Settings for Node: #{node.name}\" do\n            subject { node.authc_realm[auth_method] }\n            its ('order') { should_not be_nil }\n            its ('username_pattern') { should_not be_nil }\n          end if node.authc_realm[auth_method].type.eql?('pki')\n        end\n      end\n    end unless es_handle.nodes.nil?\n\n  rescue Exception => msg\n    describe \"Exception: #{msg}\" do\n      it { should be_nil}\n    end\n  end\nend\n",
          "source_location": {
            "line": 35,
            "ref": "../elasticsearch-inspec/controls/pki/V-26980.rb"
          },
          "results": [
            {
              "status": "passed",
              "code_desc": "Authentication methods includes PKI for Node: package-centos-72 authc_method should include \"pki\"",
              "run_time": 0.000135,
              "start_time": "2018-02-11 14:27:14 -0500"
            },
            {
              "status": "passed",
              "code_desc": "PKI Settings for Node: package-centos-72 order should not be nil",
              "run_time": 0.000062,
              "start_time": "2018-02-11 14:27:14 -0500"
            },
            {
              "status": "passed",
              "code_desc": "PKI Settings for Node: package-centos-72 username_pattern should not be nil",
              "run_time": 0.000056,
              "start_time": "2018-02-11 14:27:14 -0500"
            }
          ]
        },
        {
          "id": "V-26973",
          "title": "The application must use multifactor authentication for network access\nto privileged accounts.",
          "desc": "Within X-Pack Security, a Custom Realm can be implemented that\nfulfills multifactor authentication. Multifactor checks can be integrated\nwithin the single custom realm.",
          "impact": 0.5,
          "refs": [],
          "tags": {
            "nist": [
              "IA-2 (1)",
              "Rev_4"
            ],
            "severity": "medium",
            "rid": "SV-34261r1_rule",
            "gtitle": "SRG-APP-000149",
            "cci": "CCI-000765",
            "check": "Guidance in Appendix B - System accounts cannot be disabled and\nelasticsearch does not enforce multifactor authentication.\n\nElasticsearch only supports PKI for multifactor authentication; to ensure PKI\nis enabled, verify the following settings.\n\n$ cat config/elasticsearch.yml | grep -A 6 -B 6 'type: \\?pki'\n\n xpack:\n  security:\n    authc:\n      realms:\n        pki1:\n          type: pki\n          username_pattern: 'EMAILADDRESS=(.*?)(?:,|$)'\n\nIf these settings are not correct or missing, this is a finding.\n\n",
            "fix": "Configure elasticsearch realms settings to point to\norganizational supported authentication mechanism\n\nSee the official documentation for the instructions on realm configuration:\nhttps://www.elastic.co/guide/en/x-pack/current/_how_authentication_works.html"
          },
          "code": "control \"V-26973\" do\n  title \"The application must use multifactor authentication for network access\nto privileged accounts.\"\n  desc  \"Within X-Pack Security, a Custom Realm can be implemented that\nfulfills multifactor authentication. Multifactor checks can be integrated\nwithin the single custom realm.\"\n  impact 0.5\n  tag \"nist\": [\"IA-2 (1)\", \"Rev_4\"]\n  tag \"severity\": \"medium\"\n  tag \"rid\": \"SV-34261r1_rule\"\n  tag \"gtitle\": \"SRG-APP-000149\"\n  tag \"cci\": \"CCI-000765\"\n  tag \"check\": \"Guidance in Appendix B - System accounts cannot be disabled and\nelasticsearch does not enforce multifactor authentication.\n\nElasticsearch only supports PKI for multifactor authentication; to ensure PKI\nis enabled, verify the following settings.\n\n$ cat config/elasticsearch.yml | grep -A 6 -B 6 'type: \\\\?pki'\n\n xpack:\n  security:\n    authc:\n      realms:\n        pki1:\n          type: pki\n          username_pattern: 'EMAILADDRESS=(.*?)(?:,|$)'\n\nIf these settings are not correct or missing, this is a finding.\n\n\"\n  tag \"fix\": \"Configure elasticsearch realms settings to point to\norganizational supported authentication mechanism\n\nSee the official documentation for the instructions on realm configuration:\nhttps://www.elastic.co/guide/en/x-pack/current/_how_authentication_works.html\"\n\n  begin\n\n    es_handle = es_helper(url:\"https://#{ELASTIC_IP}:#{ELASTIC_PORT}\",\n                    username: ES_ADMIN,\n                    password: ES_PASS,\n                    ssl_verify: SSL_VERIFY )\n\n    describe \"No nodes found\" do\n      subject { es_handle.nodes.nil? }\n      it { should_not be_truthy }\n    end if es_handle.nodes.nil?\n\n\n    es_handle.nodes.each do |node|\n      describe \"Authentication methods includes PKI for Node: #{node.name}\" do\n        subject { node }\n        its('authc_method') { should include 'pki' }\n      end\n    end unless es_handle.nodes.nil?\n\n    es_handle.nodes.each do |node|\n      describe.one do\n        node.authc_realm.keys.each do |auth_method|\n          describe \"PKI Settings for Node: #{node.name}\" do\n            subject { node.authc_realm[auth_method] }\n            its ('order') { should_not be_nil }\n            its ('username_pattern') { should_not be_nil }\n          end if node.authc_realm[auth_method].type.eql?('pki')\n        end\n      end\n    end unless es_handle.nodes.nil?\n\n  rescue Exception => msg\n    describe \"Exception: #{msg}\" do\n      it { should be_nil}\n    end\n  end\nend\n",
          "source_location": {
            "line": 35,
            "ref": "../elasticsearch-inspec/controls/pki/V-26973.rb"
          },
          "results": [
            {
              "status": "passed",
              "code_desc": "Authentication methods includes PKI for Node: package-centos-72 authc_method should include \"pki\"",
              "run_time": 0.00013,
              "start_time": "2018-02-11 14:27:14 -0500"
            },
            {
              "status": "passed",
              "code_desc": "PKI Settings for Node: package-centos-72 order should not be nil",
              "run_time": 0.000056,
              "start_time": "2018-02-11 14:27:14 -0500"
            },
            {
              "status": "passed",
              "code_desc": "PKI Settings for Node: package-centos-72 username_pattern should not be nil",
              "run_time": 0.000067,
              "start_time": "2018-02-11 14:27:14 -0500"
            }
          ]
        },
        {
          "id": "V-26981",
          "title": "Applications using multifactor authentication when accessing\nnon-privileged accounts via the network must provide one of the factors by a\ndevice separate from the information system gaining access.",
          "desc": "Within X-Pack Security, a Custom Realm can be implemented that\nfulfills multifactor authentication. Multifactor checks can be integrated\nwithin the single custom realm.",
          "impact": 0.5,
          "refs": [],
          "tags": {
            "nist": [
              "IA-2 (7)",
              "Rev_3"
            ],
            "severity": "medium",
            "rid": "SV-34270r1_rule",
            "gtitle": "SRG-APP-000155",
            "cci": "CCI-000772",
            "check": "Guidance in Appendix B - System accounts cannot be disabled and\nelasticsearch does not enforce multifactor authentication.\n\nElasticsearch only supports PKI for multifactor authentication; to ensure PKI\nis enabled, verify the following settings.\n\n$ cat config/elasticsearch.yml | grep -A 6 -B 6 'type: \\?pki'\n\n xpack:\n  security:\n    authc:\n      realms:\n        pki1:\n          type: pki\n          username_pattern: 'EMAILADDRESS=(.*?)(?:,|$)'\n\nIf these settings are not correct or missing, this is a finding.\n\n",
            "fix": "Configure elasticsearch realms settings to point to\norganizational supported authentication mechanism\n\nSee the official documentation for the instructions on realm configuration:\nhttps://www.elastic.co/guide/en/x-pack/current/_how_authentication_works.html"
          },
          "code": "control \"V-26981\" do\n  title \"Applications using multifactor authentication when accessing\nnon-privileged accounts via the network must provide one of the factors by a\ndevice separate from the information system gaining access.\"\n  desc  \"Within X-Pack Security, a Custom Realm can be implemented that\nfulfills multifactor authentication. Multifactor checks can be integrated\nwithin the single custom realm.\"\n  impact 0.5\n  tag \"nist\": [\"IA-2 (7)\", \"Rev_3\"]\n  tag \"severity\": \"medium\"\n  tag \"rid\": \"SV-34270r1_rule\"\n  tag \"gtitle\": \"SRG-APP-000155\"\n  tag \"cci\": \"CCI-000772\"\n  tag \"check\": \"Guidance in Appendix B - System accounts cannot be disabled and\nelasticsearch does not enforce multifactor authentication.\n\nElasticsearch only supports PKI for multifactor authentication; to ensure PKI\nis enabled, verify the following settings.\n\n$ cat config/elasticsearch.yml | grep -A 6 -B 6 'type: \\\\?pki'\n\n xpack:\n  security:\n    authc:\n      realms:\n        pki1:\n          type: pki\n          username_pattern: 'EMAILADDRESS=(.*?)(?:,|$)'\n\nIf these settings are not correct or missing, this is a finding.\n\n\"\n  tag \"fix\": \"Configure elasticsearch realms settings to point to\norganizational supported authentication mechanism\n\nSee the official documentation for the instructions on realm configuration:\nhttps://www.elastic.co/guide/en/x-pack/current/_how_authentication_works.html\"\n\n  begin\n\n    es_handle = es_helper(url:\"https://#{ELASTIC_IP}:#{ELASTIC_PORT}\",\n                    username: ES_ADMIN,\n                    password: ES_PASS,\n                    ssl_verify: SSL_VERIFY )\n\n    describe \"No nodes found\" do\n      subject { es_handle.nodes.nil? }\n      it { should_not be_truthy }\n    end if es_handle.nodes.nil?\n\n\n    es_handle.nodes.each do |node|\n      describe \"Authentication methods includes PKI for Node: #{node.name}\" do\n        subject { node }\n        its('authc_method') { should include 'pki' }\n      end\n    end unless es_handle.nodes.nil?\n\n    es_handle.nodes.each do |node|\n      describe.one do\n        node.authc_realm.keys.each do |auth_method|\n          describe \"PKI Settings for Node: #{node.name}\" do\n            subject { node.authc_realm[auth_method] }\n            its ('order') { should_not be_nil }\n            its ('username_pattern') { should_not be_nil }\n          end if node.authc_realm[auth_method].type.eql?('pki')\n        end\n      end\n    end unless es_handle.nodes.nil?\n\n  rescue Exception => msg\n    describe \"Exception: #{msg}\" do\n      it { should be_nil}\n    end\n  end\nend",
          "source_location": {
            "line": 35,
            "ref": "../elasticsearch-inspec/controls/pki/V-26981.rb"
          },
          "results": [
            {
              "status": "passed",
              "code_desc": "Authentication methods includes PKI for Node: package-centos-72 authc_method should include \"pki\"",
              "run_time": 0.000192,
              "start_time": "2018-02-11 14:27:14 -0500"
            },
            {
              "status": "passed",
              "code_desc": "PKI Settings for Node: package-centos-72 order should not be nil",
              "run_time": 0.000202,
              "start_time": "2018-02-11 14:27:14 -0500"
            },
            {
              "status": "passed",
              "code_desc": "PKI Settings for Node: package-centos-72 username_pattern should not be nil",
              "run_time": 0.000235,
              "start_time": "2018-02-11 14:27:14 -0500"
            }
          ]
        },
        {
          "id": "V-26927",
          "title": "The application, when utilizing PKI-based authentication, must\nvalidate certificates by constructing a certification path with status\ninformation to an accepted trust anchor.",
          "desc": "Configure the centralized authentication service to enforce\norganizational policies such as valid certification path, trusted anchor,\ncertificate revocation lists.",
          "impact": 0.5,
          "refs": [],
          "tags": {
            "nist": [
              "IA-5 (2) (a)",
              "Rev_4"
            ],
            "severity": "medium",
            "rid": "SV-34207r1_rule",
            "gtitle": "SRG-APP-000175",
            "cci": "CCI-000185",
            "check": "When using PKI-based authentication; the certificate path must\nbe validated.\n\n$ cat config/elasticsearch.yml | grep -A 10 -B 6 'type: \\?pki'\n\n xpack:\n  security:\n    authc:\n      realms:\n        pki1:\n          type: pki\n          username_pattern: 'EMAILADDRESS=(.*?)(?:,|$)'\n          certificate_authorities: <CA_PATH>\n          truststore.path: <TS_PATH>\n\nIf these settings are not correct or missing, this is a finding.  ",
            "fix": "Configure elasticsearch realms settings to point to\norganizational supported authentication mechanism\n\nSee the official documentation for the instructions on realm configuration:\nhttps://www.elastic.co/guide/en/x-pack/current/_how_authentication_works.html"
          },
          "code": "control \"V-26927\" do\n  title \"The application, when utilizing PKI-based authentication, must\nvalidate certificates by constructing a certification path with status\ninformation to an accepted trust anchor.\"\n  desc  \"Configure the centralized authentication service to enforce\norganizational policies such as valid certification path, trusted anchor,\ncertificate revocation lists.\"\n  impact 0.5\n  tag \"nist\": [\"IA-5 (2) (a)\", \"Rev_4\"]\n  tag \"severity\": \"medium\"\n  tag \"rid\": \"SV-34207r1_rule\"\n  tag \"gtitle\": \"SRG-APP-000175\"\n  tag \"cci\": \"CCI-000185\"\n  tag \"check\": \"When using PKI-based authentication; the certificate path must\nbe validated.\n\n$ cat config/elasticsearch.yml | grep -A 10 -B 6 'type: \\\\?pki'\n\n xpack:\n  security:\n    authc:\n      realms:\n        pki1:\n          type: pki\n          username_pattern: 'EMAILADDRESS=(.*?)(?:,|$)'\n          certificate_authorities: <CA_PATH>\n          truststore.path: <TS_PATH>\n\nIf these settings are not correct or missing, this is a finding.  \"\n  tag \"fix\": \"Configure elasticsearch realms settings to point to\norganizational supported authentication mechanism\n\nSee the official documentation for the instructions on realm configuration:\nhttps://www.elastic.co/guide/en/x-pack/current/_how_authentication_works.html\"\n\n  begin\n\n    es_handle = es_helper(url:\"https://#{ELASTIC_IP}:#{ELASTIC_PORT}\",\n                    username: ES_ADMIN,\n                    password: ES_PASS,\n                    ssl_verify: SSL_VERIFY )\n\n    describe \"No nodes found\" do\n      subject { es_handle.nodes.nil? }\n      it { should_not be_truthy }\n    end if es_handle.nodes.nil?\n\n\n    es_handle.nodes.each do |node|\n      describe \"Authentication methods includes PKI for Node: #{node.name}\" do\n        subject { node }\n        its('authc_method') { should include 'pki' }\n      end\n    end unless es_handle.nodes.nil?\n\n    es_handle.nodes.each do |node|\n      describe.one do\n        node.authc_realm.keys.each do |auth_method|\n          describe \"PKI Settings for Node: #{node.name}\" do\n            subject { node.authc_realm[auth_method] }\n            its ('order') { should_not be_nil }\n            its ('username_pattern') { should_not be_nil }\n          end if node.authc_realm[auth_method].type.eql?('pki')\n        end\n      end\n    end unless es_handle.nodes.nil?\n\n  rescue Exception => msg\n    describe \"Exception: #{msg}\" do\n      it { should be_nil}\n    end\n  end\nend\n",
          "source_location": {
            "line": 35,
            "ref": "../elasticsearch-inspec/controls/pki/V-26927.rb"
          },
          "results": [
            {
              "status": "passed",
              "code_desc": "Authentication methods includes PKI for Node: package-centos-72 authc_method should include \"pki\"",
              "run_time": 0.000298,
              "start_time": "2018-02-11 14:27:14 -0500"
            },
            {
              "status": "passed",
              "code_desc": "PKI Settings for Node: package-centos-72 order should not be nil",
              "run_time": 0.000206,
              "start_time": "2018-02-11 14:27:15 -0500"
            },
            {
              "status": "passed",
              "code_desc": "PKI Settings for Node: package-centos-72 username_pattern should not be nil",
              "run_time": 0.00014,
              "start_time": "2018-02-11 14:27:15 -0500"
            }
          ]
        }
      ]
    }
  ],
  "statistics": {
    "duration": 51.84415
  },
  "version": "1.51.6",
  "other_checks": []
}
